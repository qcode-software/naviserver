From: David Osborne <david@qcode.co.uk>
Date: Thu, 3 Nov 2016 11:10:20 +0000
Subject: partialtimes bug fix

---
 nsd/queue.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/nsd/queue.c b/nsd/queue.c
index 1009fc6..4782e2d 100644
--- a/nsd/queue.c
+++ b/nsd/queue.c
@@ -1565,6 +1565,8 @@ ConnRun(const ConnThreadArg *UNUSED(argPtr), Conn *connPtr)
         }
     }
 
+    Ns_ConnTimeStats(conn);
+
     if ((status == NS_OK) || (status == NS_FILTER_RETURN)) {
         status = NsRunFilters(conn, NS_FILTER_TRACE);
         if (status == NS_OK) {
@@ -1601,7 +1603,6 @@ ConnRun(const ConnThreadArg *UNUSED(argPtr), Conn *connPtr)
 
     (void) Ns_ConnClose(conn);
 
-    Ns_ConnTimeStats(conn);
     connPtr->reqPtr = NULL;
 
     /*
