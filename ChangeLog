commit 4edd96403f7e6477f9271ecae2f62fe4be77db8a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-29

    added comment to NEWS file

M	NEWS

commit 774b7591d024589a142809b123d66f21fa803eeb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-29

    release work

M	NEWS

commit 0402dcd0344d02796766a2999bf5cee3614b65d4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-29

    fix nesting of lists

M	doc/src/naviserver/ns_baseunit.man
M	doc/src/naviserver/ns_strcoll.man

commit 95b92c051ac2ce2616734c1da2496baeb2ed6970
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-29

    release work

M	README
M	configure.ac
M	doc/src/naviserver/ns_baseunit.man

commit 7df7b3220893c4207326d18d3226e52b5130b33a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-29

    minor compilation cleanup for clang on some platforms

M	nsthread/time.c

commit bf8e94003371c15a050d362ddf95e9f30eade0fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-29

    updated default include/nsconfig.h.in due to m4 changes

M	include/nsconfig.h.in

commit 062980bc467302fe09dffa767de58ec5f9230230
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-29

    mark ns_set_precision as deprecated

M	tcl/util.tcl

commit 817dfbb3f7bb702128a2bc5c536438787bbd255d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-29

    modernize m4 macros to get rid of warnings during autogen.sh

M	m4/ax_pthread.m4
M	m4/sendfile.m4
M	m4/tcl.m4

commit 94e8513543abccc12278669d93d822d8fbcaef3b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-29

    improve man page

M	doc/src/naviserver/ns_strcoll.man

commit 6b6112ab1b4d6d3f4a6b1082a6085f7956efe676
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-22

    further fine-tune cross-platform behavior of locale specific comparison

M	tests/misc.test

commit 418331f1ca190bbd80e6993ed678369f6a9a3688
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-22

    fine-tune cross-platform behavior of locale specific comparison

M	tests/misc.test

commit e1001e83ff703800a4fbb63e2ed8697f924df00d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-22

    improve cross-platform behavior of locale specific comparison

M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/tclmisc.c
M	tests/misc.test

commit 25a9fece0655e2ff9ed1ea9ca17f3d3b5fa5a296
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-20

    prepare rc2

M	configure.ac

commit 25abfa12d525758abda7ff4e554566128a859fd4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-20

    fix windows compatibility (many thanks to Oleg Oleinik)

M	nsd/tclmisc.c

commit b31889c92ba569d930755797f89ad3b7b70842e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-20

    improve error message

M	nsdb/dbinit.c

commit 0be5a19431979f5ab99ae46838db14261ac68818
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-16

    Improve robustness of ns_strcoll
    
    - provide error message, when locale lookup fails
    - try to get LC_COLLATE from current locale settings instead of
      hard-wiring en_US.UTF-8.

M	doc/src/naviserver/ns_strcoll.man
M	nsd/tclmisc.c
M	tests/misc.test

commit c44101766aec901e4fcafc4eefadb8b49b43030b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-13

    improve heuristics in openssl.m4 to determine the LD_PATH when "--with-openssl" is used

M	m4/openssl.m4

commit 9ee23a34376c23c170b0db1dcb6dc181c7793c72
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-13

    Keep exit() in bind on the original place
    
    It seems that a recent "cleanup" change was introducing a bug, when
    naviserver is running with daemontools, since binder processes are not
    terminated correctly (see [1]). Although i see no problems when nsd is
    running under plain systemd (the recommended way), reverting seems
    appropriate, at least for legacy setups.

M	nsd/binder.c

commit b918154f7ae61a37072b4277ef569fa4499c449c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-13

    reduce implicit conversions

M	nsd/sock.c

commit 5937a06ed83057af66f88a76947cc1a20362fd4e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-08

    include basic test cases for ns_crypto::aead::encrypt and decrypt

M	tests/ns_crypto.test

commit 26d1ca8adf6f1678207b064f80584c5d38f5a551
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-08

    improved documentation of ns_crypto::aead::encrypt
    
    make clear that result of encryption is randomized. Two messages with the same plaintext will not yield the same ciphertext.

M	doc/src/naviserver/ns_crypto.man

commit 2df3b29f7dedd0613224904223691aace7d3b78c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-08

    Improved log files entries
    
    Include just a single line when someone tries to connect to a plain nssock connection via TLS

M	nsd/driver.c
M	nsd/request.c

commit 454fe6980ebb56281c7f64cd25f6aa90d5b5ced3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-05

    updated version numbers

M	README
M	configure.ac

commit e3f33ba8a96f3540e7176b63e01b382fd264a224
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-05

    silence static checkers

M	nsd/index.c
M	nsd/tclcallbacks.c
M	nsd/tclmisc.c

commit a57ee5cdf8674cb06f2f42986dab7b32d6ffac81
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-05

    improve documentation

M	doc/src/naviserver/textutil-cmds.man

commit 54ff3baa2aa550e1da8906a8e738643b07026728
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-04

    fix dirty editor buffer problem

M	nsd/tclmisc.c

commit cf1deb8f239d0d7573ecf771af90ec5f9888f4dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-12-04

    Added experimental commands "ns_baseunit" and "ns_strcoll"
    
    - ns_baseunit ?-size size? ?-time time?
    
      Convert from memory units or from time units to its
      base value using the NaviServer internal converters,
      which are used the same way for various commands.
      The base unit for a memory size is a byte,
      for a time value a second). This command os necessary to
      provide Tcl-level commands calculating with these
      units to support uniform interfaces (e.g. calculating
      cache partition sizes base on values such as 2MB).
    
      Either "-size" or "-time" has to be specified.
    
      % ns_baseunit -size 10KB
      10240
    
      ns_baseunit -time 2.5h
      9000
    
    - ns_strcoll ?-locale locale? string1 string2"
    
      This command compares lexicographically string1 with string2
      according to the current locale collation and returns an integer
      greater than, equal to, or less than 0, depending on whether string1
      is greater than, equal to, or less than string2. The command is
      necessary in cases, where e.g. the sorting order from the database
      (normally based on local collation) is different from default Tcl
      sorting order to provide a unifor interface with same sorting
      orders. The name is derived from the baseline POSIX function call.
    
      The command is suitable for usage in the lsort command:
    
      % set l {Bor Bar Bär}
      % lsort -command ns_strcoll $l
      Bar Bär Bor
    
      % lsort $l
      Bar Bor Bär

M	configure.ac
M	doc/src/naviserver/commandlist.man
A	doc/src/naviserver/ns_baseunit.man
M	doc/src/naviserver/ns_charsets.man
M	doc/src/naviserver/ns_choosecharset.man
M	doc/src/naviserver/ns_cookiecharset.man
M	doc/src/naviserver/ns_encodingforcharset.man
M	doc/src/naviserver/ns_encodingfortype.man
M	doc/src/naviserver/ns_formfieldcharset.man
M	doc/src/naviserver/ns_setformencoding.man
M	doc/src/naviserver/ns_sockcallback.man
A	doc/src/naviserver/ns_strcoll.man
M	doc/src/naviserver/ns_urlcharset.man
M	doc/src/naviserver/ns_valid_utf8.man
M	include/nsconfig.h.in
M	include/nsthread.h
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c

commit cf05d72705d203d06a56ef5ccebcfefaf0917871
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-11-29

    Extended number of supported time units
    
    The newly added time units are w, y.
    Accepted time units are: μs, ms, s, m, h, d, w, y

M	doc/src/naviserver/ns_adp_include.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_cookie.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_schedule.man
M	doc/src/naviserver/ns_shutdown.man
M	doc/src/naviserver/ns_sleep.man
M	doc/src/naviserver/ns_sockcallback.man
M	doc/src/naviserver/ns_sockopen.man
M	doc/src/naviserver/ns_time.man
M	nsd/tcltime.c

commit ea0cc4ed5ff346091a8995a145ba319de7d29553
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-11-21

    minor cleanup
    
    - added nonnull assert
    - fixed typos

M	nsd/tclobjv.c
M	nsdb/dbdrv.c
M	nsdb/nsdb.h
M	nsdbtest/nsdbtest.c

commit 13485e567d4947091d42ee4dc91a28c67f79d050
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-11-19

    convert now also data to proper external UTF8 for the plain ns_db command
    
    A similar change was done before on "ns_pg_bind" in the nsdbpg driver.
    Btw, the 700-line function DbObjCmd() consisting mostly of a
    switch statement should be split off.

M	nsdb/dbtcl.c

commit 67adf3c34710e7cfae553b63d0b0d1d21c2d9729
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-11-09

    set default for "concurrentinterpcreate" to "true" for Tcl 8.6 or newer
    
    Versions up to at least Tcl 8.5 are known to
    crash in case two threads create interpreters at the same
    time. These crashes were hard to reproduce, but serializing
    helped. Since all our major servers are running since several
    years without problems with this parameter turned on the default is now set to "true", when NaviServer is
    compiled with Tcl 8.6 or newer.

M	doc/src/manual/admin-tuning.man
M	doc/src/naviserver/ns_ictl.man
M	nsd-config.tcl
M	nsd/adpeval.c
M	nsd/tclinit.c
M	openacs-config.tcl

commit cf607ce53526e597df4a10f11b498ea074641b1c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-11-09

    make sure to produce "Tcl-external" UTF-8 for multi-byte characters
    
    Earlier versions assumed that tcl-internal UTF-8 is also valid UTF-8 for external
    sources, which is often, but not always true. For example, "U+1F603 Smiling Face
    with Open Mouth Unicode Character" is in Tcl internal representation 6 bytes and
    in external representation 4 bytes. The bypass of the conversion for utf-8
    was removed by this change. Regression test was extended.

M	nsd/connio.c
M	tests/ns_http_charsets.test

commit 416b615066c979fcf6e22f6c71a2db45f7df40f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-10-29

    Do not declare reserved C identifiers
    
    All identifiers that begin with an underscore and either an uppercase letter or
    another underscore are reserved in the C standard.

M	include/ns.h

commit f9a919f8cb39fdf3b25fac67f5fde69f27c2a83a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-10-29

    Ease configuration via environment variables (e.g. for docker settings)

M	openacs-config.tcl
M	tcl/init.tcl

commit 8383a07f420193173f806b966427135614adcf64
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-10-29

    ns_trim enhancements
    
    - added option "-prefix"
    - added test cases

M	doc/src/naviserver/textutil-cmds.man
M	nsd/tclmisc.c
M	tests/misc.test

commit 3b25096e6e82f3826125c38710dc0876bea5c962
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-10-27

    fixed memory leak in "nsv_dict get" operations

M	nsd/tclvar.c

commit 66d6da76426c48741d3965f46cc1d71bffe42c0b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-09-29

    debug, why interp updates take very long when a high number of threads and cores are available

M	nsd/tclinit.c

commit c0e8a79a7e2dec2a594bfbde2c7fa2c64e43acaa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-09-29

    fixed documentation, how to obtain the registered filters

M	doc/src/naviserver/ns_register.man

commit ce7de0a488317efc9180be60870f980454f1957c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-09-28

    New crypto function: ::ns_crypto::pbkdf2_hmac
    
    This function computes a password hash using PBKDF2 (Password-Based
    Key Derivation Function 2). This function is used to reduce
    vulnerabilities of brute-force attacks against password hashes and is
    used e.g. in SCRAM (Salted Challenge Response Authentication
    Mechanism).
    
    The hash function of SCRAM is PBKDF2 [RFC2898] with HMAC as the
    pseudorandom function (PRF) and with dkLen == output length of
    HMAC == output length of the digest function.
    
    Here is an example of using pbkdf2_hmac for the hash function of
    SCRAM-sha-256. RFC 7677 recommends to use 15K iterations for PBKDF2.
    
      ::ns_crypto::pbkdf2_hmac \
               -digest sha256 \
               -iterations 15000 \
               -secret $password \
               -salt $salt]

M	doc/src/naviserver/ns_crypto.man
M	doc/src/naviserver/ns_job.man
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/tclcmds.c
M	nsd/tclcrypto.c
M	tests/ns_crypto.test

commit d2f816f21ad11a1bc12a4313a3959e1696adbccc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-09-26

    handle (most common) case, where cachingmode is not specified in the configuration file

M	nsd/nsmain.c

commit dd5b2ccc935a72aa04708b7411973ea1167d7f71
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-09-24

    use term "cachingmode" instead of "nocache"
    
    This change for the experimental flag leaves more room for future
    extensions, since there are multiple (mutual exclusive) caching modes
    possible.

M	nsd/nsmain.c
M	nsd/tclcache.c

commit 2de81db4a528f8bd49284109f271a76994114b17
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-09-23

    fix behavior with experimental nocache feature of ns_cache_eval where eval block contains "return" statement

M	nsd/tclcache.c

commit 27e93b08560af90f112513c0936332c4c40344ef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-09-21

    added an experimental global parameter "nocache" to exeriment with horizontal scaling

M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/tclcache.c

commit c7611641e17a090a7de08ea83bf0bac5802e8e32
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-09-17

    remove unneeded arguments

M	nsd/driver.c
M	nsperm/nsperm.c

commit a3a6bbe979b1c17ef63e893c5d4a5b51045eda99
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-27

    minor optimization for TransferHandleStats()

M	nsdb/dbinit.c

commit f18e72133d715881f50876c55b451825d9a6c283
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-27

    Increase scalability on DB operations by reducing DB pool locks
    
    On one of our main servers, the total number of locks and busy locks
    is the highest on nsdb:pool1, where a large number of these locks
    origin from statistics operations. The new code caches these
    statistics in the handles (which are per thread, requiring no locks)
    and transfers the aggregated values on handle closes or statistics
    calls.

M	nsdb/db.h
M	nsdb/dbinit.c

commit cf87f194f1013a2e4338e4256c3a35560544ab92
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-25

    release work

M	NEWS

commit 0c1c29c882e5653667fc4888c0bcb1fcc1fff962
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-25

    release work

M	NEWS

commit 107e2d732975523722e158bc5149491dcf505871
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-25

    release work

M	NEWS

commit 1a79b9c1b9b3501272c7ee74ed6f2328f7d2a1ce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-25

    release work

M	configure.ac
M	doc/src/manual/admin-maintenance.man
M	nscgi/doc/mann/nscgi.man
M	nscp/doc/mann/nscp.man

commit b0a76028caa23d4e1d20fb570998de7cb64a3c0f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-25

    minor cleanup

M	nsd/tclxkeylist.c
M	nsd/tls.c

commit b6921025aacf4d249b56201284ba0089d58b80de
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-24

    use consistently "NS_RESTRICT" instead of "restrict"

M	nsd/sockaddr.c

commit 2090329d6b92f850da656298f66855ec34806d3f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-24

    added handling of __restrict for MSVC

M	include/nscheck.h

commit c091c57ef7dc82b8d86d413db5eef6ac015da776
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-23

    minor configure magic update
    
    - make it possible to pass CFLAGS_OPTIMIZE to Makefile
    - make sure that linker uses passed-in C compiler (remove warning about different libraries on macOS)

M	configure.ac
M	include/Makefile.global.in
M	m4/tcl.m4

commit 212dbd148bff38f834e773ca3faf4631105a04d9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-23

    make clear, we are talking about cache entries

M	doc/src/naviserver/ns_cache.man

commit 51c21ec5bcc4c9c06c6fd1b51b8c27abe5d07bd6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-23

    improve variable name

M	nsd/log.c

commit f481758c314b46eb5d4073ee0240fe7f630ab340
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-17

    Fixed more issues flagged by fb infer 1.1

M	nsthread/memory.c
M	nsthread/nsthreadtest.c

commit b09b11eac93b98e1dc0ff59f782d3e5a9ae8ff49
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-16

    release work

M	README
M	configure.ac

commit 7bf2468775ccbbf2191db7b5382624b173332121
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-16

    fix man page

M	doc/src/naviserver/ns_http.man

commit f7740ac62376d99170f904403a9bc50d80824b44
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-16

    minor cleanup

M	NEWS
M	doc/src/naviserver/commandlist.man
A	doc/src/naviserver/ns_valid_utf8.man
M	nsd/str.c
M	nsd/tclmisc.c

commit 8114f6870009985366a65342928062f08cde80fe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-16

    Added more comments to double-fork construct in NsForkBinder()

M	nsd/binder.c

commit db057401dae34267279f16299b1aee7570240341
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-16

    styling conventions: use uppercase for hexdigits

M	nsd/connchan.c

commit d4857ae89d8ae0fe152ab5ea7d55e0d580db5cc2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-16

    minor code cleanup: added missing static declaration, reduced implicit coversions, added prototype

M	nsd/connchan.c
M	nsd/str.c
M	nsd/tclhttp.c

commit 4ae77fd73e7dffb6cd777fa814b3796fd65c4751
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-16

    avoid passing NULL after the last typed argument to a variadic function

M	nsd/sock.c

commit aabca15a0aa3295850a05f5ff1e1bd1745b16f62
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-16

    improve handling when running out of memory (raising tcl error, don't set erroneous values)

M	nsd/tclthread.c

commit ac3b8c473cf5b3af4a4d06efd5fb0e4e70a75976
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-15

    silence compiler when fprinting rlim_t

M	nsd/nsmain.c

commit b70152a504024c4ccf283c2ced9ea6a2a7698511
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-15

    Fixed Apple M1 problem with double-fork in NsBinder()
    
    The problem was the reuse of the variable "pid" for both forks.
    We are using now two different variables, everything is fine.
    The same thing could have hit as well for other architectures.

M	nsd/binder.c

commit 23027e1d8fd2ac82f996de6127524e1bfd624912
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-15

    silence picky compilers

M	include/nsthread.h

commit ec17b3d8d7229b1016cd231d48d27641e9652aaf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-14

    Improved support for Apple M1 machines:
    - call NsForkBinder() only when prebind is specified, such that
      regression test and testing on non-privileged ports works
      (there is still a problem when prebind is specified on M1 with
      the double-fork construct)
    - Improved output of limit warning (rl.rlim_cur == handle RLIM_INFINITY)

M	nsd/nsmain.c

commit 9c0f55b9bb81783e65f007c1f98450e4ff0f8645
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-14

    install man.css extra for better appearance on plain git checkouts (without running doc-generation)

M	Makefile

commit d1fd94c4d0c4ba099994a699a89f614d70be87e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-09

    fix for FreeBSD 13.0-CURRENT: complains about failing unlock in "ns_logctl flush" call

M	nsd/log.c

commit d90b0979342a02be73a54f502be9b41933fd5593
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-04

    macOS fix for connecting to domain names having multiple IP addresses assigend
    
    The behaviour on macOS differs from Linux: while we see a writable
    socket during in-progress states, we do not get this under macOS. In
    case, we have no error state, we retry.

M	nsd/sock.c

commit 831e5e59e4d1edc1058b1e8adde3a42a53d5726a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-04

    Improved backwards compatibility of ns_parseurl
    
    The new version does not require that every relative URL has to start
    with a slash or dot, but accepts everything that does not look like a
    scheme. Also, the legacy behavior (put everything into "tail" when
    relative URL does not start with a slash) is preserved.

M	doc/src/naviserver/ns_parseurl.man
M	nsd/url.c
M	tests/ns_parseurl.test

commit d0cb971cb809fac732a071e5985e08d8b4fd5eb0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-04

    Do not require to have tcllib package "try" installed when using Tcl 8.6 or newer

M	tests/http_chunked.test
M	tests/ns_http.test
M	tests/ns_nsv.test

commit 78f85e2164aa9d30c6609789d885ec8c9d0770a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-03

    extended regression test for parsing paths with ns_parseurl (including legacy behavior)

M	tests/ns_parseurl.test

commit 7dd81c484e211cff59ae816da7fd72c33314ad8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-03

    document legacy behavior of parsing relative URLs starting with a "."

M	doc/src/naviserver/ns_parseurl.man

commit 1958a0fc3df37708980f6cde35434620c33b4aed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-03

    accept URLs (actually paths) stating with a "." to improve legacy compatibility

M	nsd/url.c
M	tests/ns_parseurl.test

commit 8235f30928356d45bb80bd337bef741e5c24b641
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-02

    improve spelling

M	tcl/compat.tcl

commit ae5953823c5fdc6a3050f0e8cbe3738da0fd075d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-02

    Reduce usage of ns_mktemp
    
    ns_mktemp uses the deprecated old POSIX call mktemp(), which should
    not be used anymore for security reasons (race between the name
    creation and opening the file). This change removes all usages of
    "ns_mktemp" from the NaviServer code and replaces it with calls to the
    safe Tcl call "file tempfile ..." as introduced by Tcl 8.6. A
    compatibility version for Tcl 8.5 is included in the code.

M	tcl/form.tcl

commit 85b896c0c0e0f3e33998a70b4cac9e8b119d3178
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-08-02

    Added remaining work of Oleg Oleinick (as contributed last year) to main NaviServer
    
    - made TCLHTTP_USE_EXTERNALTOUTF default (since this is the right thing,
      since it handles the provided encoding in non-binary cases)
    - removed deprecated "ns_http wait -binary" calls
    - updated regression tests (remove unneeded constraint binarySwitch)
    - merged tests/encoding.test into tests/ns_http_charsets.test

M	nsd/tclhttp.c
D	tests/encoding.test
M	tests/ns_http_charsets.test

commit e2f399cb1e6a7e22bdf94569c15ff1dec684692c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-29

    update sample cipher configurations with mozilla's recommendation

M	nsssl/doc/mann/nsssl.man
M	openacs-config.tcl

commit 10a6ab21cb034d0487db30477ca23a336687b99e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-29

    cast to unsigned char is sufficient

M	nsd/tclhttp.c
M	nsd/url.c

commit b1b7afdbdc5afe12b942ee3df113756bfb3067df
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-28

    Improve log messages in case a certificate could not be loaded

M	nsd/driver.c
M	nsd/tls.c
M	nsssl/nsssl.c

commit d199a25d0d319476a7b6be4c15b30b3dee0c2d6e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-28

    new command: ns_parsehostport ?-strict? string
    
    This command exposes in essence the C-level API function Ns_HttpParseHost2()
    to the Tcl level and performs a part of the parsing performed by
    "ns_parseurl". In essence, it provides IP-literal parsing, parsing of
    the optional port and validation of the characters allowed in the hostname.
    
    In addition, the parsing of ns_parseurl became more strict, since
    the RFC requires an ALPHA character as first character of the scheme.

M	doc/src/naviserver/commandlist.man
A	doc/src/naviserver/ns_parsehostport.man
M	doc/src/naviserver/ns_parseurl.man
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclhttp.c
M	nsd/url.c
M	tests/ns_parseurl.test

commit 7dfa9b545c97dd90c1d6897841be99382bc39025
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-21

    Factor out WaitForConnect() as own function and extend its behavior
    
    Background: NaviServer performs async connects, which are apparently
    difficult to handle, especially when an DNS name is bound to multiple
    IP addresses, where some of those cannot be used. The usual
    recommendation is to use after async connections in EINPROGRESS cases
    getsockopt(fd, SOL_SOCKET, SO_ERROR, ...) to determine
    errors. However, this returns *sometimes* false positives. When
    someone checks after a connect operation if the socket is writable,
    this fails also as a detector for an existing connection, because at
    least new Linux versions return the writable flags in EINPROGRESS
    cases via poll().  So, an additional method was added based on
    getpeername(), which tries to retrieve the peer address for a file
    descriptor.

M	nsd/sock.c

commit 1306e9a15122d5591694d1b0a3c5125e96c2f658
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-20

    Added a somple section for using the letsencrypt NaviServer module

M	openacs-config.tcl

commit fda437caa7c20376d524c71677abcec8ca47c1cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-20

    improve robustness for error conditions

M	nsd/driver.c

commit d81708af53125c431de97b9e4523d2125a45b89d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-19

    Added automated reloading of server certificates when SIGHUP is received.

M	doc/src/manual/admin-config.man
M	nsd/tls.c
M	nsssl/doc/mann/nsssl.man

commit 7909e79e8d41a12dd35e9b28c1afe7dcce9627b0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-19

    improved spelling and aligned documentation with code

M	nsd/tclhttp.c

commit 7daa60321cf4b0f8d3acc7c53cb25a820c8597bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-19

    Bugfix for "ns_http connect": Linux sometimes returned error (false positive)
    
    Sometimes "ns_http run SOMEHOST:PORT" returned under Linux an error of
    the form
    
       Error: can't connect to SOMEHOST port PORT: operation now in progress
    
    on connections to hosts where the DNS entries have multiple IP
    addresses associated. This error only showed up on the first
    connection attempt (e.g. after a server restart, or on no connections
    to this host for e.g. a few hours), all later attempts with identical
    parameters worked without problems. It turned out that sometimes -
    while working through the associated IP addresses - the call
    "getsockopt(sock, SOL_SOCKET, SO_ERROR, ...)"  retrieved errno 113 <No
    route to host> from the socket, maybe related with routing table
    lookup.
    
    The new code avoids this error lookup by checking just for the
    writable condition returned by poll().

M	nsd/sock.c

commit 1b3a59a623c3de197fb380ded9f29c0876ddac7f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2021-07-15

    Added http-status code in the error message when unable
    to open http tunnel.

M	nsd/tclhttp.c

commit 3ccc08a2a2cc1f85a792d7d9f04289d5f716187a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-13

    fix and extend regression test for ns_hostbyaddr
    
    the test for ns_hostbyaddr was broken since ages and was not generic enough.
    The old condition was never true, and the assumtion that IPv4 is configured
    is removed.

M	tests/ns_hostbyaddr.test

commit c9cc6488257dc2c6d7d6176d9014ec443ee57682
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-13

    move initialization before call of ns_inet_pton() to avoid problems with a reverse lookup of localhost

M	nsd/dns.c

commit 14c6bcf4f9bd425c5fc9e65568596a1e2d521fb1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-13

    charset update: include charsets names form IANA and newer Tcl charsets
    
    - base list of supported charsets on the updated IANA list
      https://www.iana.org/assignments/character-sets/character-sets.xml
    - include charset names in the result of [ns_charset] even when the
      IANA name is identical to the Tcl encoding name

M	nsd/encoding.c

commit 3bce96bebcf9d875cd75e7cf25f98e5431e108fe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-11

    ns_http: added a log message in case userinfo is passed in

M	nsd/tclhttp.c

commit 338f6f8e5fb4999d9343f04f767df8f9f4383410
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-11

    improve spelling

M	doc/src/naviserver/ns_http.man
M	nsd/url.c

commit 0863a903051324f2f55878c3cc95e7304412004b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-11

    added CCLD rule as discussed in the tcl mailing list

M	include/Makefile.global.in

commit 4b760fcdd8015fd7939513b90ad88a2d9b1460ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-08

    fix (most) issues found by facebook infer 1.1.0

M	nsd/adpparse.c
M	nsd/binder.c
M	nsd/config.c
M	nsd/connchan.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/index.c
M	nsd/sock.c
M	nsd/tclcallbacks.c
M	nsd/tclhttp.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/tls.c
M	nsd/url.c

commit 9e9d8124a8dd77223eb8913896b22268788b9815
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-08

    make code more robust in cases system time is set to an earlier time

M	nsdb/dbinit.c
M	nsdb/nsdb.h

commit fecda4419c601ada34cc5f7b85ae1634b08cc42a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-08

    align new name nsproxy-helper in test script

M	nsproxy/test-nsproxy.sh

commit d637be504053aa82e97a44c7b49d8b1e7c411079
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-08

    reduced implicit conversions

M	nsd/binder.c
M	nsd/tclhttp.c

commit 5640087935bcbc55e2a55ffea480851c9305fab3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-08

    ns_getcontent.man: improved example in documentation

M	doc/src/naviserver/ns_getcontent.man

commit 45fdb29f1847e23d784efad32b844660decb468a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-08

    cleanup after "ns_parseurl" reform
    - fixed prebind options (command line argument "-b") for unix domain sockets,
      icmp, option handling (was already broken before)
    - improved source code documentation
    - disallow now empty port specifications in URLs (e.g. http://foo.com:/)
    - return in Ns_HttpParseHost2() the port starting with the first digit
      (it was the character before the first digit, forcing the client to skip).
    - Extended regression test

M	nsd/binder.c
M	nsd/tclhttp.c
M	nsd/url.c
M	tests/ns_parseurl.test

commit 61fa6b1ad5bc9e954ff3104b822fe2cf7fb7b1e9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2021-07-08

    Added proxy handling for [ns_http].

M	doc/src/naviserver/ns_http.man
M	nsd/nsd.h
M	nsd/sock.c
M	nsd/tclhttp.c

commit 0ba0a280da65a1d9dd5bd332fc4f323ec5a5f06f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-07

    "ns_parseurl" reform: make URL conformant with RFC 3986
    - return consistently a dict with all URL components
    - support of userinfo (authority   = [ userinfo "@" ] host [ ":" port ])
    - new option "-strict": check if URL components consists only of allowed characters.
      Note that the standard allows in the URL only a subset of 7-bit ASCII, all other
      characters have to be percent-encoded.
    - new C-level API call: Ns_HttpParseHost2(), supports strict/non-strict parsing,
      returns boolean success, returns always the next characters to be parsed.
    - extended Ns_ParseUrl() to support optional strict/non-strict parsing
    - Most internal usages of Ns_HttpParseHost() are non-strict to provide
      good backwards compatibility.
    - The old API call: Ns_HttpParseHost() continues to work but is deprecated.
    - Extended regression test

M	doc/src/naviserver/ns_parseurl.man
M	include/ns.h
M	nscgi/nscgi.c
M	nsd/binder.c
M	nsd/driver.c
M	nsd/request.c
M	nsd/tclhttp.c
M	nsd/url.c
M	tests/ns_parseurl.test

commit 4d2bfec85d437b20b4b020e3d78dc62886fe7506
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-06

    added jpeg/xl to the default mimetypes (from IANA provisional list)

M	nsd/mimetypes.c

commit 51ff708a3c1d6785e683ce1288e588effbb188c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-02

    Improved handling of invalid input while parsing the authority field of URLs

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/binder.c
M	nsd/driver.c
M	nsd/request.c
M	nsd/tclhttp.c
M	nsproxy/nsproxylib.c

commit 9ca173623a53e7dcf99e07fb5203e8d0ed75b110
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-02

    improve spelling: fix typos, make spelling more consistent

M	nsd/binder.c
M	nsd/sched.c
M	tests/ns_urlencode.test

commit 5e69220286365b54c407a69141e0baca06658f7c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-02

    nsproxy: Disambiguate the name of the helper cmd with the name of the module
    
    Background: a bug report stated that
      Error: modload: /usr/local/ns-4.99.21/bin/nsproxy: couldn't load file "/usr/local/ns-4.99.21/bin/nsproxy": /usr/local/ns-4.99.21/bin/nsproxy: cannot dynamically load position-independent executable
    on newer Linux versions. It turned out that there are indeed changes with PIE
    in glibc(>=2.30). But the real problem was that the nsproxy cmd
    was tried to be loaded as a module. To avoid any possible
    confusion and to ease debugging, the helper command is
    now called "nsproxy-helper" rather than "nsproxy", and
    the name of the command can be specified via Makefile.

M	nsproxy/Makefile
M	nsproxy/nsproxylib.c

commit 935bb745f920393f95b836a1170f56f80adce56d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-01

    remove uselss message in case openssl path is not provided

M	m4/openssl.m4

commit 404b4fa0bc037c1cd30efb4f61b3d7e8fe544a31
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-07-01

    Fix potential bug in openssl.m4
    
    AC_CHECK_HEADERS depends on CFLAGS, therefore, one has to
    include the current (but potentially not final) CFLAGS.
    Since AC_CHECK_LIB depends on LDFLAGS, one has to update
    LDFLAGS as well temporarily.

M	m4/openssl.m4

commit 149021e399d8dbe6bd281103e02d84c7cec241fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-06-28

    extended regression test: added application/json with UTF-8 charset

M	tests/ns_http.test

commit 7034ad8f5a6cd670a62f6dab58045b224742172b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-06-28

    handle potentially negative time values when result of Ns_GetTime() is non-monotonous.
    
    The time of Ns_GetTime() is determined by gettimeofday() is therefore potentially
    affected by discontinuous jumps in the system time (e.g., if the system administrator
    manually changes the system time). On the longer range, we should probably
    switch to clock_gettime() with a monotonically increasing clock, but
    portability and detailed implications have to be checked carefully

M	nsthread/mutex.c
M	nsthread/time.c

commit 6ba7d28c1616d64458b1987d99381399c596bc9f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-06-28

    add comment

M	nsd/binder.c

commit 61ac883d3aca2ddcce9340bfe8a5cb651977d9df
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-06-16

    minor cleanup

M	nsd/adpcmds.c
M	nsd/driver.c
M	nsd/queue.c
M	nsperm/nsperm.c

commit 021e94ec1b00d82a3c98abc3d04bbb0fe3ef1c51
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-06-02

    improve spelling

M	NEWS
M	doc/src/naviserver/ns_schedule.man

commit b9c33f511928629783fbfd96e0fc7d7440e04cba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-06-02

    reduced variable scope

M	nsd/sched.c

commit ece746e3ab9b772aad6f4ef858f3b556967b8a28
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-06-02

    Fixed (currently harmless) typing bugs, not detected by most compilers
    
    If a functions returns NS_*, the result has to be Ns_ReturnCode.

M	include/ns.h
M	include/nsthread.h
M	nscp/nscp.c
M	nsd/cache.c
M	nsd/tclinit.c
M	nsd/tls.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxymod.c
M	nsthread/mutex.c

commit 1761110fb2938d777a4637439b293a3447675099
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-27

    try as well test cases with capital %3F

M	tests/ns_urlencode.test

commit 2b140b8245cb4f9c546d2efc64d613e1fb4a80ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-27

    Extended regression test
    
    Test cases, where URL ends with an encoded question mark, with and without
    a custom error page.

M	tests/ns_urlencode.test

commit dc6672f7c862670d1943cc9e85881c24f25191e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-23

    reduce data races (all cases are essentially harmless, but were easy to fix)

M	nsd/driver.c
M	nsd/queue.c
M	nsd/urlencode.c
M	nsdb/dbinit.c
M	nsthread/thread.c

commit 5ba7774176dc5138ef34b4f9188f4eea41aff8b4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-23

    reduce verbosity and add comment on potential dirty read

M	nsd/log.c

commit 27d80024d559a806cc2e67455547eb290479de30
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-23

    provide better warning messages in case incoming requests are rejected due to server protocol configuration

M	nsd/tls.c

commit b1fc2e8e09c07672cb78e56c2a8bcbea040c84e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-23

    simplify logic in UTF-8 detection

M	nsd/str.c

commit ee6e7d82d19f55fbf0fd0bc0792003608a195a9e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-23

    reject logging attempts in shutdown mode (essentially, as proposed by Ibrahim Tannir)

M	nsd/log.c

commit cc5abfacbe8564693df7af0f183e566bad852086
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-22

    Improved handling of invalid UTF-8 characters
    
    The cases, where invalid UTF-8 is provided via URLs is now handled identical when
    these values are provided via percent codes (previously Tcl mangled the invalid precent
    codes into valid UTF-8). Example:
       curl -v http://127.0.0.1:8100/x$'\xc3'
       curl -v http://127.0.0.1:8100/x%c3
    
    The same sanity checks are as well to ns_urldecode.
    When the checks fail, warnings are written to the system log file.
    
    Also: Extended regression test and small performance optimizations

M	nsd/str.c
M	nsd/urlencode.c
M	tests/ns_urlencode.test

commit df7c65052cce75608130fbb408ac19a012379db6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-22

    fixed/improved documentation and comments on "ns_conn location"

M	doc/src/naviserver/ns_conn.man
M	nsd/conn.c

commit ff1f3df2777c9e9f7fd59304162417dd2e47b12b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-22

    provide compatibility with OpenSSL 3.0.0-beta1-dev

M	nsd/tclcrypto.c

commit ce7e477950d20b2d97a1efa7950190e23c9b8529
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-18

    fix fresh bug in sched daily/weekly induced by more precise time calculations

M	nsd/request.c
M	nsd/sched.c

commit 9d0d10f9cdfd7c9c35c9167d5a9122eb6c85a8dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-17

    fix typo

M	nsd/str.c

commit 098417c1458cb1a3c692ce9ce1d52923fb27214e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-17

    fix typo

M	nsd/request.c

commit 96a01929e52483eea5d21e531f9f6900784cb9a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-17

    Added a test for uncoded 8-bit characters in URLs
    
    Proper encoded URLs contain just a subset of 7-bit US ASCII. The
    general problem of handling UTF-8 in request headers is actually quite
    complex and spread over several RFCs. The recent HTTP specification
    RFC 7230 states that "Parsing an HTTP message as a stream of Unicode
    characters, without regard for the specific encoding, creates security
    vulnerabilities due to the varying ways that string processing
    libraries handle invalid multibyte character sequences that contain
    the octet LF (%x0A)." ... older RFCs allowed explicitly ISO8859-1.
    However, all recent browsers code properly encode UTF-8 in the URLs.
    So, in theory, a server could reject uncoded "binary" data, and
    assume this data is coming from hacking attacks. However, this change
    just adds a warning for these cases.

M	include/ns.h
M	nsd/driver.c
M	nsd/request.c
M	nsd/str.c
M	nsd/tclmisc.c

commit 9a445fcf1b15490728d5803ba3d21df7024eb4c1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-17

    Improved compilation cleanness with gcc-11:
    
    Get rid of warnings of the form
    warning: a label can only be part of a statement and a declaration is not a statement [-Wpedantic]
    induced by NS_FALL_THROUGH macro

M	include/nscheck.h

commit d7e382d77b37b11b55fa41af3b8969d52a4a31ef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-17

    Base repeated scheduled procs on the original scheduled time
    
    This change extends the previous change, which still could lead
    to time-shifts (for a per-minute event about 1 sec per day).
    Due to remember the original scheduled time, and base all
    time calculations on this, the time shift does not happen
    after this change.

M	doc/src/naviserver/ns_schedule.man
M	nsd/sched.c

commit 599f8ca9c92b0f64a15ac182e54d81e7443604b8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-14

    check validity of UTF request internally.
    
    This test can only be performed, after the server is determined, since different
    servers might have different URLencodings (which is probably an overkill).
    Note that Tcl transforms sometimes invalid UTF-8 into valid UTF-8, such
    as e.g. /x%c3. Not sure, if this is desired behavior or this should as
    well be handled in nsd.

M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/request.c
M	nsd/str.c
M	nsd/tclmisc.c
M	nsd/urlencode.c
M	nsd/urlopen.c

commit f3b54c4dff3929e494bec897400b95ffb2359b55
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-13

    Fix Ns_StrTrimRight() to avoid damaging of UTF-8 characters
    
    Background: Up to now, NaviServer was using "CHARTYPE(space, c)" to
    determine, which characters can be trimmed at the end of a string.
    Unfortunately, there exists characters, which are classified as
    "space", but which can be trailing bytes with different semantics
    in multibyte UTF-8 characters (e.g. 0x85). When these bytes are stripped
    the result are invalid UTF-8 characters.

M	nsd/str.c

commit 4331bc3cada26f7243e8c76f0e3b4f289c99d2f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-13

    Base repeated scheduled procs on last scheduled time rather than on last finish time
    
    Background: previously, the scheduling of repeated threads was based on
    the last finish time. This has the consequence that the execution time
    might drift away more and more depending on the runtime of certain
    jobs. If one has e.g. a service that should run every minute, some of
    these minutes might be skipped by the cumulative drift on a long
    running server.

M	nsd/sched.c

commit 372632c656a08110da809c377245ed7f971dad7c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-12

    added experimental function for validating UTF-8: ns_valid_utf8

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c
M	tests/misc.test

commit 2496b93c67d61755cadf4448aa3d9949585eaca0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-10

    prefer reentrant version (also in test cases)

M	nsthread/nsthreadtest.c

commit fb9061928c4c211184adfb3029e8e5e54a80c06b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-10

    remove tautological test

M	nsd/tclfile.c

commit b7de4586986ea618b00699e8e19df575c5b239b4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-10

    add extra rule for private key for testing

M	Makefile

commit b82712795155236b1896aec05bac8f4ebed6e55e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-10

    improve man page (tcl doctools show garbage)

M	doc/src/naviserver/ns_crypto.man

commit 5732805761da7298453c9fbb93d081885a398034
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-04

    Don't use restrict with C++ compiler, since it is so far just C99, but not C++

M	include/ns.h
M	include/nscheck.h

commit 9c2499bff3c8435109ce6618326ce45f9ce8c42c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-03

    moved peer and proxypeer from request structure to connection structure
    
    This change fixes a potential race condition on e.g. pipelined requests, where
    the request structure is already reused in a new request, while the
    old connection is used for logging. This could result in incorrect
    peer addresses in the access.log

M	include/ns.h
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h

commit 41c5002d01a22d55f138f26a52ed346eef2b85c9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-03

    use "restrict" like in the Linux documentation

M	nsd/sockaddr.c

commit ad566adb542a093c507bfa0f8a7c29db1036a3fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-03

    align with current version of OpenSSL 3.0

M	nsd/tclcrypto.c

commit 21d2a13043ce593b0892b48307b561e3e316cb21
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-03

    Disambiguate names: use RegisteredProc instead of Req for the registered requests procs.
    
    This change avoids confusion with the request structures (reqPtr, etc.)

M	nsd/op.c

commit e685943d5ba59fe317718b605e3e55c6430b7283
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-03

    improve wording in comment

M	nslog/nslog.c

commit 8b3c9addad0caf6f7183c294cf03d200cbe5076b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-05-01

    added an example to the manual page

M	doc/src/naviserver/ns_getcontent.man

commit 567d06579072d5ec085060aba0131d4fbbf4e883
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-27

    Fixed .pem keys in tar file distro and signature signing
    
    Keep a .pem file for result testing in tar file, and generate
    a pair containing public and private key for signature test
    on target installation.

M	Makefile
M	nsd/tclcrypto.c
M	tests/ns_crypto.test
R100	tests/testserver/etc/myprivate.pem	tests/testserver/etc/TESTKEY.pem

commit 146baa6ed89fa6cdb4cb387721ab56ee0fae6cd0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-27

    added default value in comment of sample config file

M	openacs-config.tcl

commit 0c8cddd6e9c6b0ebc7422fa9990157e161389c7f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-27

    fix wording

M	nsd/log.c

commit 837385a7c06247cd8d5dbb07d34085471683fe94
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-10

    Make sure to nul-terminate IPv4 portion in V4MAPPED addresses.

M	nsd/sockaddr.c

commit da7017ff1c87258bfe4aadff7ec38d80c7398dd0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-09

    release work

M	README

commit 31c604afff9ee6510d99eb2a03a6f2d5cf09fb64
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-09

    release work

M	NEWS
M	configure.ac

commit fb82717eb8676ed84adef57d94a935aa31040a34
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-07

    minor updates of sample config files

M	openacs-config.tcl
M	sample-config.tcl.in

commit 8d95dc1b81d6cb9f519f9840fd3c766119b8186b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-07

    make sure, variable is laways initialized

M	nsthread/nsthreadtest.c

commit 57c7260cca4b0ad45a8b0c5112301460da5023f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-07

    made symbol pread() static (only used for windows)

M	nsd/sockfile.c

commit b95dac7785efc0ba2b5f015997f76e32b5c42a6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-02

    release work for rc1

M	NEWS
M	README
M	configure.ac
M	include/nsconfig.h.in

commit f2ba5fd036ab23d2c046f1183cc8f91ed77370b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-02

    removed debugging statements

M	nslog/doc/mann/ns_accesslog.man
M	nsthread/time.c

commit e374f3385d68d023453b1756ecc8dd691064fb05
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-02

    made comma settings more consistent

M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/c-driverdb.man
M	doc/src/naviserver/ns_locationproc.man
M	doc/src/naviserver/ns_sendmail.man
M	doc/src/naviserver/ns_urlspace.man

commit 8630d41a789b075aacf6d53314eb2925a4e18582
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-02

    provide thread-local support for recent package versions of OpenBSD 6.8 via clang

M	include/nscheck.h

commit 010536676d4f2ab8f6a2cc0fa758c28e2e6d32c8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-04-02

    reduce complaints of static checkers

M	NEWS
M	nscp/nscp.c
M	nsd/auth.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/set.c
M	nsd/tls.c
M	nsssl/nsssl.c

commit a744ae480572aecc8bc4aede464728a719b5e38d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-29

    added ns/parameter to make logging of full timestamps and thread info optional: "logsec" and "logthread"

M	doc/src/naviserver/ns_log.man
M	nsd-config.tcl
M	nsd/log.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit 62a314f122b98348dc4efa8ee424db045831b23d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-24

    added soecial code for handling client complaints since certificate is unknown

M	nsd/tls.c

commit 2fde7e1697f146bca66868e2e816c14bf56f20dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-23

    align form of log message

M	nsd/sock.c

commit 7d63badaf9575c59d95c59cb49ce735967e090ae
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2021-03-23

    Fixed handling of sendBodyLength

M	nsd/tclhttp.c

commit f3a6a76e9d1cbee6f0490857ed89b90396ba4883
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-21

    include fd in debug message

M	nsd/sock.c

commit 80a9128ae73f16ca579e8f2915ffda6b7d456304
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-20

    reduce code clones

M	include/ns.h
M	nsd/sock.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit f62fd8c903bcd4cb2fe25d15c70fc4ab4ee279a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-17

    added TCP_NODELAY for https sockets

M	nsd/nsopenssl.h
M	nsd/tls.c
M	nssock/nssock.c

commit e5f45042133070a8c6adddff2e9445cb9ce7c370
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-16

    relax bailing out on malloc(0), since at least the OpenSSL 3a* versions use this frequently on certain configurations

M	nsthread/memory.c

commit cd6675d6852fceb4d76ba4ae836a24766974dd5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-15

    white-space changes and fixed typos

M	nsd/driver.c
M	nsd/dstring.c
M	nsd/fastpath.c
M	nsd/tclmisc.c

commit 266512744ff94817945fdddc6d6437a3c3d01dc5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-15

    fix potential index violation

M	nsd/cls.c

commit 76c03baa0d915b739210dbf21ab409954a7de853
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-08

    avoid deprecated call to Tcl_DStringTrunc()

M	nsdb/dbtcl.c

commit d8dd3ed39d953276ac1278806aa1fdf151a71d7e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-08

    added missing argument

M	nsd/tclcrypto.c

commit 48aa7f838319f359e2d48376bdacb204e324c989
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-04

    set und clear raw/compress flag explicitly

M	nsd/nsd.h
M	nsd/tclhttp.c

commit cf81504f260dd5d357ceb2f197c973f9e49d7eaf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-04

    use consistent idiom for endless loop

M	nsd/tclparsefieldvalue.c
M	nsproxy/nsproxylib.c

commit f78619c2c7a8345732c97d29106eaaa4b7ac8ec3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-04

    minor cleanup

M	nsd/tclhttp.c

commit baa1b38cd24f52aa4ed7e722ceb8aa01dfef3529
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-04

    get rid of obsolete function 'asctime_r'

M	include/nsthread.h
M	nsthread/reentrant.c

commit f004f9bbd5304b7e6c7a1e127c137e45ccc74e7f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-04

    get rid of obsolete function 'ctime_r'

M	nsthread/nsthreadtest.c
M	nsthread/reentrant.c

commit f21357916e091e58dcd79de3857045c7b2a18c61
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-03-04

    remove debugging stuff

M	nsd/connchan.c

commit 974f77956163c099d28193383d6f6d601f4e1ef9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2021-03-03

    Documents -raw option of ns_http

M	doc/src/naviserver/ns_http.man

commit e9dab1ad1b98b236bf0f3eb0619f8fcba73e6260
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2021-03-03

    MAde -decompress obsolete in favour of -raw. Fixed crash.

M	nsd/tclhttp.c

commit b56b05eccceeab5df2a1e13cdd046ebe9518291d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-02-21

    delete escaped code (problem with versions of OpenSSL before 3.0)

M	nsd/tls.c

commit 17a1be566c475aeb363f21a09f3833f0928a1f63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-02-21

    Increase sysadmin-friendliness in error cases.
    
    In case OCSP is activated and the connection to the AIA-server is
    blocked, do not reject all traffic but behave like in a configuration
    without having OCSP activated, and complain the system log.
    Background: Sometimes requests to the let' encrypt AIA server seems to
    be blocked by firewalls.
    
    Also, avoid calls to functions recently deprecated in OpenSSL 3.0.

M	nsd/tls.c

commit d4e6193bb221ef24f812983c849d13a435b12288
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-02-20

    Fix potential segmentation violation in debug output, when (a) the
    network driver is installed locally, and (b) the content of host
    header field cannot be located in virtual server map (fallback to
    validation via driver data).
    
    Many thanks to Oleg Oleinick for a good bug report and example
    for reproducing the problem.

M	nsd/driver.c

commit 51333ff0f6a6a66a7ea65fd4893c6796a1ccc087
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-02-20

    Cleanup of shadowed argument names
    
    Finalize change 04e5860 which was necessary to make
    nscp user management workable in case multiple servers
    are involved. In essence, the change made the nscp
    module information.

M	nscp/nscp.c

commit 65be84f4b3b08f0c70cd39ad8b0e8b19a04ae23b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-02-20

    Fix potential segmentation violation when nsd is called with '-c' and
    '-t' and the config file contains no "home" parameter in the config
    file. The fix simplifies the logic, and performs same configuration of
    nsconf.home whenever "-c" is used in the command line.
    
    Many thanks to Oleg Oleinick for a good bug report and example
    for reproducing the problem.

M	nsd/nsmain.c

commit 5103d8819ff1eeee031b180bfd18157bb3d2546b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-02-17

    fix man pages

M	nsdb/doc/mann/ns_db.man
R088	nsdb/doc/mann/dbquotevalues.man	nsdb/doc/mann/ns_dbquotevalues.man

commit add0c75c080ba6d949384aa226b4e70d6c19464d
Merge: 413e16d5 be6ff36e
Author: Filip Minic <filip.minic@s.wu.ac.at>
Date:   2021-02-13

    Merged in master (pull request #12)
    
    nsthread.h Windows comment updated
    
    Approved-by: Gustaf Neumann

commit be6ff36e50ed1366fe614a4c3b2fc3cbf9ff139a
Author: Filip Minic <filip.minic@s.wu.ac.at>
Date:   2021-02-13

    nsthread.h Windows comment updated

M	include/nsthread.h

commit 413e16d528dd24272cc0ac6e78913bd542f6fe00
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-02-06

    fix doc generation

M	doc/src/manual/main-history.man

commit c6afdc182da0cd3136dcb92fac1d967ffc0cd473
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-02-03

    fix typos

M	nsd/crypt.c
M	nsd/fd.c
M	nsd/nsd.h
M	nsd/queue.c
M	tests/ns_connchan.test

commit da423be865b65a795055ab080a3666fb0f9c801f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-02-03

    add description of missing argument

M	doc/src/naviserver/ns_write.man

commit a3dee84f643c36c0b6b9bfa8d55f43dca222c33d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-28

    minor documentation updates

M	doc/src/manual/admin-tuning.man
M	nsd/queue.c
M	openacs-config.tcl

commit 433c2f96009a6a470485892f65aec26b9aad30a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-28

    Fixed computation of "location" for cases, where the network driver is not installed globally
    
    The value of [ns_conn location] (and the redirect target) is computed by
    
    Globally defined network driver (recommended installation, supports virtual hosting)
    a) Use content of host header field, when the value is configured as an
       accepted host for one of the servers.
    b) If the host value is different, fall back to the default server
       (a default server has to be configured).
    c) If the request has no host header field, fall back to the default server.
    
    Per-server network driver:
    a) Use content of host header field, when the valued is configured as an
       accepted host for the server.
    b) If the host value is different or missing (allowed in HTTP/1.0),
       fall back to the value as configured in the driver parameter "location".
    c) If the driver parameter "location" is not given, use the actual
       local IP address and port for determining the location.

M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/sock.c

commit a7139d5abbfd8b14e6aa2af2dc40963b1dc87f1b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-26

    remove .pem files from tar-ball

M	Makefile

commit d112f3d652a0b03f368212153894ed704d1142a0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-26

    improve comments

M	nsd/driver.c
M	nsd/queue.c

commit e9304780a13cdc944f1a5dd668f1b1285352cbf6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-25

    fix typo

M	nslog/nslog.c

commit ee376693042ea79081eff16b586dae25fabd6326
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-25

    fix spelling error (kind of)

M	nslog/nslog.c

commit 04e586062b3c1bc3b84f7cb238a8cf9ffcf0733e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-24

    Fix handling of user-ids in nscp
    
    Applied in essence the change from David Osborn, but added as well
    regression testing. Primarily for testing purposes the new command
    "nscp users" was added which can be used to query at runtime the
    users. Additional subcommands may be added later. The command "ns_cp"
    is already taken by a deprecated command.

M	nscp/nscp.c
M	tests/ns_info.test
M	tests/test.nscfg

commit e507025a8b4b40921c3e77ec13eeb503d14c97f2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-24

    improve man pages

M	doc/src/manual/admin-config.man
M	doc/src/manual/main-history.man
M	doc/src/naviserver/ns_http.man

commit 03417a97683ee165fb9643a99ecb481cdb7e4511
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-23

    remove dead assignment

M	nsd/tclhttp.c

commit c704a75176926ef4b8470eae4eed2ce4e7c591d4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-23

    remove dead assignments

M	nsd/rollfile.c
M	nsd/set.c

commit 1ffba032f74c86c078d1a4872d0097da9bb59e29
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-23

    remove redundant test

M	nsd/connchan.c

commit 3c5a98efbeeae9e73aca0fdce79a89e8a133c746
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-23

    avoid void casts of void expressions

M	nsd/config.c
M	nsd/task.c
M	nsd/tclhttp.c

commit 22d9fad1c297e2800a2fe2227458a9ffbc97612b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-23

    reduce implicit type conversions

M	nsd/cache.c

commit 3c2018781b3761f90324004708f89f17184c8ffd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-23

    Don't pass (implementation-defined) NULL as last argument of a variadic function.

M	nsd/sock.c
M	nsd/tls.c

commit 8a218910153d707745eb9b9a82a55d7f015d1ded
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-19

    added comment to the last change

M	nsd/config.c

commit 64be1145e046c4088913779952c56a13bfd4a04f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-18

    Don't allow extending configuration Ns_Sets after server start

M	nsd/config.c

commit 986f4e67338ed95cbfab90e2476c6ffe6e82d673
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-17

    release work

M	NEWS

commit ba0defb7e0ea80ad3f533db5a177a250fb27e7a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-17

    release work

M	NEWS
M	configure.ac
M	doc/src/manual/admin-maintenance.man

commit f9f4dbebbaedfb40868b837e2521551b1f557b3d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-17

    improve spelling

M	openacs-config.tcl

commit bff1d8ffbf8b0503f784b74da5ea152bd1bb4021
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-17

    improve spelling

M	NEWS

commit f759b73e9b0d9811b688a5cdc3b08cde010c2859
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-17

    improve spelling

M	nsd/tclsock.c

commit 57893832bcc3f464aaf4e338cdf103aab56dd6bc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-17

    minor cleanup: let GetSocketFromChannel() return always a value to sockPtr to reduce danger of uninitialized memory

M	nsd/tclsock.c

commit 6db34347da37e22fceb2b2e350d9f67778e419f7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-16

    Removed the test constraint http09 for windows due to the fixed "ns_sockselect".
    
    This change activates 71 additional test cases from regression test for
    windows, which were broken before.  Added "package require try" to all
    test file using "try" to improve Tcl 8.5 compatibility.

M	tests/encoding.test
M	tests/http_chunked.test
M	tests/http_keep.test
M	tests/ns_adp_compress.test
M	tests/ns_http.test
M	tests/ns_nsv.test
M	tests/tclconnio.test
M	tests/tclresp.test

commit ee78d0fcdd008b99013f5b80822e59562913c844
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-16

    Added function GetSocketFromChannel()
    
    Previously, Ns_TclGetOpenFd() was used for obtaining sockets from
    channels, but the function actually returns a file descriptor.  The old
    implementation worked perfectly on most operating systems also for
    sockets.  However, under windows 64-bit a socket has a different size
    than a file descriptor.
    
    Additionally, this change fixes a bug in ns_sockselect where the code
    had mixed up result codes and sockets. This change together with the
    use of GetSocketFromChannel() fixes ns_sockselect for windows 64-bit
    versions.

M	nsd/tclsock.c

commit 3f990dc7a34dd78d886927201eba5715f2ee707a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-16

    make test independent from OS (don't hardcode temp directory)

M	tests/tclresp.test

commit 010daa96412eaf7f02833aa7a9c255ad09b68d8d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-16

    fix default temp directory for windows

M	include/nsthread.h

commit 5d37d6acd247be64e19c018587b569820ba96759
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-15

    make usage of rwlocks for filters configurable

M	nsd-config.tcl
M	nsd/filter.c
M	nsd/nsd.h
M	nsd/server.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit 632f74aeac1602d0f6349c9e31fa4398deb57a9f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-12

    improve spelling

M	doc/src/manual/admin-tuning.man
M	nsd/rollfile.c

commit e80da4f2f8d550c45e9b3f2c3234d1cc0674d840
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-12

    release work

M	configure.ac

commit f85e75a4b8688315a7dd00164243574948b6c986
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-11

    Fixed all places, where resulting path of Ns_ConfigGetPath() is
    assumed to be non-null.
    
    Introduced Ns_ConfigSectionPath(), which returns always the path,
    and optionally the Ns_Set of this configuration section.

M	include/ns.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/config.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/returnresp.c
M	nsd/server.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit 48a4fdb5285e1d261169bfbd85d2a54a7e31f067
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-11

    Added API call Ns_ConfigPath()
    
    This function is similar to Ns_ConfigGetPath() but returns the
    configuration file section path also in cases, where no config
    parameters for this path are provided in the configuration file.

M	include/ns.h
M	nsd/config.c
M	nsproxy/nsproxylib.c

commit a29505b944c1aafa90fca2522811741583669854
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-10

    bumped version number

M	configure.ac

commit b741ef4ed4416d1fb8f31a6b11503218782354df
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-10

    added flags for cross-compiling

M	README

commit e7ea441f373eff9396df2f524707751bfcac9947
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-10

    Fixes for crosscompiling NaviServer with (gcc/mingw) for Windows 64bit (Many thanks to Oleg Oleinick)

M	include/nsthread.h
M	nsd/connchan.c
M	nsd/dstring.c
M	nsd/exec.c

commit 52afcc7683dcabcd7c88ffb12eefcc630c19b372
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-09

    added basic test for ns_quotehtml

M	tests/misc.test

commit bef3b04a663b28fd71096e0dd91b511bcfbe7864
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-08

    move ns_quotehtml and ns_striphtml to the same documentation page

M	doc/src/naviserver/commandlist.man
D	doc/src/naviserver/ns_quotehtml.man
M	doc/src/naviserver/textutil-cmds.man

commit 97c81ef6d4774bfea2770712cd2ee90d6604482a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-08

    modernize code

M	tcl/util.tcl

commit 7c10a72d41aa322866a087cdde967031a020305e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-08

    fix broken man-page

M	doc/src/naviserver/ns_htmlselect.man

commit 9603dc50a164ecd24a416cbf99bc470e86e29205
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-08

    move ns_striphtml to text-util man page

M	doc/src/naviserver/commandlist.man
D	doc/src/naviserver/ns_striphtml.man
M	doc/src/naviserver/textutil-cmds.man

commit 9b60bc1444108cf00683848faf945711a1d396d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-08

    improve comment

M	nsd/connchan.c

commit b497d4b85a70c71034163126ce8d3e8ed2be7465
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-08

    release work

M	configure.ac

commit c407fafe7b3f23582b9fb8aa10ab6f31811bdce4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-05

    keep timegm, since alternatives are not really portable either

M	nsd/httptime.c

commit 8f81cea2e3456e77311269f3929194adc654066f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-05

    fixed 20 year old time bomb in HTTP time parsing, avoid usage of timegm(), usage should be avoided

M	nsd/httptime.c
M	tests/ns_httptime.test

commit a24bd2c4df7f40d5c19d0692ab982949282016b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-05

    relax test, such it works with release candidates in version number

M	tests/ns_http.test

commit 6287bff8f0112d4bdd595a16ec6600fc23a28319
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-05

    fix typo

M	NEWS

commit dfc6d8549ffab12b08d2d5f319e5f30b6799a7a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-05

    release work

M	Makefile
M	configure.ac

commit a9fdd63f871fbfaef701e3b871e75223853d6fe2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-05

    align one more line with output of current NaviServer

M	doc/src/manual/admin-maintenance.man

commit fe5da9fc0dbdf8acd6fc1a00387078073c16519d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-04

    release work

M	Makefile

commit 13a3626d0be47c69ca35035acb51589d45b16c3c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-04

    whitespace changes

M	nsd/connchan.c

commit 0a04c9a7ffb5eb50492df45cc2c6d6d35b09552c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-04

    updated autoconf needed files

M	config.guess
M	config.sub

commit 5a919cf64ece404fb693406d648cf2c7c33da4c1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-04

    update version numbers, include MSVC build notice

M	README

commit 91ac6e7923cd27f90e6062f2c433022c79b8e1fa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-04

    update man pages

M	doc/src/manual/admin-maintenance.man
M	nscgi/doc/mann/nscgi.man
M	nscp/doc/mann/nscp.man

commit ecd0dd2ba300774c4b4211306c8033c24552a8eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-03

    whitespace changes

M	nsssl/tests/nsssl.test
M	tests/https.test

commit ed5d98f8b13bb1b24e42911089f342a89d552a59
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-03

    whitespace changes

M	tests/ns_http_charsets.test

commit 6148473666417b1ff56b18712b7b83ea9ca84b40
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-03

    improve man pages (fix incorrect title, don't use misleading names)

R097	nsdb/doc/mann/ns_dbquotevalue.man	nsdb/doc/mann/dbquotevalues.man
M	nsdb/doc/mann/ns_getcsv.man

commit 7521d6d70f180418ddf816a95cad403ef2a5c863
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-03

    added cross references to configuration examples

M	doc/src/manual/admin-db.man
M	doc/src/manual/adp-overview.man
M	doc/src/naviserver/ns_ictl.man
M	doc/src/naviserver/nsv.man
M	nscp/doc/mann/nscp.man

commit 8f1dc491e626e5e81a5e731146b6d495e2bf84c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-03

    added NS_TCL_TRACE_IDLE to the FIFO commands.

M	nsd/tclinit.c

commit 73d7de1440df586ac6e6219add02e49a1964a482
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-03

    added man pages for text util commands

M	doc/src/naviserver/commandlist.man
A	doc/src/naviserver/textutil-cmds.man

commit 276fb4be53c58c8363c24a09ff1c873893adbb7a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-02

    improve comments

M	nsd/driver.c
M	nsd/sock.c
M	nsd/tls.c
M	nsd/unix.c

commit 20dcf57f82c51845cffd8ffacf61dac7b446ecdb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-02

    improve alignment with Tcl Engineering manual

M	nsd/connchan.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nsd/tls.c

commit f03fe6f48b98c2b33f1dc42fd4a4b8b7e9f92c78
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-01

    whitespace changes: improve alignment with Tcl Engineering manual

M	nsd/connchan.c
M	nsd/sock.c

commit fc946462f9bd7b2efd26b82df6ace6e3fd87246a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-01

    fix typo

M	nsd/sockfile.c

commit 08309677f58209695420a3d847b2be6f5301e394
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-01

    prefer strtol*() over sscanf() to increase code-safety

M	nsd/config.c
M	nsd/tls.c
M	nsd/unix.c

commit 623e794ff477ee06ac01c3927f2587ac688a1b77
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-01

    Reduce code clones

M	nsd/request.c
M	nsd/set.c

commit dbab87d09c500a0e4946098c6428f646f162beb2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-01

    improve structure packing (for private members)

M	nsdb/dbinit.c

commit d81254a4ade37c6e096c1fd8708eb20573d53c87
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-01

    use memmove() instead of memcpy(), factor out common code

M	nsd/connchan.c

commit e567d38588da8b3bc2d93963fe0f274fbf3c8e6b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-01

    improve type-cleanness

M	nsd/connio.c

commit ad1ac6604dae5d3fa28d3c1e9377435f53999d22
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-01

    avoid static identifier '_SendFile', which is a reserved identifier [cert-dcl37-c,cert-dcl51-cpp]

M	nsd/sockfile.c

commit 925e1ec47cc4752a90451b9df5fd69bb5aa380e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2021-01-01

    Renamed "ns_connchan wsframe" to "ns_connchan wsencode"
    
    Rationale: the new naming leaves room open for a corresponding
    decode command, which might be needed in the future for
    encapsulated streams.

M	doc/src/naviserver/ns_connchan.man
M	nsd/connchan.c
M	tests/ns_connchan.test

commit b1de8f569527234a0c1ba2ca6c56477597914025
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-31

    compatibility for OpenBSD 6.8 (LibreSSL 3.1.1)

M	nsd/connchan.c
M	nsd/tls.c

commit f7c5228efc8313db103beb9ec001fcc4b4343ffd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-31

    improve platform compatibility

M	nsd/connchan.c

commit cd668a84a3647ea264e93d130eb86ca36bcc9a3a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-31

    removed deactivated code

M	nsd/connchan.c

commit 750e32be40a73aa96118321eacf8fb386c46b00e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-31

    "ns_connchan status": add fragments to return dict; fixed typos, whitespace changes

M	doc/src/naviserver/ns_connchan.man
M	nsd/connchan.c

commit 30f7b5e7c7d89a8424e490e3b672735d14afe65a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-31

    improve spelling

M	doc/src/naviserver/ns_sema.man
M	doc/src/naviserver/ns_server.man
M	doc/src/naviserver/ns_set.man
M	doc/src/naviserver/ns_thread.man
M	nsd/driver.c

commit 9f63d3f4153a96e439fc13c0d98ef8680015b428
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-31

    ns_connchan: C-level WebSocket support and buffered output handling
    
    WebSocket handling based on strings purlely on the Tcl level is tricky
    and slow.
    - The WebSocket protocol (RFC 6455) is based on WebSocket frames and potentially
      on multiple WebSocket segments building a message. When receiving messages,
      it can happen that
      * only a part of a frame is received, or that
      * some additional data after the frame is received, or that
      * a frame spans multiple received chunks.
    - To detect the size of the frame, the first bytes of the frame
      have to be interpreted, even these which might not be complete either.
    - When doing the frame/message assembly in event driven loops in
      Tcl, one has to carry the received and potentially unprocessed
      bytes around. Previous versions did this via nsv variables.
    - Furthermore, for non-binary messages the handling splits inside
      multi-byte characters is complex.
    - When writing messages the handling of partial write operations
      inside readable-driven event loops is facing similar problems.
    - WebSocket is relying on byte-wise XORs, which are performance-wise
      bad in Tcl.
    
    The new interface allows a developer to perform receiving and sending of
    WebSocket frames and messages in a much easier, more robust and faster way.
    - receiving messages: "ns_connchan -websocket ...."
      returns a dict containing the websocket data (including payload,
      websocket status bits, buffering state, etc.; see documentation and
      NaviServer websocket modules for details)
    - sending messages: "ns_connchan write -buffered ..."
      returns nrBytesSent. When this number is smaller than the message
      size, the data which is not yet sent is kept in an internal buffer.
      Additional writer operations will append to this buffer and
      try to send the aggregated chunk. So, the Tcl-developer does
      not have to carry the unsent chunks around, the connchan
      implementation takes care.
    - websocket frame generation: "ns_connchan wsframe ..."
      can be used to efficient produce websocket frames.
    - status: "ns_connchan status ..." returns a dict containing the
      buffering status of a channel.
    - performance: the C-level WebSocket handling (including XOR coding)
      is about 200x faster than the Tcl version.

M	doc/src/naviserver/ns_connchan.man
M	nsd/connchan.c
M	tests/ns_connchan.test

commit a7514972a78e82e8c7d84241e775826e3aa093da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-31

    fixed typo, whitespace changes

M	nsd/init.tcl

commit fbbe2a56c69a4ae9371622df778ab2e3cf951bb5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-30

    improve spelling

M	nsthread/fork.c
M	nsthread/signal.c

commit d7523ba78acee1a1908efb616db3efee586e171e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-30

    improve spelling

M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_crypto.man
M	doc/src/naviserver/ns_register.man

commit 4de70e7a671091be1c1ae43bca8443d60f113cd9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-30

    reduce variable scopes

M	nsd/driver.c
M	nsd/rollfile.c

commit ea506d9a95a0ea8c6e578d81514158d1536b0520
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-30

    Reform for error code handling on driver receive operations
    
    Motivation:
    - ns_connchan is using the Driver functions (nssock or nsssl).
    - the driver functions are silent on error conditions
      (just returning NS_SOCK_EXCEPTION)
    - When a driver receive fails (return -1 for nr bytes read),
      it was impossible to provide error messages in "ns_connchan read",
      or to distinguish between tolerable errors (e.g. peer closed connection)
      and other ones (both in C and in Tcl), since
      a) ns_errno was already 0 (even for nssock)
      b) OpenSSL error codes are logically a superset of POSIX errors
         and based on a different data type.
    
    Example: Ns_SockRecvBufs2 reports an ECONNRESET, but in "ns_connchan
    read", the error code is already gone.
    
    [28/Dec/2020:21:37:27][31121.7f09aa0c6700][-socks-] Warning: Ns_SockRecvBufs2 errno 104 on sock 5: Connection reset by peer
    [28/Dec/2020:21:37:27][31121.7f09aa0c6700][-socks-] Error: connchan channel conn7089 driver nssock sock 5 errno 0: Success
    Even trying to get the error code via
        getsockopt(sock, SOL_SOCKET, SO_ERROR, (void*)&sockerrno, &len);
    did not reveal the right errno.
    
    The new error code handling in the driver is based on the following design goals:
    - Address volatility of error codes by adding these to the Sock*, such that
      higher-level APIs can still handle these or to provide error messages
    - Support for POSIX errors and OpenSSL errors
    - Set Tcl error codes for error handling to avoid the need to
      rely on error message strings. The error codes are either POSIX errors
      (like in Tcl) or OpenSSL errors.
    - Technically, basic type for the generic error codes
      (covering POSIX and OpenSSL) is an unsigned long (like in OpenSSL,
      which supports handling error codes from multiple sources, including POSIX)
    
    New API calls:
     Ns_Sock* based setting of Tcl error codes:
     * NsSockSetRecvErrorCode(const Sock *sockPtr, Tcl_Interp *interp)
     *
     *      Set the Tcl error code in the interpreter based on the information
     *      provided by Sock* (actually by recvErrno); the function works for
     *      OpenSSL and plain POSIX style error codes.
    
    Setting Tcl error codes for POSIX errno:
     * Ns_PosixSetErrorCode(Tcl_Interp *interp, int errorNum)
     *
     *      Set the Tcl error code in the interpreter based on the provided
     *      numeric value (POSIX errno) and return the error message.
    
    Setting Tcl error codes for OpenSSL error values
     * Ns_SSLSetErrorCode(Tcl_Interp *interp, unsigned long sslERRcode)
     *
     *      Set the Tcl error code in the interpreter based on the
     *      provided numeric value (OpenSSL error value) and return the
     *      error message.
    
    Changed API-calls: One additional output argument for
    returning/setting the generic error codes in:
     - Ns_SockRecvBufs2,
     - Ns_SSLRecvBufs2,
     - Ns_SockSetReceiveState

M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sock.c
M	nsd/tclhttp.c
M	nsd/tls.c
M	nsssl/nsssl.c

commit 249804d697a20b104aa896631b8a7be97e4152a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-28

    fix of NS_CRYPTO_malloc for installations, with OPENSSL_NO_OCSP

M	nsd/tls.c

commit c037c2231ceb327107f7c5b38cef27992aaeea33
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-28

    align naming conventions and fix wrong names in comments

M	nsd/tcljob.c
M	nsd/tclsock.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c

commit 6c6447fdd9bf00b4fa29a53706769f93443da15e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-28

    provide a more uniform description of implemented Tcl commands

M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsd/urlencode.c
M	nsdb/dbtcl.c
M	nsperm/nsperm.c

commit b8054ca6ddcc319c1c3c8a68080ce8d54cf9fb32
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-28

    provide a more uniform description of implemented Tcl commands

M	nsd/tclcrypto.c

commit 1286e57483352a4dea49382255ac51e3dd4c5ecc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-28

    flush dirty editor buffer

M	nsd/tclcache.c

commit ef4f8ba195423174eb0cb4a77aceb0d413a56f21
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-28

    provide a more uniform description of implemented Tcl commands

M	nsd/adpcmds.c
M	nsd/adpparse.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/limits.c
M	nsd/nsmain.c
M	nsd/progress.c
M	nsd/tclcache.c

commit 73b78daa50bb859474aa1f729fc7f704b5fd0f83
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-28

    New API function Ns_SockErrorCode(Tcl_Interp *interp, NS_SOCKET sock)
    
    The function Ns_SockErrorCode() returns the last error from a
    socket. When the provided interp is not NULL it sets the Tcl error
    code based on the error code.

M	include/ns.h
M	nsd/sock.c

commit 1d974ed1eac02abf454e112cbf06c36c1a5824ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-27

    provide a more uniform description of implemented Tcl commands

M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/config.c
M	nsd/driver.c

commit 8cec6dae87fe7c05f7ec3d2ad59f8e15b0c8f2eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-27

    register for all IPaddresses as valid addresses in the "/servers" section

M	openacs-config.tcl

commit fbaee99dec0f451f1e514fd2eafd18dba503629e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-27

    Make documentation about implemented commands uniform.

M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/cookies.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/info.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/modload.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/quotehtml.c
M	nsd/random.c
M	nsd/sls.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclconf.c
M	nsd/tclcrypto.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclparsefieldvalue.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/url.c
M	nsd/url2file.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsdb/dbtcl.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsthread/fork.c

commit a0adfadc0e87f98c2ad3812b76ca1f4704ebacc2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-27

    align test witj yesterday's ns_driver change

M	tests/ns_driver.test

commit b37d8134b31624d4a7eeb51e1db0cc69a99e8a63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-27

    align comments about results with boolean values (use NS_TRUE/NS_FALSE instead of 0 and 1)

M	nsd/fastpath.c
M	nsd/pathname.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/tcljob.c
M	nsd/tclvar.c
M	nsd/urlopen.c
M	nsd/watchdog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsthread/pthread.c
M	nsthread/thread.h
M	nsthread/winthread.c

commit 407ba82eeea31ea02ff8a1fbd78e0016dbd44abc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-26

    "ns_driver info": return also "port" and "defaultport"

M	doc/src/naviserver/ns_driver.man
M	nsd/driver.c

commit 591c15277fbc340b49c525db4d25294ae8a5f909
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-26

    make code more robust in case NsGetServer(nsconf.defaultServer) returns NULL

M	nsd/tclhttp.c

commit 250c652d6988170bebacf60eb6df28380740fa5f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-26

    make clode more robust in cases localtime_r() returns NULL

M	nsd/rollfile.c

commit 2861684fecdc20fd769b57ac696b00fb79719a24
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-26

    updated implementation using crypr_r()

M	nsd/crypt.c

commit 1664dc581dad1b341aa8b52a6567b756916903bc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-26

    crypt_r: fix m4 configuration and provide error message for invalid input
    
    The m4 configuration for crypt_r() was broken since many years,
    which as also the case for the code for using the function (include missing).

M	include/ns.h
M	include/nsconfig.h.in
M	m4/misc.m4
M	nsd/tclmisc.c
M	tests/ns_crypt.test

commit 8a6cc45087d1e4e5f44b732fc8f7e8b6022c24d2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-26

    improve spelling: resolve confusion between "its" and "it's"

M	nsd/cache.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/encoding.c
M	nsd/event.c
M	nsd/fastpath.c
M	nsd/httptime.c
M	nsd/init.tcl
M	nsd/log.c
M	nsd/nsconf.c
M	nsd/progress.c
M	nsd/return.c
M	nsd/sls.c
M	nsd/sockcallback.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsdb/dbinit.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsthread/tls.c
M	nsthread/winthread.c
M	tcl/util.tcl

commit 3698476fdaa42d85a2c82d6fc09b0045d6f68378
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-26

    minor clode cleanup (avoid dead assignment, improve error handling)

M	nsd/connio.c
M	nsd/driver.c

commit c3d86803192fd5637d8484f16ed6bf0476fc1979
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-26

    whitespace changes

M	include/ns.h

commit 3fa70082741ffbd614d5cbdedbbb2881651bd554
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-25

    improve comments and spelling

M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclinit.c
M	nsd/tclobjv.c
M	nsd/url.c
M	nsd/urlspace.c
M	nsd/watchdog.c
M	tests/ns_cache.test

commit e0814d017fd98c262d16ac20b6cf09458e15d269
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-25

    improve comments

M	nsd/sock.c

commit c4704f22268cdf34ff77fb9abcc91f2f09de3196
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-23

    improve documentation and spelling

M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/admin-tuning.man
M	doc/src/manual/adp-overview.man
M	doc/src/manual/c-driverdb.man
M	doc/src/manual/main-faq.man
M	doc/src/manual/tcl-libraries.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_adp_abort.man
M	doc/src/naviserver/ns_adp_register.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_cookie.man
M	doc/src/naviserver/ns_hash.man
M	doc/src/naviserver/ns_ictl.man
M	doc/src/naviserver/ns_memoize.man
M	doc/src/naviserver/ns_queryget.man
M	doc/src/naviserver/ns_querygetall.man
M	doc/src/naviserver/returnstatus-cmds.man
M	nsdb/doc/mann/ns_db.man
M	nsproxy/doc/mann/ns_proxy.man
M	nsthread/cslock.c
M	nsthread/thread.c
M	nsthread/winthread.c

commit 82ac3ad1e4d3cb39b44b2f674bf054e6fdc9b652
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-12-23

    Move some driver-related garbage-collectors out of NsStopDrivers().

M	nsd/driver.c

commit 68b8714f2b32621d69a0f05b9e4861ebce9202fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-23

    make cpp macro handling for one vs. two arguments fool-proof

M	include/nscheck.h
M	include/nsthread.h
M	nsd/tls.c

commit 2575c7fe63f31ed8b575796b40d1d77a04d17d14
Merge: 2ee76cca 301565ac
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-12-23

    Merge branch 'master' of https://bitbucket.org/naviserver/naviserver

commit 2ee76cca07fdb64033a32e27feb3b82c457d8a0a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-12-23

    Fixed potential crash at handling of ns_http timed-out requests

M	include/ns.h
M	nsd/task.c
M	nsd/tclhttp.c

commit 301565ac28983c425bf538346bff244692e2c188
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-20

    spelling changes

M	tests/http_byteranges.test
M	tests/ns_http_charsets.test

commit 8d0400b74c2fe006b3a513cb444c1506de8249bd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-20

     - Allow a single driver to listen on multiple ports:
    
       This feature greatly simplifies setups, where a single server is
       listening on multiple ports of the same driver. Previously, it was
       necessary to define separate drivers for these cases, which need
       different names but which are often configured identically.
       Together with the change introduced in 4.99.19 (support for
       multiple listen addresses) this means that when multiple addresses
       and multiple ports are specified for a single driver, it will
       listen on the cross product of all combinations. The maximum number
       of listening ports of a driver is limited by a compile time
       constant to MAX_LISTEN_ADDR_PER_DRIVER (per default 16).
    
       To use this feature, specify in the configuration file for "port"
       in the network driver section a space separated list of multiple
       ports. This change is fully backwards compatible, old configuration
       files will continue to work.

M	doc/src/manual/admin-config.man
M	doc/src/naviserver/ns_driver.man
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nssock/doc/mann/nssock.man
M	nsssl/doc/mann/nsssl.man

commit 0e00fa4a1c45de8e5abe64418ede8abc9d8854e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-20

    make function name better self-explaining (Ns_StrIsHost -> Ns_StrIsValidHostHeaderContent)

M	include/ns.h
M	nsd/conn.c
M	nsd/pathname.c
M	nsd/str.c

commit 945b1edf86ddf66ab4417405a45be359ced11d74
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-20

    white-space change

M	nsd/queue.c

commit 25282af5b6eb841fb8a00f965172fe16e6a7e687
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-20

    added more compiler hints for custom memory functions

M	include/nscheck.h
M	include/nsthread.h
M	nsd/tls.c

commit f59818f320e77156b8c97b9da9b40061a7400387
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-20

    Fix registry of connchans from all servers to the default server.
    
    see: https://sourceforge.net/p/naviserver/mailman/message/37179476/

M	nsd/connchan.c

commit c20afb68679ba3c1f4d696269edb02b4dd83d9cf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-20

    minor cleanup and improved documentation

M	tests/testserver/modules/client.tcl

commit de1dae16e0873f75da6f8daa8c72df822bc51b2a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-19

    improve indentation

M	nsd/str.c

commit 1d48a5038c802fc9b50de14b85cc519837f98c3d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-19

    improve indentation

M	nsd/urlencode.c

commit 334184a067c398418f96fe39cb5dca2d1138ccd8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-19

    reduce verbosity

M	nsd/tclhttp.c

commit 09d8087867d51428fba288e12005ecad2e741277
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-19

    factor out common code and improve code reuse

M	nsd/tclcrypto.c

commit 18c3b7c45af26769c6e14a44e71b01d09ab3b461
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-14

    remove PURE property from WordEndsInSemi(), at least with some compilers, this might produce wrong code (e.g. gcc 5.*)

M	nsd/tclmisc.c

commit cab6c6ccf4a58499801e1b04dc4a907f1446c48b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-14

    Reactivate CRYPTO_set_mem_functions() for OpenSSL 1.1.0 or newer

M	nsd/tls.c

commit 8a8755ebc40f0e77e86b4212251f3cd842b87ae2
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-12-14

    Fixed ConnSend w.r.t. streaming mode.

M	nsd/connio.c

commit b212fb2cb555e6be0c9eaeff2622ecc3f400e563
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-12-14

    Fix for older compilers: false -> NS_FALSE, true -> NS_TRUE

M	nsd/connio.c

commit fa3defba54d51f841416980a91e6c05bb2b27622
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-12-14

    Fixed nsssl handling of EAGAIN/EWOULDBLOCK.

M	nsssl/nsssl.c

commit 12cee2bda49a0f235f6a114fb0ba03651b41ad77
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-12-14

    Fixed [ns_writefp] to act as advertised. Fixed nsssl streaming.

M	include/ns.h
M	nsd/connio.c
M	nsd/return.c
M	nsd/tclfile.c
M	nsd/tclresp.c
M	tests/all.tcl
M	tests/tclresp.test

commit e488054202af68d18db6c5ca4ae545bbb11eed44
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-13

    Added test constraint http09 to flag test cases, where nstest::http-0.9 is still needed.
    Reduced cases, where nstest::http-0.9 is still needed.

M	tests/http_keep.test

commit 06c4ba1ddcb5891e2130bf28c87733c3fec3e4b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-13

    Added test constraint http09 to flag test cases, where nstest::http-0.9 is still needed.
    Reduced cases, where nstest::http-0.9 is still needed.

M	tests/encoding.test
M	tests/http_chunked.test
M	tests/ns_adp_compress.test
M	tests/ns_http.test
M	tests/tclconnio.test
M	tests/tclresp.test

commit d3cfe5ab94dcf78b230b8f41194cef2ef5d13959
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-13

    avoid duplicated slashes in URL

M	tests/testserver/modules/testhttps.tcl

commit 389c121747af244beb1182c560bdcece28d3d84a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-13

    remove dead code

M	tests/testserver/modules/testhttp.tcl

commit 93ff68950e2739972dae6c4a7de7b3711b367318
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-13

    get rid of nstest::http-0.9

M	tests/ns_urlencode.test

commit d4f275a6a348f82c76dbe1bb4ec5f6232e958f94
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-13

    make test more robust concerning crlf results

M	tests/adp.test

commit 79c6e749248c2f1da4e072c8239c0341c42af2f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-13

    reduce usage of nstest::http-0.9 (and switch to preferred nstest::http)

M	tests/http_byteranges.test

commit f70ed938a9f7c5c0cf17168fe9b3b7c875c8b935
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-13

    fix most of the byterange tests under windows
    
    64bit windows uses a 32bit sized offset type off_t, which was used
    under windows to keep a pointer sized quantity

M	include/ns.h
M	nsd/driver.c
M	nsd/return.c
M	nsd/sockfile.c

commit cc93fc17c089e0783584c07ce99fc597f145b06d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-12

    windows cleanup
    - use consequently NS_EAGAIN
    - don't use "const" on output arguments of Ns_ParseObjv
    - use ptrdiff_t for pointer differences

M	nsd/connchan.c
M	nsd/driver.c
M	nsd/range.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nsd/str.c
M	nsd/tclcrypto.c
M	nsd/tclmisc.c
M	nsd/tls.c
M	nsd/unix.c
M	nsproxy/nsproxylib.c
M	nsssl/nsssl.c
M	nsthread/reentrant.c

commit e9acde350887780f298463283ead9760d949b1b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-11

    add missing variable declaration

M	nsthread/reentrant.c

commit 8f6f10c762a7d0d4e6411a97ea3548c29b720890
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-09

    added comment

M	nsd/tclmisc.c

commit 390a1a9039febac1f5ade70213814dd96d9f2254
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-08

    use using format for unsigned value

M	nsd/rollfile.c

commit c99569ee2f7096530c59b27f88165d96dab1bfe3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-08

    align name of arguments in prototypes

M	nsd/sched.c

commit bbfe286c0011f64a0bc9027bbda0f7d7a95d5154
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-08

    improve comment

M	nsd/form.c

commit f873f0088a48d092a56f886c340621e0146321f9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-06

    Reduced time sensitivity on time format when rolling log files
    
    Rolling log files happens often at midnight, using often a day
    precision. When e.g. a scheduled procedure the time when this function
    is called might be slightly after the scheduled time, which might lead
    to a day jump. The problem aggravates, when multiple log files are
    rotated.  The new code identifies day wraps and uses in such cases the
    earlier day.

M	nsd/rollfile.c

commit 9abbd947784cc31538159f61d143a0510a2ddb4a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-06

    Added cross-platform function ns_localtime_r (localtime with user-provided storage)
    
    The previously defined function ns_localtime() uses a single
    per-thread local storage, so, it was not possible to have in one
    thread two time buffers with different values.

M	include/nsthread.h
M	nsthread/reentrant.c

commit c56a2089923e16e3d8e7a4f3b2c40743e57434d9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-05

    Improved source code documentation and added optional consistency check
    
    Documented the binary heap structure and commands is use for
    ordering scheduled commands in more detail. Additionally,
    a consistency check was introduced to check consistency of
    the binary heap after every update (can be activated
    via NS_SCHED_CONSISTENCY_CHECK).

M	nsd/sched.c

commit d8a79821ac0125c071a2b2bdf3a07f95ee509b07
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-05

    improve spelling

M	nsd/tclhttp.c

commit 140d183e9598a49f6ccbc12941b9d2dc47bd1473
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-05

    fix typo

M	nsd/tclparsefieldvalue.c

commit 232cb0cf9def7c267c7ce49e6ab0af3cfaff644d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-05

    General support for running NaviServer behind a reverse proxy server
    
    This change provides general support for running NaviServer behind a
    reverse proxy.  Previously, the support was rather punctual (e.g. for
    nslog).
    
    Reverse proxy mode is activated by setting the global parameter (in
    section "ns/parameters") named "reverseproxymode" to true (default false).
    
    Current limitation: In the current implementation, NaviServer supports
    only the "X-Forwarded-For" header field, which is supported by most
    proxy servers, treating the first provided IP-address as the client
    IP address (see https://en.wikipedia.org/wiki/X-Forwarded-For). The
    newer "Forwarded" header field is currently not supported.
    
    The reverse proxy mode setting effects the behavior of the following
    functions:
    
       a) "ns_conn peeraddr"
          In reverse proxy mode the function returns without extra arguments
          the client IP address as provided via the X-forwarded-for header
          field.
    
          In addition, "ns_conn peeraddr" is extended by an optional flag
    
              -source configured|direct|forwarded
    
          to provide more detailed control when needed. The provided value
          has the following meaning
              configured: return either the IP address of the directly
                          connected host, or the client IP address as
                          provided by x-forwarded-for when reverse proxy mode
                          is activated (same behavior as when not "-source"
                          is specified)
              direct:     return the IP address of the directly
                          connected host
              forwarded:  return the client address as provided by
                          x-forwarded-for
    
       b) The introspection commands
    
            ns_server all|running
            ns_writer list
            ns_connchan list
    
           Report in reverse proxy mode the client IP addresses as provided
           by the reverse proxy server.
    
       c) Access log entries:
    
          Report in reverse proxy mode the client IP addresses as provided
          by the reverse proxy server
    
          The former configuration parameter of "nslog" named
          "checkforproxy" is obsolete now.
    
       g) Context filters (used e.g. for mapping requests to pools)
    
          In reverse proxy mode, all IP-address specific context filters
          refer to the x-forwarded-for addresses. As a consequence,
          context filters (of URLspace commands) can now be used to map
          incoming requests to a certain connection pool by the client IP
          address (IPv4, IPv6, with masks) also behind reverse proxy
          servers. Previously the IP-based mapping was just possible when
          no reverse proxy was in use.
    
    Basic tests were added to the regression test suite.

M	doc/src/manual/admin-config.man
M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_server.man
M	doc/src/naviserver/ns_writer.man
M	include/ns.h
M	nsd-config.tcl
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/queue.c
M	nslog/doc/mann/ns_accesslog.man
M	nslog/nslog.c
M	openacs-config.tcl
M	sample-config.tcl.in
M	tests/ns_conn.test
M	tests/ns_server.test

commit e11031d2cd40b3b00640d8eefecb686418254932
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-05

    reduce verbosity

M	tcl/form.tcl

commit 8bcdee1a328d6e9a943ef2b8856b8e4aba347531
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-05

    prefer config section with braces

M	simple-config.tcl

commit 3001fb26f5e1ce6a562dca5ca6683422be8ec17d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-03

    improve comments

M	nsd/tls.c

commit 8608cb41c89149bee74d5cb9ff9389e57c00d063
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-02

    prefer SSL_CTX_set_dh_auto() over low-level functions
    
    In newer versions of OpenSSL, all low-level DH* functions were
    deprecated. Since OpenSSL 1.1.0, SSL_*set_dh_auto() can be
    used, which is sufficient for implementing forward secrecy.

M	nsd/tls.c

commit cca8c16b314ab0e767e4eba0c917074a95ce0ef0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-01

    perform more strict parsing based on ns_parsefieldvalue and ns_parseheader in file-based form parser
    
    previously, there was a bug with the regexp-based parsing, when e.g. a filename of
    and upload file contained e.g. a semicolon.

M	tcl/form.tcl

commit c75054e2224713bc13d2f1503c57accce6121f05
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-01

    Generalize form-data processing
    - decouple content-type processing of
        "application/x-www-form-urlencoded" and
        "multipart/form-data"
      from HTTP methods.
    - Previously, parsing of form data in these two formats
      happened only on POST requests. However, several REST
      services use often also PUT with form data and distinguish
      POST and PUT methods mostly by "add item to a collection" (POST)
      and process single item (PUT) but not by their content-type
      processing.

M	nsd/form.c
M	tests/ns_http.test

commit d5976b22362956acd3229e65c6e45943c6ae3a43
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-01

    whitespace changes: fix indentation

M	tests/adp.test

commit 973ef9de49bc694ec62a0be27a01d508f4bd6f70
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-01

    use always the first server as defaultServer

M	tests/test.nscfg

commit 3aeb852ecab79f37ea65b058e03d7146a97050ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-01

    initialize variable to silence static checker

M	nsd/tclinit.c

commit c746d01074216d75dbb8503228bed38a9f6cea93
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-01

    use the default server for OCSP client requests (for httpclient log configuration)

M	nsd/tls.c

commit 411dfb267ac3c857827fcd910b6d237ddc4f2c9a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-01

    improve error messages and wordng of comments

M	nsd/rollfile.c

commit 4c440d0ceb4e8345ab53a557a1b105d17b56cc6b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-01

    use always the first server as defaultServer of nsd

M	nsd/nsmain.c

commit ce7436c756300341e1ef3fbdea74853740bb8013
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-12-01

    use defaultServer as a fallback in case httpPtr->servPtr was not set

M	nsd/tclhttp.c

commit 9801d39ebc1673dc1b20f06ab399ab884978c467
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-29

    pass logPtr to CloseCallback

M	nslog/nslog.c

commit ab58e39bb841d9dd65de3d693da98b8107b28f00
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-28

    Don't show *ast* files (abstract syntax tree as produced by static analysis)

M	.gitignore

commit 88753c6deb9477288512da10f7ec689f74f6d5c2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-28

    ns_unschedule_proc: return boolean value indicating success

M	doc/src/naviserver/ns_schedule.man
M	nsd/tclsched.c

commit 22934f30564c6e6a3c8e0df632e0748d48205960
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-27

    httplcient: added callback description for SchedLogRollCallback

M	nsd/tclhttp.c
M	nsd/tclthread.c

commit 5c2c9402988b0c43ea6dd9f760e356e45580a03c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-27

    httpclient logging: provide endtime for error cases.

M	nsd/tclhttp.c

commit 7137bf00590d381510ca1005d8aa9ac1f4547b86
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-27

    break overlong lines

M	nsd/sched.c

commit e82796544b0265a91a9a80b52427510a0a9d4a98
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-26

    HTTP client request logging
    - support for optionally writing a logfile of outgoing HTTP requests
      initiated via ns_http. This is important for webserver that
      are dependent on other webservers for the healthiness and performance.
    - new config-file section for handling httpclient specific data.
      Currently this is just used for the log-file, but can be used as
      well in the future for setting default timeouts, configuring
      security options (e.g. client certificates, etc.)
    - General refactoring of the logging infrastructure for
      (now for access.log, error.log and httpclient.log) to reduce
      code duplication and to achieve a more consistent behavior.
    
    Sample httpclient log configuration:
    
    ns_section ns/server/$server/httpclient {
        ns_param    logging         on ;# default: off
        ns_param    logfile         ${logroot}/httpclient.log
        ns_param    logrollfmt      %Y-%m-%d ;# format appended to log filename
        #ns_param   logmaxbackup    100      ;# 10, max number of backup log files
        #ns_param   logroll         true     ;# true, should server log files automatically
        #ns_param   logrollonsignal true     ;# false, perform roll on a sighup
        #ns_param   logrollhour     0        ;# 0, specify at which hour to roll
    }

M	include/ns.h
M	nsd/log.c
M	nsd/nsd.h
M	nsd/rollfile.c
M	nsd/server.c
M	nsd/tclhttp.c
M	nslog/nslog.c
M	openacs-config.tcl

commit 3f0b18bd6cc490a835c34c281ca512ea9ef941ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-23

    prefer variable name "filename" over "file"

M	nslog/nslog.c

commit 188e3b3bd779483d9389e6d6366c4f90f2cb2201
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-22

    document behavior of "ns_conn auth" with Bearer and Digest Authorization, added test cases

M	doc/src/naviserver/ns_conn.man
M	tests/ns_conn.test

commit f3e396e3c545c2c4fdb16e68be3792b524b3cc1a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-22

    reduce number of locks on interp updates and fix a memory-leak on new feature of update delaying

M	nsd/tclinit.c

commit 138e1f97c13bef2783e9f838a87cae67a3c2ba71
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-21

    provide information about Bearer authentication via [ns_conn auth]

M	doc/src/naviserver/ns_server.man
M	nsd/auth.c

commit 8cfbd24933c7e237248febc7ea48cbdde8992fa2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-16

    fix typo

M	nsd/cache.c

commit 07ed7f427d40abaf85bb29ab016a998801a25ced
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-15

    reduce verbosity

M	nsd/tclcache.c

commit 341784fbf666ff923470457950c8ab51e6c604de
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-15

    ns_parseurl: added parsing of query and fragment components in tail
    
    When provided url contains a tail element, this is potentially parsed info a query and/or fragment.

M	doc/src/naviserver/ns_parseurl.man
M	nsd/url.c
M	tests/ns_parseurl.test

commit c4c4c04a5ed9b29f232bcba951a1e6088e3c33d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-15

    Added additional option to ns_getcsv: -quotechar
    
    Although RFC 4180 specifies double quotes as quoting chars, some
    implementations support also different quoting characters.
    The new options allows a developer to specify also non-standard
    quoting characters

M	nsdb/dbtcl.c
M	nsdb/doc/mann/ns_db.man
A	nsdb/doc/mann/ns_getcsv.man

commit 1f6d51cb36c84a9b9348d1154bd3f515af071191
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-15

    add slow pool to example configuration file for OpenACS

M	openacs-config.tcl

commit ed9f24ad3de77d3dbee4f3ca8bcc83c0ae43f077
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-15

    improve wording, sort params alphabetically

M	doc/src/naviserver/ns_job.man

commit ff88adc4a40e200abc7c901c5d5aea3205955017
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-15

    add additional notification after ns_cache commit transactions happen.
    
    This is intended to help in rare situations, where on concurrent entry
    creates, one of the create attempts fails and the other succeeds, and
    the one of the cache transitions is rolled back.

M	include/ns.h
M	nsd/cache.c
M	nsd/tclcache.c

commit 130c9a2119623e0f7e54fbf46a752f8f0f9c5503
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-13

    fix incrorrect position information in warning message

M	nsd/range.c

commit 0dc816f0fc6116170d8345ee2d29753c482e3dce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-12

    Use rwlocks for tcl.cache
    
    In essence this concerns the per-server hashtables for the created caches,
    not the caches itself.

M	nsd/nsd.h
M	nsd/tclcache.c
M	nsd/tclinit.c

commit 4bdbd53a3c36f60b8ec0c4e400de1b69bf3e19e5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-12

    ns_sendmail: convert all leading "." to ".." in the message body
    
    see RFC 5321 section 4.5.2

M	tcl/sendmail.tcl

commit 9d42bc9f9eefbcc68c1c61613d1680eb9aa0d20f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-08

    Use rwlocks for filters
    
    This change increases parallelism for executing filter conditions
    concurrently in multiple threads

M	nsd/filter.c
M	nsd/nsd.h
M	nsd/server.c

commit dbe3364cb3c5f48b375f4e207b0ff3ad3ba1d933
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-05

    use consistently NS_TIME_FMT for printing Ns_Time values

M	nsd/connchan.c
M	nsd/fd.c
M	nsd/queue.c
M	nsd/tclcache.c
M	nsd/tcltime.c
M	nsd/tls.c
M	nsdb/dbinit.c
M	nsthread/cslock.c
M	nsthread/mutex.c
M	nsthread/nsthreadtest.c
M	nsthread/rwlock.c
M	nsthread/time.c

commit 8edfea4ceb7470b822870847dfe35a1d9ca0987c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-05

    Set result of Send() to -1 when it has failed due to an error condition

M	nsssl/nsssl.c

commit b6f47a68b8dfbc4ccbcb3b42a2076de2c593d36a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-05

    add concurrency level to log message of interp updates
    
    By logging providing this information in the log, a server admin
    can get information about portential need of setting
    maxConcurrentUpdates.

M	nsd/tclinit.c

commit 8cbaae223fa3f2747bd22428bd62285a4d416767
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-05

    New option for improved resource management: "ns_ictl maxconcurrentupdates ?max?"
    
    This experimental option allows a server admin to configure, how many
    concurrent interpreter updates induced via epoch changes (e.g. on
    ns_eval) are allowed. This option is just useful for large sites with
    high number of connection threads defined. The default value for this
    parameter is sufficiently high, such that all updates will be
    performed by default potentially concurrent.
    
    Background: For example, when a sites allows unlimited parallel
    updates, and the site has defined e.g. 100 connection threads, and
    every single update takes 1 second, then the request processing of the
    whole server comes to a complete standstill on epoch increments for at
    least for 1 second, since all threads will be busy with updates. When
    the number is sufficintly high it all available cores will be used,
    which will slow down the concurrent interpreter updates further. When
    the server will receive a higher number of requests (e.g. 800 per
    second), queueing will be inevitable (unless the number of concurrent
    updates is adjusted).
    
    When during an update the maximum number of concurrent updates is
    reached, further updates are delayed until the count is again below
    this threshould. In such cases it is possible that some request will
    be still use the previous blueprint (similar to "eventually
    consistent" in distributed database systems).

M	doc/src/naviserver/ns_ictl.man
M	nsd/tclinit.c

commit b5ec5e1a1feb6d4ddec0a57732cd4ba014de6736
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-05

    whitespace changes

M	nsd/tclthread.c

commit 6ce524a988c2b9cec78b6b67baae98e1fd908997
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-05

    improve comments

M	nsthread/thread.c

commit 63a83f421a5f19104701ad08f760fbe5c8477518
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-05

    fix typo

M	nsd/queue.c

commit f6c47d461a235afa5899840a1f10b1161ef34f7e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-03

    use NS_TIME_FMT as uniform macro as print format for printing Ns_Time values

M	include/nsthread.h
M	nsd/config.c
M	nsd/connchan.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/sched.c
M	nsd/sock.c
M	nsd/tcljob.c
M	nsproxy/nsproxylib.c

commit 994540997ed9d0c10c4b750507fbe84cdf07cefb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-03

    fix syntax of markup in doc generation

M	doc/src/naviserver/ns_urlencode.man

commit 8b15b114f25b5d24788b61366b50bad7412ac9cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-11-01

    nstrace: only perform "rename" commands, when source exists and target does not exist
    
    otherwise, tcl raises an error.

M	tcl/nstrace.tcl

commit c9fef24649bd9acc8f0b9eac6f4c195df5966778
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-29

    use a better variable name: csvFile instead of cvsFile in test case

M	tests/nsdb.test

commit 01339d7bb122b6493b429db5c6cb47e64becd237
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-29

    ns_getcsv: provide compatibility with rfc4180
    
    - accept multi-line input,
    - handle quotes in quotes and empty elements
    - optionally stripping unquoted elements (not covered by RFC)
    - added regression tests

M	nsdb/dbtcl.c
M	tests/nsdb.test
A	tests/testserver/pages/csv

commit caab40365f0429a44740db1927e9f459d733db3f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-27

    make code more robust in case Tcl and NaviServer are compiled with different memory allocators
    
    many thanks for Oleg Oleinik for pointing out this potential problem.

M	nsd/dstring.c

commit b6af48cecbaa03a55b5966f126b47e112c50952e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    whitespace changes and improved comments

M	nsd/filter.c
M	openacs-config.tcl

commit 21ff3cf0686354b2a8ef5d88fcfcf35e2fa1e94d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    remove experimental code

M	nsd/tclinit.c

commit b3b8f99aba2ff356668f450419d369f16bc24a54
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    prefer boolean expressions

M	nsd/config.c
M	nsd/connchan.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/pathname.c
M	nsd/sock.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tclresp.c
M	nsd/tclthread.c
M	nsd/unix.c

commit 6652968af1ca4c0cba2928eaf3cc04cea4f710a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    revert simplify path

M	nsthread/rwlock.c

commit 220185921deda6bbb2ed844b23faac2adabdd8b0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    reduce implicit conversions

M	nsd/conn.c
M	nsthread/memory.c

commit a4c0d049e2ea6c1d355bfca1ab2320516defccc8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    reduce number of dead assignments

M	nsd/nsmain.c
M	nsd/sock.c
M	nsd/task.c
M	nsd/tclhttp.c
M	nsd/tclvar.c
M	nsd/tls.c

commit 4dcb399f6855a75e67e839494355ddedd22cd168
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    simplify logic

M	nsthread/rwlock.c

commit a761accc17c2b2c1706e27d4b28e6bef35eaf9de
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    make gcc10 static analyzer happy (flag "-fanalyzer")

M	nsd/form.c

commit ffeafdebecb999732712c6edf891917ea0eeab4d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    Use "for(;;)" instead of "while(1)" like on other places

M	nsdb/dbtcl.c

commit d79f9b323d7d59b0f9416a4a284d3c9b53922a47
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    improve type cleanness on gcc-10

M	nsd/driver.c

commit 4d8ba99fac63a946ade19f9937b17d1c7fb06ea9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    avoid potential null pointer dereference in an error condition

M	nsd/connchan.c

commit 02cd32c01ebff5e6b613159582b3c7203df01230
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    add assertion to guide static checker

M	nsd/config.c

commit 7a4eb60eb1b284445622a0efb1c4e4c76b5cbd6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-26

    make sure, close() and other functions accepting "sock" are not called with invalid sock values

M	nsd/binder.c
M	nsd/tclinit.c

commit 3c3eaa517d3111589bfcb5ae118f78cdac0e51d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-19

    reduce verbosity and make message a debug message

M	nsd/queue.c

commit 0b41b345f52f8df7dcc12575ff13528a9e6aba98
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-19

    added comments how to get Google's address sanitizer working

M	include/Makefile.global.in

commit 1fd7fbc6e9d9781dcee1dc9d3dea223bd23ba111
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-18

    cleanup after testing with FB infer 1.0
    - reduced the number of issues from >200 to 12
    - resulting cases are mostly false positives
    - checked e.g. all results from malloc() and friends against NULL
      (when compiled with SYSTEM_MALLOC)

M	nsd/connchan.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/form.c
M	nsd/pathname.c
M	nsd/sock.c
M	nsd/tclcache.c
M	nsd/tclcrypto.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tcltime.c
M	nsd/tls.c
M	nsd/urlencode.c
M	nsthread/memory.c
M	nsthread/pthread.c

commit 1d840a343d9469490c86e17adc8e684c9a9fb8ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-18

    improve variable name

M	include/ns.h
M	nsd/config.c
M	nsd/tclcallbacks.c

commit 5642bff3702a7129a3aad28a183e56df745b7a82
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-18

    improve type cleanness

M	nsd/driver.c

commit 06f935619d67635d27e2217bab63c33a03846c86
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-18

    reduce conversions

M	nsd/nsmain.c
M	nsd/uuencode.c

commit c97830d6a85cbad6545ee93d3fb1be98c2a91455
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-16

    fix potential crash in "ns_http wait"
    
    ns_http could crash in cases, where "ns_http queue" and "ns_http wait" were
    executed with a timeout, where the task was freed by the caller before the
    queue was executed.
    
    The bug could be triggered via (probably it has to be run multiple times
    before it crashes)
       $ make test TESTFLAGS="-verbose start -file ns_http.test -match http-8.4.3*"

M	nsd/task.c

commit bfea6269deac0b8eed3aa615c1a2afe47958ff46
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-16

    Provide compatibility with aliases defined without fully qualified namespace path
    
    Many thanks to Oleg Oleinick for providing the patch

M	tcl/nstrace.tcl
M	tests/init.test
M	tests/testserver/modules/init-test.tcl

commit 057b874f75e12f915d7de827d25a837967c333a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-16

    tls.c: provide compatibility with OpenSSL 1.0.2 (as shipped e.g. with RHEL 7.4)
    
    Many thanks for Oleg Oleinick for the patch

M	nsd/tls.c

commit bc5e3f5cdd3ca74a9daff2da7b988374c4694da2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-16

    fix tests with old versions of curl (as e.g. shipped on RHEL 7.4)
    
    Older versions of curl do not support fully IPv6 addresses and complain about
    invalid "URL globbing" parameters. The option -g silences this.
    Many thanks to Oleg Oleinick for the fix

M	tests/ns_http.test
M	tests/ns_http_charsets.test

commit c512cd515c34cbbf5af1026cc5c0a31f24e2de88
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-16

    align name in assertion as well

M	nsd/driver.c

commit 515ed844ac8da72b7e18fd42ec5b7704d101aba1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-16

    align variable names

M	nsd/driver.c

commit 0f64a98d83821d6ffeb3d4314dd0be5f5e32eafe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-15

    use same naming convention (based on threadName) for writer and spooler locks

M	nsd/driver.c

commit 994cec0d237feb491a21c24a9c69a720e314c478
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-15

    Disambiguate names of locks for writer threads

M	nsd/driver.c

commit 117fcc2e617019b3dd1151d5c46e77d8511c7cdb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-15

    Added metering for long wait times of Ns_CsEnter locks (e.g. Ns_MasterLock)

M	nsthread/cslock.c
M	nsthread/mutex.c

commit 8f0ce5edb10b8a64c3c9d5a6bd010901fc71d7e3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-15

    added tests for the "ns_conn auth*" interface

M	tests/ns_conn.test
A	tests/ns_connchan.test

commit f2dc29ca839c46b3ec2ad23cbab9e31e73ad6cad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-15

    improve documentation

M	tests/ns_cache.test

commit 93700e4b27083bce2de1a54cbc74ca4c19a1c60b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-14

    provide more detailed warning message

M	tcl/form.tcl

commit 28504c4c387faefa692ced8c3d5a83dfdc58e5ba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-14

    fix for recently introduced bug: compare on NUL terminated string

M	nsd/auth.c

commit fc13a6ad55a37e3fbc54beb2fb25653daa957fc6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-13

    deactivate GNUC_PURE or older gcc
    
    There seems to be a problem mit GNUC_PURE at least on gcc 4.8 and -O2
    in this combination (e.g. on RHEL 7.4) WordEndsInSemi returns always 0.
    Many thanks to Oleg Oleinick for figuring this out.
    
    e Bitte geben Sie eine Commit-Beschreibung für Ihre Änderungen ein. Zeilen,

M	include/nscheck.h

commit d6d18a72a88d755eb0d7fa3b0ff1164b95609331
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-11

    make ignoring of return values explicit

M	nscgi/nscgi.c
M	nsd/adpparse.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/exec.c
M	nsd/info.c
M	nsd/log.c
M	nsd/nsconf.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/queue.c

commit 0d4f29404443b60850300f67f8dedb7508d02746
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-11

    added const declarationss

M	nsd/proc.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclsched.c
M	nsd/tcltime.c
M	nsd/tclxkeylist.c

commit f599a9d762baa150ca7110e17a0ad2e8e5bfbf65
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-11

    add const declarations and make sure, ns_set content is not overwritten
    
    When ns_set content is modified, make a copy, preferable via Tcl_DString,
    since this works (in contrary to malloc) in most cases (short string)
    lockfree.

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/auth.c
M	nsd/conn.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/fd.c
M	nsd/httptime.c
M	nsd/info.c
M	nsd/nsd.h
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/range.c
M	nsd/set.c
M	nsd/sock.c
M	nsd/tclhttp.c
M	nsd/tls.c

commit 7fe6e07eebd93da921fc2f9d9fcde1216203d6c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-11

    prefer variable initializations over separate statements

M	nsd/config.c
M	nsd/dns.c
M	nsd/form.c
M	nsd/pathname.c
M	nsd/set.c
M	nsd/task.c
M	nsd/urlspace.c
M	nsproxy/nsproxylib.c

commit 8dc8bbedfba69d4b5c1d656869b032ab4fbb5ecc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-10

    prefer variable initializations over separate statements

M	nsd/event.c

commit 17323ff58ca96f135f8356611aa2ca01fd580a7a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-10

    prefer variable initializations over separate statements

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/cache.c
M	nsd/config.c
M	nsd/driver.c

commit 3e955e151f5e81f3ea88de659ccd7926c663ea05
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-10

    prefere single statement per line

M	doc/src/naviserver/ns_return.man
M	nsd/driver.c
M	nsd/form.c
M	nsd/url2file.c
M	nsperm/nsperm.c

commit 0e53914d7e55763a60fb7f51e8036bec59bf3c0c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-10

    improve spelling

M	nsd/str.c

commit b52162cf8ff4a32f4e520d1e61f246eb6af11fdf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-09

    fix sample config file when multiple addresses ae used

M	openacs-config.tcl

commit ddb6c723d0436275d614c737bc8320c1f2df8831
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-06

    fixed potential race condition in ns_connchan for channel creation and channel listings

M	nsd/connchan.c

commit cc4df906a740d181120ca11e7b77c6488d6a5561
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-10-05

    Fixed potential crash in sock callback interaction, when connchan was canceled during introspection (ns_connchan list)

M	nsd/connchan.c

commit 6aebde5aced9454cb177cdf56b643c394058f5dd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-09

    improve cleanness of compilation

M	nslog/nslog.c

commit f9b9ae8c48be0726bd43f850adfaa718120103ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-08

    allow one to call "ns_conn status" without argument in a trace

M	nsd/conn.c

commit 6ebbfdb8604def01ec202bbf4c5a25f31a2c9790
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-07

    add experimental travis.yml file

A	.travis.yml

commit e4eb21f4e9b402a4b7f9b163567e030ebf42e211
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-06

    fix name of Tcl_ObjCmdProc when compiled without HAVE_OPENSSL_3

M	nsd/tclcrypto.c

commit ef2b4c351d6ec4fec521a12b58938aa5d5d3e02b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-06

    use "unsigned char *" for byte arrays more consistently

M	include/ns.h
M	nsd/str.c
M	nsd/tclcrypto.c
M	nsd/tclmisc.c

commit c2c8ca247dff5e71dd55d0262c734d2ee20c560e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-06

    make debugging code easier to locate

M	nsd/tcltime.c
M	nsperm/nsperm.c

commit 34259fea730bdaf98670544a752ed84bf5f9fea0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-06

    deactivate debugging output

M	nsdb/dbtcl.c

commit b2d57b8fdde5d0165435215796ba6d1855fddeae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-05

    new flag "-binary" for ns_http
    
    This patch introduces the "-binary" flag to ns_http to
    transmit data binary and perform no automatic encoding
    transformations. It is symmetrical to the flag in e.g.
    ns_return.
    
    This change was essentially developed by oleg (ooa64@ua.fm)

M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_return.man
M	nsd/nsd.h
M	nsd/tclhttp.c
R100	tests/http.test	tests/ns_http.test
A	tests/ns_http_charsets.test

commit 6e94e876980661a34fa3e9358f1818ee99a3d504
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-05

    added experimental multiline trim command with optional delimiter

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c

commit cca915aa9289d488f80e314a34261010fc303196
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-05

    follow usual naming conventions

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclcrypto.c

commit 081829e43606b0e50baf3f258649ce4311358e10
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-01

    sharpen terminilogy: use Tcl_Obj when it is meant

M	nsd/log.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclthread.c
M	nsd/tclxkeylist.c
M	tests/tclresp.test

commit 4fda8b516ad1e27bf43dbadcfb98be2d891d077e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-01

    extend regression test

M	tests/ns_urlencode.test

commit a77321077634ac0a7485b51f2c4b518fcb19c447
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-01

    Added option for "oauth1" encoding the ns_urelencode
    
    One case now specify "oauth1" for the encoding table of ns_urlencode
    to obtain an encoding as specified in RFC 5849 Section 3.6
    for the construction of the signature base string and the "Authorization"
    header field.
    
    This is not terribly important but better and faster than several "manual"
    implementation in case oauth1 is needed.

M	doc/src/naviserver/ns_urlencode.man
M	include/ns.h
M	nsd/urlencode.c
M	tests/ns_urlencode.test

commit 9956f1c8810d4f19f608e43611b947a514910835
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-09-01

    followup commit for same-site=none
    
    Don't tree the absence of the samesite flag as "samsite=none"

M	nsd/cookies.c
M	tests/cookies.test

commit 6e7485773501225e1831ef79aa9e404d565f8f00
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-31

    make configuration files and documentation more consistent

M	nsproxy/doc/mann/ns_proxy.man

commit 9fd96453faa28222e836e1f60fade53484dda1b2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-31

    make documentation more consistent with actual code
    
    This change aligns the documentation of configuration files
    and the actual sample configuration files.

M	doc/src/manual/admin-config.man
M	doc/src/manual/admin-db.man
M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/admin-tuning.man
M	doc/src/manual/adp-overview.man
M	doc/src/manual/tcl-lib-file.man
M	doc/src/manual/tcl-libraries.man
M	nscp/doc/mann/nscp.man
M	nsd-config.tcl
M	nsperm/doc/mann/ns_perm.man
M	nsperm/doc/mann/nsperm.man
M	openacs-config.tcl
M	sample-config.tcl.in

commit 6fd70db35b5dd947307d08306f093893108cb73f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-31

    Make nsv locktype configurable
    
    Per default rwlocks are used, when nsvrwlocks is configured as false
    mutex locks are used.

M	doc/src/naviserver/nsv.man
M	nsd/nsd.h
M	nsd/tclinit.c
M	nsd/tclvar.c

commit b0c3766f6242462a7ff5bed78819517522fc3746
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-31

    Support explicit setting of same-site=none
    
    In previous version of browsers, no explicit setting
    of the samesite flag was exactly the same as explicit setting.
    Since some browsers switched to a default of "lax", explicit
    setting became necessary.

M	include/ns.h
M	nsd/cookies.c

commit 88373aff7f1d07f0db32f0c0229b68ad8d1ce3c7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-28

    apply window fixes from oleg sent via navidel

M	include/Makefile.win32
M	nsd/Makefile
M	nsd/nswin32.c
M	tests/all.tcl
M	tests/http.test

commit f3db352cabdcfff167a976ad3dde6bc4d2a557be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-28

    extend regression test a little to cover basic ns_db commands

M	nsdbtest/nsdbtest.c
M	tests/nsdb.test

commit 672643c41bb05cc9b7f8f45f0dfb2615c882c418
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-28

    minor refactoring to reduce redundancy

M	nsdb/dbtcl.c

commit 937d8ee9181e69acf4dd995b52f78498dd23c07f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-28

    modernize time units in example

M	nsdb/doc/mann/ns_db.man

commit 0845fa407a766d635953bde9281c332abb6f34fd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-28

    initialize Ns_Time usec with 0

M	nsd/sched.c

commit 98866d01def968ef15051b8312e1ba661fec61d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-14

    fix call of naviserver without any configuration

M	nsd/nsmain.c

commit 814953953a4c55ade730bcfdba56f96394054ff1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-14

    whitepace changes

M	nsd/fastpath.c

commit 4ecea6c6eb2c419103b143e0237e03bfec8d94be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-14

    Keep reading the configuration file before chroot()
    
    A change 6 days ago has introduced the testing flag "-T"
    where also the code locality was improved. This moved the
    reading of the configuration file after the chroot() command.
    
    Many thanks to Oleg for the good bug report.

M	nsd/nsmain.c

commit 8cc9201858717dc32174d15e7d68b8642cd645d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-14

    whitespace changes: space after comma helps the eyes

M	nsd/binder.c
M	nsd/conn.c
M	nsd/crypt.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/fastpath.c
M	nsd/index.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/request.c
M	nsd/sockaddr.c
M	nsd/task.c
M	nsd/tclcrypto.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclset.c
M	nsd/tclxkeylist.c
M	nsd/urlspace.c
M	nsd/uuencode.c
M	nsdb/dbdrv.c
M	nslog/nslog.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit 62a21e5954699aa59e99cb2b85907df029c93cdb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-14

    proved locks for callback changes

M	nsd/connchan.c

commit 29d9113d6c8574e766b07b5d2c3f24363db1aa66
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-12

    fix typo

M	nsd/nsmain.c

commit 117693cc9b21ba0bcaac2fcef69ef83c7fb8f416
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-12

    adjust test to new naming

M	tests/ns_proxy.test

commit 7aad0a38896e99be5b75a16699df09502a69c34f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-11

    added fall-through declarations

M	nsd/driver.c
M	nsd/nsmain.c
M	nsd/tclinit.c

commit 11df6cdbac0a26035e54b31f12e039bcc5109e37
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-11

    white-space changes

M	doc/src/manual/admin-install.man

commit f7fbcb3e20a8f0e6f43f0323a6da6681aaa07091
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-11

    prefere uppercase abbreviation

M	nsd/urlencode.c

commit e82901478a0acafa53d1881b4d7fba37f4ecdfe8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-11

    white-space changes

M	nsd/tclset.c

commit 7432bdb669780de8437a8b0da240dd5e3060fafe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-11

    add alias for maxslaves/maxworkers

M	nsproxy/nsproxylib.c

commit 54eeaf11f023bbc99ea6f8c1996b6a2451cd822d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-11

    improve spelling

M	nsthread/rwlock.c

commit ae638d77dc904fdd4142f8cb091c22067a9137a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-11

    nsproxy: change "slave" to "worker process"
    
    The configuration and configure flag "maxslaves" is still
    accepted for backward compatibility.

M	nsproxy/doc/mann/ns_proxy.man
M	nsproxy/nsproxy.h
M	nsproxy/nsproxylib.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit c4cf89bf266f136d773ef45eba67c512474ade24
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-11

    replace "slave process" by "child process"

M	nsd/binder.c

commit aad1a473f3cac3b78c46dff97bb8b8b331bd35ec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-08

    New command line option for NaviServer: -T
    
    When this option is used, NaviServer just checks the configuration
    file (specified as usual by "-t") for syntax errors.  This option
    should be used on production sites to reduce the downtime of a server
    in case of typos.

M	doc/src/manual/admin-config.man
M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/c-driverdb.man
M	doc/src/naviserver/ns_getform.man
M	nsd/config.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/tclmisc.c

commit f30dcea0d3427ef1f3a4b49e085ded957a602487
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-08

    prefere boolean datatype for boolean values

M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/unix.c

commit 9233725fa9857217dda5aa267facfcd9e6977e4f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-08

    openacs-config.tcl: improve regularity and locality

M	openacs-config.tcl

commit 73e8a39052c3bd8066ca40dafa085f69d2153e5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-08

    make variable name self-explanatory

M	nsd/info.c
M	nsd/nsd.h
M	nsd/nsmain.c

commit 8605a28c0b57ffa9cf8e87ef5550f3fe3e1d5eb3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-08

    improve spelling

M	nsd/sockaddr.c
M	nsssl/doc/mann/nsssl.man

commit 2fd610e2af706154f4da97aa949829b20f05a0e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-07

    prefer Ns_ObjvServer to reduce redundant code

M	nsd/connchan.c
M	nsd/limits.c

commit 63e3fce8b88010bb83f13b2666fb5fb5e2aa79f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-07

    fix spurious bracket

M	doc/src/naviserver/ns_connchan.man

commit a28002b7338181d568c99563261fd793e1e77ac5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-07

    added optional argument "-server" to ns_connchan for cleaning stale handles

M	doc/src/naviserver/ns_connchan.man
M	nsd/connchan.c

commit 5f82763edbc2bf05e14386f45c91f5d6535f5b9e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-07

    improve spelling

M	doc/src/naviserver/ns_crypto.man
M	nsd/sockaddr.c
M	nsd/tclthread.c
M	tests/tclresp.test

commit 4b8ccdb2cbb0244f7116620eb13f94456b3be8f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-07

    OCSP: reduce default verbosity and add parameter OCSPstaplingVerbose

M	nsd/tls.c
M	nsssl/doc/mann/nsssl.man
M	openacs-config.tcl

commit 7161897eaf8cad7ff067da4d1deef89dadac3e94
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-06

    whitespace changes: replace tabs by spaces in .h files

M	include/nsthread.h
M	nsdb/db.h
M	nsproxy/nsproxy.h

commit b9e121fc4b0181f5c5db0d9d0058092b535e9567
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-06

    whitepace changes: replace tabs by spaces in C code

M	nsd/exec.c
M	nsd/proc.c
M	nsd/tclmisc.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsthread/memory.c
M	win/cgitest/main.c
M	win32/cgitest/main.c

commit ba9efc0ae790e4e68ccbfc8531a1aba0fb958ae8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-06

    improve documentation pages a little, which were not touched since 15 years.

M	doc/src/manual/c-driverdb.man

commit f29ae5017137f107f186950d69ee2117a170be45
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-06

    reduce verbosity when setting SockSetKeepalive

M	nsd/sock.c

commit 2d64bf5da80e536d541163388e08cffbcfe56b19
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-06

    improve spelling

M	doc/src/manual/c-driverdb.man
M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_http.man
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/form.c
M	nsd/modload.c
M	nsd/sock.c
M	nsd/sockaddr.c
M	nsd/sockcallback.c
M	nsd/tclrequest.c
M	nsd/tclthread.c
M	nsd/urlspace.c
M	nsdb/doc/mann/ns_db.man
M	nsthread/mutex.c
M	tests/ns_cache.test

commit 9159e7c318cf61ef9eff90f55fb1e21b037d8d3d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-05

    avoid uninitialized variables in complex error paths

M	nsd/tclvar.c
M	nsd/tls.c

commit ddb668b7e9e3a93f4d9903ea03c43e2f154fa2be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-05

    update to clang-10

M	Makefile

commit 146f784d2e84cb35b8004a075237ab4390921188
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-05

    OCSP: reduce variable scopes, refresh expire date

M	nsd/tls.c

commit 22b3eb2f24b7e78fcfae9e28b206f8d3cebb0bd7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-05

    OCSP: perform runtime re-check of OCSP records (previously, only check at startup time)

M	nsd/tls.c

commit 2f3992caef73065dc4bd5b38cf37ccab388ca41e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-05

    added keepalive for connchan connections to be able to distinguish between empty read and stale connection

M	include/ns.h
M	nsd/connchan.c
M	nsd/sock.c

commit a31faa54e70186d12738eb306ae620e4a2ce6ff5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-05

    remove length indicator from result

M	tests/ns_adp_compress.test

commit dbadd0a63b7c99ef65bedcd5199be47c932aab2a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-04

    improve spelling

M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_parsefieldvalue.man
M	doc/src/naviserver/ns_parsehttptime.man
M	doc/src/naviserver/ns_write.man
M	doc/src/naviserver/returnstatus-cmds.man

commit c5d5f9b4c6793472553a2b084b246588b81a33f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-04

    improve spelling

M	nscgi/doc/mann/nscgi.man
M	nsd/driver.c
M	nsd/request.c
M	nsd/return.c
M	nsd/sockaddr.c
M	nsd/tclhttp.c
M	nsd/tls.c
M	nsssl/nsssl.c
M	sample-config.tcl.in

commit 427525f256f2a0d04b090b4623656bfd49ce2695
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-03

    fix comment and make structure more regular

M	nscgi/nscgi.c

commit 37ee2af1d0b2bd204677764961811534f8115b37
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-03

    improve comment

M	nsd/adpeval.c

commit e43e45dce7696f7050809f7fcdbc6ffbf6800982
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-03

    make operator precedence in complex expressions explicit

M	nsd/conn.c

commit 22f2149c81c929593ae2c2c3c1de29c367ab2fe1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-02

    added OCSP expiry checking for cache file at server start time

M	nsd/tls.c

commit 1f8d7ab3fc6a2eb2521bbfe623d1c1826480dee9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-02

    add OCSPstapling example to man page

M	nsssl/doc/mann/nsssl.man

commit 7f9298a8b883f6e2f787cc7d199ba6602718ac74
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-02

    reduce verbosity

M	nsssl/nsssl.c

commit 7055d3ddf50dcb65b247bf768848d472a1e8eaee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-02

    reduce verbosity

M	nsd/driver.c

commit e1e52994822265e51961bfb078751604731e718b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-08-02

    add OCSPstapling example for config file

M	doc/src/manual/admin-config.man

commit f8cf0f7834d24beaffeba8b67ddb626641280b4f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-30

    fix nsv_dict unset, extend regression test

M	nsd/tclvar.c
M	tests/ns_nsv.test

commit 720277673935b64d2e5e0b3cbecda5f5a1d6bef4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-30

    reduce verbosity

M	nsssl/nsssl.c

commit 103d1bcfcd1be39f4b58ab4fddfc970c834f9abe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-30

    fix parens

M	nsd/urlspace.c

commit c4479c4207a3664a866d661fb64d7fe3b2e3729b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-27

    improve naming of main-thread: make source always clear by -main: suffix

M	include/nsthread.h
M	nsd/nsconf.c
M	nsd/tclinit.c
M	nsthread/nsthreadtest.c
M	nsthread/thread.c

commit 14713808b59c5e401a2d320eab4207605c23a8e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-27

    make it more clear, what RequestNew() does

M	nsd/driver.c

commit a277baca9e53df0bffeac13ef04bcebf655e3f6c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-27

    make clear, that RequestNew(sockPtr) initialized always sockPtr->reqPtr

M	nsd/driver.c

commit dc4c8d15271132dd3fcf9b6120b97a83b88e3c7b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-27

    reduce variable scopes

M	nsd/tclvar.c

commit 3bf5b862243172f282ba9e0a9370e68a5dad6a6f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-27

    remove dead code and always false condition

M	nsdb/dbtcl.c

commit 613343bd3ff0e97044990a8e5fee3fad3dc8e6b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-26

    removed one "FIXME": get the interp not always from the default server, but from the server, where the command was started

M	nsd/nsd.h
M	nsd/tclhttp.c

commit b0806fe7d14a599e9561e64b6f145ffb5991624a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-25

    remove extern declaration from function definition (provided by declaration)

M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclenv.c

commit 51a78492eca6976c8cbbb5af25c34dd7fd905e26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-25

    reduce variable scopes

M	nsd/tclvar.c
M	nsthread/rwlock.c

commit 641ebb06c5dc14fed901ea4b7d18d7c0b367b551
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-25

    fix indentation

M	nsd/connio.c
M	nsd/tclcrypto.c

commit cd66ee187f4154070bc7cbab8720539c25720fbe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-25

    fix potentially misleading indentation

M	nsd/adprequest.c
M	nsd/auth.c

commit a3d05f6e1a7cf747ab6aca33b51d0a2c567667ee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-25

    remove redundant declaration

M	nsd/tclenv.c
M	nsthread/rwlock.c

commit 03cc50355f06029cb7b594b4628f1471c3272e89
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-25

    make clear, that value casted to size_t is positive

M	nsproxy/nsproxylib.c

commit 708b728e60fdccb091c9daebafbfec5af880000a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-25

    include driver_locks only for versions of SSL that need it

M	nsssl/nsssl.c

commit 7413b3c8a07bfdfdda868f54214668fe2962bf2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-25

    add const declarations

M	include/ns.h
M	nsd/driver.c
M	nsd/sched.c
M	nsproxy/nsproxy.h
M	nsproxy/nsproxylib.c
M	nsthread/winthread.c

commit f3be222c859f3b0eb8c5a56b6c96b0496778f225
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-25

    remove potentially incorrect non-null constraint

M	nsd/driver.c

commit 3cf1379b5ac4da275dd39b5e2e5f272ff21b3c75
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-25

    avoid potential NULL pointer dereference

M	nsd/tls.c

commit 76dbdbecc9434e7b78a21ace36c06ad32d915347
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-25

    Reduced verbosity of SNI-interactions

M	nsd/tls.c

commit 3f1de19798bc9bb24436caed509faec5baf2efec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-23

    added patch for windows from Ibrahim Tannir

M	nsthread/winthread.c

commit 69b6b81e1dd3c779e9d59f2af25ccce059f1f91e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-19

    code cleanup
    - added "const" declarations
    - reduced variable scope
    - task.c: fixed macro with if-statement (turned it into a function)
    added experimenal idle callback

M	include/ns.h
M	include/nsthread.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/nsopenssl.h
M	nsd/queue.c
M	nsd/sched.c
M	nsd/sock.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclvar.c
M	nsd/tls.c
M	nsd/urlencode.c
M	nsd/urlspace.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nssock/nssock.c
M	nsthread/reentrant.c
M	nsthread/tls.c

commit a45cdae9185c63365b900e29c8a3ab52d655b583
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-18

    prefer term "configuration file" over "config file"

M	nsd-config.tcl
M	openacs-config.tcl
M	simple-config.tcl
M	tests/http_byteranges.test

commit 481cf2ce2e9ca61997d442b17cc8c3d2cefe6484
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-18

    make switch statement wellformed

M	nsd/tls.c

commit d309c45841eddde4b3a82f696710e3b156630c64
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-18

    add parameter names to static function prototypes

M	nsd/task.c

commit c82f57506fa4ad4906531e61e74ae78788355421
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-18

    remove incorrect assignment

M	nsdb/dbtcl.c

commit 581430be4390c2b76af4945892e1c966760a3b95
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-18

    Don't pass  NULL after the last typed argument to a variadic function

M	nsd/tclvar.c

commit 4afd8d1d082c02fbf64d488cf58633fcd0a53ddb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-18

    reduce tech speak

M	nsd/callbacks.c
M	nsd/config.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/info.c
M	nsd/log.c
M	nsd/nsmain.c
M	nsd/returnresp.c
M	nsd/tclconf.c
M	nsd/tls.c

commit 3eb3b6d81e637e946e314228e80cae184b561602
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-18

    reduce tech speak

M	doc/src/manual/admin-install.man
M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/admin-tuning.man
M	doc/src/manual/main-standards.man
M	doc/src/manual/tcl-libraries.man
M	doc/src/naviserver/ns_guesstype.man
M	doc/src/naviserver/ns_info.man
M	doc/src/naviserver/ns_log.man
M	doc/src/naviserver/ns_moduleload.man
M	doc/src/naviserver/ns_parseheader.man
M	doc/src/naviserver/ns_rlimit.man
M	doc/src/naviserver/ns_shutdown.man
M	nsproxy/doc/mann/ns_proxy.man

commit 1a8342a7d1c19573e9e89a652fb396a9add9c0dd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-18

    Added a new admin-* manual page for an introduction to configuration
    
    In particular this page describes the general structure and aspects
    of global/local drivers and virtual hosting (including HTTPS and SNI)

A	doc/src/manual/admin-config.man
M	nssock/doc/mann/nssock.man
M	nsssl/doc/mann/nsssl.man

commit 542efdc9c701875e74324ada2ff57f63b5b6f79a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-18

    added compatibility with OpenSSL 3.0.0-alpha6-dev

M	nsd/tclcrypto.c
M	nsssl/nsssl.c

commit 5c28daaaaf317d8ae3baef975b8a261c4a567542
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-16

    Improved server-side SNI support
    - added support for EC for virtual hosting with SNI
    - added support for OCSP for virtual hosting with SNI
    - added support for DH ephemeral key exchange with a key length of 2048 bits
    - reuse SSLcontext for virtual hosting when SNI is used

M	nsd/Makefile
A	nsd/dhparams.h
M	nsd/driver.c
M	nsd/nsopenssl.h
M	nsd/tls.c
M	nsssl/Makefile
M	nsssl/Makefile.common
D	nsssl/dhparams.h
M	nsssl/nsssl.c

commit 1e91dca5c40a94317d4467818c9c96ba447ce237
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-16

    minor code cleanup (align variable names, reduce scope, implicit conversions)

M	include/ns.h
M	nsd/connio.c
M	nsd/driver.c
M	nsd/rollfile.c
M	nsd/tclvar.c

commit 5616cdd1dc7b95d86d435226c45b14f3b63d38de
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-15

    avoid warnings in the log file on soft errors (such as a browser complaining about a self-signed certificate)

M	nsd/driver.c

commit 22c22bd43af34755448f464ee29843c6ba6d80d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-15

    avoid shutdown in OpenSSL init state

M	nsssl/nsssl.c

commit 76d725ed21645f883d679e61297aa3ea60b52ef6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-14

    Provide infrastructure for client-side TLS API to support SNI
    
    - introduced type Ns_DriverClientInitArg to pass
      context info to the Ns_DriverClientInit callback
      (similar in style to OpenSSL conventions)
    - ns_connchan open: Added support for client-side SNI
      (new parameter "-hostname)
    - automatically retry read operations on "ns_connchan read"
      when NS_SOCK_AGAIN is returned

M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_http.man
M	include/ns.h
M	nsd/connchan.c
M	nsssl/nsssl.c

commit 24776c4d40e896cb893e4005276999e1b9e96310
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-14

    Improved handling of SSL_ERROR_WANT_WRITE and SSL_ERROR_WANT_READ
    
    THe old code checked always for readable and writable conditions
    when one of these OpenSSL conditions were returned. Now we
    check only for either readable or writable.

M	nsd/tls.c

commit 8d0af1c3ac506d4317e0a46f071987b9d9c4f625
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-13

    improve man page
    
    make clear that ns_parseheader operates on a single line;
    add example

M	doc/src/naviserver/ns_parseheader.man

commit af8ea12960eef413ace5825da4e369d47a4f89d6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-11

    insert missing space in documentation

M	nsproxy/doc/mann/ns_proxy.man

commit f7ffa382900b96f8f539bcaf92a2d85ff5ad4783
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-11

    return the number of running worker processes in the nsproxy pool statistics

M	nsproxy/doc/mann/ns_proxy.man
M	nsproxy/nsproxylib.c

commit 7b523135338c57dec9fc4441fbaffb37fa744283
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-10

    improved documentation

M	doc/src/naviserver/ns_queryget.man
M	doc/src/naviserver/ns_return.man

commit 2bb1ba2d661706cc16244e21e02975cc1c5fb9a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-10

    Improve spelling: move closer to the Linux documentation recommendations

M	tests/http.test
M	tests/misc.test
M	tests/ns_crypto.test

commit 7896f699690621d9eaa956e3661b27be5dc68a99
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-10

    improve spelling: move closer to the Linux documentation recommendations

M	contrib/examples/upload.tcl
M	nsd-config.tcl
M	openacs-config.tcl
M	tcl/compat.tcl
M	tcl/config.tcl
M	tcl/form.tcl
M	tcl/http.tcl
M	win32-util/install-nsd.tcl

commit 3389d07b3d46a53343fe340a07bed7ea8fcbfa60
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-10

    refactor DH handling to work as with server-side SNI

M	nsd/nsopenssl.h
M	nsd/tls.c
M	nsssl/nsssl.c

commit fab1fb5ff1561d7f73f746f151f8110fdc37c9ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-10

    update sample config file to deliver extensionless files as HTML

M	openacs-config.tcl

commit 6cdd0726c6b04c81d5679836020d0a0355eb0ce5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-08

    Added support for removing TLSv1.0, TLSv1.1, TLSv1.2, and TLSv1.3

M	nsd/tls.c
M	nsssl/doc/mann/nsssl.man

commit 4662b12c3c548db4b2d0ed6625c66260662d2089
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-08

    Implement server-side SNI (Server Name Indication (SNI)
    
    - Through this change, different certificates can be used by virtual hosts.
      The setup requires a global installation of the driver. In addition to the
      top-level certificate, different certificates can be defined per virtual
      server (below: srv2). The certificate will be registered for all alternate
      names specified for the server.
    
      In addition to the certificate, also all other OpenSSL specific parameters
      (ciphers, protocols, ...) will be loaded form the same place as the certificate
    
    =============================
        ns_section ns/modules {
          # ...
          ns_param        nsssl           ${bindir}/nsssl.so
        }
        ns_section ns/module/nsssl {
          # ...
          ns_param   defaultserver   srv1
          ns_param   certificate     /usr/local/ns/modules/nsssl/srv1.pem
        }
        ns_section "ns/module/nsssl/servers" {
           ns_param   srv1            test.org
           ns_param   srv1            www.test.org
           ns_param   srv2            someotherhost.org
        }
        ns_section "ns/server/srv2/module/nsssl" {
          # ...
          ns_param   certificate     /usr/local/ns/modules/nsssl/srv2.pem
          ns_param   ciphersuites    TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256
        }
    =============================
    
    - Support for OpenSSL "ciphersuites": Starting with TLSv1.3
      OpenSSL supports ciphersuites, which are defined differently than
      then the "ciphers" for TLSv1.2 or earlier. For this purpose, an addition
      parameter named "ciphersuites" was introduced.
      Consult the OpenSSL documentation for details about possible values.
    
    - Base a larger part of nsssl on the code in nsd/tls.c
    - API change: Ns_TLS_CtxServerCreate() was extended with the additional parameters.
    - new API call "Ns_SockGetPort(const Ns_Sock *sock)" to obtain port from a sockPtr
    - some refactoring to ease access to driver and to reduce size of functions

M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sock.c
M	nsd/tls.c
M	nsssl/doc/mann/nsssl.man
M	nsssl/nsssl.c
M	tests/https.test
M	tests/test.nscfg
M	tests/testserver/modules/testhttps.tcl

commit 103c302a523851749bdde9ef227cf6eeb9b0619f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-07

    fix typo

M	tests/all.tcl

commit bd7e7fd58a0e4bdd846e961cd2ddbc4f4ed1c691
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-06

    follow the NaviServer capitalization rules for types and variables

M	nsssl/nsssl.c

commit 348e7b59cbb11ecf65b94655c5fbabdf2553924a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-02

    Name nsjob threads consistently
    
    Use "nsjob" prefix for idle and running nsjobs to ease live of montoring software.
    Follow conventions of other the and use ":" as a separator of name parts

M	nsd/tcljob.c

commit c2b17f6707fe48f4906ac18aa03abcc7070a0a48
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-01

    follow the recommended spelling convention of the Linux man pages

M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/c-driverdb.man
M	doc/src/manual/main-features.man
M	doc/src/manual/tcl-libraries.man
M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/ns_adp_info.man
M	doc/src/naviserver/ns_adp_stats.man
M	doc/src/naviserver/ns_atsignal.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_getcontent.man
M	doc/src/naviserver/ns_getform.man
M	doc/src/naviserver/ns_getformfile.man
M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_log.man
M	doc/src/naviserver/ns_mktemp.man
M	doc/src/naviserver/ns_parsefieldvalue.man
M	doc/src/naviserver/ns_parseheader.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_rlimit.man
M	doc/src/naviserver/ns_shutdown.man
M	doc/src/naviserver/ns_upload_stats.man
M	include/ns.h
M	nscgi/doc/mann/nscgi.man
M	nsd/adpcmds.c
M	nsd/binder.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/quotehtml.c
M	nsd/server.c
M	nsd/set.c
M	nsd/sock.c
M	nsd/sockaddr.c
M	nsd/sockfile.c
M	nsd/tclcrypto.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclobjv.c
M	nsd/tcltime.c
M	nsd/tls.c
M	nsd/unix.c
M	nsd/url2file.c
M	nsd/urlspace.c
M	nsdb/dbinit.c
M	nslog/doc/mann/ns_accesslog.man
M	nslog/nslog.c
M	nsperm/doc/mann/nsperm.man
M	nsperm/nsperm.c
M	nsproxy/doc/mann/ns_proxy.man
M	nsproxy/nsproxylib.c
M	nssock/doc/mann/nssock.man
M	nssock/nssock.c
M	nsssl/doc/mann/nsssl.man
M	nsssl/nsssl.c
M	nsthread/thread.c
M	nsthread/winthread.c

commit 06bac6041c0b68601c4cbdd9ad971da98b20744d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-01

    we require at least Tcl 8.5

M	nsd/init.tcl

commit 88321819812d7690a5b6a59b13c73e3cad1e3c0f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-07-01

    add timings for rwlock writers, set write preference to avoid rwlock starvation (live locks)

M	nsd/returnresp.c
M	nsthread/rwlock.c

commit 91bc23bd82ed57463fa9e0106b4e3d025a92e7a1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-29

    remove debug line

M	tests/test.nscfg

commit 4033431278ceb621ae7a0c32a9dbd354ebc372c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-26

    use RWlocks for connchans

M	nsd/connchan.c
M	nsd/nsd.h
M	nsd/tclinit.c

commit de36696c331bb0fc8a57ae0736b9222d7c8f2044
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-26

    use RWlocks for urlspace

M	nsd/nsd.h
M	nsd/urlspace.c

commit 72d54cea389d0452d345d5f8a4b50d798313ee00
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-26

    generalize names to ease potential compile-time configuration

M	include/nsthread.h
M	nsd/tclvar.c

commit a617d67d715429934a7ca494c622a315c4fc9d42
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-26

    fix typo

M	nsd/queue.c

commit db9961de9f5474762991a27da281480a93dd8ce2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-22

    fix repeated word

M	win32-util/configure.tcl

commit 5c9ee714166a9c21c3b1634f1355276ac8ef7039
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-22

    bugfix: clear assignment of pools to sockPtr, when request info is cleared
    
    This bug was introduced about a week ago.

M	nsd/driver.c

commit ab5819360798fd63235d94a3e4b05b45079c894e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-22

    free dictObj when not needed as result

A	doc/src/naviserver/ns_hash.man
M	nsd/tclvar.c

commit 4a5eaf80090b38400dd16b1e468a1386b4885288
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-22

    write lock entry for pushed-back sockPtr entries (having already a pool assigned)

M	nsd/queue.c

commit 94ecbfce91057453ef932b753f6f9594470cdf60
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-22

    increase variable scopes

M	nsd/driver.c

commit 07cac909c599c1eed082cbaca030f38462504647
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    fix a few small memory leaks

M	nsd/driver.c

commit 8533a97ea55a2360a5e0de4deecf1a7d3201650b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    fix a few small memory leaks

M	nsd/tclinit.c

commit 02e0d86428bc5f9252b79437d4578c59f293d81e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    fix two small memory leaks

M	nsd/log.c
M	nsd/sockcallback.c

commit 55f8faa6117d09320cfc71779e31d6997497894f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    improve cleanness of compilation under Linux

M	nsd/returnresp.c

commit f3bdce1dd7795ea77c6fa9186b22e0da9173ed55
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    Avoid multiple library initializations for OpenSSL 1.1.0 or newer

M	nsd/tls.c

commit 4f47cccbb5f6b60340bed1a7f2ee297dffc459db
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    remove broken command

M	tests/all.tcl

commit cdd803a2c49f5899d2d70ec713dfdcbfdc517f5f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    remove warnings when compiling with OpenSSL 3.0 a4

M	nsd/tclcrypto.c

commit b2fabf37a20e8f93bc7dc4aee5d349ab170fe470
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    fix potential abortion of testruns under macOS
    
    Under macOS, tests runs were sometimes abruptly ended with a
    broken pipe signal. The call "NsBlockSignal(NS_SIGPIPE);" does
    not avoid these signals. So we ignore bluntly all such
    signals by using "NsBlockSignal(NS_SIGPIPE);"

M	nsd/nsmain.c

commit 8c1955531ecd772c7cefa562833f24eeb28621cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    tclcrypto: added comment for SCRYPT under OpenSSL 1.1.1:

M	nsd/tclcrypto.c

commit 0072469bedcd7a4640af9d9f215b1573504e385f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    Fixed bug for custom error pages (defined via redirect sections):
    - Always use GET in the redirection not the original HTTP method.
      When e.g. "PUT /somepage" is requested, where no PUT handler
      but a custom error page /405.tcl, the previous code tried a
      PUT /405.tcl, leading the same error. Now, the error
      page us delivered like with a GET request.
    - Provided a hint as a warning, where NaviServer searches
      for non-existing pages.
    - Extended regression test: cover HEAD requests for existing
      and non-existing pages, and various forms of redirects

M	nsd/adprequest.c
M	nsd/returnresp.c
M	tests/http.test
M	tests/test.nscfg
A	tests/testserver/vhosts/t/e/s/testvhost/pages/404.tcl
A	tests/testserver/vhosts/t/e/s/testvhost/pages/405.tcl

commit bd23b99711636b53ffdbcb352170cedd997dca18
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    reduce verbosity for regression test

M	tests/all.tcl

commit 1a553bc2dfec835b650bc8eae810748a3fb758c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    add hint about usefulness for custom error pages

M	doc/src/naviserver/returnstatus-cmds.man

commit 6b8324215b31c6fb7cb20a7066b3b9d0873c91cf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    reduce verbosity

M	Makefile

commit d355acd0250154d8eab14e93cb81dc96f02b5c6a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-21

    prefer all uppercase spelling for URL

M	nsd/progress.c

commit 50a13c785abdc507dc50b464b19eff659c3db834
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-15

    Fixed compilation with OpenSSL 3.0 Alpha 3
    
    A few calls were made deprecated, so there will be warnings.
    It will take some time to figure out how to keep compatibility
    with OpenSSL 1.* and its clones while introducing the new
    interface.

M	nsd/tclcrypto.c

commit 9c48894ae8e433aa4dfbe5473e9553f796ec24bd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-14

    windows 64-bit improvements:
    - fix thread exit result (e.g. ns_thread-2.2): the Windows function
      _endthreadex() returns just a 32bit usigned value. Since NaviServer
      relies of returning a pointer value, a mapping table
      (threadExitResults) was added, which requires as well an additional
      API call (Ns_ThreadResult()).
    
    - fix handle access (e.g. ns_thread-2-6): The thread handle for
      windows of the main thread (which is technically a closed handle)
      was set to 0, which was disallowed by the pointer types. The closed
      handle is now set to "-1" instead.
    
    - improve comments

M	include/nsthread.h
M	nsd/tclthread.c
M	nsthread/pthread.c
M	nsthread/thread.c
M	nsthread/thread.h
M	nsthread/winthread.c
M	tests/ns_thread.test

commit d43b541227b6778bd470694e4a9057b453d4f438
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-14

    fix typo

M	tests/http_persistent.test

commit 8e5408ad483c97f2119e01fa28c3b826610688a1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-14

    reduce verbosity, add /DEBUG flag

M	include/Makefile.win32

commit eae192179a849f906edaca5565c84f92dfa55f7b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-14

    fix typo

M	doc/src/naviserver/ns_info.man

commit 7d1137e7a1da0ddf14fb5aa9bc67065946969b7e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-14

    reduce verbosity, add ActiveTcl as potential Tcl implementation, add simple target for running one test

M	Makefile.win32

commit 56c86e7c0919896603e62132047052db83e05a9f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-09

    rwlocks for nsvs.
    
    This change introduces an optional usage of rwlocks for nsvars, which
    can be activated/deactivated at compile time via the macro
    USE_RWLOCK. rwlocks offer unblocked parallel execution for read
    operations. Since nsv are typically more often read than written
    rwlocks offer better scalability for large sites.
    
    The following table compares the busy locks with mutex operations vs
    the number of busy locks with rwlocks for openacs.org:
    
       With mutex (24h)
                                    locks   busy
       nsv:3:openacs.org    27      4.71M   1.3K
       nsv:6:openacs.org    24      4.88M   1.03K
       nsv:2:openacs.org    28      3.37M   784
       nsv:7:openacs.org    23      9.11M   755
       nsv:5:openacs.org    25      2.88M   460
    
       With rwlocks (after 24h)
       nsv:7:openacs.org    1       7.22M   0
       nsv:6:openacs.org    2       3.92M   143
       nsv:3:openacs.org    5       3.31M   1
       nsv:2:openacs.org    6       2.23M   16
       nsv:5:openacs.org    3       2.16M   0
    
    Since this based on a real-world site, there were different nsvs used
    more intensively in the compared days.  In the mutex case, we saw on
    the first day 4mio locks on nsv:3 and nsv:6 busy locks around 1k. On
    the day with rwlocks we see in the most cases busy locks drastically
    reduced (for some nsvs no busy locks at all). openacs.org is a low
    traffic site (~200K requests/day). The improvement on more busy sites
    will be more significant.
    
    I will do a more detailed performance evaluation, then we can decide,
    if we want to keep a compile-time switch, or a config variable, or a
    single mutex kind for nsvs.

M	nsd/tclvar.c

commit d9b41607d595904855ede29173e8523af84237c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-09

    add statistics about read and write operations to the result of "ns_info locks"

M	doc/src/naviserver/ns_info.man
M	nsthread/rwlock.c

commit db43e439965404ca0b6f218ee7566828ca06a453
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-08

    avoid warning: embedding a directive within macro arguments has undefined behavior (snprintf is defined as a macro on some platforms)

M	nsthread/rwlock.c

commit a21ddda4dff1d564c54daa9ba1de715ff35c7a17
Merge: 4e28b6f9 86fd0831
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2020-06-08

    Merged in apiskors/naviserver (pull request #7)
    
    Use TLS_OUT_OF_INDEXES in Nsthreads_LibInit().
    
    Approved-by: Gustaf Neumann <neumann@wu.ac.at>

commit 86fd0831b83e7ddec91fdbdd923e9f62b675d65f
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-06-08

    Fix Windows Ns_LogAccessDebug inconsistent dll linkage warning.

M	include/ns.h
M	nsd/driver.c

commit 04f1ab4cf461b4045ec85436dbceb5324d4a955f
Merge: 45c95075 4e28b6f9
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-06-08

    Merge in upstream changes.

commit 4e28b6f9391a40c635ab1bcb2f8ebff97a9d57bc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-06-08

    Fixed typo

M	nsthread/pthread.c

commit d4d8c096af32cfc92d001655b8b00e1f83e7c984
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-07

    use time_t for secs in Ns_Time

M	include/nsthread.h

commit 1d247440ef992e986cf4d934b2e73d8a4908d7fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-07

    use time_t for secs in Ns_Time, since long is just 32bit on 64bit windows, but time_t is 64 bits

M	nsd/config.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/exec.c
M	nsd/nswin32.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/str.c
M	nsd/tclcache.c
M	nsd/tcljob.c
M	nsd/tclsock.c
M	nsd/tcltime.c
M	nsdb/dbinit.c
M	nsproxy/nsproxylib.c
M	nssock/nssock.c
M	nsthread/rwlock.c
M	nsthread/time.c
M	nsthread/winthread.c

commit 638f39e4a906d40a8b7fe5f4190fc2993fe4880b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-07

    remove redundnat definition

M	include/ns.h

commit 45c950750f248b4fb06d4f7b5532549db06d0fab
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-06-06

    Use TLS_OUT_OF_INDEXES in Nsthreads_LibInit().
    
    The previous approach was to check for 0xFFFFFFFF, decimal 4294967295,
    the maximum value for a 32-bit DWORD.  Truly ancient versions of
    Windows (pre-XP?) might need that.  But in 2020-06 the values I see in
    the debugger for tlskey are always 64-bit.

M	nsthread/winthread.c

commit 373c924e2d834cf9110a3d3e8a20777e246dee52
Merge: 40d98ba4 e3cdb719
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2020-06-06

    Merged in apiskors/naviserver (pull request #6)
    
    Fix Windows build, use notWin32 constraint in tests.
    
    Approved-by: Gustaf Neumann <neumann@wu.ac.at>

commit 40d98ba45aec02ad01831efef109007338d7d0b0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-06

    fix broken test

M	tests/ns_nsv.test

commit a60c743e0225e4ef03bcf776214182e0c6e26c11
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-06

    add prototype, since file does not include nsthread.h

M	nsthread/rwlock.c

commit b7c31ef26e1d5d0ace9c2427b9958bd1e40eb407
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-06

    whitespce change

M	include/nsthread.h

commit e3cdb71932c9267406721824160d236a35a57e6d
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-06-05

    Use tcltest constraints to skip problematic Windows tests.

M	tests/ns_thread.test

commit ade45c394e410a27ae0ef4c508d313c6b3fea472
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-05

    make behavior of nsv_dict more orthogonal to the rest
    
    instead of providing the "-varname" option to exists, we provide
    it to "nsv_dict get". This makes it logically consistent
    with the optional last argument in "nsv_dict getdef" (similar to "nsv_get"
    or "ns_cache_get". We can't use the optional last argument here
    because of the var-args semantics of the mirrored tcl commands.

M	nsd/tclvar.c
M	tests/ns_nsv.test

commit a0a0409264ad79040701103e4d22f4a2d8176d62
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-05

    improve comments

M	nsd/tclmisc.c

commit 7c074959e967b63e5782f53b34e70d93e520d396
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-05

    add man page

M	doc/src/naviserver/nsv.man

commit 239b4edc265d06e9f6bb6f674e22428f9ab4b0eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-05

    add missing commands in command list

M	doc/src/naviserver/commandlist.man

commit 13598dd1784c469d7cdc2d9a112ba3eaa3ce59a0
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-06-05

    Use tcltest constraints to skip problematic Windows tests.

M	tests/all.tcl
M	tests/http_persistent.test
M	tests/ns_proxy.test

commit 1019abd1c9793518596e7745fee1c369332b3512
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-06-05

    Move ifdef to be only around nsconfig.h, not the whole pthread.c file.

M	nsthread/pthread.c

commit 7dc2ffff27b40b34edda6fb5b8c8185f551bc0b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-04

    document and extend nsv_dict

M	doc/src/naviserver/nsv.man
M	nsd/tclvar.c
M	tests/ns_nsv.test

commit aede5b75ca7342cf17c5b9eb866f1a7a8e75610a
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-06-04

    On Windows skip http_persistent.test and ns_proxy.test for now.

M	tests/all.tcl

commit 7e77ffe465b6b2c8adfdcd26b78d28b630c69101
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-06-04

    Create the tests/testserver/etc/server.pem file on Windows.

M	Makefile.win32

commit c1df1751b57fe558df63bda25ad0935ff78fe0c8
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-06-04

    Fix Windows build, recent 2020-06-01 changes broke it.

M	nsthread/pthread.c

commit 25dff9846e0060ead5e54a516d887b95cf5fc12b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-04

    return 0 for [nsv_dict exists ARRAY KEY value] when either ARRAY or KEY do not exist
    the "set" operation creates these on the fly

M	nsd/tclvar.c
M	tests/ns_nsv.test

commit 31d335a99e633ff22d840e7cb6b0729892b0b92c
Merge: 353c1c29 c8ac8c44
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-04

    Merge branch 'master' of https://bitbucket.org/naviserver/naviserver

commit 353c1c2946c6198aa90bb223c7cd48dfc4bba30f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-04

    make clear that we expect a non-null thread id.

M	nsd/tclthread.c

commit c8ac8c44e2807c25df37529af7b605f3d7b71aa0
Merge: 372ea50f 7d7e245f
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2020-06-04

    Merged in apiskors/naviserver (pull request #4)
    
    run regression tests from Windows Makefile.win32
    
    Approved-by: Gustaf Neumann <neumann@wu.ac.at>

commit 372ea50f207eb0a14b46aea77f9539921d888498
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-02

    fix and simplify logic of options

M	tcl/form.tcl

commit 657330573966d7466bc428cc9130699c59159694
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-02

    fix one more place for options

M	tcl/form.tcl

commit cc848e64260dd5ef65fee252773c4ca324fd27e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-02

    handle parse form file in case, no options are provided

M	tcl/form.tcl

commit 79e340fbd6db3219ef269769f0644e0af0d79a3e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-02

    reduce verbosity on sock accept errors (Linux)

M	nsd/driver.c

commit c48d9874ad66227e565680894c5455c33ebe546b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-01

    name rwlocks

M	nsd/tclinit.c
M	nsd/tclthread.c

commit afe75e728d2260093b184ba7697b08559c31a0a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-01

    Add PTHREAD to m4 directory to avoid necessity to install autoconf-archive package

M	configure.ac
A	m4/ax_pthread.m4

commit 324910329a6529e1dbfce448191efb014e600cf7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-01

    rwlock reform: base Ns_RWLock* interface on ptrhreads when available
    
    So for, Ns_RWLock* used an implementation based on mutexes and cond
    vars. This implementation has the advantage of being portable. However,
    since on all *nix platforms, NaviServer uses the pthread library,
    using the POSIX rwlock implementation poses no additional dependency.
    
    A quick test compares nsurlspace using mutex vs the classical
    rwlock implementation of NaviServer based on condvars and a variant
    using rwlocks from the pthread library.
    
            macOS (8 cores) rwlock (POSIX)  0.3105    2,27 %
                            rwlock (ns)     11.5263  84,23 %
                            mutex (ns)      13.6839 100,00 %
    
            Linux (6 cores) rwlock (POSIX)  0.6081   43,38 %
                            rwlock (ns)     3.6259  258,66 %
                            mutex (ns)      1.4018  100,00 %
    
    We see that POSIX rwlocks (pthread_rwlock_rdlock etc.)
    are always better than the classical naviserver rwlock
    implementation, and we see as well that significant
    improvements can be achieved by using rwlocks (at least
    in cases, where most operations are read operations).
    
    This change introduces:
    a) Ns_RWLock* based on pthreads when available
    b) switch to recommended configure setup for pthreads (AX_PTHREAD)
    c) New API call: Ns_RWLockSetName2() modeled after Ns_MutexSetName2()
    d) New API call: Ns_RWLockList() modeld after Ns_MutexList()
       (removed dependency of rwlocks to mutex statistics)

A	config.guess
A	config.sub
M	configure.ac
M	include/Makefile.global.in
M	include/nsconfig.h.in
M	include/nsthread.h
M	nsd/adpeval.c
M	nsd/info.c
M	nsperm/nsperm.c
M	nsthread/mutex.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	nsthread/rwlock.c
M	nsthread/winthread.c
M	tests/ns_server.test

commit a55e8ecdee07afe1d1a4540a62fc643d52208581
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-06-01

    added dropped requests (from queue overruns) to "ns_server stats"

M	doc/src/naviserver/ns_server.man
M	nsd/queue.c

commit 1a387ddff2108a2c12c4b48421c52a96edd3d843
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-31

    Improve liveliness under high load (improved handling of connection queue overrun)
    
    When NaviServer processes an HTTP request, it is received (head and
    body) and associated with a connection thread pool. If the thread pool
    has a thread free, the request is directly assigned to this
    thread. Otherwise, the request is added to a queue of the connection
    pool, waiting for a connection thread.  Since the queue has a limited
    size (limited by "maxconnections"), this queue might overrun. In this
    situation, the received request is added to a waiting list. Here is,
    where the behavior is now improved.
    
    1) previously, as soon as there were entries in the waiting list, no
       more fresh requests were accepted by the driver (just working on
       waiting requests). While this behavior is sensible if only one
       connection pool is available, it causes a blocking behavior in
       cases, when a single connection pool overruns but others could
       continue. Now, more fresh requests are still accepted in this
       situation.
    
    2) In addition, it is now possible to configure the overrun behavior
       via two pool parameters:
       a) pool parameter "rejectoverrun": when set to true, NaviServer sends on
          queue overruns an error "503 service unavailable". The overflowing
          request is not added to the waiting list.
       b) when (a) is set, it is possible to specify parameter "retryafter"
          with a seconds interval to add reply header field "Retry-After" to the
          503 response. (see https://tools.ietf.org/html/rfc7231#section-7.1.3)
    
    When "rejectoverrun" is false (default) then behavior is similar to
    before, accept the server does not fully block. The request is kept in
    the waiting list, which is checked, whenever a request finishes. For
    the client, there is no need to resubmit the request, which will be
    proceed eventually. Technically, this means an arbitrary large queue.
    
    When "rejectoverrun" is true, then the request causing the overrun is
    rejected, and will have to be resubmitted by the client (maybe
    automatically, when "Retry-After" is specified. However, the client
    support for "Retry-After" is rather bad.
    
    For large sites, "rejectoverrun" is probably the better behavior, since
    no background queuing in the waiting list is performed. For now, we
    keep the old behavior as default for better backwards compatibility.
    The default might change in the future.

M	doc/src/manual/admin-tuning.man
M	doc/src/naviserver/ns_server.man
M	include/ns.h
M	nsd-config.tcl
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit f2b45714435efa302d878f1aac8fac8879e2a45f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-29

    in case a queue is full, send a 503 error. The old code was blocking all queues,
    until a queue entry in the overflowed queue became available.

M	nsd/driver.c

commit 7d7e245f8451419de3ac9b1d6202e5f26c883fdd
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-05-26

    Build nsdbtest.  Add _test target.

M	Makefile.win32

commit d26b8a23a971d5d17cef8ea9510834f2410bb55b
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-05-26

    Also install tests.

M	win32-util/install-nsd.tcl

commit 665b3ca22073835dc64ce1a6d2294249854feca1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-26

    add debug log entry when adp request handler accesses a file

M	nsd/adprequest.c

commit 2c6fcbc98832f5e8c0217eaf2749800403595ead
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-25

    added commands "ns_set keys /setId/ ?pattern?" and "ns_set values /setId/ ?pattern?"
    
    These commands are similar to the Tcl command "dict keys" and "dict values"
    and can reduce the necessity for loops.

M	doc/src/naviserver/ns_set.man
M	nsd/tclset.c
M	tests/ns_set.test

commit 8cb6c67042a4cefd45ecedf8aa6f59442ab95b34
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-24

    Added support for nsv dict values:
    
    - The new command "nsv_dict" provides thread-safe support for
      setting, getting, updating, and unsetting dict values in nsv array.
    
      Motivation: Some larger OpenACS installations have currently more
      than 1 mio (!) nsv arrays, which comes mostly from creating nsv
      arrays per packages. Most of these arrays have only a few keys
      with very short values. The number of arrays can be greatly reduced
      by supporting complex values (dictionaries), similar to REDIS
      hash values.
    
    - nsv_dict supports nested dicts like in Tcl
    
    - The following dict commands (subset of Tcl 8.7) are now
      available for nsv_arrays:
    
        nsv_dict append  array key dictkey dictvalue:0..n
        nsv_dict exists  array key dictkey:1..n
        nsv_dict get     array key dictkey:0..n
        nsv_dict getdef  array key dictkey:0..n default
        nsv_dict incr    array key dictkey ?increment?
        nsv_dict keys    array key ?pattern?
        nsv_dict lappend array key dictkey dictvalue:0..n
        nsv_dict set     array key dictkey:1..n dictvalue
        nsv_dict size    array key
        nsv_dict unset   array key dictkey:1..n
    
    - added 41 test cases for nsv_dict
    - TODO: documentation, maybe additional thread-safe test/set operations.

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclvar.c
M	tests/ns_nsv.test

commit 85648e7ec9b130c26e436831e0a5d0ce1cdad78a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-24

    added cleanup code

M	tests/ns_base64.test

commit bf2cd1dcd5257f1b89a902d32fefdd33765f4bca
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-05-22

    Also build nsproxy.

M	Makefile.win32

commit e767226c62040b7326e8508d723497cd01b11ea8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-19

    make parsing of content type more robust

M	tcl/form.tcl

commit a744a7d71a49835717f2cf86deefedef3a787fb8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-19

    allow charset to be specified for spooled requests that are processed by ns_parseformfile
    extend regression test

M	tcl/form.tcl
M	tests/http.test

commit bc98803e99cffe839d3cdb0639d644226c231c36
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-17

    improve spelling

M	doc/src/naviserver/ns_shutdown.man
M	nsd/driver.c
M	nsd/sched.c
M	nsd/task.c
M	nsd/tclimg.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsdbtest/nsdbtest.c
M	nslog/doc/mann/ns_accesslog.man

commit c764df49bf4bf61f941294ff34c1da2a513a6c77
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-16

    handle more cases of invalid chunked data, extend regression test

M	nsd/driver.c
M	tests/http_chunked.test

commit 7edd29567185baaada3a92caa803886a6bbea290
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-16

    remove minor race condition

M	nsd/queue.c

commit 8182d38be1bd725b3a1d0caee18b657b9c4de99b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-16

    remove renamed files

D	util/fake-configure.tcl
D	util/win32-install-nsd.tcl

commit 4667bbb45fec9f8ac662ee37df4ec3bd7681b13b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-16

    let windows decide, what version of localtime should be used (variant depends on _USE_32BIT_TIME_T)

M	nsthread/reentrant.c

commit a32061006cc77ca6a937bff639b804e74a982900
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-16

    name windows configuration utilities win32-util

M	Makefile.win32
A	win32-util/configure.tcl
A	win32-util/install-nsd.tcl

commit 44ab3b25b1b09a806f5e0d44c47554559b3d521c
Merge: a5c3079f a02989dc
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2020-05-16

    Merged in apiskors/naviserver (pull request #3)
    
    Many Windows build improvements, especially for nsssl and nsoracle.
    
    Approved-by: Gustaf Neumann <neumann@wu.ac.at>

commit a5c3079f1d8996d5f34c9384a440acf3519ca3bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-16

    fix for bug https://sourceforge.net/p/naviserver/bugs/89/
    
    A negative value provided as chunk encoding length led to a potential crash.
    A test case for this case was added to the regression test.

M	nsd/driver.c
M	tests/http_chunked.test

commit 8fdde976a0e96b257a7f1ba87de1a493c0ecb3d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-15

    fixed race condition in leftover management

M	nsd/queue.c

commit 69047be7367bf553620c790a3dd4e7639d61a571
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-05-15

    Fixed race during [ns_http wait -timeout] processing.

M	nsd/task.c
M	nsd/tclhttp.c

commit dfd443f5bae12f9e03635f4cfa8115f8a04b57f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-14

    address one more race condition

M	nsd/driver.c
M	nsd/queue.c

commit 0d7f86416a2414d1644d1d6c75a8bc8bffd4bec3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-14

    fix duplicate test name

M	tests/http.test

commit f3047bbca2528ba40d563b133b4305572cca4e9a
Merge: 1c218990 b4d2f5fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-14

    Merge branch 'master' of https://bitbucket.org/naviserver/naviserver

commit b4d2f5fb9972416c687824c737480065c4047e76
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-05-14

    Removed traces of doneCallback processing during list/cleanup/stat
    as tasks posted with doneCallback option cannot be addressed.
    (have no taskID assigned).

M	nsd/tclhttp.c

commit 6dee5261be6ad587239a95e1707be8e64e0688fb
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-05-14

    Set task flags as unsigned constants to avoid compiler complaints.

M	nsd/task.c

commit b6e18e74bc9c2074f4fb31202b26db14fbde55be
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-05-14

    Added simplified Tcl-version of [lmap] for Tcl 8.5

M	tcl/form.tcl

commit 1c21899089bcb1a6f57047b43243d86ecec44485
Merge: 8750e6a9 11e31fd4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-14

    Merge branch 'master' of https://bitbucket.org/naviserver/naviserver

commit 11e31fd484fe4d127bf80ac7128a445f087ebee9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-05-14

    Removed debug flag.

M	tests/http.test

commit 2572b7250eaa6e6d044199578d74f0a5169ea2cc
Merge: 0c8235ed fd0f78a8
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-05-14

    Merge branch 'master' of https://bitbucket.org/naviserver/naviserver

commit 0c8235ed66e840bcf8c834022606e195ee55c8ed
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-05-14

    Fixed odd race conditions in task management caused by
    non-honoured spurious condvar wake-ups.
    Also... unify debug log messages.

M	nsd/task.c
M	nsd/tclhttp.c
M	tests/http.test

commit 8750e6a9f10180329ba192e04bfbc76c08af31a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-13

    fix sorting order

M	nsd/mimetypes.c

commit fd0f78a8db665000726a971c5d7b75d33cdff0bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-13

    add mime types heif and heic which has become a preferred image type for iOS and macOS
    
    https://www.iana.org/assignments/media-types/media-types.xhtml
    https://www.iana.org/assignments/media-types/image/heic

M	nsd/mimetypes.c

commit c447fbad7897a333d495306431e9cabf1e70ccad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-09

    add sanitation flags

M	include/Makefile.global.in

commit 908a6008520a52a23e37358bafaa9bf8c6cef523
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-09

    remove dead initialization

M	nsd/sock.c

commit 709707dc0a717730f5c1b1d3efb07240e00fb0d4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-09

    improve variable initializations

M	nsd/log.c

commit 0afb503048e7ed975a63eb1884a7fe245285d2b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-09

    reduce variable scopes

M	nsd/limits.c

commit 04c5ab1008d5fd3ff6c33cb0a9f5f35b17e87cfa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-09

    make sure that address of variable on stack is not used after stack frame is closed

M	nsd/connio.c

commit d1eccc0dc63182a39df97c697a4f22f5665f3f57
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-09

    fix potential race condition

M	nsd/tclhttp.c

commit 037bd609244c0ab5747f4783caa38780b0bc8439
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-09

    make sure, memory units are always Tcl_WideInts

M	nsd/config.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/tclhttp.c

commit f2de97c4f7f59b63b301904b4096a2b862b63de9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-08

    add fortify to tidy flags

M	include/Makefile.global.in

commit 9fa2c6506ec80264ce4c47f426d902693a7cfa7a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-08

    minor improvement for entity parsing (no need to iterate charwise)

M	nsd/tclmisc.c

commit 3647e06c14e901123b0444666682ad6594ce135d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-08

    minor cleanup for type-cleanness (checked with gcc10)

M	nsd/driver.c
M	nsdb/dbtcl.c

commit ab7fdc32a5fc5b54074b8a9cf80092861312470b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-08

    Added support for "100 CONTINUE"
    
    This feature is in HTTP since a very long time, but not widely supported
    although useful (best support is currently in curl). When the client
    sends "Expect: 100-continue", the server can check the header fields and
    provide an early feedback, whether it is useful to transmit the full
    body. This way, e.g. content which is too large can be rejected quickly.

M	include/ns.h
M	nsd/driver.c
M	tests/http.test

commit 6edbb780ae51b870dfae264bbdf54a0d4aeaf234
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-08

    improve wording in comment

M	nslog/nslog.c

commit bdc47999643459f339babce8417f5d3413e97fbd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-08

    whitespace changes

M	nscgi/doc/mann/nscgi.man
M	nscp/doc/mann/nscp.man
M	nsdb/doc/mann/ns_db.man
M	nsdb/doc/mann/ns_dbquotevalue.man
M	nslog/doc/mann/ns_accesslog.man
M	nsperm/doc/mann/ns_perm.man
M	nsperm/doc/mann/nsperm.man
M	nsproxy/doc/mann/ns_proxy.man
M	nssock/doc/mann/nssock.man
M	nsssl/doc/mann/nsssl.man

commit f4fbb9a903df538016d5d4ca36222c09bfdf09fa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-08

    whitespace changes

M	doc/src/manual/tcl-libraries.man
M	doc/src/naviserver/ns_chan.man
M	doc/src/naviserver/ns_findset.man
M	doc/src/naviserver/ns_imgmime.man

commit 8f8df2000684bb468a9fc2a6834977a136cf6f29
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-07

    whitespace changes
    
    make all examples starting with a single whitespace. This has the following benefits
    - indentation etc. can be done via CSS
    - still some optical separation
    - also empty lines require a single space, otherwise these are swallowed by the Tcl formatter

M	doc/src/man3/Ns_Sls.man
M	doc/src/manual/admin-db.man
M	doc/src/manual/admin-install.man
M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/admin-tuning.man
M	doc/src/manual/adp-overview.man
M	doc/src/manual/c-driverdb.man
M	doc/src/manual/c-urlspace.man
M	doc/src/manual/main-standards.man
M	doc/src/manual/tcl-lib-nstrace.man
M	doc/src/manual/tcl-libraries.man
M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/keyl.man
M	doc/src/naviserver/ns_absoluteurl.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_adp_abort.man
M	doc/src/naviserver/ns_adp_argc.man
M	doc/src/naviserver/ns_adp_argv.man
M	doc/src/naviserver/ns_adp_bind_args.man
M	doc/src/naviserver/ns_adp_break.man
M	doc/src/naviserver/ns_adp_ctl.man
M	doc/src/naviserver/ns_adp_dump.man
M	doc/src/naviserver/ns_adp_include.man
M	doc/src/naviserver/ns_adp_info.man
M	doc/src/naviserver/ns_adp_mimetype.man
M	doc/src/naviserver/ns_adp_parse.man
M	doc/src/naviserver/ns_adp_register.man
M	doc/src/naviserver/ns_adp_stats.man
M	doc/src/naviserver/ns_atsignal.man
M	doc/src/naviserver/ns_base64.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_chan.man
M	doc/src/naviserver/ns_charsets.man
M	doc/src/naviserver/ns_choosecharset.man
M	doc/src/naviserver/ns_config.man
M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_cookie.man
M	doc/src/naviserver/ns_cookiecharset.man
M	doc/src/naviserver/ns_critsec.man
M	doc/src/naviserver/ns_crypt.man
M	doc/src/naviserver/ns_crypto.man
M	doc/src/naviserver/ns_driver.man
M	doc/src/naviserver/ns_encodingforcharset.man
M	doc/src/naviserver/ns_env.man
M	doc/src/naviserver/ns_filestat.man
M	doc/src/naviserver/ns_findset.man
M	doc/src/naviserver/ns_fmttime.man
M	doc/src/naviserver/ns_formfieldcharset.man
M	doc/src/naviserver/ns_getformfile.man
M	doc/src/naviserver/ns_gifsize.man
M	doc/src/naviserver/ns_gmtime.man
M	doc/src/naviserver/ns_guesstype.man
M	doc/src/naviserver/ns_hashpath.man
M	doc/src/naviserver/ns_hmac.man
M	doc/src/naviserver/ns_hotp.man
M	doc/src/naviserver/ns_hrefs.man
M	doc/src/naviserver/ns_htmlselect.man
M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_ictl.man
M	doc/src/naviserver/ns_imgmime.man
M	doc/src/naviserver/ns_imgsize.man
M	doc/src/naviserver/ns_imgtype.man
M	doc/src/naviserver/ns_internalredirect.man
M	doc/src/naviserver/ns_issmallint.man
M	doc/src/naviserver/ns_job.man
M	doc/src/naviserver/ns_jpegsize.man
M	doc/src/naviserver/ns_library.man
M	doc/src/naviserver/ns_localtime.man
M	doc/src/naviserver/ns_locationproc.man
M	doc/src/naviserver/ns_log.man
M	doc/src/naviserver/ns_md.man
M	doc/src/naviserver/ns_md5.man
M	doc/src/naviserver/ns_memoize.man
M	doc/src/naviserver/ns_mktemp.man
M	doc/src/naviserver/ns_modulepath.man
M	doc/src/naviserver/ns_mutex.man
M	doc/src/naviserver/ns_pagepath.man
M	doc/src/naviserver/ns_paren.man
M	doc/src/naviserver/ns_parseargs.man
M	doc/src/naviserver/ns_parsefieldvalue.man
M	doc/src/naviserver/ns_parsequery.man
M	doc/src/naviserver/ns_parsetime.man
M	doc/src/naviserver/ns_parseurl.man
M	doc/src/naviserver/ns_pngsize.man
M	doc/src/naviserver/ns_queryexists.man
M	doc/src/naviserver/ns_queryget.man
M	doc/src/naviserver/ns_quotehtml.man
M	doc/src/naviserver/ns_rand.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/ns_runonce.man
M	doc/src/naviserver/ns_rwlock.man
M	doc/src/naviserver/ns_schedule.man
M	doc/src/naviserver/ns_sema.man
M	doc/src/naviserver/ns_sendmail.man
M	doc/src/naviserver/ns_server.man
M	doc/src/naviserver/ns_serverpath.man
M	doc/src/naviserver/ns_serverrootproc.man
M	doc/src/naviserver/ns_set.man
M	doc/src/naviserver/ns_setformencoding.man
M	doc/src/naviserver/ns_setprivileges.man
M	doc/src/naviserver/ns_sha1.man
M	doc/src/naviserver/ns_sleep.man
M	doc/src/naviserver/ns_sls.man
M	doc/src/naviserver/ns_sockaccept.man
M	doc/src/naviserver/ns_sockcallback.man
M	doc/src/naviserver/ns_sockopen.man
M	doc/src/naviserver/ns_sockselect.man
M	doc/src/naviserver/ns_striphtml.man
M	doc/src/naviserver/ns_symlink.man
M	doc/src/naviserver/ns_tagelement.man
M	doc/src/naviserver/ns_time.man
M	doc/src/naviserver/ns_totp.man
M	doc/src/naviserver/ns_upload_stats.man
M	doc/src/naviserver/ns_url2file.man
M	doc/src/naviserver/ns_urlcharset.man
M	doc/src/naviserver/ns_uudecode.man
M	doc/src/naviserver/ns_uuencode.man
M	doc/src/naviserver/ns_write.man
M	doc/src/naviserver/ns_writecontent.man
M	doc/src/naviserver/ns_writer.man
M	doc/src/naviserver/nsv.man
M	doc/src/naviserver/returnstatus-cmds.man
M	doc/src/template.man

commit abf58a47a93eff46df18e859434bf83e1a3ecfa1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-07

    improve spelling, whitespace changes

M	doc/src/naviserver/ns_asynclogfile.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_schedule.man

commit a02989dce5347325608c9e9fc37388ee57d23a68
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-05-05

    On Windows use new fake-configure.tcl to generate nsversion-win32.h.

M	.gitignore
M	Makefile.win32
M	include/ns.h
A	util/fake-configure.tcl

commit be0a5ae64024003905f7629083e6d07b18faf6d5
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-05-05

    On Windows use new win32-install-nsd.tcl script.

M	Makefile.win32
A	util/win32-install-nsd.tcl

commit 55184fccc3ceab31d66088ba7330cbe1bc950773
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-05-05

    Move Unix-specific stuff out of nsssl Makefile.common into Makefile.

M	nsssl/Makefile
M	nsssl/Makefile.common
M	nsssl/Makefile.win32

commit 6d8ef6fd57d849dc07894f6da85e4b36cf39a329
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-05-05

    Fix Windows nsssl linking.

M	include/Makefile.win32
M	nsssl/nsssl.c

commit c3f467d7e464e6ffb4fff67529588aacb29d5c90
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-05-04

    Automatically choose between make/Unix and nmake/Windows in Makefile.build.
    Update human instructions to match.

M	Makefile.win32
M	include/Makefile.build

commit 2b00c26b2f7ed1dde24b5eff0828104b8cdc42c5
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-05-02

    On Windows nsdb must export its Ns_LogSqlDebug global variable so
    database drivers like nsoracle can see it.

M	include/Makefile.win32

commit 692bffa96af7c2e55d1cd0d87010c918f9b3be3f
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-05-02

    Add ability to build non-core Windows modules, like nsoracle.
    Also some general cleanup of Windows nmake build system.

M	Makefile.win32
M	include/Makefile.win32

commit 1a89c174d5adf60eadb29a7eb70b6456a32f38b9
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-05-01

    Turn on Windows OpenSSL support by default.

M	include/Makefile.win32
A	include/nsconfig-win32.h
M	nsd/nsd.h

commit 54bbe213a44f0557d9ab8eb5e5b26b95fc657414
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    - changed "schedmaxelapsed" to "schedlogminduration" for consistency
      We have now the same naming convention for nsproxy, ns_jobs,
      scheduled procedures and SQL commands for logging slow commands.
    - added a sample configure section to ns_sched man page.

M	doc/src/naviserver/ns_schedule.man
M	nsd-config.tcl
M	nsd/nsconf.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit cb658fc90e4216ea97b1b0ca7217fab95e3e216f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    add a configuration section for the nxproxy module

M	nsproxy/doc/mann/ns_proxy.man

commit da8285d55a9b7934adb8a9e11e1fb40a2fec42d9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    new option to ns_jobs: logminduration
    
    Specifies a time-limit for logging (long) ns_job operations to the system
    log (similar to "logminduration" in the db drivers or nsproxy). Set it to a high
    value to avoid logging (e.g. 1d). The default is 1s.

M	doc/src/naviserver/ns_job.man
M	nsd-config.tcl
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/tcljob.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit fb5e819938355180f99a30514ce97987ad2f38e6
Merge: 1ee7256c 411f8a67
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    Merge branch 'master' of https://bitbucket.org/naviserver/naviserver

commit 411f8a67b3882be725bea54a39721d5bce19e848
Merge: a5e2f798 65bcc824
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2020-05-03

    Merged in apiskors/naviserver (pull request #2)
    
    easy fixes for newer Windows compilers
    
    Approved-by: Gustaf Neumann <neumann@wu.ac.at>

commit 1ee7256c8a7296903d95a1e551056623b524de3d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    add explicit falthough statements

M	nsproxy/nsproxylib.c

commit 3619bb1cdfb37fe9d2814813cfdd954c5ef945ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    new option to nsproxy: logminduration
    
    Specifies a time-limit for logging (long) eval operations to the system
    log (similar to "logminduration" in the db drivers). Set it to a high
    value to avoid logging (e.g. 1d). The default is 1s.

M	nsproxy/doc/mann/ns_proxy.man
M	nsproxy/nsproxylib.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit 31e03bbefd38568b713239a96539670b92120371
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    order options of "ns_proxy configure" alphabetically

M	nsproxy/doc/mann/ns_proxy.man

commit 7aa2b27b63939c3743797d2a0da5d821a8a348bd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    minor documentation updates

M	doc/src/naviserver/ns_shutdown.man
M	nsd-config.tcl
M	nsd/server.c
M	nsd/tcljob.c
M	nsproxy/doc/mann/ns_proxy.man
M	nssock/doc/mann/nssock.man
M	openacs-config.tcl

commit 156a13f504bb268fa23fc7a66d8897589a044982
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    Minor spelling improvements

M	nsd/driver.c
M	nsssl/nsssl.c

commit e1856e8fa3f2696e8db10106166a99da368b716e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    allow time units for configuring "MaxIdle" and "MaxOpen"

M	nsdb/dbinit.c
M	nsdb/doc/mann/ns_db.man

commit 13b5ad045f115c6d698ee1bf025ccc7aeaef4b75
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    improve source code documentation

M	nsd/tcltime.c

commit 29fc6f985e76b793bfa1890b2177fcf708a3d156
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    various man page improvements (removed obsolete section, broken typesetting, missing references)

M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_parsequery.man
M	doc/src/naviserver/ns_set.man
M	doc/src/naviserver/ns_urlencode.man

commit 4665584e32d274b20f65fb6748ccd8ef0ca822b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    Mark ns_adp_mime explicitly as deprecated, and provide deprecated messages for it
    
    The command was deprecated more than 10 years ago, ns_adp_mimetype should be used

D	doc/src/naviserver/ns_adp_mime.man
M	doc/src/naviserver/ns_adp_mimetype.man
M	nsd/tclcmds.c
M	tcl/compat.tcl

commit ce7dd8cd6add28dcb3f849c651bed816a7d0296d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-03

    make man pages more eye-friendly

M	doc/src/man.css

commit 2e70328bfaedd1b45236e3656325e66c6adea5db
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-02

    new command "ns_dbquotelist": similar to "ns_dbquotevalue", but for Tcl lists

M	doc/src/naviserver/commandlist.man
M	nsdb/dbtcl.c
M	nsdb/doc/mann/ns_dbquotevalue.man
M	tests/nsdb.test

commit 7f1c5915f5803fd761552843ec5fc6a3c29fdff1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-02

    move log statement out of mutexed block

M	nsd/driver.c

commit f80b7aca3c760f88ca319553092edadbe2a7b284
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-05-02

    Don't swallow errors in braced config sections

M	nsd/config.c

commit 65bcc824668a285981666c7efe4767feeb709b10
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-04-30

    Support MS 2019 compilers with VSCMD_ARG_TGT_ARCH.

M	Makefile.win32
M	include/Makefile.win32

commit 8a88547ec00ec46fed0b89419792cd31588e0c7e
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-04-30

    Use native round() from math.h with newer Microsoft compilers that include it.

M	nsd/tcltime.c

commit 0ec5cc70490f1e6566a6c26e5e51107edcb9a6a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-18

    order commands alphabetically

M	nsdb/dbtcl.c

commit a5e2f798ee7e42ae0bcd0b7b6d22fc2ef13aed71
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-18

    provided a C implementation for "ns_dbquotevalue"

M	nsdb/dbtcl.c
M	nsdb/util.tcl
M	tests/nsdb.test

commit 877add7ff23c9caae6ed56ac6c6385a74eacaa12
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-16

    fix a problem e.g. in PUT, when file is query-parameters are passed in addition to the put content.
    Previously, these parameters were only available via [ns_queryget ...] when the content
    file was not spooled.

M	tcl/form.tcl

commit dabb7f3520c19d1fc4d5485488da59442c873e96
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-16

    report to log file, when traces are not executed

M	nsd/queue.c

commit 4e2a4b460388455f9affd0c5356b0a1e690c9b0c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-13

    prefer "ns_sleep" over "after"

M	tests/ns_cache.test
M	tests/ns_proxy.test
M	tests/ns_register_filter.test
M	tests/ns_schedule.test

commit 9f3de28629740e3ebb886c1ace3800a4ad8f59cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-13

    ns_cache: base cache size calculation on the full size of a cache entry.
    
    In previous versions, the cache size calculation was based only on the
    value size, leaving the size of the key and the size of the overhead
    (size of cache entry, about 126 bytes on a 64bit machine) aside. This
    can lead to misleading interpretations, when the cache size is 0 bytes
    (just using the cache key as a flag), leaving admins wondering about
    the memory consumption.

M	doc/src/naviserver/ns_cache.man
M	nsd/cache.c
M	nsd/tclcache.c
M	tests/ns_cache.test

commit 5c54db3388a40a49f8fb80641156bcbb2c6feec7
Merge: d589a4fb ba21fe20
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2020-04-12

    Merged in apiskors/naviserver (pull request #1)
    
    Fix Windows build breakage due to 2020-01-24 Ns_Time reform.
    
    Approved-by: Gustaf Neumann <neumann@wu.ac.at>

commit ba21fe200039aaa20d33b1a749e313454ed61625
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-04-08

    Windows math.h does not include round(), add simple implementation.

M	nsd/tcltime.c

commit e0f2b0728510163ec94513fe4d3466f79e9bb344
Author: Andrew Piskorski <Andrew Piskorski atp@piskorski.com>
Date:   2020-04-08

    To fix Windows link errors, move Ns_TimeToMilliseconds() into
    nsthread/time.c, out of nsd/tcltime.c.

M	include/nsthread.h
M	nsd/tcltime.c
M	nsthread/time.c

commit d589a4fb900b28a88bc884da5414eb13e5153cdb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-11

    fix for issue #88 (at sourceforge): continue to accept "ns_schedule_proc -once 0 ..."
    but reject repeated procs with time interval 0s "ns_schedule_proc 0 ..."

M	nsd/tclsched.c
M	tests/ns_schedule.test

commit 909e200ea7a4a5fd1c5b2bc6c6d307cc07f3d837
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-08

    added the new ns_conn subcommand to the output in the base regression test

M	tests/ns_conn.test

commit 1fa1e1d58a4ce7ea35fcb3fef04ed532cdc5f41c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-08

    add documentation for "ns_conn headerlength"

M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_getformfile.man

commit 0969d61e594d1e84a8bfac8bf20d8ac2a17b1057
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-08

    ns_conn: added "headerlength" as an additional subcommand

M	nsd/conn.c

commit 56492e5643367c57a2ea76128ea8b1d86e1be999
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-05

    add debug entries to 404 returns

M	nsd/fastpath.c

commit d5a4faaf07dc54e12afbac8e40b1c36575c64f62
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-05

    change version number to 4.99.20a

M	configure.ac

commit 00dfedfa65d813ec925379a7066be9f05bf41b66
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-05

    handle cases, where a driver does not define a keepProc

M	nsd/driver.c

commit aaab6e9044b982c8fefcc00a4a578c5689e27e2b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-03

    added comment

M	nsd/queue.c

commit 7860c1bda419cf8a14769798ea80cedf2772d427
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-03

    improve comments and minor cleanup

M	nsd/tclenv.c
M	nsssl/nsssl.c

commit 91ca547e93bd5631b11fa819d0a9894cc12f8cce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-03

    removed redundant test

M	nsd/tclobjv.c

commit 656f74a8e2e0f80d32d3611f61f0f6b283b577d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-04-03

    use consistently the variable name "fileName" for filenames

M	include/ns.h
M	nsd/adprequest.c

commit d1c8de59f417b833ff1a8b3b61bf1aea63ac5a94
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-03-14

    New log severity "Debug(timeout)" to force NaviServer to write an entry to the
    systemlog, whenever a timeout occurs. Therefore, the command
    
        ns_logctl severity Debug(timeout) on
    
    can be used to debug cases, where NaviServer runs into HTTP status code 503
    (Service Unavailable).

M	nsd/adprequest.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sock.c
M	nsd/tclcache.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclrequest.c

commit 0535dffe8c6af07e26a187dcd70aaffa489148f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-03-11

    let "ns_getformfile" return a list of filenames when "multiple" attribute is provided in the input field and multiple files are submitted

M	doc/src/naviserver/ns_getformfile.man
M	tcl/form.tcl

commit 2c7c93ee28a36eb146b86cf693ce6118b722d4a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-03-11

    rework bitbucket-install.tcl
    - switch download URL from mercurial to git
    - terminate script after "ns_return"
    - reduce external dependencies by using ns_http instead of wget
    - added editor hints and replaced tabs by spaces

M	bitbucket-install.tcl

commit 7179042ec1e624fb57002fbe609a67eb407dfe46
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-03-11

    improve spelling

M	nsd/dns.c
M	nsd/exec.c
M	nsd/tclcrypto.c
M	nsd/tclxkeylist.c
M	nsssl/nsssl.c
M	tcl/ns_crypto.tcl

commit 04c5775b59ffc84de8f64cc7ba42f200ff30b1a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-03-11

    Provide a warning, when an NsTclRequestProc or an ADP request runs into a timeout

M	nsd/adprequest.c
M	nsd/tclrequest.c

commit 8712aadc4a2ad992f037c208544ed6373fb57d97
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-03-11

    improve comment

M	nsd/tclresp.c

commit 0c9ad59d91d48bf6f214b081bdfec94291fc2cdd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-03-03

    reuse macro from nsopenssl.h

M	nsd/tclcrypto.c

commit 2a0ba5e86c4cc00fdd843057d71365e9381cb205
Merge: 762207ab c11bf19b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-03-03

    Merge branch 'master' of https://bitbucket.org/naviserver/naviserver

commit 762207abdfdd25d35d606813e02dc4dcdc11f0c8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-03-03

    improve compatibility with various versions of LibreSSL

M	include/nsconfig.h.in
M	m4/openssl.m4
M	nsd/tclcrypto.c
M	nsssl/nsssl.c

commit c11bf19b9f80987c334a0c5cd811989a3ad4264f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-03-02

    Fixed Ns_SockAccept() to save errno from being ditched by Ns_Log.

M	nsd/sock.c

commit be6604c7b338a0d93cb83b1c1c148ca6503f21af
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-29

    add hint about required OpenSSL version to man pages

M	nsssl/doc/mann/nsssl.man

commit 4ae584fcabbf92d35ab8d78ae20b5f9bbe6984bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-29

    don't try to compile OCSP when OpenSSL version is before 1.1.0

M	nsssl/nsssl.c

commit 35cd440e0393a0eec4b79af62b91d9dbadf8ac08
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-29

    Adopt code to deal with a change in the OpenSSL_1_1_1-stable branch
    
    Starting with the commit in OpenSSL 1.1.1 branch OpenSSL_1_1_1-stable
    below, at least https client requests answered without an explicit
    content length start to fail. This can be tested with:
    
           ns_logctl severity Debug(task) on
           ns_http run https://www.google.com/
    
    This fix just triggers for exactly this condition (handling reason
    code SSL_R_UNEXPECTED_EOF_WHILE_READING) to provide a graceful end for
    these requests (handling this as end-of-data like before).

M	nsd/tls.c

commit c1ddb009d87d3652f0513d6d77c3cff9fcbe419d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-29

    ease modification of OPENSSL_LIBS in Makefile.global (don't resolve 2nd occurrence during configure)

M	include/Makefile.global.in

commit 6016f7d9bf49cfd5d0a27038049dce4e13162cbe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-29

    Fixed issue noted by Maksym Zinchenko on the naviserver developer list
    
    A recent change of tDOM 0.9.2 introduced a namespace local command
    "namespace" which was picked up by the blueprint generator incorrectly
    instead of the global ::namespace command.  As a fix, all "namespace"
    invocations in the blueprint generator were replaced by "::namespace"
    to avoid considering invocation context for every occurrence.

M	tcl/nstrace.tcl

commit 671a9fd15642c9ddc2e22bcf7e8521344fbde5d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-26

    - Make sure, ns_localtime() is always called with a pointer to a
      time_t value
    - Aligned argument names of ns_ctime(), ns_gmtime() and ns_localtime()
      with the name in Linux man pages.

M	include/nsthread.h
M	nsd/sched.c
M	nsthread/reentrant.c

commit e4d5f854662b6fcab12df87866c8f1886177176c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-26

    implemented nsv_append similar as nsv_lappend ty increase syymetry
    
    The performance gain is much less than with nsv_lappend
    (see previous commit), but still noticeable (about 35% faster,
    10K ns_append operations went from 0.94 microseconds to 0.62

M	nsd/tclvar.c

commit 41dcc5de961d074a9e48b8fe9729e1e616c5c213
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-26

    fix typo

M	nsssl/doc/mann/nsssl.man

commit e96f4be3dac10720c403383dd84bf3f5b61ef39c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-25

    Improved performance of nsv_lappend significantly
    
    The old implementation showed a linear slowdown for
    nsv_lappend operations depending on the number of
    elements in the list. The new implementation
    avoids frequent string to list and vice versa
    operations by using Tcl_DStrings. It is essentially
    independent on the number of elements in the nsv.
    For a list with 10K elements, the performance
    improvement is about a factor of 400.
    
    Test:
       nsv_set d 1 1
       time {nsv_lappend d 1 1} 10000
    
    OLD:
       403.7255 microseconds per iteration
    
    NEW:
       0.860547 microseconds per iteration

M	nsd/tclvar.c

commit c204be39e1ffb87c1e368335dfe0750c1cea9bb3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-24

    Implemented OCSP Stapling for NaviServer.
    
    still todo: configure verbsosity, duration of validity
    
    NaviServer performs two level of caching: in-memory caching and disk caching. When the server receives the first TLS request with OCSP stapling turned on, it checks for an already retrieved OCSP response. The disk cache file is saved in the "log" directory of the server and uses the serial number of the certificate to be checked as filename with ".der" as extension. When the disk cache file does not exist, an http/https request is made to the server issuing the servers certificate as defined by the Authority Information Access (AIA) Extension. The names of the file and the http/https request for the OCSP response can be obtained from the system log of the server:.

M	nsssl/doc/mann/nsssl.man
M	nsssl/nsssl.c
M	openacs-config.tcl

commit 1ee2f657a3db32a336351ca80be8fe1c5d70dae9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-24

    whitespace change

M	nslog/nslog.c

commit 8790fb5e2797804b8cb3e43f642a8a2e52db335a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-24

    include nsssl.c in cppcheck file

M	Makefile

commit 0345789fda6b1bc07d39cef67500376676c5a083
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-23

    Generalized Ns_HtuuEncode2() to Ns_Base64Encode(), since in some
    cases, the line wrapping hardcoded in Ns_HtuuEncode2 is not needed.
    Furthermore, the name Ns_Base64Encode() is better self-explaining.

M	include/ns.h
M	nsd/uuencode.c

commit ef510609a424d4fe42571c37897f63550e895f0b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-18

    improve spelling

M	doc/src/naviserver/ns_log.man

commit 4826739ad9bc954d3343617dad0367745556e688
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-18

    fix typo and ease life of optimizer

M	nsd/task.c

commit bbe8c7bac51a05fb969c20b573635bf0a6384d29
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-18

    access non-null variables only after non-null assertion (make life easier for static checkers)

M	nsd/adprequest.c
M	nsd/progress.c
M	nsd/task.c

commit 65689e7c2cfee84bcf4a9789b4ff14f500e57861
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-18

    make sure, variable is always initialized

M	nsd/tls.c

commit f073466693ab9cad618c075504f41f4720fe53b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-18

    remove redundant test

M	nsd/sockcallback.c

commit 4dcd8b1253021d6de19748ad33c3f1b149dccc17
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-12

    remove deprecated command "ns_adp_stream" from documentation

D	doc/src/naviserver/ns_adp_stream.man

commit 928902266275d8e67d5c37d28496130cb77222ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-12

    complete list of deprecated command and add suggested alternatives

M	doc/src/naviserver/commandlist.man

commit 8803b1624eb33a9b2aa0ea6af144649cd7181ea7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-12

    fix documentation

M	tcl/compat.tcl

commit 932a0b35263ce23b7b1b789cf3bd69ec7171c3e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-12

    remove deprecated command "ns_info winnt" from documentation.

M	doc/src/naviserver/ns_info.man

commit 2cfb85a6a8946957c678d2ce6af405db91245fc0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-12

    remove man page of deprecated command ns_tmpnam

D	doc/src/naviserver/ns_tmpnam.man

commit 8a306ce077176e9a692729370e6269c0260b0487
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-12

    move command name to deprecated commands

M	doc/src/naviserver/commandlist.man

commit 476195b3eb1c30def10b33314739236cebd60411
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-12

    remove deprecated command from examples

M	doc/src/naviserver/ns_register.man

commit 408dcc0998962b4a3f67e01d43c1b025bc92657c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-12

    preserve empty lines in program listings

M	doc/src/naviserver/ns_http.man

commit eb78ec3d40819a17975973535dfb33fee6169df1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-12

    remove man pages of deprecated commands ns_httpget and ns_httpopen

M	doc/src/naviserver/commandlist.man
D	doc/src/naviserver/ns_httpget.man
D	doc/src/naviserver/ns_httpopen.man

commit dca11eaac69f18c034ba707966aa3ef0bc84987c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-12

    delete man page of deprecated command ns_geturl

D	doc/src/naviserver/ns_geturl.man
M	doc/src/naviserver/ns_hotp.man

commit 9c3bdeaf9b67c5701b95722476ef0a6a587055d4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-12

    fix broken man page (duplicated content, HTML markup)

M	doc/src/naviserver/ns_requestauthorize.man

commit b6231aa5a7488519a5ee75e0dd84b7cb1d8c8920
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-11

    fix typo

M	nsperm/doc/mann/ns_perm.man

commit a3115fa70a56709b78f18011faa0c9eed742081f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-11

    add .gitignore file

A	.gitignore

commit b778b1db011157496f5a71d3b81178424c020e58
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-11

    make man pages more consistent, remove man page of deprecated command

M	doc/src/naviserver/ns_adp_ctl.man
M	doc/src/naviserver/ns_config.man
D	doc/src/naviserver/ns_httppost.man
M	doc/src/naviserver/ns_mutex.man
M	doc/src/naviserver/ns_parsetime.man
M	doc/src/naviserver/ns_rand.man
M	doc/src/naviserver/ns_rwlock.man
M	doc/src/naviserver/ns_sockcheck.man
M	doc/src/naviserver/ns_sockopen.man
M	nsdb/doc/mann/ns_buildsqldate.man
M	nsperm/doc/mann/ns_perm.man

commit 819d5966b54675a62548c46481e63b889b5afc79
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-11

    - allow ns_sleep to be called with the value of 0 (as documented in the man page)

M	nsd/tcltime.c

commit 933fd53224e19b505f05b16daa4d98574de7fafe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-09

    improve documentation

M	doc/src/manual/admin-install.man
M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_http.man
M	nsd/form.c
M	nsdb/doc/mann/ns_db.man

commit a016809deace9d447db7d01bd7b3cd322ac1fade
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-09

    update references to Tcl website (replace http://tcl.tk by https://core.tcl-lang.org)

M	NEWS
M	contrib/examples/index.adp
M	doc/src/header.inc
M	index.adp

commit f510c443753bc5db5d1add9a43530e6f90aadf2d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-09

    improve wording

M	NEWS
M	sample-config.tcl.in

commit 73bc8ff7fbf2a9930b41c47ea8978662ed7fdf85
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-09

    update URLs

M	Makefile
M	README
M	doc/src/man.css
M	doc/src/naviserver/ns_adp_abort.man
M	index.adp
M	naviserver.rdf.in

commit ae51852c11bfeabf6ba2f73b38c4cbfad607c95f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-09

    more changes concerning repository move

M	README
M	doc/src/manual/admin-install.man
M	doc/src/naviserver/ns_info.man

commit 33f0d89b9d14ebc47295fa001c203999e5f8f210
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-09

    Update documentation for git.

M	README

commit e1e798a721ff7ef20f6154ff611da0a00093a4e5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-02-06

    added link to postgres docu for db connection string

M	nsdb/doc/mann/ns_db.man

commit d8b03a4f006ca11bc2f13cdfdb1d3c1f051a1f75
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-30

    avoid potential conflict with global errno variable

M	nsd/sock.c

commit 3aac878a6d9975bf2cab8ba9d3c4bc16932d3466
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-30

    fix typo

M	nsd/sock.c

commit c6da25874f4dd123f4e8a1b049d887835f60507a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-30

    improve man page (prefer specific terms from RFC, such as request header fields)

M	doc/src/naviserver/ns_conn.man

commit b85867b2bf1e8e00d1a6cec8e09efce61d540d0c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-28

    address issue that time_t under MS VC 2019 x64 seems to be 32 bit
    
    Many thanks to Maurizio for reporting:
    https://openacs.org/forums/message-view?message_id=5441501

M	nsthread/reentrant.c

commit fd132303c267fce9162fac0476b07fd6fd67ef12
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-24

    Ns_Time reform: change granularity from seconds to Ns_Time (internally and in Tcl API)
    - Added proper handling of negative values in Ns_Time (was broken/not implemented)
    - Upgraded scheduling machinery from seconds to Ns_Time values
    - Extended Ns_Time arithmetic (Ns_DiffTime()) to handle positive and negative Ns_Time values
    - Extended regression test for ns_time significantly
    - Ns_After(), Ns_ScheduleProc(), Ns_ScheduleProcEx(): change argument from int secs to Ns_Time
    - Marked Ns_ScheduleProc() as deprecated, Ns_ScheduleProcEx() should be used instead.
    - ns_schedule_proc, ns_after: support time specs with time units (instead of only full seconds)
    - Ns_TimeToMilliseconds(): new API call for converting positive and negative Ns_Time values to ms
    - Ns_DStringAppendTime(): format times in a more compact form (no trailing zeros)
    - Use consistently Ns_TimeToMilliseconds() to convert Ns_Time to ms
    - Ns_ObjvTimeRange, Ns_CheckTimeRange(): support to specify time ranges in argument handling
    - Trim trailing zeros after comma point when printing Ns_Time, represent as int when possible
    - "ns_info scheduled" returns now timestamps in sub-second resolution (with a second faction).
      By this, the runtime of the scheduled procedure can be determined on the sub-second level.
      (potential incompatibility)
    - Added handling of "schedmaxelapsed" on the sub-second level.

M	doc/src/naviserver/ns_schedule.man
M	include/ns.h
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/sched.c
M	nsd/sock.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclobjv.c
M	nsd/tclsched.c
M	nsd/tclsock.c
M	nsd/tcltime.c
M	nsdb/dbinit.c
M	nsproxy/nsproxylib.c
M	nsthread/time.c
M	nsthread/winthread.c
M	tests/ns_cache.test
M	tests/ns_schedule.test
M	tests/ns_time.test

commit 334b0a2767622866e886bc05dac6a7a8a23f64c7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-21

    fix broken example (too many square brackets)

M	doc/src/naviserver/ns_schedule.man

commit e170eed73c5548083e58bb47c527ef3f4b3770b2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-18

    fix typo

M	nsd/task.c

commit 6e0edbed181c920db16a3ad0fad0b6b089db81a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-17

    - Base all durations in nsproxy to time units (was milliseconds before)
      This is a POTENTIAL INCOMPATIBILITY with previous versions.
      * switched to time units for the following config parameters of
        nsproxy: "evaltimeout", "gettimeout", "idletimeout",
        "recvtimeout", "sendtimeout", "waittimeout"
      * ns_proxy get: changed "-timeout" parameter to time unit value
      * ns_proxy wait: changed optional "timeout" parameter to time unit value

M	nsproxy/doc/mann/ns_proxy.man
M	nsproxy/nsproxy.h
M	nsproxy/nsproxylib.c
M	nsssl/nsssl.c
M	openacs-config.tcl
M	sample-config.tcl.in
M	tests/ns_proxy.test

commit 83e8c50a38a6986f3c0468b69e8ef3abd68f926e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-17

    improve spelling

M	doc/src/naviserver/ns_http.man

commit 792c764cbdee81e2e5810c16062b94b03a975701
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-17

    fix broken condition

M	nsdb/dbinit.c

commit d8b01b13c55d736c1c8f1695b652a1d84d9883d2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-17

    make error message for failed conversions closer to Tcl's output

M	nsd/tcltime.c

commit f6c3e77d13fb5691b9f6549cd82074176b4cc216
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-17

    name prototype and function consistently

M	nsd/tclhttp.c

commit b6099590d5742f9473291f3a001ab360e608c23c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-17

    Added function Ns_TimeToMilliseconds() to avoid repeated logic.

M	include/ns.h
M	nsd/tcltime.c

commit da29de3ecd3925d8c28b3bb10102bf2235d6a837
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-16

    - use time units for the global config parameter "schedmaxelapsed"

M	nsd-config.tcl
M	nsd/nsconf.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit b81a272db068ee49ad05f12b857c4117604b07c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-16

    - use time units for the nsdb config parameter "checkinterval"
    - updated documentation

M	doc/src/manual/admin-db.man
M	nsdb/dbinit.c
M	openacs-config.tcl

commit 79c308153759ce85da0828cd37613c1f75aaa555
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-16

    compute package tag from git similarly like to the mercurial version

M	configure.ac

commit 33e78365b085256112d94612266a731de7d633b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-16

    fix (shifted) NS_GNUC_NONNULL argument declaration

M	nsd/tclhttp.c

commit 177e4e66a54810ed0bf4434ed0e60510584e3b90
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-01-16

    Changed -timeout semantics for [ns_http run|queue] to cover comm/read/write timeouts.
    Added -expire option to [ns_http run|queue] to limit the task duration.
    
    The previous -timeout semantics corresponded roughly to the new -expire
    option but there were cases where a task might indefinitely exceed the
    given timeout. Also... it is far more common to encounter/handle read/write
    timeouts and less need to limit the task handling as a whole.
    
    This new -timeout/-expire separation allows for both to be adjusted.
    
    Scripts already using the -timeout will most probably not see any
    change unless they are handling huge up/downloads. In such cases
    we will now continue with the request, instead of terminating it
    in the middle. If somebody explicitly needs to limit the task
    duration as a whole, he should consider using -expire option.

M	doc/src/naviserver/ns_http.man
M	include/ns.h
M	nsd/nsd.h
M	nsd/task.c
M	nsd/tclhttp.c
M	tests/http.test

commit bb76adf17a12ca062d91b89a8f9b3b75e8966ea4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-15

    improve source code documentation

M	openacs-config.tcl
M	sample-config.tcl.in

commit 37af0fdd0988a2aed5f1ebc50d5cca7b235e9846
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-15

    modernize test config file

M	win32/test/nsd.tcl

commit 58f14544d559be63fd6877eec8de0e7da91bf5b2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-15

    - use time units for the server config parameters "threadtimeout"

M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit 286d31921e938de9cbc57e3ec5019527cdc627f9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-15

    - add "sendwait", "recvwait" as NS_Time to the common driver structure in Ns_Driver

M	include/ns.h
M	nssock/nssock.c
M	nsssl/nsssl.c

commit ba2d0fe065f363f62bd4b434ffade5d138310c12
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-15

    - use time units for the driver config parameters "sendwait", "recvwait", "closewait", and "keepwait"

M	doc/src/naviserver/ns_driver.man
M	nsd-config.tcl
M	nsd/connchan.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nssock/doc/mann/nssock.man
M	openacs-config.tcl
M	sample-config.tcl.in

commit f24cfe0f8af62b22349e0f76cde553862bd789b8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-15

    don't warn about missing suffix in GetTimeFromString()

M	nsd/tcltime.c

commit 1eea2fff5a7f493fdb3837f6b6d189cdd8001699
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-15

    use time units for the config parameter "jobtimeout"

M	nsd-config.tcl
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/tcljob.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit b6928a5223d325cf7e599309fda6846c071fc742
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-15

    use time units for the config parameters "dnswaittimeout" and "dnscachetimeout"

M	doc/src/manual/admin-tuning.man
M	nsd/dns.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit a95c0108e6edc7548eda809c70eaae400c3e708b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-15

    whitespace changes

M	nsdb/dbinit.c

commit 0d332440b75a4881a225df6b22e4a087ae5e7328
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-15

    fix config parameter: use "dnscachetimeout" instead of "keepwaittimeout"
    
    the parameter name "dnscachetimeout" was used internally at
    least since 4.99.4 (nov 2012) but used incorrectly in the config files.

M	openacs-config.tcl
M	sample-config.tcl.in

commit fc3bdd309c9b03578533f300aff715892655c5d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-14

    support time units for nsdb LogMinDuration

M	doc/src/manual/admin-db.man
M	nsdb/dbinit.c
M	nsdb/doc/mann/ns_db.man
M	openacs-config.tcl

commit 8872fa521601916ce7ae57c54cc4336276fb7c1b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-14

    provide default parameter as string
    
    This change makes sure that reverse lookup from config db gives a nicely formatted string
    (see e.g. nsconfig, page "Config Parameters", shutdowntimeout)

M	include/ns.h
M	nsd/config.c
M	nsd/nsconf.c

commit cd8c487cd63ef16ac963d08647e388999e62220d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-14

    specify min, max and default value of Ns_ConfigTimeUnitRange() as sec/usec pairs

M	include/ns.h
M	nsd/config.c
M	nsd/nsconf.c

commit e81b9d2f2e27992ae256f9d0f031da95b6eb75c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-14

    - Added support for using time units as config values
    - Allow time unit to be used for "shutdowntimeout"
    - Consequently, supporting last argument of "ns_shutdown" to be a time unit spec
      (returning now as well a time value)
    - more timeouts currently specified in seconds will be converted similarly.

M	doc/src/naviserver/ns_atsignal.man
M	doc/src/naviserver/ns_shutdown.man
M	include/ns.h
M	nsd/config.c
M	nsd/driver.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit 6b9b314647c34b5f254308f569dda49fd45cac65
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-14

    do not shadow local variables

M	nsd/tcltime.c

commit 2f1da4fbcc2f811319aaf708d4d6b82992911412
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-14

    improve comment

M	nsd/config.c

commit c990a5fa571dc09b09fb2cee2ccc552bc2bd4b2a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-14

    fix typo

M	nsd/driver.c

commit e8ff233754ae31dd4c6a34c1420a44decc3a7eb8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-13

    Support for time units: all arguments of Ns_ObjvTime can be specified now
    with time units such as ms, s, m, d.

M	doc/src/naviserver/ns_adp_include.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_cookie.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_sockcallback.man
M	doc/src/naviserver/ns_sockopen.man
M	doc/src/naviserver/ns_time.man
M	nsd/tclobjv.c
M	nsd/tcltime.c
M	nsdb/doc/mann/ns_db.man
A	tests/ns_time.test

commit 9d51f141bac3e79a745a3574bbe20fb17f355992
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-13

    improve source code documentation

M	nsd/tclsock.c

commit 7f791af37f800d9ce6496e96d431de1480c8f990
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-13

    improve source code documentation

M	nsd/str.c

commit 5849ca219f285f4b7de79f7e6cae3b49a4d244e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-13

    fix typo

M	NEWS

commit 225f0948c99a6c98be3201c0444201040e22b5c5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2020-01-06

    Fixed potential access to a out-of-scope stack variable.

M	nsd/task.c

commit 527b9740ec31bf05f650f1a74bd231cb30314bcc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-06

    Added tag naviserver-4.99.19 for changeset 8bea1c622f34

M	.hgtags

commit bf693ef1a613cbb02780c0f0d57269ade6a36f7c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-06

    release work

M	NEWS
M	README
M	configure.ac

commit 8af40308876cb44449466848fccb04dbb44ec2cb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-05

    improved comments, improved naming of a static function, removed redundant condition

M	nsd/driver.c

commit 90e3c47884d5f0dbd8d425c12df0d6015c543ac9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-02

    fix broken error message; reduce verbosity

M	nsd/tclcrypto.c

commit fc483c0560a2452504679fb851d3a4bfd4bd9de0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2020-01-01

    strengthen request canceling, when filter closed connection

M	nsd/queue.c

commit 3982b39cbd70e0277c2cc615fbd6c4461cc218b2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-30

    add regression test to previous change

A	tests/testserver/modules/ns_filter.tcl

commit 5a6d8532c61506143e81bdae8250802d151e5e19
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-30

    fix for the bug reported by wolfgang winkler.
    
    If - for what-ever reason - a filter has closed the connection,
    treat the filter result as NS_FILTER_RETURN. Other replies to this
    connection can not work anymore.

M	nsd/queue.c
M	tests/ns_server.test

commit c7850085644c5fed0a9e0a0756ab94af6d0b31da
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-12-29

    Fixed [ns_md] and [ns_hmac] when fed with paths with embedded blanks.

M	tcl/ns_crypto.tcl

commit 6b2ff223d8eec24ee28893ed4a5ce954e4989105
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-26

    Manually transfer changes from Andrew Piskorski's Windows nmake changes
    (Fix Windows 64-bit build, and use ActiveTcl 8.6)

M	Makefile.win32
M	include/Makefile.win32

commit 9be60dfefe249924a966a84b0752e8bab1c20e73
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-26

    added example for separate log files of a single server

M	nslog/doc/mann/ns_accesslog.man

commit fb207dbfb8a17eb93abd0a18594f08e27e7d9545
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-26

    improved handling of posix thread library of OpenBSD

M	include/Makefile.global.in

commit 1ab28c2ed99550dba71c265c6533830bfb931bf7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-26

    improved documentation of map specs

M	doc/src/naviserver/ns_server.man

commit 6d7ff53188832b84290766fb23fa23e0189c59f5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-26

    improved documentation of map specs

M	doc/src/manual/admin-tuning.man

commit ec7791b50c6912b6b90614110405ade3ca89aafa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-26

    improve styling of man pages a little

M	doc/src/man.css

commit 6e45086ac71d3b279fb5e49972916b58d89ef419
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-26

    improved spelling

M	NEWS

commit 2ee0b3c1be4d7e135f2865c2bee793cfeea115b4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-26

    updated clang-tidy call

M	Makefile

commit 0ab0aa97a7f5f47465e0461bb1a82d32eec95c81
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-25

    more fine-tuning for compiling with LibreSSL 2.7 (OpenBSD 6.3)

M	nsd/nsopenssl.h
M	nsd/tclcrypto.c
M	nsssl/nsssl.c

commit 97db8e139d983bab43ae3c0f0fe562038f3e0aec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-25

    added compatibility function for LibreSSL < 3.0

M	nsssl/nsssl.c

commit 873b9074dc1d84c8d48d040e7fd33f020e5c58d3
Merge: 1bfb5095 3089c61d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-25

    merge

commit 1bfb5095293b32fd4250692688871d8dcc590b26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-25

    use the more safe call "snprintf" instead of "sprintf"

M	nsd/tclhttp.c

commit 58bb6ee29407950f007dced4b926ebeae2bda6d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-25

    gcc on OpenBSD has so far no support for "__thread" (thread local storage)

M	include/nscheck.h

commit 9dce147250580f8e642a088fe3ad0ce9a8a9ca1f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-25

    silence static checker

M	nsd/conn.c
M	nsd/driver.c

commit 3089c61d0a1f39063d8cc826d70836fc415302aa
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-12-24

    Fixed crash on [ns_http cleanup] when garbage-collecting channels.

M	nsd/tclhttp.c

commit 3c89383b6e3d415376a1e7bf4cb09489bec4a9ab
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-12-18

    Added EPROTOTYPE bugfix for Darwin.

M	nsd/sock.c

commit eaaf76f32aaaafac3a80982d590c4605fd9f06a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-18

    add test for "ns_writer submitfiles" with file chunks larger than writerbufsize

M	nsd/driver.c
M	tests/ns_writer.test

commit 8ff6bad983630002260118290787a64312661151
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-17

    fix error segment switching

M	nsd/driver.c

commit 3f72e9afdd9ed5628701f04aad3741c581a4cb44
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-17

    avoid potential read buffer overflow in new code: limit read length to max.

M	nsd/driver.c

commit 1dfbb98a12ce884df8de67965b356cb9e0dad481
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-16

    improve cleanness of compilation with older versions of gcc

M	nsd/driver.c

commit 0cef681f496f4809ecfb2a97f43120762871aa34
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-16

    - handling of external Ns_LogAccessDebug: switch back to the solution provided by Andrew Piskorski to handle external symbol under windows.
      If someone has a better version, please let me know.
    
    - align function prototypes

M	include/ns.h
M	include/nsconfig.h.in
M	nsd/sched.c

commit 10f518c77caca82ef05f3649fc8becefe9a8c994
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-16

    - new Tcl API call:
    
          ns_writer sendfiles /list of filespecs/
    
       every filespec is a dict which must contain a "filename" element and
       can contain additionally an "-offset" and/or a "-size" element.
    
          ns_writer submitfiles {{filename /tmp/f1} {filename /tmp/f2 -offset 10}}
    
       This function is e.g. useful for video streaming applications,
       where multiple video file chunks should be transferred (sometimes)
       concatenated in a single chunk. Therefore, this function avoids the
       necessity to concatenate these files in advance (causing increased
       latency and disk usage).
    
    - extend nsd-internal function NsWriterQueue() by two arguments
      for keeping an optional Ns_FileVec with its length
    
    - extend regression test
    
    - despaghetti code: factor out WriterSetupStreamingMode
      (although being called just once) to improve readability of
      NsWriterQueue()

M	doc/src/naviserver/ns_writer.man
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/return.c
M	nslog/nslog.c
M	tests/ns_writer.test

commit 5119840a67cc1ab1ec7af285130ecba8fb736462
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-16

    improve spelling

M	doc/src/naviserver/ns_crypto.man

commit 5fc8890f30b33c93e5b89565b2d4951f7eae2d96
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-16

    avoid shadowing of (unused) function argument

M	nsd/connchan.c

commit ca8c771986d80677c3cebb9ac1f0ea2c4423fb10
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-16

    handle potential problem, where call to Tcl*Eval* might clean structures used in the callback handler

M	nsd/connchan.c

commit 1d7f6bc56910336dab94837cc5b94a1f53a97198
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-16

    provide Ns_TclGetMemUnitFromObj as library function (was static before)

M	include/ns.h
M	nsd/tclobjv.c

commit cc5c88632d6d6bc76683bc50e103c57ef267a2fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-15

    improve comment

M	nsd/sockcallback.c

commit d858f02971e452f859102363b54bde0d7fd876c2
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-12-13

    Fixed broken [ns_critsec eval] command.

M	nsd/tclthread.c

commit c798fbf800ff240700f83a270e1f625e8075768f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-09

    add "NS_EXTERN" declaration to global variable (shows up with -Wmissing-variable-declarations)

M	nslog/nslog.c

commit 0452238d84f4721ff4aee09f9cbea341b3ad9646
Merge: c58c23e0 34720339
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-09

    merge

commit c58c23e0987059ad6c7b881928a2d5ba1d344f3a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-09

    ease debugging in async cases

M	nsd/connchan.c

commit 62bae1e94b6f4ab3910ba4b18a08c550a8b08dd0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-09

    improve documentation

M	doc/src/naviserver/ns_crypto.man

commit 34720339b09580d4ecd9406118bfbd4012d6ff88
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-07

    address visibility problem of Ns_LogAccessDebug in nslog.c under windows

M	include/ns.h
M	nslog/nslog.c

commit 41f5328abfe4758b9cf0eaa3c9384038dac5fbb3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-07

    address compilation issue under windows (see https://openacs.org/forums/message-view?message_id=5439000)

M	nsd/dns.c

commit 1fb151703a2a582cb9b5ef46de83338759669478
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-06

    use native thread_local storage when available (experimental)

M	include/nscheck.h
M	include/nsthread.h
M	nsd/log.c

commit fe5e19e6a830cd8b94d4de4ade04fa857d136ae7
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-12-06

    HttpConnect() properly initializes sock element avoiding false
    releases during exception processing.

M	nsd/tclhttp.c

commit 8406c6fce9f391f8c3d429570dd90d1dd105671e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-05

    ns_crypto: add passphrase handling to all command working on .pem files.
    
    In principle, every .pem file can be protected by a passphrase, which
    can now be passed via argument "-passphrase"

M	doc/src/naviserver/ns_crypto.man
M	nsd/tclcrypto.c

commit d1c9f36c6136cc9113af43f73819157dae6027ee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-12-04

    make no assumption about the size of the signature.

M	nsd/tclcrypto.c

commit 0021dc25d15e6ee2b079c764bbaf9d7ee35e7e94
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-30

    provide same interface to "ns_writer streaming" as for "ns_writer size"
    
       ns_writer streaming ?-driver drv? ?bool?
    
    The change is backwards compatible, the old interface is still
    supported but deprecated.
    
    In addition, documentation was updated and test cases were added.

M	doc/src/naviserver/ns_writer.man
M	nsd/driver.c
M	tests/ns_writer.test

commit eeb9378dc5d4f38a12814cd6bbd734887628f7b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-29

    return error messages, when required parameters for non-positional arguments are missing

M	nsd/tclobjv.c

commit 4e46b9bd6ac486298c4290be05736992c2cb0fc1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-29

    document the new interface of "ns_writer size"

M	doc/src/naviserver/ns_writer.man

commit 77aa942d8c9473bfaf1f86a74b0d78552ac9e863
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-29

    provide for "ns_writer size" an interface, where per-default, the driver of the current connection threads is used
    
       ns_writer size ?-driver drv? ?size?
    
    the new interface supports as well the previous interface based on two positional arguments.
    The old interface is deprecated.
    
    still to do:
    - documentation updates
    - "ns_writer streaming"

M	nsd/driver.c

commit 4833d79a1396d63e19702f01bf60a16e61e2e1f6
Merge: f1e1559f dc06be67
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-27

    merge

commit f1e1559f22f0657be3287456ef90623b4f5fe075
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-27

    add cross reference to man page

M	doc/src/naviserver/ns_adp_parse.man

commit 5226c77d806d35f9b9913a40e64f3aa0274a3f73
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-27

    fix typo

M	NEWS

commit dc06be674b9b18c429131bd5c3345fe9f2278f41
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-11-26

    Unified handling for dns error on EAI_NONAME cases.

M	nsd/dns.c

commit b03c2e34bc689a3791c839a2b14db86fb58ac16c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-11-26

    Improved logs during dns lookup errors.

M	nsd/dns.c

commit 83aa68ef1896f5f1bfcc74a6ce21f5b2ab72e710
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-23

    remove one level on indentation

M	nsd/sockfile.c

commit 8b86300edddc9ffd8017667954f824effff71e64
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-23

    add request line to debug output

M	nslog/nslog.c

commit f0475971757f817eafadae1f0d8fb5fe672c8551
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-23

    add debug line for access log filtering

M	nslog/nslog.c

commit 4a57091f1ac79a519153bab2c4f1031ea17f338e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-23

    advertise ns_base64* stronger than ns_uu{en,de}decode, since the former is the more common name

M	doc/src/naviserver/ns_crypt.man
M	doc/src/naviserver/ns_md5.man
M	doc/src/naviserver/ns_sha1.man
M	doc/src/naviserver/ns_uudecode.man
M	doc/src/naviserver/ns_uuencode.man

commit 7532e495bfed94e45da3b4156d2a75586321d279
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-22

    improve readability of commands in doc pages
    
    previously, the commands listed in the synopsis were listed underlined,
    which and it hat to read for subcommands, whether the subcommand was
    joined via space or blank.

M	doc/src/man.css

commit 00e88a97ec21d8fa439031d4145bee1ea85eaf7d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-22

    remove trailing space messing up doc generation

M	doc/src/naviserver/ns_crypto.man

commit e12559e9e031a22c7cbab87c6213786b3e6be6da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-22

    prefer allcaps spelling for "sql"

M	nsdb/doc/mann/ns_buildsqldate.man
M	nsdb/doc/mann/ns_db.man
M	nsdb/doc/mann/ns_dbquotevalue.man

commit 22dc54f1a8ca541634469fe2db34ef7326a78a5e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-22

    new feature: allow separate access logs for requests sent via different drivers.
    
    The nslog module accepts now an additional parameter named "driver".
    This option can be used to produce different access logs for requests
    submitted via different drivers to sort out e.g. local server talk.
    Per default, every request is logged. When a value is provided for this
    parameter, only requests are logged in this log file when these come
    from a driver matching the provided glob pattern.
    
    
    #
    # Configure extra nssock driver for loopback traffic
    #
    ns_section "ns/modules" {
        ns_param loopback  ${bindir}/nssock
    }
    
    ns_section ns/module/loopback {
        ns_param    defaultserver   $server
        ns_param    address         127.0.0.1
        ns_param    port            8888
    }
    
    #
    # Load nslog modules twice with different names
    #
    ns_section ns/server/${server}/modules {
        ns_param    nslog           ${bindir}/nslog
        ns_param    nslog2          ${bindir}/nslog
    }
    
    #
    # configure driver patterns (default "*")
    #
    ns_section ns/server/${server}/module/nslog2 {
        ns_param    file      ${logroot}/access-loopback.log
        ns_param    driver    "loopback"
    }
    ns_section ns/server/${server}/module/nslog {
        ns_param    file      ${logroot}/access.log
        ns_param    driver    "ns*"
    }

M	nslog/doc/mann/ns_accesslog.man
M	nslog/nslog.c

commit 934372f70dc28afa328b39e35f18a43018751eee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-22

    order configuration options alphabetically

M	nslog/doc/mann/ns_accesslog.man

commit 22628ce0f5b39d4c1f4931ef6995f7d1b7fda6a3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-22

    fix typo

M	doc/src/naviserver/ns_limits.man-retracted

commit b7728d1a740e458414768c98402e4dde9c26cd40
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-14

    ::ns_crypto::md: add signature validation
    
    In addition to the previously supported signature generation
    (using option "-sign"), the new options "-verify" and -signature"
    can be used to verify the signature.
    
    Example:
    
    % set sig [::ns_crypto::md string \
                 -digest sha1 \
                 -encoding binary \
                 -sign /usr/local/src/naviserver/myprivate.pem \
                 "abcdefghijklmnopqrstuxvwxyz\n"]
    
    % set vfy [::ns_crypto::md string \
                 -digest sha1 \
                 -verify /usr/local/src/naviserver/myprivate.pem \
                 -signature $sig \
                 "abcdefghijklmnopqrstuxvwxyz\n"]

M	doc/src/naviserver/ns_crypto.man
M	nsd/request.c
M	nsd/tclcrypto.c
M	tests/ns_crypto.test
A	tests/testserver/etc/myprivate.pem

commit 7348865fcb9766f9d4d6b3c2af0672205c867ccc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-14

    capitalize name properly

M	nsd/uuencode.c

commit 41610695c99e613038c5eed0e0cc28e010602894
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-13

    provide a warning message in case loading of NSF/XOTcl 2 fails

M	tcl/aolserver-openacs.tcl

commit 1d558f5b7b4ce9fbc3869fdb169f880dde3d7816
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-13

    avoid double free in  EVP_MD_CTX_free(), since EVP_DigestSignFinal() seems to free the md-context

M	nsd/tclcrypto.c

commit a7e217d11faa19324d0d890d606fa62a6a510dd0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-06

    Clear sockPtr members after copying these to connPtr to avoid hard to track effects (with flag values)

M	nsd/queue.c

commit 804701d435df8e4c1ebad6aa76899fa2aa387b31
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-06

    make log messages more consistent

M	nsd/connio.c

commit 8aebaa65ebf82c682e6429d63874f25baf87d80c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-11-06

    make spelling in comments more consistent

M	include/ns.h

commit bdbc9be3a1f1c5a0fa1851be02de1f93392bd429
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-30

    Reduced number of returns before end of function; removed needless assert.

M	nsd/driver.c

commit 246e6449664795a8cbe4fa8231c4bf4ad5f930c9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-29

    use memory units for to following tcl commands
       ns_writer submitfile (for -offset and -size)
       ns_writer size vale (for value)
    
    one can now write
       ns_writer size nssock 150KB
    instead of
       ns_writer size nssock [expr 150*1024]

M	doc/src/naviserver/ns_writer.man
M	nsd/driver.c
M	nsd/tclobjv.c

commit ecfc9b959876e1b04b4ba4d14de40f98a82918f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-29

    add debugging and assertion to temporary file management

M	nsd/fd.c

commit 7c152a6a75277f91bbce8011bb3a09e1bd874638
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-29

    Fix leaking temporary file, when writerstraming is activated and streaming HTML output is used.
    This bug could appear, when "writerstreaming" is turned on in the config file (default off).
    
    see also: https://sourceforge.net/p/naviserver/mailman/naviserver-devel/thread/dd508519-1262-bd91-288a-fa30a7634224%40digital-concepts.com/#msg36794472

M	nsd/driver.c

commit dec8ff5f0cbbd9645b328bc855b95620ab196d66
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-25

    provide release-style compile flags also during development, e.g. before the release (since some old compilers might not accept all these)

M	include/Makefile.global.in

commit 03acbdf5243c5dd2708df39bba42f864cd2b41a2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-20

    Make table used for enumeration values for Ns_ObjvIndex static.
    
    Background:
    http://cvs.openacs.org/changelog/OpenACS?cs=oacs-5-10%3Agustafn%3A20191020125252

M	nsd/cookies.c
M	nsd/urlencode.c

commit 06f17c7ca3315cbef913fe1140663a5b2aa592b7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-20

    silence compiler warnings when compiling with Tcl 8.5

M	nsd/driver.c

commit a4e0efaa8272c4b4704fcd4d4660c53fc247dec8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-20

    reduce compiler warnings when compiling with tcl 8.5

M	include/nsthread.h
M	nsd/tclcrypto.c
M	nsd/unix.c
M	nsthread/thread.h

commit 5139e87d9689ddebbd98889209bf65723d2b8484
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-19

    tclhttp: fix write to freed memory when NS_SOCK_DONE is called

M	nsd/tclhttp.c

commit 1a714c87882c3e9b696306345375ac924dc96241
Merge: 72062421 1a72ef2e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-19

    merge

commit 720624211a4f4f1b6f9dc6a6b939891e3bbf8f53
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-19

    provide better variable name

M	nsperm/init.tcl

commit cb81bbc3fa153996c8e048d81e09b71787a7ea9f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-19

    provide a better name for static function

M	nsd/cache.c

commit 602f6daf672bfb2a51019e4e645b2b992b6582e2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-19

    improve comment

M	nsd/driver.c

commit a1d21f2c3349b26000afd12d4c33113fa93d5aec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-19

    avoid potential crash, when HTTP task fails before the real task has been created

M	nsd/tclhttp.c

commit 1a72ef2e8f041edc794b09ee29fed34358ab8d90
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-10-18

    Undef _STRICT_STDC that gets defined by <limits.h> on Solaris.
    This makes trouble with <signal.h>

M	include/nscheck.h

commit 028ea75b44fec0db84130b752a7f83384111c74a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-17

    output warning, when naviserver was compiled without zlib support, but the config file request compression.
    
    Before, the compress enable request was silently ignored

M	nsd/server.c

commit 01f7859657cabd3302576dab818283ea5716d718
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-12

    omit poolrate output, when poolrate is 0

M	nsd/driver.c

commit f7cbf9df7164a94f8fedfae654d3589399152b3c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-11

    improve spelling

M	doc/README
M	nsd/sched.c
M	nsd/tcltime.c

commit b32e76e5319a091a7ae61506f949fa2bfe286b2b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-11

    new debug flag: Debug(writer)

M	nsd/driver.c

commit 8625c1f2dea4de44880a1ff0d95548a214cdcb72
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-11

    fix broken nsv_bucket (objv parser was off by one)

M	nsd/tclvar.c

commit ed8374903911cf0ba1e879397f30cb38277a3d7e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-07

    new API function NsPoolName() to make output of default pool name (empty) more consistent

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c

commit e63dcbd9284b5f64326db69ce8c12ea45f1becd7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-07

    New API call Ns_ConnTryReturnInternalError() to notice internal errors (500) in cases, the connection is already closed.
    
    Before this change, the server could crash in some desperate error situations.

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/op.c
M	nsd/queue.c
M	nsd/returnresp.c
M	nsd/tclrequest.c

commit ccdc59f700f1ab3db3069b1c0fc35982768a5cf0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-05

    make comma setting more consistent
    
    see: https://onlinewritingtraining.com.au/however-therefore-furthermore/

M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_tmpnam.man
M	doc/src/naviserver/ns_totp.man
M	nsd/init.tcl
M	nsd/queue.c
M	nsd/sock.c
M	nsd/str.c
M	nsd/tclcache.c
M	nsd/tclinit.c
M	tcl/nstrace.tcl
M	tests/ns_adp_compress.test

commit 3af60592696de9f96318f12a703fa46dbb7675c7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-05

    remove debugging output

M	nsssl/nsssl.c

commit a39de014442c175263d543a595939b16084bcbf0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-05

    Fix a bug caused be the low-level refactoring leading to incomplete https transfers with connchan.
    
    The problem was that due to the refactoring since the last release, the
    low-level https operations were made strictly nonblocking, where before
    these operations might have blocked in some situations (partial writes).
    Partial writes were already working before this patch, but in certain
    situations, we experienced a 0 byte partial operation, followed by an error like
    
       Error: spool: POSIX {unknown error} Success, channel conn451 send operation failed: Success
    
    It turned out that was caused by an OpenSSL error "ssl3_write_pending:bad write retry",
    which is issued, when an operation ending in an SSL_ERROR_WANT_WRITE was executed
    with a different buffer pointer (the resubmission of partial written data
    happens via Tcl). The issue was addressed via the OpenSSL mode flag
    SSL_MODE_ACCEPT_MOVING_WRITE_BUFFER. See the comments in the source code
    for more details and alternate approaches.

M	nsd/connchan.c
M	nsd/tls.c
M	nsssl/nsssl.c

commit 01a6dea7c66c140242d6ee6fdf778e061ccd1965
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-05

    Don't abbreviate Tcl's subcommand names

M	tests/ns_info.test
M	tests/ns_proxy.test
M	tests/ns_server.test

commit d3c9b63b6cecc811d6fefbbe785a19d82f2c6694
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-05

    improve spelling

M	nsd/driver.c
M	nsd/tclvar.c

commit 30b106113ed9f8b02ea339b2f9efefe8e129f7b2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-05

    improve variable names and comments

M	nsd/sock.c

commit 50cf22ffc6b6100571767503801ee49037149e67
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-04

    improve man page

M	doc/src/naviserver/ns_connchan.man

commit 25a068ca634918934ad309048725e2a50427fcea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-04

    fix dynamic setting of poolratelimit and connectionratelimit

M	nsd/queue.c

commit 8dd38dcc8fac2615ea2adeac1a8808ca2369eef3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-03

    add missing semicolon

M	nsd/tclhttp.c

commit 67b3611c47c92cb41a66bf558a35772488c2150a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-01

    make clear via assertion, when double HttpClose operations will happen

M	nsd/tclhttp.c

commit f24af59470b84db63b57ba4c0d86e7f6ed8deabd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-01

    improve expressiveness of code: no need to use += operator when lhs is zero

M	nsd/index.c

commit 19c698c8c6c4ebc221d5300ed9f4f75aa65a797b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-01

    Avoid calls to HttpTaskSend() when there is nothing to send.
    
    We sow in some error cases such calls, leading to an assertion violation.

M	nsd/tclhttp.c

commit 06076e2bc8d53cd3b1195c9a1fcb98e3a9f10bc9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-10-01

    add comment about strange error messages appearing occoasionally

M	nsd/connchan.c

commit 17075255bca3ba3fa8832bdab50e4a4cb3c66200
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-09-26

    fix typo in var name

M	nsd/driver.c

commit 26d8732716388517270d83dfb0bdba929cdc15aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-09-26

    don't pass NULL after the last typed argument to a variadic function

M	nsd/tclhttp.c

commit 55d94eff8223710b827acbb583093950bdb7f155
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-09-18

    Silence some compilers that do not see that all enumeration values are covered by switch statement

M	nsd/tclimg.c

commit 06bd04f6e22fb572b553b1d2e116213dc3c03f35
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-09-18

    Added "-binary" option for input processing to the following functions:
    
    ns_crypto::hmac new (for "key")
    ns_crypto::hmac add (for "message")
    ns_crypto::hmac string (for "key", "message")
    ns_crypto::md add (for "message")
    ns_crypto::md string (for "message")
    ns_crypto::md vapidsign (for "message")
    ns_crypto::md hkdf (for "-salt" "-secret" "-info")
    ns_crypto::scrypt (for "-salt" "-secret")
    ns_crypto::eckey import ("-string")
    ns_crypto::eckey sharedsecret ("pubkey")
    ns_crypto::aead::encrypt string (for "-key", "-aad", "-iv", "input")
    ns_crypto::aead::decrypt string (for "-key", "-aad", "-iv", "input")

M	doc/src/naviserver/ns_crypto.man
M	nsd/tclcrypto.c
M	tests/ns_crypto.test

commit 06cdbf2f42d29c55f85fd52ea379e310dda40f52
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-09-18

    Silence some compilers that do not see that all enumeration values are covered by switch statement

M	nsd/adpcmds.c
M	nsd/nsmain.c
M	nsd/urlspace.c

commit a68f7009dd5fdce6990b43784464676a57ae40ba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-09-11

    adjust test cases

M	tests/ns_urlencode.test

commit 5479e7b11056cc5b6da82859a4b8b5ab24793f5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-09-11

    add a "-binary" option for input processing to the following functions:
    ns_base64encode ns_base64urlencode ns_uudecode ns_uuencode ns_md5 ns_sha1

M	doc/src/naviserver/ns_base64.man
M	doc/src/naviserver/ns_md5.man
M	doc/src/naviserver/ns_sha1.man
M	doc/src/naviserver/ns_uudecode.man
M	doc/src/naviserver/ns_uuencode.man
M	nsd/tclmisc.c
M	tests/ns_base64.test
M	tests/ns_md5.test
M	tests/ns_sha1.test
M	tests/ns_uuencode.test

commit c24682b21a53d1f4f1a2f1f6decc380a96010c28
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-09-11

    Argument parser: skip processing of optional arguments when the number of provided arguments is equal to the number of required parameters.
    
    Background: This change allows a fully backward compatible version of e.g. "ns_md5 $foo", no matter
    what the value of "$foo" is, although the new version of "ns_md5" has now a "-binary" option.

M	nsd/tclobjv.c

commit 5b23f4524e04bbc2639188c7c7d275fa691a5823
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-09-10

    fix typo

M	nsperm/hosts.allow

commit ba3ad9e31468d82feb11879b178f913b0399c469
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-09-09

    driver rate limit: align code with documentation

M	nsd/driver.c
M	nssock/doc/mann/nssock.man

commit bb6c6affa70b9c79584938b397827d4dd790f0b2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-31

    initialize variables in all cases

M	nsd/sockfile.c

commit 49f2475e73fab7e25319b70b203f9cd3e02e893c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-31

    add POSIX thread library to load options on FreeBSD

M	include/Makefile.global.in

commit 3efdb6018338c86e6e6a2585f8bf2ddc522310e2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-31

    improve spelling

M	Makefile.win32

commit 5e5dfcc0d6e0b6d1e034c489294d61ae0f301d58
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-31

    improve spelling

M	doc/src/naviserver/returnstatus-cmds.man

commit 0062a62f0d2072a957dd934e2aada6bedfbb6a51
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-31

    support more test cases also when not nsf is available

M	tests/ns_base64.test
M	tests/ns_crypto.test

commit 7776dac97de5516fe131309b71f80bc2f4cc98ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-23

    get rid auf all warnings about bad-function-cast

M	nsd/driver.c
M	nsd/info.c
M	nsd/sched.c
M	nsssl/nsssl.c
M	nsthread/nsthreadtest.c

commit bde2b645f70863970b8806403e8fa524614fba3a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-23

    reduce warnings about bad-function-cast

M	nsthread/pthread.c

commit 867db3f53338b05408962743d30cd8db71de1758
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-23

    improve alignment issues

M	nsd/binder.c

commit 1135dee8a88b12c7c88148f42ce9d0a331b73406
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-23

    make sure, variables are always initialized (also in non-reachable branches)

M	nsd/conn.c
M	nsd/sockaddr.c
M	nsd/urlspace.c

commit 1040da8a21745b7335f5cf68834bda0e75e44b57
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-23

    fix alignment issues

M	include/ns.h
M	nsd/tclcallbacks.c

commit c65c7e9c2a207430e2bb8fcdced5417d6492f273
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-22

    simplify logic of function

M	nsd/driver.c

commit 8903379d9a91c6bd519318a3a6f613499cfad403
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-22

    adding missing "extern" declarations

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsdb/nsdb.c
M	nsdbtest/nsdbtest.c
M	nsperm/nsperm.c
M	nsproxy/nsproxymod.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit 88c4631e59f98d370237ffd8cd67b869d44b58f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-22

    add "static" declaration

M	nsthread/tls.c

commit 1a25a4ff01d54a91783254eb5715df745a6ff81b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-22

    removed unreachable "break" statements

M	nsd/driver.c
M	nsd/nsmain.c

commit 7ffb93a1e2c642cc946978a5de0b9555e31e41f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-22

    added NS_GNUC_NORETURN declarations

M	include/ns.h
M	include/nsthread.h
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/unix.c
M	nsthread/nsthreadtest.c
M	nsthread/thread.h

commit 7adfb2f9a17f74576ed6d5e54e9a477c66fcac7c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-22

    removed empty statements

M	nsd/compress.c
M	nsd/sock.c
M	nsd/tclcrypto.c

commit 9ecf747dfbbd5f80ccac142ac5c60c622005ba42
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-22

    remove "default" from switch statements having all enumeration values covered.

M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/driver.c
M	nsd/nsmain.c
M	nsd/op.c
M	nsd/queue.c
M	nsd/tclcrypto.c
M	nsd/tclimg.c
M	nsd/tclrequest.c
M	nsd/urlspace.c
M	nsdb/dbdrv.c

commit 9ced281fb2a56ba24184c10105ae2e2bb84a36b0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-22

    use the term "response" instead of "reply", since RFC 2068ff use "request" and "response"

M	nslog/doc/mann/ns_accesslog.man
M	nslog/nslog.c

commit 5357093b7e4190b40f3d19a3e9f4f512664e9c18
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-21

    add "foreBinary" argument to Ns_GetBinaryString() (currently not used)

M	include/ns.h
M	nsd/str.c
M	nsd/tclcrypto.c
M	nsd/tclmisc.c

commit bbbcc5d09ace51e386820c9a156281a117cba599
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-21

    fix alignment issues

M	nsd/tclmisc.c

commit 2252847ad613bcae9d16918b8ba97fc5368708fe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-21

    - improve documentation, how locations in redirects are handled/configured

M	doc/src/naviserver/ns_locationproc.man
M	doc/src/naviserver/returnstatus-cmds.man
M	nssock/doc/mann/nssock.man

commit be90e8647b9cf3017316a2eee789fe1d7302994a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-21

    - fix different alignment requirements of char* and Req * (or Res *).
    - add missing static declarations
    - make sure, data is always initialized

M	nsproxy/nsproxylib.c

commit 2303cffba736d56eeda0fb5fb089ebea5df637e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-20

    new feature: provide access to request AND reply header fields via "exteheaders" specification.
    
    It is now optionally possible to specify the header fields with a tag "request:" or "reply:" to
    denote request and reply header fields. In case, no tag is provided, field names are
    interpreted as request header fields. The change is fully backwards compatible,

M	include/ns.h
M	nslog/doc/mann/ns_accesslog.man
M	nslog/nslog.c
M	openacs-config.tcl

commit bab3c8f9861b486f565fcce7869506271d73c615
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-20

    improve spelling

M	nsssl/README.md

commit 405853c253505ca653749c6b2ed00b1e15046a72
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-20

    add static declarations to variables, remove unreachable break

M	nsthread/nsthreadtest.c

commit a62e3a4f2749ca383956902ea2f53fd682dd124d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-20

    add missing EXTERN declarations

M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/stamp.c

commit f2b41b03e0150c8c138c95c07761005251e0c3b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-20

    fix type mismatch

M	nsd/tclhttp.c

commit 5d40b7efd4aac0f9af2bc787fb12f375c5b1eadd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-20

    Debug(access): avoid trailing newline in system log

M	nslog/nslog.c

commit 98df8d27250ce8301e7996ded3b976fb78a1d959
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-20

    list predefined severities

M	doc/src/naviserver/ns_log.man

commit 75f76d91b9fd128f8393cef889491fd7dae4628b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-20

    Additional severity Debug(access): when activated, entries of the access log are mirrored in the system log (error.log)
    
    This feature eases debugging for setups with no sophisticated log analysis infrastructure (such as e.g. elastic stack)

M	include/ns.h
M	nsd/driver.c
M	nslog/nslog.c

commit 2e2a43c344785ed05e079fa9bcfffadbc231bc2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-20

    Removed unused macro definition

M	nsthread/mutex.c

commit c895ad7da081c82cae2d6ad7868a0ea6f5cbe158
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-17

    omit test in versions before tcl8.6

M	tests/ns_crypto.test

commit ba05b6e856cf794f5db5982cc063e556e74a3f0f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-17

    fix typo

M	nsd/connchan.c

commit c426dc4bf401a507629288a037366d3cd98c6239
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-17

    - reduce variable scopes
    - reduce return before end of function

M	nslog/nslog.c

commit 44fd2566443a8f08a0689bfc290c0ab3adc89612
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-17

    improve structure packing

M	include/ns.h

commit 0b9fef887ef6656fce995f77899f355adf2ef0ef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-17

    remove unneeded cast

M	nssock/nssock.c

commit dd5ea0b8cc73639e2876136b949af3603cc850d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-17

    remove unused macro and unneeded casts

M	nsssl/nsssl.c

commit 2f2e9ed6474859bac340865bfa2d09d9a9804b1c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-17

    use default encoding

M	nsd/tclmisc.c

commit b9e31cc693194471efdf041d82f87c1a5cdaf1f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-17

    on logging, write the full request, not only until the first NULL character

M	nsd/tclhttp.c

commit ca85a6bde3e2fb5793667ac42638f0977917b3da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-16

    ns_base64decode, ns_base64urldecode: added documentation for option "-binary"

M	doc/src/naviserver/ns_base64.man
M	nsd/tclmisc.c

commit 82a098d34709f4a1709db337fe6576bfc755d788
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-15

    Add option "-binary" to ns_base64decode

M	tests/ns_base64.test
M	tests/ns_crypto.test
M	tests/ns_nsv.test
M	tests/ns_uuencode.test

commit db551604af934a572c29e0dcbe8b2c2e951d3fe7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-15

    improve comment

M	nsd/tclmisc.c

commit 53d1ffbb3aa99188305f2067883f49e1f6c93f5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-15

    remove redundant declarations

M	include/nsthread.h
M	nsd/pathname.c

commit 7221fe2cdabb8a068319007735038b5aa12c4b40
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-15

    adjust sample service file to current naming conventions of TCmalloc

M	doc/src/manual/admin-maintenance.man

commit 962c1b581bca0cd8a3ffe23250ee0f535b70b16e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-15

    documentation for ns_hmac: make clear that "new" requires always a key.

M	doc/src/naviserver/ns_hmac.man
M	doc/src/naviserver/ns_md.man

commit 29b3eb3c9fbdcc05a4835ddbf26dfe239d0eb7c0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-08-15

    Added -encoding and multiple files to "file" method

M	doc/src/naviserver/ns_hmac.man
M	doc/src/naviserver/ns_md.man
M	tcl/ns_crypto.tcl

commit b0bcd0de8b68444a42b0307c36037900a8024fcd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-14

    update documentation of "ns_md" and "ns_hmac": add documentation of "encoding"

M	doc/src/naviserver/ns_hmac.man
M	doc/src/naviserver/ns_md.man

commit 774ce48dd3f552272d942c4271f6530e91cc6008
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-13

    return result of ns_base64decode as bytearray to avoid loss of binary data.

M	nsd/tclmisc.c
M	tests/ns_base64.test

commit cce455f5031f6975e794a10c46c1eadc5a5313dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-13

    add example to NEWS file

M	NEWS

commit 61dca9fc1194069dc2cef7697b5538c718a5077d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-10

    improve spelling

M	NEWS
M	include/nsconfig.h.in
M	nsproxy/doc/mann/ns_proxy.man
M	sample-config.tcl.in
M	tests/testserver/modules/testhttp.tcl

commit 48d25bbfa6295ae810f2ec02fa86fc032535264c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-10

    fix man pages

M	doc/src/naviserver/ns_asynclogfile.man
M	doc/src/naviserver/ns_http.man

commit 52f7c7fc38da1333f762e807fcf1c7bb46f54e71
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-10

    support "-encoding" option for "ns_hmac|ns_md get"

M	tcl/ns_crypto.tcl

commit 458d5413ca68f07f81aa7557c1a7e6b92a1c206b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-09

    improve spelling

M	NEWS
M	tcl/sendmail.tcl

commit 8ae0ed750aa965f5931cd51344504586154f0041
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-09

    improve spelling

M	doc/src/manual/admin-tuning.man
M	doc/src/manual/tcl-lib-file.man
M	doc/src/manual/tcl-libraries.man
M	doc/src/naviserver/ns_adp_ctl.man
M	doc/src/naviserver/ns_adp_info.man
M	doc/src/naviserver/ns_base64.man
M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_filestat.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/ns_writer.man
M	doc/src/naviserver/returnstatus-cmds.man
M	include/ns.h
M	nsd/adpeval.c
M	nsd/binder.c
M	nsd/cls.c
M	nsd/conn.c
M	nsd/dstring.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/index.c
M	nsd/info.c
M	nsd/lisp.c
M	nsd/nsmain.c
M	nsd/progress.c
M	nsd/request.c
M	nsd/return.c
M	nsd/sls.c
M	nsd/sockaddr.c
M	nsd/sockcallback.c
M	nsd/str.c
M	nsd/tclcache.c
M	nsd/tclcmds.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/unix.c
M	nsdb/dbinit.c
M	nslog/doc/mann/ns_accesslog.man
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nsthread/sema.c
M	nsthread/tls.c
M	tcl/config.tcl
M	tests/http.test
M	tests/ns_urlspace.test

commit 8def5998766a6147ce65cba181820cbb6b8c540e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-09

    Fix nasty bug with pure byte arrays in versions of Tcl before 8.7.
    Extended regression test.

M	include/nsthread.h
M	nsd/str.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	tests/ns_base64.test
M	tests/ns_crypto.test

commit 5b2ce881eba5b2bb6b39ad2a95d7cd3fd440a113
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-08

    adjust syntax respnose in test

M	tests/ns_crypto.test

commit 1bc694c7be83ebb50f3f0eea55d0779215976146
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-08

    add "--" to make sure the parsing is not confused with values looking like flags

M	nsd/tclcrypto.c

commit c6122696dc9357b1b356fde6df13d8856bff2262
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-08

    support "-encoding interface" for ns_md and ns_hmac

M	tcl/ns_crypto.tcl

commit 114cf603d2a2945b932a414a3601a41d3cdf9844
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-08

    further extend test cases (e.g. binary content from files)

M	tests/ns_base64.test

commit cbecd1ecb7083745821242c0e2860c4b4bbd5675
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-08

    make documentation more precise

M	doc/src/naviserver/ns_crypto.man

commit 2d967eb3138793caf5c0585fd7dcb9e78316db86
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-08

    add additional test for bytearray conversions

M	tests/ns_base64.test
A	tests/testserver/pages/utf-8-chars

commit 67df6158a871be10ac25b7bc6ccce1579c44d252
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-07

    Brought output of hexprint of binary crypto commands under the control of ns_logctl:
    
    % ns_logctl severity Debug on
    0
    
    % ns_md string ü
    [07/Aug/2019:21:15:54][5989.70000e0ac000][-command-] Debug: md (len 2): c3 bc
    607474ca475a9724d7360aba71a56d5df77e61350e3f724cfa1f46e857e2d85f
    
    % ns_hmac string ä ü
    [07/Aug/2019:21:16:59][5989.70000e0ac000][-command-] Debug: hmac key (len 2): c3 a4
    [07/Aug/2019:21:16:59][5989.70000e0ac000][-command-] Debug: hmac message (len 2): c3 bc

M	nsd/driver.c
M	nsd/tclcrypto.c

commit b851c447320b5b6d6208cb9b77444c1d986196d9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-07

    fix bug in "nsv_set -default" overwriting pre-existing values; extended regression test

M	nsd/tclvar.c
M	tests/ns_nsv.test

commit eed3f34a17403f77c42fef3e08db9eb2444e48c8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-07

    improve hint from config file

M	nsd/init.tcl

commit 0dc7c18778c811411eaf9ad9a1178e43ac720cc7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-07

    typographic changes

M	NEWS
M	nsd/set.c
M	nsd/tclcrypto.c

commit b785c4d1895f74f3cc7d5d0bd1753d23c2e7db29
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-02

    improve spelling

M	nsd/tclhttp.c

commit 49502828e2843b9face7571eecf06022e44e7b17
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-02

    Do not require the user to convert UTF-8 characters manually to byte arrays on the Tcl level.
    In the last two releases (4.99.17 and 4.99.18) the NaviServer behavior went towards Tcl,
    but this lead to compatibility problems and puts a burden to the user on the Tcl level.
    
    See below for some background and consequences.
    
        /*
         * Obtain the binary data from an obj. If the Tcl_Obj is not a bytecode
         * obj, produce it on the fly to avoid putting the burden to the user.
         *
         * Tcl requires the user to convert UTF-8 characters into bytearrays on
         * the scripting level, as the following example illustrates. The UTF-8
         * character "ü" requires 2 bytes:
         *
         * % binary encode hex ü
         * fc
         * % binary encode hex [encoding convertto utf-8 ü]
         * c3bc
         *
         * When doing a base64 encoding, the casual user expect the same behavior
         * as in a shell, e.g. for transforming "ü" into a based64 encoded string:
         *
         * $ echo -n "ü" |base64
         * w7w=
         *
         * % ns_base64encode ü
         * w7w=
         *
         * But Tcl requires this interaction "manually":
         *
         * % binary encode base64 ü
         * /A==
         *
         * % binary encode base64 [encoding convertto utf-8 ü]
         * w7w=
         *
         * The same principle should as well apply for the crypto commands, where
         * the NaviServer user should not have to care for converting chars to
         * bytestrings manually.
         *
         * $ echo -n "ü" |openssl sha1
         * (stdin)= 94a759fd37735430753c7b6b80684306d80ea16e
         *
         * % ns_sha1 "ü"
         * 94A759FD37735430753C7B6B80684306D80EA16E
         *
         * % ns_md string -digest sha1 ü
         * 94a759fd37735430753c7b6b80684306d80ea16e
         *
         * The same should hold as well for 3-byte UTF-8 characters
         *
         * $ echo -n "☀" |openssl sha1
         * (stdin)= d5b6c20ee0b3f6dafa632a63eafe3fd0db26752d
         *
         * % ns_sha1 ☀
         * D5B6C20EE0B3F6DAFA632A63EAFE3FD0DB26752D
         *
         * % ns_md string -digest sha1 ☀
         * d5b6c20ee0b3f6dafa632a63eafe3fd0db26752d
         *
         */

M	nsd/str.c
M	nsd/tclmisc.c
M	tests/ns_base64.test

commit b81f648f1db924d8518fee0a44505f72ab14b09d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-02

    use lowercase parameter names

M	openacs-config.tcl

commit f27036212276bdd1c3663338a0b1f874268da79e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-02

    omit questionable tests with binary content via non-binary mimetype for versions before Tcl 8.7

M	tests/http.test

commit 327152bfbbf21e0739e6be2f47201b2e69f47bfc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-02

    make test more robust for different timezones

M	tests/misc.test

commit 01bee1a4013e96a1f2d0c186ec7d6fe075b2c51c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-08-02

    pass the character data in the "binary" cases explicitly as bytearrays. This fixes the formerly "broken" cases in the regression test

M	nsd/tclhttp.c
M	tests/http.test

commit 953cc00f37ea857a895d5da04f2985ffc1fbfa3c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-30

    improve spelling

M	nsd/tclhttp.c

commit b8f75ec2cf31e99f560934582225ca58c172696d
Merge: bd35d9d1 24f8d77a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-30

    merge

commit bd35d9d1f62698e1923f46f760eab01c7769b3db
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-30

    Make log-file sanitizer better configurable: instead of
    just turning the sanitizer on/off as implemented by
    https://bitbucket.org/naviserver/naviserver/commits/e08c3449bfc592ab1451bd7e232e97436e7181ff
    a third value was added for a human readable sanitized log-file format,
    that still addresses security concerns (make it impossible to
    confuse logged content with log entries). The new option
    preserves new-line characters but prefixes continuation lines.

M	doc/src/naviserver/commandlist.man
A	doc/src/naviserver/ns_asynclogfile.man
M	doc/src/naviserver/ns_log.man
M	include/ns.h
M	nsd-config.tcl
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsdb/dbinit.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit ba151edafa1469f8edc4996c585134bbbc110baa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-30

    Reduce verbosity

M	tests/http_byteranges.test

commit 24f8d77a812b6a961f9e6d6bfb858aedbd099c3b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-30

    Added request/reply body byte counters for [ns_http stats].

M	doc/src/naviserver/ns_http.man
M	nsd/nsd.h
M	nsd/tclhttp.c

commit d805fa6b306d7a24c2ab06746304cc86b4e3b1a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-27

    Clarify bitwise expression with parentheses
    Make sure, sockstate is always initialized.

M	nsd/tclhttp.c

commit cda6adfe48d2517e065d40fafe5ba9bed3801f54
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-25

    Remove transfer-encoding header from reply because we parse it now clean.

M	nsd/tclhttp.c

commit 4e5c2267f1bae3f281d889f3a4feb188a386fa54
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-25

    Decision to end read state during chunked encoding is now strengthened.

M	nsd/tclhttp.c

commit c4a4395bac72ddb477d5c6c77db14a14aa4f5c67
Merge: cdd5e2bf d868b5cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-25

    merge and remove dead code

commit cdd5e2bf8757f4c2167d2b7763bcce6969231bf2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-24

    add shutdown timeout to openacs config file

M	openacs-config.tcl

commit d868b5cd202e920d35ee7e814833b6c0f0277119
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-24

    Make sure we never read mpre than necessary from the socket.
    For non-chunked replies, stop on Content-Length.
    For chunked replies, stop on end-frame (last CRLF).

M	nsd/nsd.h
M	nsd/tclhttp.c

commit fd09e60cbe52ded97629c4aa4b743dcb4b964bcd
Merge: 6b530321 ae92b243
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-24

    Re-merged.

commit 6b5303213d47dd2d2f56e8d22fdf907fe1b6eca1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-24

    Make sure not to append more data than specified by Content-Length

M	nsd/tclhttp.c

commit cf47fd2618cca45cf50506de76107a796f5323f7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-23

    extend urspace tests

M	tests/ns_urlspace.test

commit ae92b2439274010810d3e1a4f0151f1ede8427e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-22

    fix print statement

M	nsd/sock.c

commit 13dba34545d244d4ea8aedbfa559cea2b7a81f3d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-22

    fix compilation for windows (MSG_DONTWAIT not defined). Many thanks to  Maurizio Martignano!

M	include/nsthread.h

commit a8b1181e2790b7f716508ba0c87f92b1b4076314
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-22

    make the failing test more clear

M	nsd/tclhttp.c

commit a84bce93d463455bd525dc0842c314a024894689
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-22

    increase debugging output

M	tests/http_byteranges.test

commit 5ba3858dd05918c493fe6500df6a779c3167409a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-22

    reduce debugging putput

M	tests/tclresp.test

commit 2db3b0de1e18d62835440d1ae04fe3cf18eb97c0
Merge: ac81abd4 5a6464db
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-22

    merge + fix of ns_fmttime + extended regression test

commit 5a6464dbc3f7f106819aa8425196f67a9985fd5e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-22

    Fixed chunked-encoding parse machine to recognize low-data correctly.

M	nsd/tclhttp.c

commit a36e17f8b80f0602aa11cbf1d14d1c0ea1bb8295
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-22

    Fixed Ns_SockTimedWait() to correctly check connection state.

M	nsd/sock.c

commit ac81abd45e7166e47c759668db0d6adcccdb781e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-22

    improve alignment with Tcl's current .m4 file to get rid of "-prebind" deprecated message under macOS

M	m4/tcl.m4

commit a393ff5e1640efb743d0a3f4b35250e3691c3b8b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-22

    align loopback address with client address in test cases

M	tests/testserver/modules/testhttps.tcl

commit 59541fc61880beb61c47278dbbb2180bf04d68f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-22

    strt counting allocated slots from 0, fix loop variable

M	nsd/queue.c

commit f2e62b8ab777c5c3d1075c28dbc371d6a40d5ea5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-22

    include totalPoolRate in debug messages

M	nsd/driver.c

commit 3048bb2a571b4d4388304d6133065190cce09f09
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-22

    use square bracket notation only for IPv6

M	tests/test.nscfg

commit 21f0340ba7b495db974bcbc28f83f04817f980c8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-21

    remove compiler warning when printing function pointer

M	nsd/tclhttp.c

commit 0d41011eb52f7a5be5e9e75b67d45c58ef12726f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-21

    make asynchronous nature of functions programmatically explicit

M	nsd/sock.c

commit fed1c5d76c091de2537a9a7b84600ed63f84d250
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-21

    generalize the usage of SO_NOSIGPIPE since this is relevant for all *BSD* like unixes

M	nsd/sock.c

commit 57160f97b8e339937891f1753911b1632c200e6b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-20

    use MSG_NOSIGNAL also in SockSend()

M	nsd/sock.c

commit f0c4e373b0391462d2e777a4a909212f0d589da6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-20

    use MSG_NOSIGNAL on sendmsg() to avoid potentials SIGPIPE signals

M	include/nsthread.h
M	nsd/sock.c

commit 52887497ab520e226fb49bf8e6f40eb01ed655bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-19

    add debugging hooks to ease debugging for tclresp-12.4

M	nsd/tclhttp.c
M	tests/tclresp.test

commit e2901d20e6c6cc2a6cc3ec030f8e32edb9223b13
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-19

    - add commands to manage connection rate limit and pool rate limit dynamically.
        ns_server ?-server s? ?-pool p? connectionratelimit ?value?
        ns_server ?-server s? ?-pool p? poolratelimit ?value?
    - name config parameters exactly like above.

M	doc/src/manual/admin-tuning.man
M	doc/src/naviserver/ns_server.man
M	nsd-config.tcl
M	nsd/queue.c
M	nsd/server.c
M	openacs-config.tcl
M	sample-config.tcl.in
M	tests/ns_server.test

commit c1d5348f3975ac69eb34a6d509dc87944d91d8bb
Merge: 9e15ab9f 350118c3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-19

    merge and fix compilation issues

commit 350118c38187a8f7f2ab9f5af1c6d56cff87f617
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-19

    Added chunked-encoding parser to ns_http

M	nsd/nsd.h
M	nsd/tclhttp.c

commit 9e15ab9f8f0a720848fa5b90f268f85756037b96
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-19

    silence compiler

M	nsd/nsopenssl.h
M	nsd/tclcrypto.c

commit aa58965cfa97ba378f13847f09f1da91980e77d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-19

    add usual comment block per function

M	nsd/tclcrypto.c

commit 06d61acd08f5475e779353f887df96b817ce3402
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-19

    adjust test case

M	tests/ns_set.test

commit 90ce55a58974bc7ec36dc4af064b8d74c760d44d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-19

    newer versions of OpenSSL refuse to work with rsa keys of size 1024

M	Makefile

commit 4447b4b4f64ff93f86db44ceaba045a45614fad0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-18

    New feature: scrypt Password-Based Key Derivation Function (RFC 7914)
    
    The scrypt function is a modern replacement for crypt and bcrypt and
    derives secret keys from a secret string.  It is based on memory-hard
    functions, which offer added protection against attacks using custom hardware
    and GPU arrays. The functions requires the compilation of NaviServer against
    OpenSSL 3.0 or newer.
    
    Example from RFC 7914:
       ::ns_crypto::scrypt -secret "password" -salt NaCl -n 1024 -r 8 -p 16
    
          fdbabe1c9d3472007856e7190d01e9fe7c6ad7cbc8237830e77376634b373162
          2eaf30d92e22a3886ff109279d9830dac727afb94a83ee6d8360cbdfa2cc0640

M	doc/src/naviserver/ns_crypto.man
M	nsd/nsd.h
M	nsd/nsopenssl.h
M	nsd/tclcmds.c
M	nsd/tclcrypto.c

commit 4fb8c63fa938b349a0c201b65146aa0303f56ea5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-18

    new subcommand "ns_set iupdate": this command completes the case insenstive counterpart of other commands
    extend regression test
    update man pages

M	doc/src/naviserver/ns_set.man
M	doc/src/naviserver/ns_urlspace.man
M	doc/src/naviserver/nsv.man
M	nsd/tclset.c
M	tests/ns_set.test

commit 6a870f12fb70abad0807c0b681557e5ab5fc5d58
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-18

    make debug messages more easy to follow

M	nsd/connchan.c

commit 0d78242b70df8f2bfdb60d109a1569aab0da5bad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-18

    reduce variable scopes

M	nsd/urlspace.c

commit 95c228fd808386df5cba1fbcca1fbf458f48835c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-18

    add binary testfile
    fix some tests for binary PUT

M	tests/http.test
A	tests/testserver/pages/binary

commit 31a37b003e4559cb51be127b5a5da3261fa75f86
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-17

    add test cases, where binary data is sent via ns_http

M	tests/http.test

commit dec6ecc40d73944a9ff0cf750ecc08380850af42
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-17

    add string and content length to expected results
    make explicit, that broken test case 5.2.0 (no content type) is actually equivalent to a binary mime type

M	tests/http.test

commit 2aa280fe0d2c03ed530caf058e987c235b122a6c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-17

    extend regression test and make differences more clear
    add testConstraints binaryMismatch and broken for problematic cases

M	tests/http.test

commit 1762d1f5b71c1b40e9f6cdb05b79d65576199198
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-16

    improve man pages

M	doc/src/naviserver/ns_crypto.man
M	doc/src/naviserver/ns_rand.man

commit 3ee678b524379d678bc689d8c9178a6cfed67a92
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-16

    added macro NS_INLINE to achieve higher portability with (older?) Microsoft compilers

M	include/nscheck.h
M	nsd/sock.c

commit 3603e69c9c86421347feae9a68a340085b66185b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-16

    add missing NS_EXTERM (as noted by Andrew Piskorski )

M	include/ns.h

commit 94f9a40e944d030eb4907f800f001ba276f8c7fe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-16

    fix typo (as reported by Andrew Piskorski)

M	nsd/sockaddr.c

commit 48ef7e990bf9a4e6b64e31334f76c393f0109297
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-16

    new global parameter "sanitizelogfiles", per default turned on
    
    If data entered into a log file containing special characters (e.g. end line characters),
    these could alter the appearance of content within the log file. Single entries may
    appear as multiple entries. Attackers may leverage log forging to insert fake entries to
    that obfuscate malicious acts, or these can confuse log-file analyzers to avoid
    analysis.
    
    New flag "-sanitize true|false" for "ns_asynclogfile write".
    The global parameter sanitizelogfiles is used as default sanitize.

M	nsd-config.tcl
M	nsd/driver.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit a08ae610c6f20b0dd26869370b8b283e14252d2f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-16

    improve comment

M	nsd/tclobjv.c

commit ef9943420b4800702a55c00160bbb48d55ef82ce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-16

    in include *xml* and *json* in non-binary MIME types

M	nsd/mimetypes.c

commit 02b354117676acb4cd01cae0c22e5372fcbc5bcb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-16

    Make the regression tests pass by
    a) removing the explicit testcase showing the difference between the ns_http regression test infrastructure and the old one (http-3.3new), and
    b) by using for test case http-5.5 as well the old test case infrastructure (use nstest::http-0.9 instead of nstest::http). This difference
       shows only up under Linux, but not on macOS

M	tests/http.test

commit ccef448e926c121b55cacfbe00963ee5dcc6dd85
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-16

    - New feature: context filter for urlspace
    
      NaviServer's urlspace a trie data structure used for various
      purposes such as registering methods/URL pairs for procs or for
      mapping of requests to connection thread pools. The classical trie
      mapping for e.g. "GET /foo/bar/*.html" is based on method + path +
      string match pattern, where the last part "*.html" is used as a
      "filter". The new version of NaviServer allows in addition to the
      string based glob pattern so-called "context filter", which include
      the IP-address or header fields in the matching process. The context
      filters are applied after the classical URLspace processing, such
      that the behavior is fully backwards compatible. The context filters
      are kept in a stable order (IP before header based filters, specific
      before less specific) such that the behavior is not order dependent.
    
      The new feature can be used map e.g. bots or certain IP ranges to
      the specified connection pools. When connection pools named "bots"
      and "local" are defined, one can use the following mapping commands
      to map incoming requests to the specified pools.
    
       ns_server -pool bots map "GET  /* {user-agent *bot*}"
       ns_server -pool bots map "GET  /* {user-agent *crawl*}"
       ns_server -pool bots map "GET  /* {user-agent *baidu*}"
       ns_server -pool bots map "GET  /* {X-NS-ip 2a03:2880::/29}"
       ns_server -pool local map "GET /* {X-NS-ip 127.0.0.1}"
       ns_server -pool local map "GET /* {X-NS-ip 137.208.1.0/16}"
    
      Note that arbitrary header fields can be used for the mapping,
      containing potentially some glob style match characters. The special
      header field "X-NS-ip" denotes IP based filters, which can be provided
      fully qualified or in CIDR notation (denoting significant bits) for
      IPv4 and IPv6.
    
      Current limitations: only for inherited patters, no "exact" feature,
      no deletion of a single filter via "ns_urlspace unset" (only "-allfiters"),
      only one constraint per rule, documentation not updated.
    
    - Defined typedef for free-procs "Ns_FreeProc" (more self explanatory
      than the previous usage of "Ns_Callback")
    
    - Use existing types "Ns_IndexCmpProc" and "Ns_IndexKeyCmpProc"
      consistently
    
    - Defined debug option "Debug(urlspace)" for urlspace debugging
    
    - Include "default" for the default pool name in the thread name
      (this eases the analysis of log files)
    
    - New API functionNs_SockaddrMaskedMatch() to check, whether
      an IPv4 or IPv6 address matches a provided masked address.
    
    - Extended regression test

M	include/ns.h
M	nsd/cache.c
M	nsd/driver.c
M	nsd/index.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/queue.c
M	nsd/sockaddr.c
M	nsd/url2file.c
M	nsd/urlspace.c
M	nsperm/nsperm.c
M	tests/ns_server.test
M	tests/ns_urlspace.test

commit 66bed817867fddc79f001d22c87723107c712e86
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-15

    improve man page

M	doc/src/naviserver/ns_server.man

commit b3476b496a3e604941c7329cb36828f10f6fa2c3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-13

    new function Ns_SockaddrParseIPMask: factored out code from nsperm module to make it reusable

M	nsd/sockaddr.c
M	nsperm/nsperm.c

commit 9af5d2aa9960a05f914c1a402af5b35f58694ffd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-12

    remove debug line

M	nsdb/dbinit.c

commit 6826bbca913740849f6fc7442e5e355bd73df9d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-09

    add bytes sent to the dict of the per-pool statistics "ns_server .... stats"

M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c

commit f7b526c00828323b4991d379ff8a29ceb191d405
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-08

    refine bandwidth adjustment heuristics: never reduce bandwidth by more than 50% in one step

M	nsd/driver.c

commit ba719141c85258af69fd0e4a2d0a0291426a1c57
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-08

    allow full rate per thread for a idle pool

M	nsd/driver.c

commit 69d1f1d73b2fa1fb59a9116ef60d9d6f86608245
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-08

    don't use first write to tcp buffer as real write, require more than a buffer written to start metering

M	nsd/driver.c

commit bb2783cfb80def36affee7be55969b27b86914e4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-08

    improve log entry

M	nsd/driver.c

commit b4eb888482ed750a777b30ef328a0ef1bb014d50
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-08

    improve log entry

M	nsd/driver.c

commit e2f8bad6594e87f065c5e185f731966c57bf6034
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-08

    improve log entry

M	nsd/driver.c

commit f0cb024ef624a3ead52ab222438bd64fe491892c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-07

    use ns_http as well for test cases with explicit specification of the host header field

M	tests/ns_conn_host.test
M	tests/ns_pagepath.test
M	tests/ns_serverpath.test
M	tests/testserver/modules/testhttps.tcl

commit ce3a79d81280e02f27abb80da6413a019197da2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-07

    move most of test setup from low-level socket I/O to "ns_http".
    
    Cases, where "ns_http" cannot be used yet are still using the old interface
    named now "nstest::http-0.9". These test cases contain
    - invalid requests and HTTP/0.9 requests (hence the name)
    - test cases passing the "Host:" header field
    - test cases which specify the encoding
    - some chunked cases

M	tests/encoding.test
M	tests/http.test
M	tests/http_byteranges.test
M	tests/http_chunked.test
M	tests/http_keep.test
M	tests/https.test
M	tests/ns_adp_compress.test
M	tests/ns_conn_host.test
M	tests/ns_pagepath.test
M	tests/ns_serverpath.test
M	tests/ns_urlencode.test
M	tests/tclconnio.test
M	tests/tclresp.test
M	tests/testserver/modules/testhttp.tcl
M	tests/testserver/modules/testhttps.tcl

commit e0002571cac4ba234857e7c5a655d7fc2a501660
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-07

    reduce verbosity

M	nsd/sock.c

commit 1f01fba6d8f39ede9138ea2f40108400ddd23a37
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-07

    adjust tests due to different testserver config setup

M	tests/ns_driver.test

commit 42250a86699067d84a191f40a73180a37dd6e67d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-07

    integrate https tests with other tests in the main test directory

M	Makefile
A	tests/https.test
M	tests/test.nscfg
A	tests/testserver/etc/openssl.cnf
A	tests/testserver/modules/testhttps.tcl

commit ffe030533769ba1c316d5cb5dfa011f3d0048f05
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-07

    break overlong lines

M	nsd/urlspace.c

commit 32926c611a6d0b03e74867bee2304abf1133de15
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-06

    replace deprecated calls to "ns_http wait" with result and status variables

M	tests/http.test

commit ee42665aa2792bec4e5262f936089250c0eec88f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-06

    - New feature: download bandwidth management per connection pool (specified as kilobytes per second)
    
      Similar to the recently introduced per-connection bandwidth management,
      one can now as well bandwidth management per connection pool.  By using
      this features the total bandwidth of all currently running connections
      can be limited to some maximum value.  The rate limitation is only
      active, when writer threads are used. Per default, the pool rate
      limitation is turned off (value 0).
    
      New configuration option for connection pools
         ns_param poolratelimit ....
    
    - The command "ns_writer list" returns now the current
      transfer rate and the rate limit per writer job.
    
    - new API infrastructure: Ns_DList
      The Ns_DList ist similar to Tcl_DString, but operates on pointers
      instead of characters. Like Tcl_DString, Ns_DList pre-allocates
      some data and extends it when necessary. Ns_DList structures
      are especially useful alternative to linked lists, when usually
      data is added to the end. Since the data is kept as a dense
      (potentially growing) array, the memory locality is much better
      than linked list, resulting in better CPU cache hit rates. This
      is actually a port of the structure, using since many years
      in the NSF framework.

M	NEWS
M	doc/src/manual/admin-tuning.man
M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_crypt.man
M	doc/src/naviserver/ns_hmac.man
M	doc/src/naviserver/ns_hotp.man
M	doc/src/naviserver/ns_md.man
M	doc/src/naviserver/ns_md5.man
M	doc/src/naviserver/ns_parsefieldvalue.man
M	doc/src/naviserver/ns_server.man
M	doc/src/naviserver/ns_sha1.man
M	doc/src/naviserver/ns_totp.man
M	doc/src/naviserver/ns_writer.man
M	nsd-config.tcl
M	nsd/Makefile
A	nsd/dlist.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c
M	nsdb/doc/mann/ns_db.man
M	nsproxy/doc/mann/ns_proxy.man
M	openacs-config.tcl
M	sample-config.tcl.in

commit 02dd3da5d33e24ed109430cbe0c1d8ccf23aa95b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-04

    WSASend receives as 5th argument flags, but not a pointer to flags.

M	nsd/sock.c

commit 547253b142c82547f022f95d3cefa7b52b474bac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-04

    Define Retry as pure inline function
    
    Defining Retry as an inline function rathen than a macro to
    avoids potentially multiple calls to GetLastError(), which
    is used for "ns_sockerrno" under windows

M	nsd/sock.c

commit ed5bbf34fb107cf4cc8e52b97c76dcbba6135b43
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-04

    fix confusing variable name

M	nsd/sock.c

commit 371910cc55ff6275bf212761e3bc9a0130330226
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-03

    cleanup for gcc8

M	nsd/driver.c

commit 32eda05f6edb2d74713390977898eb443b4c8816
Merge: a9c60abd 5ce1b356
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-03

    merge

commit a9c60abdc012d7ae2dd397cbdbb8dd4e1cb603b3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-03

    New feature: limit download rate to a maximum (specified as kilobytes per second)
    
    On servers with relative bad internet connections, it is possible that
    a few eager downloaders use up all available bandwidth. NaviServer
    allows now admins and developers to specify the maximum outgoing
    bandwidth per connection. The rate limit can be specified per
    connection (highest weight) or per connection thread pool (second
    highest weight) or per network driver. The rate limitation is only
    active, when writer threads are used. Per default, the rate
    limitation is turned off (value 0).
    
    Note that when a rate limit is specified per connection pool, it
    defines the default for every connection in this pool and not the
    total bandwidth for this pool.
    
    New option for ns_conn:
       ns_conn ratelimit ?limit?
    New configuration option for connection pools
       ns_param ratelimit ...
    New configuration option for network drivers
       ns_param writerratelimit ...

M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/admin-tuning.man
M	doc/src/naviserver/ns_conn.man
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c
M	nssock/doc/mann/nssock.man
M	openacs-config.tcl
M	sample-config.tcl.in
M	tests/ns_conn.test

commit 5ce1b35662a35e66ba649ba45539dc876b984e4a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-03

    Make ns_conn copy doc more precise.

M	doc/src/naviserver/ns_conn.man

commit b1564bac2d4968379cc68322c88c487fc3b90084
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-03

    Fixed SockSend() et al. to uniformly handle retry cases.

M	nsd/sock.c

commit 582a5ac4d163fbfaadd1abc3a1b1aa2fe4378042
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-03

    ns_poll checks SOCKET_ERROR explicitly.

M	nsd/nswin32.c

commit 23b3bc62432eadcebc4faf95a10a6ff015bda6df
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-07-03

    Improve comments w.r.t zero return value for retries.

M	nsd/driver.c

commit c4b3aeb0998202ba9e4757219f50025f41ab99d4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-07-01

    add missing NS_GNUC_NONNULL

M	nsd/sockfile.c

commit 7c71690caafb0dfe07f38d484ec9437db4c4b7bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-30

    let the driver decide via flag NS_DRIVER_CAN_USE_SENDFILE whether or not plain sendfile() can be used

M	include/ns.h
M	nsd/driver.c
M	nsd/sockfile.c
M	nssock/nssock.c

commit b48804bfa839e208903c7c879dbafc26d0f5d1fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-30

    make adding of tests of nsssl conditional depending on the availability of OpenSSL

M	Makefile
M	include/Makefile.global.in

commit 01d36784f644b09c9a80a8d894f2a6509d8a74c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-29

    modernize tests to reduce deprecated messages

M	nsssl/tests/modules/testhttps.tcl
M	nsssl/tests/nsssl.test

commit 469472f54d6392378411692f322fb899a2736a5f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-29

    add nsssl to the default test target

M	Makefile

commit b8aebdcc6674cdcdcdc192573cbbfcaccb7d9e76
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-29

    fix bug for small file requests (below writersize) via nsssl

M	nsd/sockfile.c
M	nsssl/tests/nsssl.test

commit 92c4bac7b8e5cdd2b0f581d321208294d428f131
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-29

    fix typo in test

M	tests/ns_cache.test

commit 977fc620ad702d47135b3c5983261cec0a73807b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-29

    reflow overlong lines

M	nsssl/tests/nsssl.test

commit 23341ba8ce4e8c56644f1185f0948e53cf8ddad1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-29

    use recommended configuration for testing

M	nsssl/tests/config.tcl

commit 5858d33787e077d28f2029306a94b9b64a5b13ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-25

    added -DSYSTEM_MALLOC to default compile flags

M	m4/tcl.m4

commit 2a537497b9046f12263594e6b1d2943ffa5b4e2d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-24

    HTTPS driver cleanup:
    - Added API call Ns_SockInErrorState() since
      SSL_shutdown() must not be called if a previous fatal error has
      occurred on a connection i.e. if SSL_get_error() has returned
      SSL_ERROR_SYSCALL or SSL_ERROR_SSL.
    
    - provided local buffers for OpenSSL ERR_error_string handling to
      avoid potential race conditions (OpenSSL keeps otherwise error messages
      in static memory)
    
    - made naming conf variable of type SSLContext consistent.

M	include/ns.h
M	nsd/sock.c
M	nsd/tclobjv.c
M	nsd/tls.c
M	nsssl/nsssl.c

commit d3261f2c2e89f97547837740e3975919484b51ce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-23

    improve spelling

M	nsd/tclhttp.c

commit 72bf09a09e590baaf1f66be49994363dc6341f40
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-23

    improve spelling

M	nsd/driver.c
M	nsd/tclcrypto.c

commit c2d0dda3baf85577a5205cd63be166e99f643556
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-23

    Driver cleanup
    
    - Improved code locality in driver.c to avoid potential confusion between
      SockState (as used in driver.c) and Ns_SockState
      (as used e.g. sock.c, task.c and tclhttp.c)
    - Provided human readable stock SockStates

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c

commit dce26c62c9695af73f8d6b899e29ea28a4b18eba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-23

    allow useless case (write with length 0) to provide backward compatibility

M	nsd/conn.c

commit 41c84edaa81850dbb329b412f1e949efd88af51d
Merge: d0d97795 20185db5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-20

    merge

commit d0d9779566525dfe74d66d6a2ad42c3d239969ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-20

    New command: ns_parsefieldvalue
    
    This function parses the provided field value (from an HTTP request or
    reply header field) into its parts and returns these in the form of a
    list of Tcl dicts or a single Tcl dict depending on parameters The
    syntax of the contents of these header fields is specified in RFC 7230
    section 3.2.6.
    
           Forwarded: for="_gazonk"
           Forwarded: For="[2001:db8:cafe::17]:4711"
           Forwarded: for=192.0.2.60;proto=http;by=203.0.113.43
           Forwarded: for=192.0.2.43, for=198.51.100.17

M	doc/src/naviserver/commandlist.man
A	doc/src/naviserver/ns_parsefieldvalue.man
M	doc/src/naviserver/ns_parseheader.man
M	doc/src/naviserver/ns_parseurl.man
M	nsd/Makefile
M	nsd/nsd.h
M	nsd/tclcmds.c
A	nsd/tclparsefieldvalue.c
A	tests/ns_parsefieldvalue.test

commit f19d1e3072057e9a880f90edaf1695699a98a08c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-20

    add regression test for ns_rand

A	tests/misc.test

commit cf0678716d22cf796eb56ad6dc6c061fcafc3cc4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-20

    ns_rand: fix index value of Ns_ParseObjv()

M	nsd/random.c

commit 20185db50100c9b4c082d2ba8c315284fbcc524a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-19

    Fixed parsing ns_roll command.

M	nsd/tclfile.c

commit a40d30c6b33c9fc7cd8334e2400aea652484c344
Merge: e5fa2127 c31d3a0c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-19

    Merge Ns_SockListenCallback API change

commit e5fa2127f93191968a650ee450b30f5eee5d9c09
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-19

    Fixed edge cases for body uploaders when files get truncated
    while we send them, or somebody passes wrongly positioned channels.

M	nsd/tclhttp.c

commit c31d3a0c4ef60b79c542cacbdc66c9cb53428faa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-18

    fix prototype of Ns_SockListenCallback in ns.h (many thanks to Maurizio Martignano)

M	include/ns.h

commit f8b1f2341816c9b3d9c127e6ce3a7d77ea13fb8f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-18

    Fixed broken handling of body payloads > 16K
    and payloads from truncated files or channels
    positioned on the wrong byte w.r.t passed bodySize.

M	nsd/tclhttp.c

commit 16b7ce0cca81affc3f6ef9b66cfcf29efcefda69
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-18

    Better handle/log SSL_ERROR_SYSCALL cases.

M	nsd/tls.c

commit 21a5a3751739c0ab84ce2a350eaf1d991feb57fa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-18

    document usage of connection pools in config files

M	openacs-config.tcl
M	sample-config.tcl.in

commit 768d65e795b174094ef065663c80d57e9c247ca9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-15

    add range-checks for Long and WideInt and improve error messages

M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsmain.c
M	nsd/queue.c
M	nsd/tclhttp.c
M	nsd/tclobjv.c
M	nsd/tclset.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	tests/http_byteranges.test
M	tests/ns_hashpath.test
M	tests/ns_server.test

commit b8fea238c3526029382c32c7b3257516495c732b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-15

    Add Range checking in the style of Ns_ObjvInt to Ns_ObjvLong and Ns_ObjvWideInt.
    
    Next steps: check usages if these functions (and Tcl_GetLongFromObj()
    and Tcl_GetWideintFromObj()) to add range checks if necessary.

M	nsd/tclobjv.c

commit ee668b2023954c5dfbce3cdac8df6bfdf0150089
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-15

    fix all cases, where Tcl_GetIntFromObj() was used without a range check.
    Switch to Ns_ParseObjv() on more occasions.

M	doc/src/naviserver/ns_conn.man
M	nsd/adpcmds.c
M	nsd/conn.c
M	nsd/log.c
M	nsd/pathname.c
M	nsd/random.c
M	nsd/tclsched.c
M	nsd/tclset.c
M	nsd/tclvar.c
M	tests/adp.test
M	tests/ns_hashpath.test
M	tests/ns_schedule.test

commit 45eb6e4758747b5d8850cd5f0852d1102e9c9781
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-15

    new feature for Ns_ParseObjv: optional range checking for Ns_ObjvInt
    
    It is now possible to provide a range for positional and non-positional
    arguments of type Ns_ObjvInt, which is checked already during Ns_ParseObjv.
    This leads to uniform behavior, more thorough checking, and uniform
    error messages.
    
    By this changeset various potential crashes were fixed, when e.g.
    passed-in values are used as array-indices (crash on negative numbers)
    or where the values were casted to unsigned types (very high
    unsigned values, potential memory alloc problems).

M	include/ns.h
M	nsd/adpcmds.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/limits.c
M	nsd/queue.c
M	nsd/tclcrypto.c
M	nsd/tclfile.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/urlspace.c
M	nsdb/dbtcl.c
M	tests/http.test
M	tests/ns_limits.test
M	tests/ns_reflow_text.test
M	tests/ns_schedule.test
M	tests/ns_server.test
M	tests/ns_urlspace.test
M	tests/tclresp.test

commit 1f146259fc2336e2f865a451b7a308ca02c57d00
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-15

    improve spelling

M	nsd/tclhttp.c

commit a0bd0eca7e6b1cc67db0c8ae496863786a1895dd
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-14

    Make -body_size optional for seekable channels. Updated docs with some hints
    about passing Tcl channels.

M	doc/src/naviserver/ns_http.man
M	nsd/tclhttp.c

commit 485930272515fb879c0f354f744cb7ec94da9a98
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-12

    bug-fix: initialize always optional parameters

M	nsd/tclhttp.c

commit ab6f2f23992e0d2dc3d88c36d027dd03920f322a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-12

    improve spelling

M	nsd/nsd.h
M	nsd/task.c

commit ca21477bd26a41c31fccfffe0d5d5f27cbce33cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-12

    improve spelling, reduce variable scope

M	nsd/tclhttp.c

commit 3324149e5267e561e70c022dcf349c341dcf02f7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-12

    improve spelling

M	doc/src/naviserver/ns_http.man

commit 1f3faabf69be470d2dac7ff2570cb1ebddd52d28
Merge: b48c385e 35ceb3fe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-12

    merge

commit b48c385e5a0b035a275f2094dd10ad8a2f08fc1b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-12

    new command ns_asynclogfile: facility for writing log files of various kinds, using the AsyncWriterThread.
    
    Usage example:
        set fd [ns_asynclogfile open /tmp/test.log]
        ns_asynclogfile write $fd hello\n
        ns_asynclogfile close $fd

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/tclcmds.c

commit c2c1f3f46c17c1542c6cf77af13bd54364bf77ef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-12

    add instrumentation to ease debugging

M	tests/http.test

commit 77424b3b994c16c0696d6de5b8290cd315a46ddd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-12

    whitespace change

M	nsd/tclmisc.c

commit 7f8c6b89294a4193b7eaf82c5a948c64e12c760c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-12

    improve configurability of clang-tidy

M	Makefile

commit 35ceb3fe1084b68af6c5495227aa1e6e1d58ee14
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-11

    Fixed typos

M	doc/src/naviserver/ns_http.man

commit b0b0ee36bca3c7e9fe718bfa9275c47e7c87f29b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-10

    Finished ns_http rewrite. Added some docs, tests.

M	doc/src/naviserver/ns_http.man
M	nsd/tclhttp.c
M	tests/http.test

commit 44be0d89e22fc512e1ddce900d1d9bd2aa6e93bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-10

    minor code cleanup:
    improve padding, remove redundant casts and const declarations for unused arguments

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/adprequest.c
M	nsd/binder.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/queue.c
M	nsd/unix.c
M	nsproxy/nsproxylib.c

commit 7fe612a79c12c2231dddb530d3a056a9279b465b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-09

    Fixed internal comments

M	nsd/tclhttp.c

commit d42df28b315251770d64c4a6c89fd9d1ae00cd6a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-09

    Merged to the tip. Fixed various conflicts. Fixed ns_http post with
    body as file/channel. Updated ns_http man page (work still in progress).

M	doc/src/naviserver/ns_http.man
M	nsd/sock.c
M	nsd/task.c
M	nsd/tclhttp.c
M	nsd/tls.c
M	nsssl/nsssl.c

commit eaf9c2a2816a07b5afbbc7dd9eebe6ad7f0ca0ae
Merge: 05944bd4 68cfcb24
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-09

    Merge 5832 head.

commit 05944bd42eac75e3a5821e7dd07662e760ed486f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-09

    Added refCount based Task reservation and cleanup.

M	nsd/task.c
M	nsd/tclhttp.c

commit 8805164ca09027bce4ecc56dab1157b23b82e757
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-09

    Moved Ns_TaslProc signature back to (void) return value

M	include/ns.h

commit af5acf9b6a89ae41fe23a7dc776631cb88c62f14
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-07

    First updates for ns_http man page (still pending).
    Changed API for Ns_TaskProc from void to int as to
    be able to check whether the proc garbage-colltected
    the taskPtr.

M	doc/src/naviserver/ns_http.man
M	include/ns.h
M	nsd/task.c
M	nsd/tclhttp.c

commit 69a401df8a413d5b4db2669dff227a6098ca67e3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-07

    memory allocated by Tcl has to be returned by Tcl

M	nsd/nsmain.c

commit b893023c5c5941719b152ac7e2db1692bbbff50b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-07

    Updated NsHttpTask elements - added recvSpoolMode.

M	nsd/nsd.h

commit 68cfcb24825862287df6d54b5a7f6553f934985e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-06

    improve documentation

M	doc/src/naviserver/ns_crypto.man
M	doc/src/naviserver/ns_register.man

commit d46ba7c7ccb04dad15763d05f4dcc7b97b1b70bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-05

    provide compatibility with LibreSSL 2.9 (tested with LibreSSL 2.9.2)

M	nsd/nsopenssl.h
M	nsd/tclcrypto.c

commit f4a453b3e48e19e5f60449a906f96404904e10da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-04

    fix potential invalid reads in cases, where LogConnchanDebug is enabled
    and the callback is deleted during a Tcl_Eval().

M	nsd/connchan.c

commit baddba4b2f1d17dede5fea1c73cafb1e571a27b0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-04

    Revamp of ns_http and related supportive code.
    Fixed some descriptor leaks, memory leaks, double-frees
    improved comments, simplified code, unified debug logs
    and added tons of other minor and major style fixes.

M	nsd/sock.c
M	nsd/task.c
M	nsd/tclhttp.c
M	nsd/tls.c

commit 1960fd0ab4b4335c31e54e9aadf54c2e574793fc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-06-04

    Improved comments for some NsHttpTask elements.

M	nsd/nsd.h

commit b945a5a331045ac4306d60b4a5539496b2d22bdf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-02

    avoid potential double free of tasks

M	nsd/tclhttp.c

commit 486247b37af5299b18920bffdf7536a4848e8537
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-02

    add debug lines for Ns_TaskDone and Ns_TaskFree

M	nsd/task.c

commit 3ab5be3fcc398c14ba9e32e5d2874c4b8a290457
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-02

    add additional PURE flags

M	include/ns.h
M	nsd/tcljob.c

commit 00f63d222f0160cef05ded4a9480964dea0d704a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-02

    remove debug output

M	nsd/driver.c

commit 08060818f6d94a3b91b683ffdd356242f8fde797
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-02

    add additional warning flags for tidy checks

M	include/Makefile.global.in

commit b3c5527b20eb8cbb32ffdcc7a51d92dd6db7b3cf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-02

    avoid potential string truncations (without terminating NULL)

M	nsdb/dbutil.c
M	nsperm/nsperm.c

commit f5b84da302efcb1bc850e1d127fe8e57379fc6a0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-02

    make sure to initialize sockState for error cases

M	nsd/tclhttp.c

commit eadf773f8136e615442d6bc704c169aede3241e2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-02

    silence gcc 7+ on FC29: use attribute based approach for denoting fall through in case statements

M	include/nscheck.h
M	nsd/adpeval.c
M	nsd/auth.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/info.c
M	nsd/log.c
M	nsd/op.c
M	nsd/queue.c
M	nsd/sock.c
M	nsd/tclcrypto.c
M	nsd/tclset.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsd/tls.c
M	nsdb/dbtcl.c
M	nsdb/dbutil.c
M	nsthread/winthread.c

commit 08a50deccf9810b0a307b97fcd9343f3d78ea499
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-02

    sock is already properly initialized with NS_INVALID_SOCKET for fail cases

M	nsd/tclhttp.c

commit 9dabd6fc5bf8d0a8e6311e9c89578decd67988f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-02

    removed dead store

M	nsd/sockfile.c

commit 956019a3d844ac4162e470130fc83b0a8f878a4b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-02

    remove tautological assert

M	nsd/driver.c

commit f93040dce068fe3e8b77088a36668e43a9dfcfe0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-01

    Sock receive/send reform (part 2): Provide low-level
    interface (NS_SOCKET, SSL) with common result semantics,
    used in drivers, nssock and task interface.
    
    Ns_SockSendBufs2()
       called by sock.c (Ns_SockRecvBufs, sendProc), tclhttp.c
    Ns_SSLSendBufs2()
       called by nsssl.c (sendProc), tclhttp.c
    
    Ns_SockRecvBufs2()
       called by sock.c (Ns_SockRecvBufs, recvProc), tclhttp.c
    Ns_SSLRecvBufs2()
       called by nsssl.c (recvProc), tclhttp.c

M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sock.c
M	nsd/tclhttp.c
M	nsd/tls.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit e931ed501b6ecfd9d003f4a82c224bfeba367840
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-06-01

    reduce variable scope

M	nsd/connchan.c

commit 1aee7a10a4cb82a21786ea8b65966c45e2a592a5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-05-31

    Move NS_EWOULDBLOCK to EWOULDBLOCK for Unix-only code.

M	nsd/sockfile.c

commit 656d59bb088c7d61e742b0f74f5690b68eafa307
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-05-31

    Move NS_EWOULDBLOCK to EWOULDBLOCK as we are on unix anyways.

M	nsd/unix.c

commit 086449aa5bf47eb94a39fc3686c8eef98fa98553
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-05-31

    Added Ns_HttpTask as NsHttpTask.

M	nsd/nsd.h

commit e8978e5d7646b306bc0bc1e5c5800c4c3b889eba
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-05-31

    Moved Ns_HttpTask to nsd/nsd.h into NsHttpTask
    as this one is never used elsewhere and the
    whole API is used just from the Tcl wrappers.

M	include/ns.h

commit d27aa543117abd6bb654233522d1e09dd223d977
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-05-31

    Added NS_EAGAIN as WSAEWOULDBLOCK/EAGAIN for Win/Unix.

M	include/nsthread.h

commit baecf047b441ea83984ad11cf0bb801112fb7c76
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-05-31

    Cleanup, document, enforce right column, reorganize.

M	nsd/task.c

commit bf92a913d38a2d966947b063a13714969f45902c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-05-31

    Whitespace fix.

M	nsd/connio.c

commit abe7e831000b7a1533485579fe15808fe66fa447
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-29

    - improve receive timeout handling (reduce setup cost)
    - use abstracted state instead of receive-value/errno guessing in the driver (important for OpenSSL)

M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h

commit 36d3845ac6b8eeb8cf1652bf47a6ced26b01632b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-29

    Sock receive reform (part 1):
    - New function NsDriverRecv() similar to NsDriverSend()
    - Use NsDriverRecv() by nsconnchan instead of a local function.
    - Align interfaces of Ns_SockSendBufs() and Ns_SockRecvBufs(); both calls
      receive now Ns_Sock * structures.
    - report Ns_SockState back from Ns_SockRecvBufs() (potential values
      NS_SOCK_READ, NS_SOCK_DONE, NS_SOCK_AGAIN, NS_SOCK_EXCEPTION,
      NS_SOCK_TIMEOUT) and keep it in the Sock structure
    - Missing:
      * using explicit Ns_SockState instead of trying to guess
        states from return length and error codes.
      * using NsDriverRecv as well in http tasks.
      * handling of default timeouts in driver
      * timeout handling for nsssl recv?

M	include/ns.h
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sock.c
M	nsd/tclhttp.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit d0b137d22e78a552e2e6cdcc82865da3ede78d2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-29

    prefer NS_EWOULDBLOCK over EWOULDBLOCK for better windows compatibility

M	nsd/sockfile.c

commit 220f2f48d47a5dbd782211ba049423a5fa01644d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-27

    make NaviServer fully clean in respect to conversions from function pointers to object
    pointers (which is forbidden by ISO C).

M	nsd/modload.c

commit 99e83cfad8ec3d88cce71e67e875df92ba27cead
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-26

    compute size of function pointer hash entry precisely

M	nsd/proc.c

commit 10f1bdc1f04ef4dde00862d39435514ef4f78c58
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-26

    make proc.c now fully clean in respect of handling with function pointers

M	nsd/proc.c

commit 420d0a4666dbe945ff42ba5bc228fe78e225959f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-26

    create a hash type for function pointers, since ANSI C forbids casting/comparison
    of data and function pointers. The functions are similar to these in NSF.

M	nsd/proc.c

commit b762c1b0a83c54471a09fc091dc0b972906a132e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-26

    improve naming

M	nsd/tclsched.c

commit e66829b1cef1220482c4b8c28c73efe4a6ffbbe7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-26

    make testing for existing request structure precise

M	nsd/conn.c

commit b38cd7f1171cc49527d80072079736f2c6fd974c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-24

    make clear that request is always initialized in OK cases.

M	nsd/conn.c

commit 6e74cc03e1afeef8c1c69b0f41de7018d5d18340
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-24

    improve spelling

M	nsd/tclcrypto.c
M	sample-config.tcl.in
M	tests/testserver/modules/testhttp.tcl

commit 9d8022e6119386803d2189cb2501ec22b1d88d0d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-22

    distinguish between Ns_NormalizePath and Ns_NormalizeUrl

M	include/ns.h
M	nsd/pathname.c
M	nsd/request.c
M	nsperm/nsperm.c

commit 1b3779a3b2d1001fbb6f11fefb600339aa6bb69f
Merge: 92c5c36c 8df83347
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-16

    merge branches

commit 92c5c36ccaf9c6f6b17690ff57f945c36deca404
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-16

    improve formatting of man page

M	nscp/doc/mann/nscp.man

commit 6375af98e1a837c67007e5e024e349ad4bf8b89f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-16

    modernize sample command to generated self-signed certificates
    
    Background: some browser complain already when SHA1 is used

M	nsssl/doc/mann/nsssl.man

commit 8df833477fca1665c975cb06ce05702e390b980a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-05-06

    Removed unreferenced variable.

M	nsd/connio.c

commit e023db48fb7eac07d05810d5eccd4669802c20d5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-05-06

    Re-added lost changes w.r.t Ns_ConnSendFileVec that was
    returning NS_ERROR all the time.

M	nsd/connio.c

commit fed5528d72421aa3470bfa133efbed45aafe3781
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-06

    further cleanup of function pointer conversions

M	include/ns.h
M	nsd/log.c
M	nsd/modload.c
M	nsd/sched.c
M	nsd/tclsched.c
M	nsdb/dbinit.c
M	nslog/nslog.c

commit 35b37881b0d50f557ee94bb2a70c0301a5dc6524
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-06

    use ns_funcptr_t to silence type conversion warning in newer gccs (e.g. gcc9)

M	nsdb/nsdb.h
M	nsdbtest/nsdbtest.c

commit 186a1b17a0594d1e230424d7c2d1f6e73addd548
Merge: 662c5d50 f93e741e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-05

    merged changes

commit 662c5d500a47d96e45e4c40f7205d17c8509a2e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-05

    NsConnRequire reform
    - add additional argument to NsConnRequire() to specify
      detailed requirements (NS_CONN_REQUIRE_CONNECTED, NS_CONN_REQUIRE_OPEN,
      NS_CONN_REQUIRE_CONFIGURED, NS_CONN_REQUIRE_ALL)
    - this makes it possible to query information about connections also
      when these are "closed" (e.g. detached)
    - extended regression tests to cover such cases

M	nsd/conn.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/tclfile.c
M	nsd/tclinit.c
M	nsd/tclresp.c
M	tests/ns_conn.test

commit e9cd39e72e326df3b42fbda35629eda91febfe0c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-05

    improve variable names

M	nsd/connio.c
M	nsproxy/nsproxylib.c

commit 4a917a4a67a35f5e42138ff7bab8642a967a2abe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-05

    merge changes

M	include/ns.h

commit a447559c27f24332004eca7722603948b7a1579f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-05

    extend regression test for ns_connchan to cover more cases, where someone tries to write to detached connection

M	tests/ns_conn.test

commit c4102e4727e059562909d243f40428ee3b447313
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-05

    delete code, which was commented out

M	nsd/queue.c

commit 9b5dc1a2e2951c0e3b0a9102674aa9f656665d35
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-05

    fix indentation of comments

M	nsd/uuencode.c

commit ebc5cc4922afb980db59595e7eb9a392d4a3cc86
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-05

    improve comments

M	nsd/conn.c

commit b17b7894c25aa3445a36f41ba9680d10d675ea4a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-05

    prefer more precise error message from NsConnRequire()

M	nsd/conn.c

commit f93e741e66c6e37f2a6f26457b39aaec3f6f415a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-05-03

    Added Ns_ConnIsClosed() macro.

M	include/ns.h

commit e2e6e242684b768904a223a4db193476b417c53c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-05-03

    Fixed Ns_ConnSendFileVec that was returning NS_ERROR always.

M	nsd/connio.c

commit fe46c2823d7cb74a0eda68225ad7da770d3b860a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-03

    chonnchan: handle the fact that a sock is detached via connchan command the same way as for writer threads
    (detectable via "ns_conn isconnected", avoid potential crashes)

M	nsd/connchan.c

commit 42cbb13cd382530343e38fe8a4989fc3683559d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-02

    improve regularity of output of [ns_info threads]
    return always the same number of arguments

M	nsd/queue.c
M	nsthread/thread.c

commit 1ed8c7640c08684d381e66c41efe4864974ea0f9
Merge: 7db277cf 4afe1b33
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-02

    merged sockfile-rewrite branch into main branch ("default")

commit 4afe1b336214f9ee8d1eacc46553abc318e5d756
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-02

    minor cleanup
    
    --HG--
    branch : sockfile-rewrite

M	nsd/queue.c

commit 5d7ebd6228a4837e7734a9c569b3d764536a3966
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-02

    Remove warnings about conversions of incompatible function types
    for Ns_TclNewCallback() when compiling with gcc8 und gcc9;
    
    Cleanup of argument passing for *ConnLocationProc*:
    
    -NS_EXTERN Ns_ReturnCode  Ns_SetConnLocationProc(Ns_ConnLocationProc *proc, void *arg) NS_GNUC_NONNULL(1) NS_GNUC_NONNULL(2);
    +NS_EXTERN Ns_ReturnCode  Ns_SetConnLocationProc(Ns_ConnLocationProc *proc, Ns_TclCallback *cbPtr) NS_GNUC_NONNULL(1) NS_GNUC_NONNULL(2);
    
     typedef char* (Ns_ConnLocationProc)
    -    (Ns_Conn *conn, Ns_DString *dest, const void *arg);
    +    (Ns_Conn *conn, Ns_DString *dest, const Ns_TclCallback *cbPtr);
    
    --HG--
    branch : sockfile-rewrite

M	include/ns.h
M	nsd/conn.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/pathname.c
M	nsd/tclcallbacks.c
M	nsd/tclinit.c
M	nsd/tclrequest.c
M	nsd/tclsched.c
M	nsd/url2file.c

commit 31a4cf7ab80885c0775e1b9a75bfe2606854d6d2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-02

    Remove warnings about conversions of incompatible function types
    for Ns_RegisterProcInfo() and Ns_GetProcInfo() when compiling
    with gcc8 und gcc9; to address the problem, a (new) generic
    function pointer type "ns_funcptr_t" was defined.
    
    --HG--
    branch : sockfile-rewrite

M	include/ns.h
M	nscp/nscp.c
M	nsd/callbacks.c
M	nsd/connchan.c
M	nsd/filter.c
M	nsd/info.c
M	nsd/op.c
M	nsd/proc.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/tclcallbacks.c
M	nsd/tclinit.c
M	nsd/tclrequest.c
M	nsd/url2file.c
M	nsdb/dbinit.c
M	nsdb/nsdb.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c

commit 45b9ad14c7f86bea2f5da4a4b60c13f9389dbfb1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-02

    cleanup of Ns_Log statement
    
    --HG--
    branch : sockfile-rewrite

M	nsd/connchan.c

commit 5ce79a5b88490c20a1997fd2fc44966751ae3e71
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-01

    the preferred spelling of writable is "writable"
    
    --HG--
    branch : sockfile-rewrite

M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_sockcallback.man
M	doc/src/naviserver/ns_sockselect.man
M	include/ns.h

commit 909608c25edc937f103ff5029a30b5e97a5a715b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-01

    the preferred spelling of writable is "writable"
    
    --HG--
    branch : sockfile-rewrite

M	nsd/conn.c

commit 3b440b480c1f074af74aa59adb8c2d8263b6ad12
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-01

    connchan: handle cases, where sendProc returns 0
    
    --HG--
    branch : sockfile-rewrite

M	nsd/connchan.c

commit 1d5c483307f076c78823e6cb6abd203f5782165b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-01

    mark compatibility wrappers Ns_SetThreadServer() and Ns_SetThreadServer()
    explicitly as deprecated. Use Ns_ThreadSetName() and Ns_ThreadGetName() instead.
    
    --HG--
    branch : sockfile-rewrite

M	include/ns.h

commit 2c426e26e830d260b02dd3646d241182751af8fd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-01

    make var arg processing more uniform
    
    --HG--
    branch : sockfile-rewrite

M	include/ns.h
M	nsd/log.c

commit 8a7920dada474e7ed4a720fcae4f62da6430549f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-01

    Let the C compiler check the arguments of printf like function Ns_ThreadSetName()
    
    --HG--
    branch : sockfile-rewrite

M	include/nsthread.h
M	nscp/nscp.c
M	nsd/nsthread.c
M	nsd/sched.c
M	nsd/tclthread.c
M	nsthread/nsthreadtest.c
M	nsthread/thread.c

commit 49ea8969eb666f5456b049c2bfea885e9588fae7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-01

    rename name of main thread back to original value after server-specific initializations
    
    --HG--
    branch : sockfile-rewrite

M	nsd/queue.c
M	nsd/tclinit.c

commit 1947b863da2e158a27faea7812a118a7b703bcd7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-01

    improve variable names
    
    --HG--
    branch : sockfile-rewrite

M	nsd/driver.c
M	nsd/sockcallback.c
M	nsd/tclhttp.c
M	tests/http_byteranges.test

commit d0e1248be8bc8cf7bdf83c8d0c9a71a76da6eba3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-01

    reduce magic constants
    
    --HG--
    branch : sockfile-rewrite

M	nsd/connio.c

commit a1bbcaef823fffbe5889b9119dbe754617701d83
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-05-01

    no need to close INVALID_SOCKET
    
    --HG--
    branch : sockfile-rewrite

M	nsd/binder.c

commit bd1c30ce7e03519e2b8319f5e0567e4650c4d70f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-30

    handle cases better, where writer thread delivers data, but connection
    thread wants still to write on it. This might have happened especially
    in erroneous application code, issuing e.g. two ns_return immediately
    in a row. From the client side, "ns_conn close" is returned, when
    the connection thread can't write to the connection anymore.
    
    --HG--
    branch : sockfile-rewrite

M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	tests/ns_conn.test

commit 3c601cd006743d3e5acda702b7141285f2c8005a
Merge: 8e3af296 e92fd5b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-30

    merge
    
    --HG--
    branch : sockfile-rewrite

commit 8e3af29675175f345bd4a5208c19fa675ea457ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-30

    Pass NULL to ignored timeout argument (which should be dropped)
    
    --HG--
    branch : sockfile-rewrite

M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sockfile.c

commit ca43d5d05d4521a242a3ca4da8c42fb52d7febfd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-30

    reduce variable scopes
    
    --HG--
    branch : sockfile-rewrite

M	nsd/tclresp.c

commit 10f5694a38825442e2b79162c8442728fe97f081
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-30

    re-establish dropped NULL test for writer thread cases
    
    --HG--
    branch : sockfile-rewrite

M	nsd/connio.c

commit e92fd5b53e1470b6c98eb2575c6e7414486cc4e3
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-04-30

    Added M4 macro file for checking sendfile version/type
    
    --HG--
    branch : sockfile-rewrite

A	m4/sendfile.m4

commit 52757ac2be66d8d78173a8bda3fdb749bea1b3a9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-04-30

    Added BSD/Darwin sendfile support.
    
    --HG--
    branch : sockfile-rewrite

M	configure.ac
M	include/nsconfig.h.in
M	nsd/sockfile.c

commit 3bbf4166fbd9fe8f3b827d4661975187dd6082dc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-04-29

    Fixed "nsv_set a b" when no key nor array exist. Added some tests.
    
    --HG--
    branch : sockfile-rewrite

M	nsd/tclvar.c
M	tests/ns_nsv.test

commit 1a77329358d7eb683ee3c92a8ec838f637995b2d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-29

    silence compiler under linux
    
    --HG--
    branch : sockfile-rewrite

M	nsd/driver.c

commit 9376bc3b05d74bca8e9b18f002a06e5cb2d2760d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-29

    perform lookup of virtual hosts in lowercase
    
    --HG--
    branch : sockfile-rewrite

M	nsd/driver.c

commit 827116e2776d4001f8b23925276cee468243ac3e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-28

    prevent potential null dereferences
    
    --HG--
    branch : sockfile-rewrite

M	nsd/binder.c
M	nsd/connchan.c
M	nsd/log.c
M	nsd/tclset.c

commit 5848510b293249224070f35343c1e97167b73625
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-28

    prevent premature nil termation argument
    
    --HG--
    branch : sockfile-rewrite

M	nsd/info.c

commit 60d22d9b4e92971d27236c78d9b3902b96375d3e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-28

    don't shadow outer symbols
    
    --HG--
    branch : sockfile-rewrite

M	nsd/driver.c

commit d9f283903a1efe05bb93e8378094a07a1fbb68df
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-28

    try to reduce false positives in gcc (about unmarked fall through cases)
    
    --HG--
    branch : sockfile-rewrite

M	nsdb/dbutil.c

commit 20d73bcd92e9886a747e53efead907e4e7daa2f9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-28

    align names of arguments in prototype with function definition
    
    --HG--
    branch : sockfile-rewrite

M	include/ns.h

commit ee8053ea4b0e682a48ed18b341becf64e88f10f9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-28

    use consistently NS_EMPTY_STRING
    
    --HG--
    branch : sockfile-rewrite

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/log.c
M	nsd/proc.c
M	nsd/queue.c
M	nsd/random.c
M	nsd/returnresp.c
M	nsd/rollfile.c
M	nsd/server.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclcrypto.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tcltime.c
M	nsd/tclxkeylist.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/nsdb.h
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c

commit f38cb6be454c9597e1409f17ae1bacab673c723b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-28

    reduce potential dangling pointer dereferences
    
    --HG--
    branch : sockfile-rewrite

M	nsd/connchan.c
M	nsd/info.c
M	nsd/queue.c
M	nsd/tclcache.c
M	nsd/tclconf.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/urlspace.c
M	nsdb/dbinit.c

commit 50bdc4a3509c221454707a1874ddb685f1495d00
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-27

    reduce potential NULL dereferences
    
    --HG--
    branch : sockfile-rewrite

M	nsdb/db.h
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/nsdb.h

commit ad537fa09a745f24458317e4518f8b5f97e338c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-27

    reduce potential NULL dereferences
    
    --HG--
    branch : sockfile-rewrite

M	nsd/config.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/returnresp.c
M	nsd/tclcrypto.c
M	nsd/tclfile.c
M	nsd/tclmisc.c
M	nsd/tclresp.c
M	nsd/urlencode.c
M	nsd/urlspace.c
M	nsdb/db.h
M	nsdb/dbdrv.c
M	nsperm/nsperm.c

commit 023fe8d1cf4cfa9c3c660e21963731aaf97f1c82
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-27

    ease life of static checker by initializing variables, which are set via output variables of functions
    
    --HG--
    branch : sockfile-rewrite

M	nsd/adpcmds.c
M	nsd/binder.c
M	nsd/connchan.c
M	nsd/exec.c
M	nsd/httptime.c
M	nsd/tclfile.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclsock.c
M	nsproxy/nsproxylib.c

commit bfbeb3823d622415c30365b43a3729af9013e990
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-27

    address dstring always via pointer
    
    --HG--
    branch : sockfile-rewrite

M	nslog/nslog.c

commit 45c38d23e15143c7170022dac807440527c7b1a3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-27

    reduce variable scopes and dead stores
    
    --HG--
    branch : sockfile-rewrite

M	nsd/connio.c
M	nsd/driver.c
M	nsd/return.c
M	nsd/sockfile.c
M	nssock/nssock.c

commit 3c51d166a1fcd27ccd468ae0f9613772f31925fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-27

    reflect additional non-null definition in functionals in prototype
    
    --HG--
    branch : sockfile-rewrite

M	nsd/driver.c

commit bc1625ca3f34cfe32681053703e100897324574d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-26

    remove two asserts to let regression tests run through with assertions enabled
    
    --HG--
    branch : sockfile-rewrite

M	nsd/connio.c
M	nsd/sock.c

commit 9f4a65e4be406d14a1d62071d7d27911376bfc99
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-26

    fix compilation when assertions are enabled
    
    --HG--
    branch : sockfile-rewrite

M	nsd/sock.c

commit 9f6d67e503ccfeda6db958d806514fc50bc2da67
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-04-26

    Rewritten socketfile handling. Make sure driver procs never block.
    
    --HG--
    branch : sockfile-rewrite

M	include/ns.h
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/return.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit 7db277cf56c06e95ce91b666b2756fc7853b3bff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-26

    don't silently ignore invalid syntax of range requests

M	nsd/range.c

commit c075b4439c644d42bd6be368d30401bdbe68d5ef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-26

    reduce variable scopes

M	nsd/returnresp.c

commit 035d417b60e5ff13d8c1f97ae163b15a2a466839
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-26

    fix cases, where range deliveries are performed via writer threads.
    Improve source code documentation and extend regression test.

M	nsd/range.c
M	nsd/return.c
M	tests/http_byteranges.test
M	tests/test.nscfg

commit ae49e91b18f2d1f8fe5bd5e560231e19bc8ecc90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-26

    remove debugging line

M	nsd/fastpath.c

commit de215379bb62ac1bc1a5d76467ec2349537cd93d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-24

    fix management of __GLIBC__ macros

M	include/nscheck.h

commit 4de0d3242f8ce176494be6cf0fcc13b1da2b19d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-24

    fix missing parens

M	include/nscheck.h

commit 5e2b1043bb3cb27f92dac99f7c443c52c6bce189
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-24

    fix problem with (too) many non-continguous byte ranges

M	nsd/range.c
M	nsd/return.c
M	tests/http_byteranges.test

commit e45beaa9c401cf7d88340adb082e61dc3fb38fe1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-23

    in principle, NsGetServer() can return NULL

M	nsd/returnresp.c

commit b5d5762af0729a5f73ba367e66e4c26df45eb60d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-23

    GetArray() and LockArray() can return NULL

M	nsd/tclvar.c

commit d4236b2b0046b8000f7260e1e9c6f7018dfa498b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-23

    add nonnull return declarations and reduce null tests after dereference

M	nsd/adpcmds.c
M	nsd/tclvar.c

commit 916959e805566e3c2479b0e43e79afbc67d48e1e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-23

    whitespace change

M	nsd/set.c

commit 6b056e0c468ab4c987a00685d7cf4a3e948018b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-23

    improve wording

M	nsd/tcljob.c

commit 998e0c38a0736d7eee7b13159663dc401a903136
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-23

    add missing prototype

M	nsd/driver.c

commit d44203581cb9cd22a6751c9c162b7eb0ae7da399
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-23

    add missing nunnull asserts

M	nsd/connio.c

commit 4f0501568e605a257e0defaf55fa67f7b065e0ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-20

    improve documentation

M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/returnstatus-cmds.man

commit 0a76f60da63aa4e71a0c30231bb780b6672f8cdb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-20

    remove useless config parameter

M	openacs-config.tcl

commit fb2e51379c279b09c0bf3660947bb96735282c8a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-18

    Added server name in log entries to make it easier to distinguish messages per-server during bootup

M	nsd/queue.c
M	nsd/tclinit.c
M	nsdb/dbinit.c

commit c1b81a9a107deea360168e63da518e2573237c6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-17

    avoid potential dangerous call to alloca()

M	nsd/range.c
M	nsthread/pthread.c

commit 8e999b4d35ede534553d164665390f17cc7ebfb4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-17

    don't warn about missing folders of modules, but about a missing Tcl folder for the whole initialization

M	nsd/init.tcl

commit fae10cfb02a0e19ca4c8573e94ecab998a1a70be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-16

    simplify reference chains

M	nsd/driver.c

commit 4fc9a8e9a29de00bf95a9aafaa3f9f8de2835f78
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-16

    relax non-null constraint

M	nsd/set.c

commit 488d4c39de6fd4c249fe007575d100e36bb7f511
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-16

    use typefefs for commonly used functions

M	nsd/set.c

commit 2558e54be040d1cbbd0500a7cb0829d9b8734c3a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-15

    simplify dereference chains, add asserts for more candidates

M	nsd/driver.c

commit 8dd19a646fd508478d10a45dea40cefc78ca4cfa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-15

    reduce variable scopes

M	nsd/driver.c
M	nsd/return.c

commit 8f31024ac9024a3bcf474caeb44d31bcbd65e9ae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-15

    decouple thread re-animation from virtual hosts mapping table;
    make also default virtual server mapping member of the driver;
    make sure that virtual host mapping works as well for multiple driver threads

M	nsd/driver.c
M	nsd/nsd.h

commit 64fdc6aae5c1c026b66cf45345d333d808f99d0d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-15

    bugfix: make virtual host mapping driver-specific
    
    before, "/servers" entry foo.org led always to the same location, when added on two different
    drivers (e.g. nssock and nsssl)

M	nsd/driver.c
M	nsd/nsd.h

commit 829cfe6d8a5a1ced3eac9e1642f8df4513dbfaa4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-14

    update _MSC_VER version numbers to include Visual Studio 2019

M	include/nsthread.h

commit 9a4cfa248bd54190c81dfd4416796f26c25df732
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-12

    add more examples how to configure network drivers

M	nssock/doc/mann/nssock.man

commit 53c89b721666f129da68fd51334aa87c1386e09c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-12

     new feature: added per-server extraheaders
      the extra headers are merged with the following precedence (the earlier ones have more weight)
      1) application specific headers
      2) per-server extra headers
      3) per-driver extra headers
      This makes it possible to provide in the config files defaults, which can be
      overwritten by certain pages in the applications
    
    - user global network drivers in "nsd-config.tcl"
      This makes it easier to users to extend this file by adding own virtual servers.
    
    - improve behavior and error messages for erroneous configurations.
      Previously, it was quite easy to crash the server without error message (during startup)
    
    - updated sample config files

M	doc/src/naviserver/ns_driver.man
M	include/ns.h
M	nsd-config.tcl
M	nsd/config.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/return.c
M	nsd/server.c
M	nsd/set.c
M	nsd/tclset.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit dd594295a74d82b92ae51ff7504313f29c6e24e6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-12

    improve spelling

M	tests/ns_hostbyaddr.test

commit 7e20268aec8f5a5896cce93e9a9a93ed590b3da1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-11

    new function "ns_set imerge": this is the case insignificant version of "ns_set merge"
    
    useful especially for working with header fields

M	doc/src/naviserver/ns_set.man
M	include/ns.h
M	nsd/set.c
M	nsd/tclset.c
M	tests/ns_set.test

commit fcb2c2341e737e1afd33f2e51fb8a029364d2966
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-11

    Add a commented line for the OpenACS variant of directorylisting

M	openacs-config.tcl

commit baee5880a247ec8f9525919d8fb67ba3ea2fba24
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-11

    remove debug line

M	nsd/request.c

commit 59e0b75a344755ba9bf10f644cd02b5cc551223d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-11

    for backward compatibility: accept 'maxinput' to be 0 (for arbitrary large values)

M	nscgi/nscgi.c

commit 346ec373778124dc166c6eb641fe166bc48192da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-11

    cgi: support memory units for config value "maxinput"

M	nscgi/nscgi.c

commit 18aa74395813ee2fc18a48ac00bbc2c70ada88d2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-11

    no need to include files already included by <ns.h>

M	nscgi/nscgi.c

commit 75172596d23969185e76043fd42c229ae2582927
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-11

    educe verbosity

M	nsd/driver.c

commit 1fa47e40e0ef653087e0424f6fb64c51ca0f0ab1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-10

    Added handling of partial  correct address lists,
    removed hard coded default addresses (obtain these from the drivers)

M	nsd/driver.c

commit e3d9be7fa04faf6fff65f5757adede7daab9508e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-10

    fix error message in test

M	tests/ns_nsv.test

commit 9cea7d489dcfa3252a42ba4daa54edfadebc5665
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-10

    improve spelling

M	doc/src/naviserver/nsv.man

commit 874eac68a60755a51f2ae85a2be1a2ebf1ae0a94
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-10

    update man page with missing options

M	doc/src/naviserver/nsv.man

commit eee8daa80cf0cdeab69d8a8eb5fffa7c43e6e03a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-10

    align naming with man page and Tcl's documentation of "incr"

M	nsd/tclvar.c

commit b3e47cff0b6610b34bef5eb9f711f156ac088bb4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-09

    simplify sample config file by using multiple IP addresses per driver

M	openacs-config.tcl

commit fa6b52da6b9805e3e8fd67a7c65dfd6e1aed4853
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-09

    improve documentation
    
    tough part was to get links from the configure section of
    "admin-install" to the "nssock" and "nssl" sections.

M	doc/src/manual/admin-install.man
M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/tcl-lib-file.man
M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/ns_driver.man
M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/ns_server.man
M	nscp/doc/mann/nscp.man
M	nsd-config.tcl
M	nslog/doc/mann/ns_accesslog.man
M	nsproxy/doc/mann/ns_proxy.man
M	nssock/doc/mann/nssock.man
M	nsssl/doc/mann/nsssl.man
M	sample-config.tcl.in
M	simple-config.tcl

commit 1075007d131bb1a38b29f5d788b6f0f537fb879e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-09

    abort in error situation with an error message instead of crashing

M	nslog/nslog.c

commit 716564bbdb02a97289f548d80fe5f388e3f4cc17
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-09

    improve spelling

M	nsd/driver.c

commit e77b94a8eb84340edeef4def745bf90619134cb6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-09

    minor cleanup and improved error message

M	nsd/driver.c

commit c02e384c08a12dac1272c51ea7a9e1afe285590f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-08

    New feature: Allow a single driver to listen on multiple ip addresses
    
    This feature greatly simplifies setups, where a single server is listening
    on multiple IP addresses (e.g. IPv4 and IPv6). Previously, it was
    necessary to define separate drivers for these, which need different names
    but which are typically configured identically. Furthermore, when the
    address is omitted, the server performs a lookup from the nostname
    to determine the IP address. Previously, it used the first one,
    now it can work with all returned addresses.
    
    To use this feature, simply specify the configure values of "address"
    as a Tcl list containing multiple IP addresses,
    
    The change backward compatible, old configure files will continue to work.

M	nsd/driver.c
M	nsd/nsd.h

commit 2d43d8120ae07b0e4067f017331aa7e00057930f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-08

    don't force listening on the same port as the main server.
    
    For default configuration, it is sufficient to listen just on
    the loopback port, which is actually the default

M	nsd-config.tcl

commit 639ce525faa7d2efafcd87f358941cc5aa6dfe73
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-08

    Change driver installation to global in sample configuration firle
    
    This change makes it easier for site admins to add further servers
    (e.g. for virtual hosting).

M	openacs-config.tcl

commit c50115bfaebfca358253c3b060ae9e3b126c6da5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-07

    remove clang-tidy smell: use CLOEXEC mode on fopen() when available

M	include/nscheck.h
M	nsdb/dbutil.c

commit a7da7202992b22449f59e296c4eceba710220155
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-06

    remove clang-tidy smell: prefer fcntl(fd, F_DUPFD_CLOEXEC) over dup()

M	include/nsthread.h

commit 163690f6f34b007303434b9933ffee5f378e5c98
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-06

    add warning of a probable misconfiguration of the tcllib

M	nsd/init.tcl

commit e57f7b7bab83c889af8d46187b90ff210cbe07dd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-05

    improve error messages for badly configured virtual hosting

M	nsd/driver.c

commit db09c7281362e2c8b090f468a5c5034f9342c74e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-04-05

    add retry on EAGAIN in Ns_SockSendFileBufs() implementation variant without sendfile() support
    like in the other case.

M	nsd/sockfile.c

commit e4fa812c68e0d3d38c7262755299e826b8dcabea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-31

    improve spelling

M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_register.man
M	nsproxy/nsproxylib.c

commit 89aa940338a4f3e7f8b017bdc3bf974448ad4e48
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-31

    improve spelling

M	nsd/driver.c

commit 3cc9c8d772fc2d2e8b89907eeb6f6dd703fefc8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-31

    code smell reduction: reduce variable scope and make sure the variable is always initialized

M	nsd/tclsock.c

commit 36796e5bda5f1f5fae8044c2ec3cf9bdca441ac8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-31

    string passed as prebind (command line flag "-b"): when prebinding to a unix domain socket,
    the optional "mode" value is now specified as the usual octal value (no need to convert
    mode bits into decimal notation)

M	nsd/binder.c

commit 985980e9dda9acefe943726f2d397890ca05342d
Merge: 298dfd46 bc494323
Author: Gustaf Neumann <neumann@wu.ac.at>
Date:   2019-03-30

    Merged in apiskors/naviserver (pull request #22)
    
    Fix Ns_LogRoll() to work on Windows.
    
    Approved-by: Gustaf Neumann <neumann@wu.ac.at>

commit bc494323ff344a4b17c3a65d08ea80d57ba64abf
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-03-30

    Fix Ns_LogRoll() to work on Windows.
    This includes both the 2006-03-28 (f5773e4a53a4, 3ee16203924f) and
    2014-11-03 (8d3c79974f08) fixes, which were somehow later lost.

M	nsd/log.c

commit 298dfd462bcd80e128bc4916fc803d91344a6a91
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-28

    factor out common strings

M	nsd/tclhttp.c

commit 430011a862f0ce684a3f493c3ba2cb4b8cad9025
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-28

    use Boolean expression

M	nsd/fastpath.c

commit c38b85588891d0b49469da38f2fc61409a74e25b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-28

    add one more O_CLOEXEC

M	nsd/driver.c

commit 8165c79a2d3b6901abd2b61b6aef8f9e08a356f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-27

    pass always third argument to fcntl()

M	include/nsthread.h

commit eb262e5251bf7b7b9910de0b9311bd0f686f8110
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-27

    avoid name clash of macro HAVE_CRYPT with PostgreSQL config file pg_config.h.
    
    The name clash is harmless, but annoying. Fix as well macro for crypt_r().

M	configure.ac
M	include/nsconfig.h.in
M	nsd/crypt.c

commit e618ff391cb1f9cb87810b631f29176e85050653
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-24

    reduce variable scopes

M	nsd/fd.c
M	nsd/tclhttp.c

commit 28317fe7d9ec5b8a680da7bb9a6c34059bf12468
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-24

    remove clang-tidy smell: prefer fcntl(fd, F_DUPFD_CLOEXEC) over dup()

M	include/nsthread.h
M	nsd/nswin32.c

commit d39336cf276a0e30e96b0590dabda4ed456f8945
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-22

    add O_CLOEXEC to open() operations to reduce security smells

M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/binder.c
M	nsd/fd.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tclthread.c
M	nsd/unix.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nsthread/nsthreadtest.c

commit 35d221d8a4d7428d79fbd506721e28d063ae38e3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-22

    move serialized objects in the blueprint after the namespace imports and ensemble recreators
    since constructors can call functions depending on this

M	tcl/nstrace.tcl

commit efae88171668602e502037fe160b923ecb80fc1e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-14

    no need to introduce a new field, since the "stats" member has already a similar member.

M	doc/src/naviserver/ns_server.man
M	nsd/nsd.h
M	nsd/queue.c
M	tests/ns_server.test

commit ff696c50228327184fe633d7400014976ce7029c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-14

    Report in "ns_server threads", how often a thread of this pool was started.
    
    This statistic can help to identify installations, where threads are
    started and stopped in a too eager fashion.

M	doc/src/naviserver/ns_server.man
M	nsd/nsd.h
M	nsd/queue.c
M	tests/ns_server.test

commit 5ce296bf7099178476b39bf4218e40028ed7ce4d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-14

    improved scalability: provide different locks per urlspace IDs.

M	nsd/nsd.h
M	nsd/urlspace.c

commit d8491aa820f306b454145f5daec521bedef92e74
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-14

    remove unneeded variable

M	nsd/server.c

commit 5bcfc77f1b1064cf8728bc235c64a82c6a42f72e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-11

    modload: avoid to add potentially missing extension twice, improve error message

M	nsd/modload.c

commit 0268b24bf0792f1e5efeaa2c5d571b8de6f03403
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-10

    improve spelling

M	NEWS

commit 3629671a90ddbf50ac0f7439f8754069315df5c3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-10

    improve spelling

M	nsd/adpparse.c
M	nsd/config.c
M	nsd/tclinit.c

commit 76f1b4591a556fab08fb675325df55c4e968cd5a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-10

    improve spelling

M	nsd/driver.c
M	nsd/sockaddr.c
M	nsd/str.c
M	nsd/tclhttp.c
M	nsd/tclxkeylist.c

commit 8f73a863321f131e46aef50e7a816ebd1cad7242
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-10

    improve spelling

M	doc/src/manual/admin-db.man
M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_sls.man
M	nsperm/doc/mann/nsperm.man
M	nsproxy/doc/mann/ns_proxy.man

commit 42a7d2302a81e8dc59387c8c5178d853e4532328
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-10

    improve spelling

M	nsd/driver.c
M	nsd/sls.c
M	nsd/str.c
M	nsd/tclcrypto.c
M	nsd/tclmisc.c

commit f3213a9103a24f9c6c836756cf4b3ec660bac67f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-10

    improve spelling

M	nscgi/doc/mann/nscgi.man

commit bf6e5ce675f478e87ddef40059a94917143751d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-10

    improve spelling

M	nsproxy/doc/mann/ns_proxy.man

commit 81a795bd1241d3d9ea1ecf18a56161da76aaca6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-10

    improve spelling

M	doc/src/naviserver/ns_crypto.man
M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_job.man

commit 3e82140fadf0a497dbf4d608283873fe84732eb4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-03-10

    make dist: improve cleanup of development files

M	Makefile

commit 430907f159323f04c8182128725477dd59e3b13f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-24

    Added tag naviserver-4.99.18 for changeset 97c2631e7137

M	.hgtags

commit da6d5012377eb222cbe5c66edd2893eef5969350
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-24

    update diffstats

M	NEWS

commit 974d9b60ecbdae777e09c52a9622dff355eaf687
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-24

    minor cleanup: remove commented code, add "fall through" comments

M	nsd/driver.c
M	nsd/queue.c
M	nsd/str.c
M	nsdb/dbtcl.c
M	nsperm/nsperm.c

commit 90046e1ea44dad464e7c3f2802822282950859f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-24

    update version numbers

M	README
M	configure.ac
M	doc/src/manual/admin-maintenance.man
M	nscgi/doc/mann/nscgi.man
M	nscp/doc/mann/nscp.man

commit 29a57527b4c2d1163b7609dafd3f6dfe26418694
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-24

    update NEWS file

M	NEWS

commit 9c9600c6146a4d802e89dab341606fabf32ce62a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-24

    improve "make dist"

M	Makefile

commit 65d55dec61159a586f91dda6a6733e1013bcc89e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-24

    Improve spelling, improve alignment with implementation (fix incorrect defaults).

M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/admin-tuning.man
M	doc/src/manual/c-driverdb.man
M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/keyl.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_adp_puts.man
M	doc/src/naviserver/ns_adp_stats.man
M	doc/src/naviserver/ns_config.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_crypt.man
M	doc/src/naviserver/ns_getform.man
M	doc/src/naviserver/ns_log.man
M	doc/src/naviserver/ns_quotehtml.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_server.man
M	doc/src/naviserver/ns_truncate.man
M	doc/src/naviserver/ns_upload_stats.man
M	doc/src/naviserver/ns_writer.man
M	nscp/doc/mann/nscp.man
M	nsproxy/doc/mann/ns_proxy.man

commit 59a5518cc9596e2722c0d030c5625c4bdf3aec04
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-23

    fix typos and remove obsolete parts from documentation

M	doc/src/manual/admin-install.man
M	doc/src/manual/admin-maintenance.man
M	doc/src/naviserver/ns_atsignal.man
M	doc/src/naviserver/ns_schedule.man
M	nsd/driver.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsproxy/nsproxylib.c
M	nsthread/winthread.c

commit 6777100831da4eecf3240c3c779bd029e0d30e23
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-23

    replace deprecated "ns_adp_eval" in test by "ns_adp_parse"

M	tests/adp.test

commit f082624c6eaae1562e5c5ff32e52ab423a379d67
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-23

    putting "static" storage-class specifier to the beginning of the line

M	nsd/tclmisc.c

commit abe02067b565b1c54bc7e1307d04b47b985835c2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-23

    Improve labels in ns_log entries for schedules procedures
    
    With this change, one can determine exactly, which scheduled thread
    was executing an instance of which scheduled procedure. Similarly
    as for connection threads, one can now distinguish, whether two
    log entries are from the same instance of a scheduled proc
    or from different ones.

M	nsd/sched.c

commit bf07a6bda20829d7992dfd5245139ef1a9155f7c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-23

    improve naming

M	doc/src/naviserver/ns_schedule.man

commit 6dda94c1da2cb5fc5819a93169b7562ceae783fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-23

    don't call deprecated command

M	nsd/adpparse.c

commit 24a2a7871b5bb93222bfa649fbdf6a672dc0d2ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-23

    fix typo

M	nsd/tclinit.c

commit 51a475fd51d5e0369f13109efcd7456a424cf1b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-23

    rework grouped man pages, fix broken examples, move deprecated commands to the deprecated section

M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_adp.man
D	doc/src/naviserver/ns_after.man
M	doc/src/naviserver/ns_atsignal.man
D	doc/src/naviserver/ns_cancel.man
M	doc/src/naviserver/ns_cookie.man
D	doc/src/naviserver/ns_pause.man
D	doc/src/naviserver/ns_resume.man
M	doc/src/naviserver/ns_schedule.man
D	doc/src/naviserver/ns_schedule_daily.man
D	doc/src/naviserver/ns_schedule_proc.man
D	doc/src/naviserver/ns_schedule_weekly.man

commit 2de9a4edae5de42ab41f880f70bea3bdd35f8557
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-23

    Mark ns_cancel explicitly as deprecated, use ns_unschedule_proc instead; before its use was just discouraged by the man page.

M	nsd/tclsched.c

commit b6890dd351eec50af5f0e262b2f819b322cb0412
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-23

    fix wrong argument order in sample command

M	doc/src/naviserver/ns_job.man

commit d17e3e64f74690c22f76296bb8df00309ccf850e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-21

    generalize namespace exclusion by letting the user to choose, what namespaces should be excluded

M	tcl/nstrace.tcl

commit 5f44d0ee38a4bd91e6977f098427f577192ba23b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-21

    unfortunately, there is still a site having troubles with "clock format"
    in Tcl 8.6, when the "::tcl" namespace is included. Provide some configuration
    means to control the inclusion of the namespace in the blueprint (currently
    undocumented).

M	tcl/nstrace.tcl

commit b04f196eab9a877a645f22512b3a453a025a707d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-21

    reduce assignments in expressions

M	nsd/connio.c

commit ced5ca86e1b49b54e481297a695ed48a76e6577c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-20

    nsdb stats: add number of currently connected DB connections

M	nsdb/dbinit.c
M	nsdb/doc/mann/ns_db.man

commit f24a1eb0023001afbbc6bd46fa411168919aebe2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-19

    improve cross-referencing in the ADP man pages, make spelling of ADP more consistent

M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_adp_abort.man
M	doc/src/naviserver/ns_adp_include.man
M	doc/src/naviserver/ns_adp_parse.man
M	doc/src/naviserver/ns_adp_register.man
M	doc/src/naviserver/ns_adp_stats.man
M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/returnstatus-cmds.man
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	tests/http_byteranges.test

commit 500707456ab0e351c3bee2db5100d6d9a6af6da7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-19

    remove debugging output

M	nsd/cookies.c

commit 5ce2562eb1f6796a91fd2df590234df561b3f782
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-17

    bump version number to 4.99.18b2

M	configure.ac

commit cc7db19e79e1ccad57521445d0d2c922fa096e90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-17

    ns_setcookie: add flag "-samesite" with values "strict|lax|none"
    
    When the flag is set it prevents the browser from
    sending this cookie along with cross-site requests to mitigate cross site
    scripting attacks. Permissible values are [term strict], [term lax],
    or [term none] (default). While the value [term strict] prevents
    sending the cookie to the target site in all cross-site browsing
    context, the value of [term lax] allows sending the cookie when the
    user clicks on regular links. For details, see
    https://www.owasp.org/index.php/SameSite
    
    This cookie flag is not yet part of an RFC, but most major browsers
    support it. Browsers that do not support it, ignore the flag
    silently (see https://caniuse.com/#search=samesite).
    
    Although most cookies should probably use the flags, in order to
    provide backward compatibility, the flag can't be activated by
    default on all cookies.

M	doc/src/naviserver/ns_cookie.man
M	include/ns.h
M	nsd/cookies.c
M	tests/cookies.test

commit 45c6b6d92682fa497c7036b97ca0af1847f4d1d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-17

    remove man page for non-existing command "ns_cookietime"

D	doc/src/naviserver/ns_cookietime.man

commit e6e35979d756a6d24a1b1024eae08a916bb595f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-16

    bump version number to 4.99.18b1

M	configure.ac

commit 3e01eaa32fc954c91e28c29487cd667eaeef969b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-16

    improve wording

M	doc/src/naviserver/ns_log.man

commit cad62c221861c257cd2f7ecde9640dd4f333585b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-16

    add configuration examples for ns/parameters logusec and logusecdiff;
    improve documentation in config files

M	nsd-config.tcl
M	openacs-config.tcl
M	sample-config.tcl.in

commit e931e1c5a58e0eaf64f75f68896f99aee58d4a93
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-16

    whitespace changes

M	tcl/util.tcl

commit 13965027ee83767347073748dc5bba994039885c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-16

    add sample configuration section

M	doc/src/naviserver/ns_log.man

commit fa24db190c1a1585b51350e3db4cf77e1f0fa8d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-16

    fix typo

M	doc/src/manual/admin-tuning.man

commit 1ae6182111f658d312faf9efa72994d789193722
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-14

    remove development output

M	nsd/config.c

commit 923c5a5aa624f69afa98e77e6681f3e100b9fcb6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-13

    ns_http: use memory units as well for parameter -spoolsize

M	doc/src/naviserver/ns_http.man
M	nsd/tclhttp.c

commit f49f7f0c2e38185f28e9b231453db48901431dfb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-13

    improve documentation

M	doc/src/manual/admin-install.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_shortcut_filter.man

commit 458dce42351697a673fe103b4cd62150aabc77d9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-13

    adding declarations for PURE and CONST functions

M	include/ns.h
M	nsd/nsd.h
M	nsdb/db.h
M	nsdb/nsdb.h

commit 0a157828200c7bdc84cf1447955709e542bcbbd2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-13

    reduce variable scope and fix index

M	nsd/str.c

commit 6877ffa66e1adf04214472b1fd418e383a59ff91
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-13

    support memunits also for argument parsing and use it for ns_cache_*
    
    - added Tcl_Obj type
    - added Objv type
    - updated man pages
    - extended regression test

M	doc/src/naviserver/ns_cache.man
M	include/ns.h
M	nsd/str.c
M	nsd/tclcache.c
M	nsd/tclobjv.c
M	nsd/tclvar.c
M	tests/ns_cache.test

commit db6db5b210e50b8eec8b901863d0cd5ff1593175
Merge: 875a26d3 84395812
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-12

    merged

commit 843958126dac12f2e9f6b4f3e901a0ad3791bac2
Merge: 0ff27a12 e6508727
Author: Gustaf Neumann <neumann@wu.ac.at>
Date:   2019-02-12

    Merged in apiskors/naviserver (pull request #21)
    
    Fix Ns_VarUnset() to actually support deleting the entire nsv array.
    
    Approved-by: Gustaf Neumann <neumann@wu.ac.at>

commit 875a26d3b785899bd16acb06d96bdbd366770ea8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-12

    Added support for  memory units in config files
    
    With this change, memory sizes con be configured now
    not only with bare numbers, but as well with memory
    units (e.g. 1MB instead of [expr {1024*1024}]).
    
    The International System of Units (SI) defines
        kB, MB, GB as 1000, 1000^2, 1000^3 bytes,
     and IEC defines
        KiB, MiB and GiB as 1024, 1024^2, 1024^3 bytes.
    
    For effective memory usage, multiples of 1024 are
    better (e.g. 4k pages). Therefore, we follow the PostgreSQL
    conventions and use 1024 as basis, but we allow as
    well the IEC abbreviations.

M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/admin-tuning.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/ns_upload_stats.man
M	doc/src/naviserver/ns_writer.man
M	include/ns.h
M	nsd-config.tcl
M	nsd/adpeval.c
M	nsd/config.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/progress.c
M	nsd/server.c
M	nsd/str.c
M	nsd/tclinit.c
M	nsd/tclobjv.c
M	nssock/doc/mann/nssock.man
M	openacs-config.tcl
M	sample-config.tcl.in

commit 9c40d03ab3a89e6301be25ebb2b0525ffc03d024
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-12

    improve documentation

M	doc/src/manual/admin-install.man
M	doc/src/manual/admin-tuning.man

commit 1635d326c54107b446aa174d9abbd79cd5a7c4ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-12

    add DNS config parameters

M	openacs-config.tcl
M	sample-config.tcl.in

commit 0f31f3ba9319ba5ffccc76894fcabd5f679d5288
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-12

    add parsens and indent consistently with spaces

M	sample-config.tcl.in

commit 0ff27a1277393ddc1b7e93eb4ad3f4308ac9f214
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-02-11

    one more option for error.log: "logusecdiff" records time diffs since last entry in usec

M	doc/src/naviserver/ns_log.man
M	nsd/log.c

commit e650872795f03d8e1090428bceed65c519ab3810
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-02-05

    Fix Ns_VarUnset() to actually support deleting the entire nsv array.

M	nsd/tclvar.c

commit 319b5d33ce4e5e85d627986ec0d97775d756de0c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-31

    add sorting order to use always the version with the highest version number

M	openacs-config.tcl

commit 054b9309d48c88b4e9096795ed8d65c1c8b85c67
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-30

    Revert to PRIxPTR, switching to PRIuPTR is undesirable.

M	nsd/log.c

commit eae801bc1b5c37ef5a27b82c88077ff5d358d72c
Merge: 62fb67ae 3277c7e7
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-29

    Merge in upstream changes.

commit 62fb67ae03e237d712008b71ae26616f1932adc5
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-29

    Fix garbled log output on Windows, PRIuPTR now gives I64u or I32u there.

M	include/nsthread.h
M	nsd/log.c

commit 3277c7e79795ef28d3515da5e0998b9f98e229e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-29

    revert changes trying to omit tcl stuff from blueprint since this seems to hurt, at least for Tcl 8.5

M	tcl/nstrace.tcl

commit 2dc5dbaa848f25c003a0a0e66cd6754709b45ebb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-29

    omit ::msgcat from blueprint

M	tcl/nstrace.tcl

commit e6e6d7eb44e4e067a5e8c14f6a8f10de7b608374
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-28

    initialize always thead name

M	nsthread/thread.c

commit cb648819190238a7dc9156526e924131ab2eff26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-28

    improve comment

M	nsdb/dbinit.c

commit 3d3facb2a5c24189e9a77b5c76784e52d1f7ea1a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-28

    remove commented-out code

M	nsdb/dbinit.c

commit 7cf26f9d263f7d08cca4320f9bf244d96fa330f7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-28

    whitespace changes

M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/nsdb.h

commit cf7707950d9ca21666e7c5e6b1b60583325c6b82
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-25

    Don't put ::tcl* namespaces to the list of the namespaces to be created
    (let tcl do it)

M	tcl/nstrace.tcl

commit c6d15051f121578d16c62eb4908e53b49e8877cd
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-25

    Bugfix, spurious '}' introduced in changeset 5587:bb78064b1137, 2019-01-24.

M	openacs-config.tcl

commit 4e1d01091494079e00e6e7224a2b56f66f985ffe
Merge: 97245d08 19161c7a
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-25

    Merge in Gustaf's fixes to new no *.so approach.

commit 19161c7a328727d27214544537647be3c80a7e60
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-24

    omit extension for shared objects in config files

M	openacs-config.tcl
M	simple-config.tcl

commit 5d8da0f232fae745490706234cff97cedc798076
Merge: 716609df 0e0d990a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-24

    Merged in apiskors/naviserver (pull request #19)

commit 716609dfb01c5b405bbd95a000c2b36f714c42c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-24

    fix last commit (check of returncode of library function was incorrect)

M	nsd/modload.c

commit 97245d08f3c665e2412a9389f89369090ce21493
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-23

    Remove dot_so, just use bare no-extension module names.

M	openacs-config.tcl
M	sample-config.tcl.in
M	simple-config.tcl

commit e2e0fedc8a8c663a757842702b63eed48cc811ba
Merge: 0e0d990a 17dc514f
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-23

    Merge upstream changes, adopt Gustaf's new no *.so approach.

commit 17dc514f80e2822fa142079614381c1667a5d2e3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-23

    allow omission of file extension for binary modules,
    
    Background: unixoid platforms use itraditionall in NaviServer
    ".so" as extension, no matter what "info sharedlibextension" is.
    On macOS, the sharedlibextension returns .dylib, while the
    module is named .so. Under windows, it seems that
    the extension of the module has to be .dll, so it is
    not so easy to write portable config files. The new
    code tries now first to load the library as specified
    (for backward compatibility), if this fails, it
    tries to append either ".so" in unixoid platforms
    or ".dll" under windows.

M	nsd-config.tcl
M	nsd/modload.c

commit 94707ce11a409f276a9fd6e36c9db508223bb88b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-23

    ease debugging of potential encoding problems

M	nsd/tclcrypto.c

commit 0e0d990ade29bb3c31823a87c18cdc1aa35262fa
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-23

    Use dot_so sharedlibextension so loading modules works on both Linux and Windows.

M	nsd-config.tcl
M	openacs-config.tcl
M	simple-config.tcl

commit b8e4c4db97f84de49ada61962f2c60946ff9c0d9
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-23

    Turn HAVE_OPENSSL_EVP_H on/off for Windows.

M	include/Makefile.win32
M	nsssl/Makefile.win32

commit b92099aef70a43fb192704935d9148e3db200698
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-23

    Add ifdef HAVE_OPENSSL_EVP_H around SSL_get_cipher() call.  This lets
    Windows nsd.exe link successfully!

M	nsd/tclhttp.c

commit 912f0ba36079cbda51c1857620ad90c4b5bb59df
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-23

    For core libraries, prefer Makefile.win32 if present, otherwise use plain Makefile.

M	Makefile.win32

commit 2a63e287d4d0d495f5eebaec4fbc8847b2cac1f2
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-23

    Put Windows-only stuff in Makefile.win32, Linux-only in Makefile.

A	nsssl/Makefile
A	nsssl/Makefile.win32

commit 5446b6e76c95468041d778af34a7655f33c971d0
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-23

    Rename nsssl Makefile to Makefile.common.

R072	nsssl/Makefile	nsssl/Makefile.common

commit 0f46897c69ce1de13ce79984cdb380c7f41304c7
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-23

    Clarify Linux vs. Windows incompatibility with CLEAN.

M	nsssl/Makefile

commit ba5ecee7a48b60d98dc98562cf32e02e8fdf8ad8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-23

    deprecate (softly) ns_source proc and make clear, that ns_register_tcl is the way to go.
    Update the documentation and make clear, that ns_register_tcl is used for
    interpreting .tcl files.

M	doc/src/manual/tcl-lib-file.man
M	tcl/file.tcl

commit 7ea3812dee9e9e6ada95c276644529343a01ff7d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-22

    improve man page

M	nsssl/doc/mann/nsssl.man

commit 1c23660ddbcc1d5ad2ba6dd657883e0a4a3a01d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-22

    fix broken ns_sourceproc

M	tcl/file.tcl

commit 715a8f65fe0fb0ae00f5db456406c759b5c8b9a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-22

    have to revert change, otherwise we get an compilation error (at least, under macOS)
    
    Recursive variable `CLEAN' references itself (eventually).  Stop

M	nsssl/Makefile

commit 2ccf5e98c0fc813d3f7749fae7ed48a731eb5581
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-22

    Attempt to add necessary Windows OpenSSL support.  But nsd.dll and
    nsd.exe still fail to link.

M	include/Makefile.win32

commit 787f351e1624595b98aead0cc4a855e5e868d716
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-22

    nsssl is now part of core, not an add-on module.

M	Makefile.win32

commit f1ab222bf9933aefe4e7f8eb690eed22acda8df2
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-22

    Now that nsssl is part of the NaviServer core, its Makefile.win32 is
    obsolete, remove it.

D	nsssl/Makefile.win32

commit 57ba215d2dd230d635e386fe3b65a6d7d1ddac53
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-22

    Now that nsssl is part of the NaviServer core (rather than an add-on
    module), its Makefile must be valid on Windows too, so avoid use of
    "+=" and other features which break Windows nmake.

M	nsssl/Makefile

commit 273c9bba7ed0525607169a4eff7a22a46455d734
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-21

    Simplify and clarify the smash_lib_include stuff.

M	Makefile.win32

commit c30f3c59df83b802514d5df0cc3a6e21c9360461
Merge: 7888c826 85ccf0d4
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-21

    Merge upstream changes through 2019-01-17.  No conflicts.

commit 85ccf0d4d80c80480bd91d7578526765661746c5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2019-01-18

    Fixed block in reaper thread that led to excessive time spent in
    the main reaper loop, thus blocking the whole proxy interface.

M	nsproxy/nsproxylib.c

commit 1535bedc0d02419ec4b2c569fd4f9e808227f4ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-17

    replace UTF-8 string literals by hexadecimal-escape-sequences to avoid potential encoding limitations from older compilers

M	nsd/tclmisc.c

commit 2c253a234c1b04f42404b9e02b6f15663f91cf6b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-17

    optimization: declare symbol array const and static

M	nsd/tclmisc.c

commit 38e8afd2e3d5e890235b6337e0211e0bcea6647c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-17

    remove false warning from regression test, improve test labels

M	tests/ns_striphtml.test

commit 7888c82609760547da8716820969e1a03c8244d5
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2019-01-16

    Merge upstream changes through 2019-01-13.

M	include/nsconfig.h.in

commit b8d6b2c2521a64f8abfbea912f17c312f6d7632d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-13

    Security smell: add *CLOEXEC to file descriptor open operation
    
    This fixes no real issue (forks are very limited in nsd), but silences static analyzers

M	include/nsthread.h
M	nsd/fastpath.c
M	nsd/sock.c

commit d4eb4b0af7729b6beb0f593cc567034a51fbafbb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2019-01-12

    Improve connect() operations with half-configured IPv6 installations
    
    This change addresses especially a problem, where IPv6 is activated on
    a server, but it cannot be used to connect to the outside world.
    In this situations, connect operations to hosts with domain names
    having both IPv4 and IPv6 addresses would fail, although IPv4
    connections are possible. In this cases, one should actually
    either deactivate IPv6 on the machine or probably deactivate
    IPv6 name lookups in bind (option "-4", filter-aaaa-on-v4 yes;)
    
    With this change, this should be be necessary.
    This change fixes also a resource leak in this situation.

M	nsd/sock.c

commit 76b5e5328ce319fb6faca02d9494cbdbb12fa11b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-29

    whitespace change

M	nsdb/dbinit.c

commit abfbb158ec5de5d01690cbd8ff8715e533b70a28
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-29

    add braces

M	nsd/sock.c

commit dd5fb28fe3935f1dcdf59d477ba7a88637392272
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-29

    add explicit cast

M	nsd/queue.c

commit 2591d62bc62252625bb983d15f623a7d3d1400f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-29

    simplify statements

M	nsd/driver.c

commit 1c7865cc25d511b5ae3133087d0c141c459e4c8e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-29

    add explicit else branch at end of cascade

M	nsd/dns.c

commit 269f1a14cddb60166190fa9b33151f3d55598346
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-29

    whitespace change

M	nsd/adpparse.c

commit ad59e91ed2a9d3a5be07c2a4ec588c2a71b54da6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-29

    avoid double deletes (introduced today)

M	nsd/tclcache.c

commit cdee76f3bf37ee685308df22f975817204d5c25a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-29

    reduce variable scope

M	nsd/tclresp.c

commit 8c729a4fd3eed33d63fa07b26d9f15864be27b9a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-29

    avoid unneeded cast and assignment

M	nsd/connio.c

commit 5a6e22c41f55692e0513b3415d85bc1d3468f2c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-29

    fix potential memory leak

M	nscgi/nscgi.c

commit 9bc28bbdae6d4020255e655a654cd7dba6b746e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-28

    cache transaction semantics: align behavior
    
    - make "ns_cache flush $cache" behave like "ns_cache_flush -glob $cache *".
    - extend regression test

M	nsd/tclcache.c
M	tests/ns_cache.test

commit b9a4fa636e3c62a75d2ddba3696078e3e930b575
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-20

    Improve documentation

M	openacs-config.tcl

commit 367b33dce9010794b5aa997cdd9120dc0e80f1fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-18

    fix handle-active state in error cases

M	nsdb/dbdrv.c

commit 1eaeed641d479f4a874aac4687e79b409bd496f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-17

    align code and documentation

M	tcl/ns_crypto.tcl

commit fcaa8638cc1040ae39343512d788ba43a373dc1a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-17

    new API call: ns_db currenthandles
    
    Return information about handles currently allocated to the thread
    performing this call. The result contains a dict with the pools,
    from which handles were allocated, the names of the handles and their
    "active" state (a handle is active between a "ns_db select" and the
    last "ns_db getrow" statement). If no handles are allocated by this
    thread, empty is returned.
    
    For example, a possible result is "main {nsdb0 1} subquery {nsdb1 0}"
    indicating that the current thread has allocated handles from pool
    "main" and "subquery", but the handle from pool "main" (i.e. "nsdb0")
    is currently active (during a select).

M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/doc/mann/ns_db.man
M	nsdb/nsdb.h

commit 12cde43d06a9b4d6ab92a277c6503e6c36a21545
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-17

    fix typo

M	nssock/doc/mann/nssock.man

commit 465e22d1dcd66e0d63667a29c5b4c4efb176e916
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-17

    provide macro NS_TCL_PRE85 to detect, when NaviServer is compiled with a Tcl prior to 8.5

M	include/nsthread.h

commit 0b4011d26d430df58647877bd09f98c6baace4e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-16

    reduce dead assignments

M	nsd/fastpath.c
M	nsd/index.c
M	nsd/urlspace.c

commit 31db315161399be73c564e3213c97f0d770aef24
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-07

    turn off Nagle algorithm (parameter nodelay) per default

M	nsd-config.tcl
M	nssock/doc/mann/nssock.man
M	nssock/nssock.c
M	openacs-config.tcl

commit 8bd3ec529fb0f6b6d825722a0ff1830608436f37
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-07

    remove outdated comment

M	nsd/driver.c

commit b850c34de52cb0bae1002bda9810da4f56b2a67b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-07

    distinguish consistently between subcommand and argument

M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_adp_ctl.man
M	doc/src/naviserver/ns_cond.man
M	doc/src/naviserver/ns_critsec.man
M	doc/src/naviserver/ns_env.man
M	doc/src/naviserver/ns_event.man
M	doc/src/naviserver/ns_info.man
M	doc/src/naviserver/ns_rwlock.man
M	doc/src/naviserver/ns_sema.man
M	doc/src/naviserver/ns_writer.man
M	nslog/doc/mann/ns_accesslog.man

commit 92051d8875aa3b8c07ba921be1267970a1d9df56
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-07

    improve sample service file

M	doc/src/manual/admin-maintenance.man

commit 8bdd0c33adaeaa48c57c54084b38cc60970b42ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-12-04

    improve indentation

M	nsd/sockfile.c

commit 9b3dc58e2ec190b094460e1dea70892dd5c0655a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-20

    fix compilation issue for versions of OpenSSL before 1.0.2

M	nsd/nsopenssl.h
M	nsd/tclcrypto.c

commit 9831dbcf664f72678099e4c7445f0db95179610a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-20

    whitespace changes

M	nsd/tclcrypto.c

commit df9a455cfe4842132df5bb388c152d98bdabfb30
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-16

    align implementation with documentation (if wait operation has no timeout, use timeout of queue operation)

M	nsd/tclhttp.c

commit 7cb10c8ea1f1d6cf6d861af53f5a31c10975f2e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-16

    reduce variable scope

M	nsd/task.c

commit f6fede6b9b3f814c7b68fc896d0f5d19b9c71d9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-15

    align documentation with implementation; use itemized list for describing entries in the result lists.

M	doc/src/naviserver/ns_job.man

commit 92bcbed66175ef03fcc97386f7ca01ef151fa737
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-14

    reduce variable scope

M	nsd/tclcache.c

commit 06f761145a47934daadc670df75ff5ee5b6223fe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-14

    deactivate SSLv3 by default, adjust comments to values from source code

M	openacs-config.tcl

commit bade40ad33668ce720c57f9f5dcfe193d7b77e8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-08

    remove unneeded variable

M	nsd/tclhttp.c

commit 3c871165f2f3940a6f94af83167011c95ed4919e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-08

    improved debug messages, tested with boundary cases (i.e. upload files being a multiple of CHUNK-SIZE)

M	nsd/tclhttp.c

commit c5117631fb827ade961abaa3868c2174a393e9f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-07

    ns_http: fix potential problem with partial writes on HTTP requests with large bodies (e.g. POST of larger files)

M	nsd/tclhttp.c

commit 1b65a731dd69a5ed549cc403cdadd4b4e35580f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-06

    add const declaration

M	include/ns.h
M	nsd/sockaddr.c

commit 00a35672251fe414db8e99e94248d97dec66c726
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-06

    help parse performing static analysis

M	nsd/nswin32.c

commit 24a2a60da13fac6334352228721c18f7ca0ac214
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-06

    remove unused macro

M	nsd/sock.c

commit fae638187e2240880ac3dfa70a9f4f8acab00bc0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-06

    make otherwise unused macro more local

M	nsd/dns.c

commit 522ffe76f5865596869ba2d21bc09f56602cffcd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    Added tag naviserver-4.99.17 for changeset 12b3f7e266d3

M	.hgtags

commit 07f0621d1032e50e011ec26a0e9c5657f18ba441
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    provide compatibility for Tcl 8.5 in http.test

M	tests/http.test

commit 292b6dd7ed59f007360e5f50e74f7820140d19a2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    update diff-stats

M	NEWS

commit 602adac64409b3d56925abaf8486663232d8dd70
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    add image visualizing blueprints to documentation

A	doc/images/manual/blueprint3.png
M	doc/src/manual/tcl-overview.man

commit a1af53648e142644f0c40426ccd0b03247f2dd24
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    add support for images in documentation files

M	Makefile

commit 64f33660b1767338fa60a86a7b825f1848da04f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    bump version number to 4.99.17

M	README
M	configure.ac

commit 0eac6aa548d62dcb935f77bf89d801405f7d7d06
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    add sample for initcmds to nsd-config.tcl

M	nsd-config.tcl

commit ff9a4f1472002014ba24418ca9bfa63650834f34
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    updated news files, esp. with changes in sample configure files

M	NEWS

commit 808073622f35b7d26396c8a24fbde974d13248e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    avoid shadowing of outer symbols

M	nsd/connio.c
M	nsd/cookies.c
M	nsd/queue.c
M	nsd/request.c
M	nsd/task.c

commit b906d4560ad02ebcd22fe3b95bfaf4fc63fb3ada
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    improve comment

M	nsd/conn.c

commit 0c9ea4f701118869163e99f64ef7ccd72f26083f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    whitespace change (fix indentation)

M	nsd/config.c

commit 2b636a8009382fd5f89d55cd64d1e16528279633
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    aligen name of arguments in prototype with function definition

M	include/ns.h

commit d4b4ecbcd0418800a5ec2c151acc3aa237ccbca1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-04

    improve spelling

M	tests/http.test

commit 5c81c51b33adc3e9b61176ca2e6caf575f2bfecc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-03

    remove comma before that

M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_return.man
M	nsd/cache.c
M	nsd/nswin32.c
M	nsd/queue.c
M	nssock/doc/mann/nssock.man

commit 7e48687836dd0347724b0ad470acd93f7034f94d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-03

    update change statistics

M	NEWS

commit 4aebac81dced0c69e23b5262e70028b78909a850
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-03

    add changes of NaviServer modules to NEWS file

M	NEWS

commit c8beb9d316c596bbc02bee4933951da1ad6c6af2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-03

    remove code smells

M	nsd/sockcallback.c
M	nsd/task.c

commit bfd61915d190fbc25b3c87f2d3bb83996ded47dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-03

    make function CallDoneCallback() static and comment function

M	nsd/tclhttp.c

commit 3c84eec731bfc3508abc489b8efc4e3e0640bfbd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-03

    remove test with identical outer condition

M	nsd/tclhttp.c

commit ec45fc6d69142a4f8d5e57f473be3b11887e6d6c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-03

    fixes for Raspberry PI: use proper print macros for printing size_t and ssize_t

M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsmain.c
M	nsd/queue.c
M	nsd/set.c
M	nsd/tclcrypto.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsproxy/nsproxylib.c
M	nsssl/nsssl.c

commit 25702f3aee986ffe0a3e82ea1d25f90a4d2110cb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-03

    reduce implicit conversions

M	nsd/unix.c

commit e1940a25e259852f17c1b1853f88654213a4016a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-03

    fix editing bug (many thanks to Oleg for pointing this out)
    extend regression test for ns_crypto

M	tcl/ns_crypto.tcl
M	tests/ns_crypto.test

commit d67504f39a44142b801cafa6407f34d575a49a47
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    update change statistics

M	NEWS

commit 920b38be38bb5c19b4cc4a31414ad8847ac713e4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    withspace changes

M	nsdb/db.h
M	nsdb/nsdb.h

commit b7f950ebc27b8826d61f6e66ac14728f68a4c058
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    whitespace changes (remove tabs and trailing spaces)

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/callbacks.c
M	nsd/cls.c
M	nsd/compress.c
M	nsd/connchan.c
M	nsd/crypt.c
M	nsd/encoding.c
M	nsd/event.c
M	nsd/exec.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/index.c
M	nsd/info.c
M	nsd/init.c
M	nsd/lisp.c
M	nsd/listen.c
M	nsd/main.c
M	nsd/mimetypes.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/nsmain.c
M	nsd/nsthread.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/pidfile.c
M	nsd/progress.c
M	nsd/quotehtml.c
M	nsd/random.c
M	nsd/range.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/set.c
M	nsd/sockaddr.c
M	nsd/sockcallback.c
M	nsd/sockfile.c
M	nsd/stamp.c
M	nsd/str.c
M	nsd/task.c
M	nsd/tclcallbacks.c
M	nsd/tclcmds.c
M	nsd/tclcrypto.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tcltime.c
M	nsd/tclxkeylist.c
M	nsd/tls.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/dbutil.c
M	nsdb/nsdb.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsssl/nsssl.c
M	nsthread/cslock.c
M	nsthread/error.c
M	nsthread/fork.c
M	nsthread/master.c
M	nsthread/memory.c
M	nsthread/mutex.c
M	nsthread/nsthreadtest.c
M	nsthread/rwlock.c
M	nsthread/sema.c
M	nsthread/signal.c
M	nsthread/time.c
M	nsthread/tls.c

commit 0273c8d2f8f58a75975c02a210431b42fd1e98ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    silence static checker

M	nsd/tclresp.c

commit 0df7370678a404be4dd7f7a803df1933bd75ce55
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    align variable name with prototype

M	nsthread/pthread.c
M	nsthread/winthread.c

commit cd493c4200ec78f29d8ef6236130b303ba1655f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    use always NULL instead of 0 for SERVICE_STATUS_HANDLE

M	nsd/nswin32.c

commit a24c8e994093bf0e4b45c67cf8d247f18224fce8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    avoid potential name clashes with predefined "min" or "max"

M	nsd/dns.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclconf.c
M	nsd/tclfile.c
M	nsd/tcljob.c

commit 29d37138c9c5a170339bd6391ecfcd7f18137374
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    silence static checker

M	nsd/tclmisc.c

commit b1c4948e45931ea41afef1bd3ef956f251883403
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    reduce code duplication

M	nsd/tclcrypto.c

commit e20504096a40efbf9de80be42d4a1812f290b74c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    avoid potential name clashes with predefined macros

M	include/ns.h
M	nsd/config.c

commit 609ae77c964b511a89db239f67a41f3fe3df8ad4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    improved NEWS, bumped version to 4.99.17b2

M	NEWS
M	README
M	configure.ac
M	nsthread/pthread.c

commit 948452a80927c7f3a0ffd7059e619e2b2de4208b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-11-01

    fix print string when no SO_REUSEPORT is available

M	nsd/driver.c

commit c8f84162d1bd32f0b4eec6c2b500d41b5b35b48f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-31

    improve comment

M	nsd/tclhttp.c

commit fba26c4780ab4f6d1a88c5ac432c23bc516f8c50
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-31

    fix Tcl error code setting in versions before 8.7

M	nsd/tclhttp.c

commit 5b6589765c07b955bed3b5fe8689dee4cf412adf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-31

    clean dirty editor buffer

M	include/nsthread.h

commit 2394dd3565ae1dad141a89afad4d0eea4b26afeb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-31

    do not rely on implementation defined print/scan format %p, but use instead standardized integer types

M	include/nsthread.h
M	nsd/tclobj.c

commit 6b3c6f70d6955edb409d518b6cf4b16f71ffc389
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-31

    stick to full name of "sharedlibextension" as used in Tcl

M	tests/test.nscfg

commit 6d73ccf1b2d7eac352e22af22213ea12a7bf3757
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-31

    let windows test succeed, even when binary name does not end with *nsd

M	tests/ns_info.test

commit 927be81bfce889fe805abd9d8723d727c6720a51
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-31

    fix typos

M	tcl/ns_crypto.tcl

commit f6a7db9a556093bf97c23375ad08dcd54be5c3d6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-31

    prefer current spelling of macOS

M	include/nsconfig.h.in

commit 7ece9df196dd7a15b9b6b5a781461f1cae964a2b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-31

    fix spelling

M	nsdb/util.tcl

commit fbfd38c4fff9c465706ed9c0368d1246c68ebb90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-31

    incorporating windows changes from Oleg Oleinik

M	include/Makefile.win32
M	include/nsthread.h
M	nsd/sock.c
M	tests/test.nscfg
M	tests/testserver/modules/client.tcl
M	tests/testserver/modules/testhttp.tcl

commit 5a01d526e03d633737131e0cceee66a66098df49
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-29

    fix typos in comments

M	nsd/driver.c
M	nsd/task.c

commit 2570ff926f82e09b8ec57bbee41106e841ee4881
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-29

    avoid potential naming conflicts pointed out by cppcheck

M	nsd/tclvar.c

commit 4f7326ab3561d9fa7a3388f6183c34e48fff1061
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-29

    avoid potential naming conflicts pointed out by cppcheck

M	nsd/set.c

commit c895c978620bfb3245e17e4e38af9389955895f5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-29

    Don't include access log in diest tar file

M	Makefile

commit 29d0b09c6728de0018a29482306fabba8c04c8da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-28

    updated NEWS file

M	NEWS

commit e05ac14a998d419216b28bfb03e24c73be669cca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-28

    extend regression test (added test cases for -timeout and -donecallback)

M	tests/http.test

commit b12953b57dca52895fd60f325506273715f440ee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-28

    set error code to NS_TIMEOUT when timeouts occur; improve comments, refactor code a little.

M	nsd/tclhttp.c

commit 9408250ca6adbcb9dae2020bbab4bab78d3104d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-28

    Fix potential infinite loop when a task added itself as its next task (nextWaitPtr) causing an infinite loop.
    This might have happened in connection of timeouts occurring in tasks.

M	nsd/task.c

commit 1451747d21754da261c8e5ccb4be6f696eb38682
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-27

    use 4 spaces indentation

M	doc/src/README

commit 89d6e025a266a19c1a8c4cffd70161b1235eb777
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-27

    rename README.txt to README like in other places

R095	doc/src/README.txt	doc/src/README

commit 9d81b11f78738ede0e9ddf32834b262040a42347
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-27

    update statistics

M	NEWS

commit 650388b8dac3b2f9a102207988d95517538d6578
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-27

    add first draft of NEWS update and bump version numbers

M	NEWS
M	README
M	configure.ac
M	include/nsconfig.h.in

commit ff1d80c779d2bc44e761cd58506d35f7000e29b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-26

    simplify Ns_GetBinaryString(), since detailed differentiation does not seem to be necessary anymore

M	nsd/str.c

commit 18169d4934a78d2edf68b10afd3940b1a3b96a3f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-26

    add man page for ns_crypto functionality

A	doc/src/naviserver/ns_crypto.man

commit c2cc0afacd294e1d82f9da1cd8e02c6935c3988d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-26

    fix typo

M	nsd/tclcrypto.c

commit b185877bcd11700537a38161c9083a4502ef99dd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-26

    reflow comment

M	tcl/ns_crypto.tcl

commit 6b05a9b9c4ec1940d13a4cbd669fea02e02cb32f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-26

    fix comment

M	nsd/tclcache.c

commit 419e2d15342279c0ad6adabb50a9ace1efa190b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-26

    improve man pages

M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_connchan.man

commit bff26003f1bd140273ec83970bc0704590f29d83
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-26

    improve spelling

M	NEWS

commit dc5fdfdcf19f859103c794cb9444260ae084d350
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-25

    updating contributors

M	license.terms

commit 5b8824dd61eb1e54a56a89a7450e46490055dea1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-22

    minor changes to silence cppcheck

M	nscgi/nscgi.c
M	nsd/adpcmds.c

commit 2d515bcfcb4354db2f7133b43c12c09d51f5e5af
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-22

    improve spelling

M	tests/http.test
M	tests/ns_server.test

commit 8698ef8c680ed1523720e654c38e12bc9fcb6268
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-22

    let ns_striphtml strip as well HTML comments

M	doc/src/naviserver/ns_striphtml.man
M	nsd/tclmisc.c
M	tests/ns_striphtml.test

commit e20d5267876c02cc63738916e55773a0c3b1a7d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-20

    minor changes to reduce code smells

M	nsd/adpparse.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclsock.c
M	nslog/nslog.c

commit 70d30697940c3491d115ce9767f9092201d071bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-19

    deactivate development code

M	nsd/tclmisc.c

commit 315d22c0698a7ef82005858e32b925ce9ced7f83
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-19

    support all HTML4 entities in ns_striphtml

M	nsd/tclmisc.c
M	tests/ns_striphtml.test

commit ede6edd30be9285625b409a967af4b48ab82c072
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-18

    improving ns_striphtml: add resolving of basic HTML entities (&nbsp: etc)
    fix encoding of some numeric entities
    extend regression test

M	nsd/tclmisc.c
A	tests/ns_striphtml.test

commit bb5f06393343aee43b22ef423dfdaa9ff6e531c6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-11

    improve man section

M	doc/src/manual/admin-db.man

commit 8fcc86be65316c7d80dce60d17e955ae94c9b41c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-11

    use PostgreSQL's conninfo notation in the datasource to hint, that more parameters are possible as well

M	openacs-config.tcl

commit 2cb161006c30c63453798dd5400a4294f0cd6f26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-11

    improve spelling

M	nsd/httptime.c

commit 4b3c7f2f5bc07ac38ae815dc32dc5b50b6a80f1f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-10-11

    improve documentation (many thanks to Michael Aram for point this out)

M	doc/src/naviserver/ns_http.man

commit 0e7355c28830a61478e7fd1d4ecaf37010f52d07
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-29

    improve spelling

M	doc/src/naviserver/ns_ictl.man
M	nsd/init.tcl
M	nsd/nsmain.c
M	nsd/sock.c
M	nsd/watchdog.c
M	nsdb/util.tcl

commit 1a643cedfe7bd9a60af8667f17bd144d4ee7022c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-29

    avoid potential NULL reference

M	nsd/tclsock.c

commit 3e92c0af0006c295a03b5199865978c3154862cf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-29

    remove dead assignment

M	nsd/tclhttp.c

commit 3308816b7a9bae7f27890058a7335882c567c5ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-29

    reduce variable scopes

M	nsd/sock.c

commit 3173d7dd0ed548ecaa57b27c736859f225d05b26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-23

    improve comment of test

M	tests/ns_reflow_text.test

commit 0b43554a3cbae74af4e83858bf2094d09faeb3aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-23

    improve example in man page

M	doc/src/naviserver/nsv.man

commit 783186822e55e878c7c76b4fca2d395eeb295149
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-23

    improve example in man page

M	doc/src/naviserver/ns_http.man

commit 3c5ac5b63c3be9479cb3e47d563e81324ac0890a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-23

    - avoid potential passing of NULL as 2nd arg of memcpy()

M	nsd/tclmisc.c

commit 753014df1ee703095f9419189da51003e93514a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-17

    change preset encodings (when not specified in config file) for files with extensions .htm, .html, and .adp from iso8859-1 to utf-8

M	nsd/encoding.c

commit be4a47459308c41c9350db922e02cfa82e989812
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-16

    add parameter "initcmds" to "tcl" section of the server configuration.
    
    The new features allows one to setup full configurations without separate files
    by allowing to add commands to the config file, which are executed after all
    regular configurations.

M	doc/src/manual/tcl-libraries.man
M	nsd/init.tcl

commit 897770c2e4ef114d3dcea633faeb3415767bc77f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-16

    fix line breaks in man page

M	doc/src/naviserver/ns_http.man

commit d440ed1af9c1cdd37398c4eda0ee91d9acbc2d3a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-16

    fix line breaking in man page

M	tests/http.test

commit c2618b20892253f58d14602b8fc7e594fdd051c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-16

    use ns_parseargs for ns_driversections (instead of "manual parsing")

M	nsd/init.tcl

commit 5b273168852389d01727da78f02c5a34b1dbb6e5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-15

    bump version number to 4.99.17d6

M	configure.ac

commit 0dc739cc0f3998d06c4519c8c23e99efe82cdbbb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-15

    fix issue with space for the terminating null character correctly

M	nsd/tclenv.c

commit aade86d950e93e65ccd2c9dcf349dcc6c7405ea1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-15

    make sure, we have enough space for the terminating null character

M	nsd/connchan.c
M	nsd/tclenv.c
M	nsdb/dbutil.c

commit c434d43e4d6ee6526ccd5bc560fe8246eeb6b9d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-14

    Add pointer to "ns_getform" to man page entry of "ns_conn form".

M	doc/src/naviserver/ns_conn.man

commit 9323942853856670fe6e607fcd50cb254cba46d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-14

    remove duplicated entry in man page

M	doc/src/naviserver/ns_ictl.man

commit ed4e5cc4bb97cc0b1c6391dcb7e96903af0bdc6e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-14

    Fixed memory leak in "ns_http run" and extended regression test

M	nsd/tclhttp.c
M	tests/http.test

commit c6e3c4621f08192427b2a48fded4dbb531caa8dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-14

    reduce verbosity in debug cases

M	nsd/task.c

commit 936ab443b0d18def51026a4f6b9c0df825d9f7f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-12

    add testcases for ns_getformfile with and without spool file

M	tests/http.test

commit 85a066ad5cbd26fd156468ec8f22cc1a7d8ee51f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-12

    bugfix for ns_getformfile (see https://sourceforge.net/p/naviserver/bugs/80/)
    
    Do not rely on global variables, but use ns_set instead.
    Depending on configured values, ns_getformfile could return empty, even when files were uploaded

M	tcl/form.tcl

commit f36ce0758a697e8f235dc179625c27e4c0cd64aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-12

    change for config file of testserver: set maxupload for nssock to 10000

M	tests/test.nscfg

commit 0602f4147c4317fe841d5d8df1449c097f5b9d26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-08

    improve comments in sample configuration of OpenACS

M	openacs-config.tcl

commit 7aee67a1317f5d01f18b9751f66a0d88c00fdd2b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-08

    remove unneeded mime mapping

M	tests/test.nscfg

commit ce65e866439628cb57baf7297ea2136bf10baa1f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-08

    add example with verbose test cases to "make help"

M	Makefile

commit 4d2a08262755efa53dd5915ce1e2c799100bc41e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-08

    remove false positives from log file

M	nsd/unix.c

commit 63ffcc9ba52e994f31458f8852ae51c1b3d9cc57
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-08

    don't use reuse socket option on local socket

M	nsd/sock.c

commit 4b9315889a1186d83fc55e64b690ce31ff448630
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-08

    capitalize name "Tcl"

M	nsd/init.tcl

commit 039afcb36147958ef6fb2462b2a23b3dbccc04c1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-08

    reduce verbosity

M	nsd/driver.c

commit a1d4cbca12a1e57346fbb566fa82225b0e47eeb9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-08

    whitespace cleanup

M	nsd/tclsock.c

commit 661e3506961130311fa198c6de9422ce1b86ce9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-03

    add documentation for "ns_http stats"

M	doc/src/naviserver/ns_http.man

commit 684ee8588f329387d0badb49200a34e684f2add6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-01

    provide callback info for ns_connchan

M	nsd/connchan.c

commit 833da15a891cceee65a73775b8fe02451b0e4afc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-01

    remove unneeded test

M	nsd/tclhttp.c

commit 2ba88980a1cf16979bd5e276fe62f679dff48c88
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-01

    properly initialize revents member

M	nsd/sock.c

commit ec03f15fecf39755fa4f3dc548d18a8b35984542
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-09-01

    reduce variable scope

M	nsd/connchan.c

commit a63d831913fbc7b960d01d2a4e2e168c565b1406
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-29

    use ns_poll() instead of poll() for windows portability

M	nsd/sock.c

commit 483a5d751781fe143bf557aed6225cb0347fce47
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-29

    reduce number of return statements before end of function

M	nsperm/nsperm.c

commit d36a9e5684045c633ddb85ebf03d0bb62ae05e60
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-29

    make sure to initialize all members of a structure

M	nsd/connchan.c

commit 92c8f37fbfcf847380cfdca3ecfe19d06fb1a371
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-29

    reduce verbosity

M	nsd/unix.c

commit 7f7ebb152a2300b2b05a58bba5d682a4558bc921
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-29

    bump version number to 4.99.17d5

M	configure.ac

commit 15aee58fef3bb7a1cc68f524282a2beb2160e244
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-29

    remove pedantic warning

M	nsd/task.c

commit 51cb81705696fbcebe460e2e795df36a9eef6036
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-28

    Improvements for “ns_http”:
    -       Provided support for asynchronous “ns_http” tasks: when the new flag “donecallback” is provided, then an “ns_http” task is started in the background and does not require an “ns_http wait” anymore. Instead, when it finishes it executes the provided donecallback which receives as additional arguments the Tcl result (in form of an integer) and the result dict, returned usually from “ns_http run”.
    -       As a consequence, requests of the form “ns_http queue … -donecallback … ”
    o       do not return a handle for “ns_http wait”
    o       are not automatically cleaned up (canceled) at the end of a connection requests
    o       typically, donecallback are executed in a different thread than it was started
    o       some more options, which were previously only valid on “ns_http wait” (such as e.g. spoolsize) are now valid for “ns_http queue” as well.
    -       Updated documentation

M	doc/src/naviserver/ns_http.man
M	include/ns.h
M	nsd/tclhttp.c

commit b9a2de79ab1792dba1b862c2638a2ce8c60fec28
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-28

    improve comment

M	nsd/sock.c

commit 188d5c3ee740cd7f23d57684ac7d4d870404ed72
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-28

    align tests with recent changes in "ns_connchan list"

M	tests/ns_conn.test

commit cdd84a0552f7ed959ba76a82ab6cb50573070533
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-28

    provide information in the error.log when fcntl() call fails

M	nsd/unix.c

commit 50557b982aba308c719ef7dbd1b42d84324ff782
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-28

    provide more detailed info when debugging tasks

M	nsd/task.c

commit 7c8adae99b691fcacd9cb8e8f94106ecdb55c42b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-28

    add comments to ease debugging

M	openacs-config.tcl

commit f77368d085779b47df5a9df1cc2bbbe569c0619b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-28

    reduce verbosity

M	nsd/sock.c

commit 8c12f2792c6d0ff3dce8adea1dc2786d36c3a024
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-28

    New feature: support resolving a hostname against multiple IP addresses
    for client operations:
    - in case, one domain name has multiple IP addresses registered,
      previous versions of NaviServer tried only the first returned address
      and returned an error, when this failed. This happened when using
      client functions (e.g. ns_http).
    - hostnames with multiple IP addresses are nowadays quite common,
      e.g. "localhost" having an IPv4 and an IPv6 address registered. In previous
      versions, when e.g. localhost has as first address the IPv6
      address, but IPv6 was not active, it returned an error.
    - resolving against IP addresses works always.

M	nsd/sock.c

commit 52f48a0b9f5f9e21d1c29d61d818e8468240f548
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-27

    add comment

M	nsd/dns.c

commit 9fa8c14b29099d05487ba88eff07c6a0746d866f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-22

    provide always a thread name for tclthreads

M	nsd/tclthread.c

commit 2123c5759259c824ec95d085df4577a9ebd1fcc7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-19

    fix broken thread name

M	nsd/tclthread.c

commit 17a6acd7afd5e73840e01977c1d4c03a9cc50475
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-17

    fix typo

M	doc/src/naviserver/ns_time.man

commit 04156021ce3232a0cf998aae669b7e07e815f1c3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-16

    improve source code documentation

M	nsd/connchan.c
M	nsd/mimetypes.c

commit 9400b63161b7341933eadfec4e8682105f56fa9b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-16

    ns_connchan improvements:
    * ability to suspende callbacks. Previously, one could only
      terminate a callback with closing a channel automatically,
      or continuing firing events. When a callback returns now the
      value of "2", the callback will be suspended (i.e. no
      more events, but the channel is kept open)
    * ns_connchan list: return now in the listing two more fields:
      a) cmd name of the callback (eases debugging, when callbacks are
         changed dynamically)
      b) conditions used for registering

M	doc/src/naviserver/ns_connchan.man
M	nsd/connchan.c

commit f84e61d11dbb1e98633d5f3e935656657af52c80
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-13

    when "ns_connchan write" would block, return the nr of bytes written; preare for a possible automatic registry of a callback.

M	nsd/connchan.c

commit cefa7d01bfd52bb6d820ddbf82923558d3e14c8f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-13

    improve naming

M	nsd/driver.c

commit 9671c213e4334a7e2f70c1acdd83611a0b5b1d99
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-13

    whitespace change

M	nsssl/Makefile

commit d0683285a65c09879207eaafb70db79c794b04a3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-11

    fix typo, improve error message

M	nsd/urlopen.c

commit 3e291b03ad881014ce76341d329c3d25f73def28
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-11

    set error code when ns_conncptofp fails

M	nsd/conn.c

commit 73c6ab4d4cb54007b0aef6c77ad80b4e96ac2e0a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-11

    align documentation with implementation

M	nsd/connchan.c
M	nssock/nssock.c

commit 00d72ad0ca57b5e3f884e1506715eedb6a06eacb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-11

    return POSIX error codes in case "ns_connchan write" fails

M	nsd/connchan.c

commit 966e247a9da63ecd05d231421f3700b332b73385
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-10

    improve type clean-ness

M	nsd/adpparse.c
M	nsd/tclsched.c
M	nsdb/dbinit.c

commit 0f037ed84179ce1d21560f7a86f6e1158f3f721c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-09

    improve debugging outout
    return error info NS_TIMEOUT or NS_WOULDBLOCK on "ns_connchan write"

M	nsd/connchan.c
M	nsd/task.c

commit 71511a075ebb5a9ead16429c065a4c3342488e82
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-09

    add Ns_ParseHeader to output of Debug(reququest)

M	nsd/tclhttp.c

commit 0dcc3a01715f2e38ec58b4876b476896abe3783d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-07

    improve type cleanness

M	include/ns.h
M	nsd/sched.c

commit f32d5f6b830562441d28beba0c127a4eae77e1b3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-07

    remove unneeded assignment

M	nsd/tclcrypto.c

commit 2d39a90d2b4f0060181bb4f582447da8fc858cb5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-06

    name mutex properly and handle SSL_ERROR_SYSCALL without issuing a warning

M	nsd/tclhttp.c

commit 0c2551ed8ddded10aadd313d682241635779ef56
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-06

    improve comments

M	nsthread/mutex.c

commit 5f015da83775807b695aa1f582b25378184172cc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-06

    initialize and name mutexes properly

M	nsd/init.c
M	nsd/nsd.h
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclenv.c

commit a04e6ef6e83ef6e38471570da703ed213d1db698
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-06

    reduce verbosity and perform some cleanup

M	nsd/tclcrypto.c

commit 9533c0abecfe7c1b0dbfaa1197993febad1e08dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-06

    initialize and name mutexes properly

M	nsd/init.c
M	nsd/nsd.h
M	nsd/task.c

commit 9d74ea22413c4a9bde705142c9455be0ebabc097
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-06

    initialize and name mutexes properly

M	nsd/fd.c
M	nsd/init.c
M	nsd/nsd.h
M	nsd/sockcallback.c

commit 09229d25c5f51484a994648aa86fa07953e5f11d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-06

    provide compiler-flag NS_MUTEX_NAME_DEBUG for ease locating anonymous mutexes

M	nsthread/mutex.c

commit 13c320f29cccbf69cb9dc30d1e345cddd0d626d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-06

    make sure, IP address string is always non-null

M	nslog/nslog.c

commit 268e679ef2fa5a4ec3637b372c253afba7c4b16d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-06

    name mutex properly

M	nsdb/dbinit.c

commit 7f714f8f585f6b40c8d1b425beb19294ebd59f6f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-06

    init mutexes explicitly

M	nsd/tclinit.c

commit 17c9326b2ec912090ff7e2be14754918161b69e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-06

    provide name for mutex (having a proper init call would be better)

M	nsd/tclenv.c

commit 717c435848ee8e6c232c2902a5d22395133706b0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-05

    improve spelling

M	NEWS
M	README
M	nsssl/ChangeLog
M	openacs-config.tcl
M	sample-config.tcl.in
M	tests/http.test
M	tests/http_chunked.test
M	tests/ns_hostbyaddr.test
M	tests/ns_listencallback.test

commit ee9b253640abea30f9c9bb9e44e3e4301fe5e237
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-05

    improve spelling

M	openacs-config.tcl

commit 241890321ad0289c6ff295ee58402e874f5f2f80
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-05

    improve cleanness of compilation with newest compilers

M	nsd/task.c

commit 7e6d67066783507a796d23633064b9f8666fcf68
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-05

    remove duplicate man pages

D	doc/src/naviserver/ns_atexit.man
D	doc/src/naviserver/ns_atshutdown.man
M	doc/src/naviserver/ns_atsignal.man

commit 8178545c3dd856def32fd100e055b5ebba527b82
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-04

    improve spelling

M	NEWS
M	configure.ac
M	include/nsconfig.h.in
M	m4/tcl.m4
M	nsd/init.tcl
M	nsssl/README.md
M	tcl/compat.tcl
M	tcl/ns_crypto.tcl
M	tcl/nstrace.tcl
M	tcl/sendmail.tcl

commit eefde616f83f6fe50c4b6b7d36d0a33802f03d3f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-04

    add parameter "masklogaddr" of "nslog" to sample config file set to "true"

M	sample-config.tcl.in

commit 8a02091c8534c29581e775666577f1137214f749
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-04

    add parameter "masklogaddr" of "nslog" to sample config file set to "true"

M	nsd-config.tcl

commit ece8b5972b3b22c9fdfd1e568d5d82a1d4f57803
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-04

    New feature for GDPR: add option masklogaddr to mask IP addresses in access log,
    (similar to "anonip" IP anonymizer of the Swiss privacy foundation)
    
    When this parameter is set, all IP
    addresses are masked in the log file, such that the host-specific (=
    person-specific) information is masked out and the IP-address does not
    match a particular individual anymore.  Still, with the masking turned
    on, reverse DNS lookup and/or geolocation is possible. Default: false.

M	nslog/doc/mann/ns_accesslog.man
M	nslog/nslog.c
M	openacs-config.tcl

commit c25e4b095c908ff8ff7055c64257634bb37caad1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-04

    consistently capitalize term URL

M	doc/src/naviserver/ns_server.man

commit f3ffe324c4a3472d37b88e584303d972a2d7fba1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-03

    reduce implicit conversions

M	nsd/tclhttp.c

commit f80ce24a695f0f272af30c8b07d61aa6028ab788
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-03

    improve comments in source file

M	nsd/sockaddr.c

commit 663dfd5de2dd450de58ed8b1e73c622371ffb136
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-08-02

    provide URL in warning to ease debugging

M	nsd/task.c
M	nsd/tclhttp.c

commit 55c12ff4769e050ba33eb41a6625ce53676c2e89
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-31

    bump version number to 4.99.17d4

M	configure.ac

commit 80b2eee231629ee59daeaafa84ff5fdda14bf385
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-31

    add version tag to "starting" message to ease analysis in case of problems

M	nsd/nsmain.c

commit 6fd045cbe5fe67daec6749b1a98f1e54d40ea8be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-31

    make refcounting explicit

M	nsd/tclhttp.c

commit d3480c61fb197a8d56c062dee5f94587b90ec30b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-31

    get rid of warning

M	nsd/task.c

commit e82afa418f3d71cb8be37d76dce92e3c97004486
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-31

    improve spelling

M	NEWS
M	doc/README
M	include/ns.h
M	nsd/sock.c

commit 5addef5d36fde49992da86729ba815caa38cabcb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-31

    get rid of compiler warnings

M	nsd/tclhttp.c

commit 3f34b86d2e1eb47c23841c6ee5542339c0bc45b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-31

    tclhttp client improvements for HTTPS:
    API change:
    - Ns_SockTimedConnect2() returns now Ns_ReturnCode to be able to
      distinguish between timeouts and errors
    - Ns_SockConnectError(): new call to provide consistent error
      messages and to set Tcl error info consistently
    - reactivate asynchronous reading in ns_http

M	include/ns.h
M	nsd/driver.c
M	nsd/sock.c
M	nsd/tclhttp.c
M	nsd/tclsock.c

commit 74bbc5b3355b018304876fd92e3b55ae16e7af81
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-30

    tclhttp client improvements for HTTP:
    - deactivate setting SSL_SENT_SHUTDOWN, since we see strange errors
      from ephorus when it is set.
    - generalize static function WaitWritable() to WaitState()
    - return ssl info in result dict
    - improve debug output for tasks

M	include/ns.h
M	nsd/task.c
M	nsd/tclhttp.c
M	nsd/tls.c

commit 61b0438ad6be3188aef82a96d8f6a9bea9c632d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-28

    update default openacs config file

M	openacs-config.tcl

commit a240f027093e6d0fbed66e940537e6bd8d66d947
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-28

    - provide better log message, when configured value is out of range
    - update config values when range check corrects the value to get the finally configured value via introspection

M	nsd/config.c

commit 94ff22cf6f17884e00ac5a68cc75eafb1b57c5eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-28

    reduce implicit conversions

M	nsd/cache.c

commit 4e85d0124ef2d79d4d95f139b2485cebfa761654
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-25

    make conversion from void* to other type explicit (MISRA)

M	nsd/tclinit.c

commit be581cec52c151254fc5e2cb65c8cf50a76ec700
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-24

    improve spelling

M	nscgi/doc/mann/nscgi.man
M	nsd/adpparse.c
M	nsd/connio.c
M	nsd/event.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/index.c
M	nsd/limits.c
M	nsd/modload.c
M	nsd/pathname.c
M	nsd/range.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclresp.c
M	nsd/url.c
M	nsdb/doc/mann/ns_db.man
M	nsdbtest/nsdbtest.c
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c

commit 1ab7feab5609eb8ef845f84513b3bcace1e3931e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-24

    improve spelling

M	doc/src/manual/adp-overview.man
M	doc/src/manual/main-history.man
M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/ns_adp_flush.man
M	doc/src/naviserver/ns_atsignal.man
M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_memoize.man
M	doc/src/naviserver/ns_time.man

commit 5c9d81e76d363998d43343c4454594593fa64112
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-24

    improve spelling

M	nsd/tclset.c
M	nsd/tclvar.c

commit c8cbe4ec74ed063f840b1cf8d6d893efa7934171
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-24

    improve type cleanness

M	nsdbtest/nsdbtest.c

commit 9c8cf7eeb26fb100e1cc660edbce4780e7d17c90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-24

    when a chartype is specified, never assume the mimetype is binary

M	nsd/mimetypes.c

commit 4ca95444a396b8a45b76fd082a5226dc5c6e0722
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-16

    minor edits

M	nsthread/pthread.c

commit 17544e32aa52589c696a13919d2e85e0b6aa4e66
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-16

    reduce variable scope, don't reference pointer without check of valid arguments

M	nsd/tclcache.c

commit 109067c8d29161a2e7089057783ac7114e075b90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-16

    reduce variable scopes, minor cleanup

M	nsd/conn.c
M	nsd/nsd.h
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/tclvar.c

commit 3bc5d46fff648a316accc97512331d02f4e6fb01
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-13

    Add reporting of update interp operations when epoch is changed (might be an expensive operation)

M	nsd/nsd.h
M	nsd/tclcrypto.c
M	nsd/tclinit.c

commit dc06dfc90d4fdb8189e5fddb8a9570f0446d2756
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-13

    improve formatting

M	openacs-config.tcl

commit 5b6412a3c2e2b854159687750f52b6040f43453d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-13

    check for epoch updates as well in cleanup phase (deallocate trace) to reduce latency for client requests

M	nsd/init.tcl

commit 426632a4aa3b0a297ff95065420469547fae3031
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-13

    cache statistics: return hitrate as double instead of as integer

M	nsd/cache.c

commit ef863feb5b4a7901f7c05de4ec79e80442a69409
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-05

    use "ns_conn currentaddr" and "ns_conn currentport" instead of "ns_conn addr", since "ns_conn port" means actually the port specified literally in the request.
    the current* operations refer to the actual socket.

M	include/ns.h
M	nsd/conn.c
M	tests/ns_conn.test

commit 1ce75d58e3433575e6be9e63b0d94986ca3a1bc3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-05

    improve error handling, when connection is closed early and runs into a POLLHUP

M	nsd/tclhttp.c

commit fef0b655955b5fa6e2bb024de29002532e9858ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-04

    remove obsolete information from  documentation in sample config file

M	openacs-config.tcl

commit e3fec0917877c91bcb9cb1021bfd6a8e6d25efdc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-04

    reduce potentialö warnings when compiled against a version of OpenSSL without OPENSSL_NO_EC defined

M	nsd/tclcrypto.c

commit d156a12b6c200f867277290d25b431f0b7558906
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-04

    Add atomic operation "nsv_set -default ARRAY KEY VALUE".
    Add cases for regression test.

M	nsd/tclvar.c
M	tests/ns_nsv.test

commit 3d590fefcee809012d116c611c9b1d69f0a2c949
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-03

    add ns_uuid function based on OpenSSL ns_crypto::randombytes

M	tcl/ns_crypto.tcl

commit b73643044b643608eba2edd7b19a29f7a1647594
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-02

    add const declaration

M	nsd/tclhttp.c

commit fd8ed40e7eaa18e632c5aa13ab9a558b6d779b52
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-02

    simplify sampke config file for novices

M	nsd-config.tcl

commit 52c19cb975b54da590c0bff32bc9e0b19851ef3f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-07-02

    At least since visual studio 2012, MSCV has intptr_t and uintptr_t defined

M	include/nsthread.h

commit 86088772a554cd206dff824675c8f10015b3dc67
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-29

    Add an optional argument "body" to "ns_section"
    
    This change allows us to brace the ns_params belonging to this section like
    in usual Tcl blocks. This has two advantages:
    a) it shows clearly, where the block ends
    b) when using an editor with automatic indentation, the log file looks nicer without mich work
    This change is fully backward compatible, old style config files continue to work

M	nsd-config.tcl
M	nsd/config.c
M	openacs-config.tcl

commit de24c25abac52348ec6d85718107d57144ab63be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-28

    add "-reset" option to nsv_set

M	nsd/tclvar.c
M	tests/ns_nsv.test

commit f3cee361fb0e324b9f48c8acaae176a529b91388
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-28

    add section for nsstats, whitespace cleanup

M	openacs-config.tcl

commit beb95eaecd9e25a1dcbfc789149fce31b3f1a864
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-28

    use constantly capitalized URL

M	nsd/url.c
M	tests/ns_parseurl.test

commit aee15214af1a06e6b8190cf98f8961be0c575bfa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-27

    fix typo in filename

M	tcl/fastpath.tcl

commit bd6615e6337b19cec58dbe63dabb2519aa4d16a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-27

    fix indentation

M	nsd/url.c

commit e1bb9293e3bc4de8a350f1a84d9e408e7594ef6a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-27

    user braces in a more uniform way

M	nsd/tclhttp.c

commit f3be59df337f6200ccb19b15895dd07ed7469658
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-26

    Work on ns_crypto man page

M	doc/src/man.css
M	doc/src/naviserver/ns_hmac.man
M	doc/src/naviserver/ns_md.man

commit a1e115c090271ed0d2e806220174dcf0ab780358
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-26

    remove duplicated brackets

M	doc/src/naviserver/ns_schedule_proc.man

commit 0f5b0ea071039ddfa72c60ebc3d4942ae079af33
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-26

    improve man page

M	doc/src/naviserver/nsv.man

commit 1f2b1de2f9afc6361aea29b8e5a73da697aee4e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-26

    remove duplicated word

M	doc/src/naviserver/ns_getform.man

commit 257ac23d3578727b9871f522c64b5982e6ccce71
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-25

    ns_hash: provide a script-level interface for the HashStringKey function (very useful for e.g. cache partitioning)

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c

commit 7e723fe71758fb2e8d85db02fab197805920bc12
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-25

    warn after 100 instead of 200 ms about long locking calls

M	tcl/aolserver-openacs.tcl

commit 55890aed443ec37f5c006a9d7d443b71e1b90198
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-20

    minor update of mime types based on actual IANA media types

M	nsd/mimetypes.c

commit cdd459236f2bec7ad063b244e68cacb1736adc49
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-20

    Don't reuqire content-type to be specified for ns_http requests containing a body or bodyfile (although providing it is recommended)

M	nsd/tclhttp.c

commit 2bbcbd054d3c2c226a86602f4988b43ac66a0b0d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-18

    fix pidfile entry in sample config file

M	nsd-config.tcl

commit 1215e1d72df859702ca7463d22ff22feb07ded2a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-17

    add support for compiling NaviServer against versions of OpenSSL having EC support disabled

M	nsd/tclcrypto.c
M	nsssl/nsssl.c

commit d3ffb888cea8e35acff250b8c0fccc00b07f34d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-17

    bump version number to 4.99.17d3

M	configure.ac

commit 141da035b9993b3eb70ec1785fcae14a834b2e13
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-17

    make sure to initialize variables on all error paths either

M	nsd/tclcrypto.c

commit 4ffbb6d2c4345077982b28ca4fbdae7a734fa07c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-16

    fix URL parse, where URL with colon in the pathi was given, but no port provided (detected a port incorrectly)

M	nsd/tclhttp.c
M	tests/ns_parseurl.test

commit 38682f93b312f078fe03dc0dcf570a0d161a7deb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-14

    Address problem https://stackoverflow.com/questions/49031790/how-can-i-debug-a-tcl-8-6-error-in-clock-tcl
    Definition order in tcl namespaces might confuse Tcl (clock) internals

M	tcl/nstrace.tcl

commit d9f93a7aafd4fe2f4a6993400f6775340039614e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-11

    fix documentation syntax

M	doc/src/manual/admin-install.man

commit 4962e3bbcc8e04927cd8e104ea1e30606dc98bd9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-11

    let "ns_conn isconnected" return false, when the connection is already closed.
    Otherwise we have to add a new subcommand "ns_conn closed", which seems somewhat odd (isconnected true and closed true?)

M	nsd/conn.c

commit dd1b3a57655f807775dbfac2b15b175ebd7845b4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-11

    imprive spelling

M	nsd/returnresp.c

commit bc6d5f1de08d30d9541d6a5c5063f7c674da438b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-11

    Improve spelling

M	doc/src/naviserver/keyl.man
M	doc/src/naviserver/ns_absoluteurl.man
M	doc/src/naviserver/ns_addrbyhost.man
M	doc/src/naviserver/ns_adp_abort.man
M	doc/src/naviserver/ns_adp_append.man
M	doc/src/naviserver/ns_adp_argc.man
M	doc/src/naviserver/ns_adp_argv.man
M	doc/src/naviserver/ns_adp_bind_args.man
M	doc/src/naviserver/ns_adp_break.man
M	doc/src/naviserver/ns_adp_close.man
M	doc/src/naviserver/ns_adp_ctl.man
M	doc/src/naviserver/ns_adp_debug.man
M	doc/src/naviserver/ns_adp_dir.man
M	doc/src/naviserver/ns_adp_dump.man
M	doc/src/naviserver/ns_adp_exception.man
M	doc/src/naviserver/ns_adp_flush.man
M	doc/src/naviserver/ns_adp_info.man
M	doc/src/naviserver/ns_adp_mime.man
M	doc/src/naviserver/ns_adp_mimetype.man
M	doc/src/naviserver/ns_adp_parse.man
M	doc/src/naviserver/ns_adp_puts.man
M	doc/src/naviserver/ns_adp_register.man
M	doc/src/naviserver/ns_adp_return.man
M	doc/src/naviserver/ns_adp_stats.man
M	doc/src/naviserver/ns_adp_tell.man
M	doc/src/naviserver/ns_adp_trunc.man
M	doc/src/naviserver/ns_after.man
M	doc/src/naviserver/ns_atclose.man
M	doc/src/naviserver/ns_atexit.man
M	doc/src/naviserver/ns_atshutdown.man
M	doc/src/naviserver/ns_atsignal.man
M	doc/src/naviserver/ns_base64.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_cancel.man
M	doc/src/naviserver/ns_chan.man
M	doc/src/naviserver/ns_charsets.man
M	doc/src/naviserver/ns_checkurl.man
M	doc/src/naviserver/ns_cond.man
M	doc/src/naviserver/ns_config.man
M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_conncptofp.man
M	doc/src/naviserver/ns_cookie.man
M	doc/src/naviserver/ns_critsec.man
M	doc/src/naviserver/ns_crypt.man
M	doc/src/naviserver/ns_driver.man
M	doc/src/naviserver/ns_encodingforcharset.man
M	doc/src/naviserver/ns_env.man
M	doc/src/naviserver/ns_event.man
M	doc/src/naviserver/ns_filestat.man
M	doc/src/naviserver/ns_fmttime.man
M	doc/src/naviserver/ns_ftruncate.man
M	doc/src/naviserver/ns_gifsize.man
M	doc/src/naviserver/ns_gmtime.man
M	doc/src/naviserver/ns_guesstype.man
M	doc/src/naviserver/ns_hashpath.man
M	doc/src/naviserver/ns_hmac.man
M	doc/src/naviserver/ns_hostbyaddr.man
M	doc/src/naviserver/ns_hrefs.man
M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_httptime.man
M	doc/src/naviserver/ns_ictl.man
M	doc/src/naviserver/ns_imgmime.man
M	doc/src/naviserver/ns_imgsize.man
M	doc/src/naviserver/ns_imgtype.man
M	doc/src/naviserver/ns_info.man
M	doc/src/naviserver/ns_internalredirect.man
M	doc/src/naviserver/ns_job.man
M	doc/src/naviserver/ns_jpegsize.man
M	doc/src/naviserver/ns_kill.man
M	doc/src/naviserver/ns_library.man
M	doc/src/naviserver/ns_localtime.man
M	doc/src/naviserver/ns_locationproc.man
M	doc/src/naviserver/ns_log.man
M	doc/src/naviserver/ns_md.man
M	doc/src/naviserver/ns_md5.man
M	doc/src/naviserver/ns_mktemp.man
M	doc/src/naviserver/ns_moduleload.man
M	doc/src/naviserver/ns_modulepath.man
M	doc/src/naviserver/ns_mutex.man
M	doc/src/naviserver/ns_normalizepath.man
M	doc/src/naviserver/ns_pagepath.man
M	doc/src/naviserver/ns_parseargs.man
M	doc/src/naviserver/ns_parseheader.man
M	doc/src/naviserver/ns_parsehttptime.man
M	doc/src/naviserver/ns_parsequery.man
M	doc/src/naviserver/ns_parseurl.man
M	doc/src/naviserver/ns_pause.man
M	doc/src/naviserver/ns_pngsize.man
M	doc/src/naviserver/ns_purgefiles.man
M	doc/src/naviserver/ns_quotehtml.man
M	doc/src/naviserver/ns_rand.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_requestauthorize.man
M	doc/src/naviserver/ns_resume.man
M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/ns_rlimit.man
M	doc/src/naviserver/ns_rollfile.man
M	doc/src/naviserver/ns_runonce.man
M	doc/src/naviserver/ns_rwlock.man
M	doc/src/naviserver/ns_schedule.man
M	doc/src/naviserver/ns_sema.man
M	doc/src/naviserver/ns_server.man
M	doc/src/naviserver/ns_serverpath.man
M	doc/src/naviserver/ns_serverrootproc.man
M	doc/src/naviserver/ns_set.man
M	doc/src/naviserver/ns_setprivileges.man
M	doc/src/naviserver/ns_sha1.man
M	doc/src/naviserver/ns_shortcut_filter.man
M	doc/src/naviserver/ns_shutdown.man
M	doc/src/naviserver/ns_sleep.man
M	doc/src/naviserver/ns_sls.man
M	doc/src/naviserver/ns_sockaccept.man
M	doc/src/naviserver/ns_sockblocking.man
M	doc/src/naviserver/ns_sockcallback.man
M	doc/src/naviserver/ns_sockcheck.man
M	doc/src/naviserver/ns_socketpair.man
M	doc/src/naviserver/ns_socklisten.man
M	doc/src/naviserver/ns_socklistencallback.man
M	doc/src/naviserver/ns_socknonblocking.man
M	doc/src/naviserver/ns_socknread.man
M	doc/src/naviserver/ns_sockopen.man
M	doc/src/naviserver/ns_sockselect.man
M	doc/src/naviserver/ns_striphtml.man
M	doc/src/naviserver/ns_symlink.man
M	doc/src/naviserver/ns_time.man
M	doc/src/naviserver/ns_truncate.man
M	doc/src/naviserver/ns_upload_stats.man
M	doc/src/naviserver/ns_url2file.man
M	doc/src/naviserver/ns_urldecode.man
M	doc/src/naviserver/ns_urlencode.man
M	doc/src/naviserver/ns_urlspace.man
M	doc/src/naviserver/ns_uudecode.man
M	doc/src/naviserver/ns_uuencode.man
M	doc/src/naviserver/ns_write.man
M	doc/src/naviserver/ns_writecontent.man
M	doc/src/naviserver/ns_writer.man
M	doc/src/naviserver/nsv.man
M	doc/src/naviserver/returnstatus-cmds.man
M	nsdb/doc/mann/ns_db.man
M	nslog/doc/mann/ns_accesslog.man
M	nsperm/doc/mann/ns_perm.man
M	nsproxy/doc/mann/ns_proxy.man

commit b96b66cf89880c6d12ebec7e2f4f96f32e17a722
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-11

    ns_register_filter: add missing option "-first" to documentation

M	doc/src/naviserver/ns_register.man

commit 570056b089fcff9b7042e68a277e6c36d498325d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-11

    make logic more explicit

M	nsd/url.c

commit 84206ca090e3ebd37281693689d74f3a8a8b584e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-11

    move initialization after nonnull assert

M	nsd/queue.c

commit bf2d8e9feadc4b90e092f9855b4423d272488c88
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-11

    sort Ns_Conn* method prototypes alphabetically

M	include/ns.h

commit 1232c65dd8500188dd6bc4620ec540b568bd6c9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-09

    Name authenticated encryption and decryption commands ns_crypto::aead (proper name  Authenticated Encryption with Associated Data).
    Provide different names for encryption and decryption (ns_crypto::aead::encrypt and ns_crypto::aead::decrypt)

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclcrypto.c

commit c9d7147b24bf82f6353ee84dd2015f9c95418ac5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-09

    updated list of available digests in recent versions of OpenSSL

M	doc/src/naviserver/ns_hmac.man
M	doc/src/naviserver/ns_md.man

commit 59eee90f4f1c5856be966e7a800883677a1f98a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-09

    check, whether cipher support the required mode (e.g. GCM vs. CCM)

M	nsd/tclcrypto.c
M	tcl/ns_crypto.tcl

commit 072c80881c33e83a9b6d956d90f4794a3cb26b98
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-07

    added decryption to provide Authenticated Encryption and Decryption (GCM mode); better cmd name is still needed

M	nsd/tclcrypto.c

commit 417665d7e6808db9c91ad525f077243d436b10f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-06

    remove duplicated (comment) line

M	nsd/tclcrypto.c

commit 3845e2e91b3c9b1df8b6a857daf3ced4eabca43d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-06

    add proper include file

D	nsd/ns_openssl.h
A	nsd/nsopenssl.h

commit 52c5645fb48bbd97270804fc094255d7642c2d03
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-06

    Add new crypto function "ns_crypto::randombytes" to return n random bytes as provided by OpenSSL.
    Refactor code between crypto and tls specific functions.

M	nsd/Makefile
A	nsd/ns_openssl.h
M	nsd/nsd.h
M	nsd/tclcmds.c
A	nsd/tclcrypto.c
M	nsd/tls.c

commit bb71978c6e096ab61a6065fedc9108414dab1c25
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-06

    reduce number of returns before end of function

M	nsd/request.c

commit 9afb1afae2c6cd814763ed63e9d29c75cc274426
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-06

    adapt regression test due to added option in error message

M	tests/ns_conn.test

commit 7c95a9e8415c5b8df72bc09176360a5879c504f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-01

    get the server-side IP address via getsockname()

M	nsd/conn.c
M	nsd/op.c

commit 3c0de4f2393f45fa33278b343d9e0a7ce2616918
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-06-01

    Add "ns_conn addr": previously, we had "ns_conn peeraddr",
    "ns_conn peerport" and "ns_conn port" but no "ns_conn addr".
    now this is also available for symmetry.
    
    Similarly, Ns_ConnAddr() was added as new API function.
    Ns_ConnPeer() was marked deprecated, Ns_ConnPeerAddr() should be used instead.

M	doc/src/naviserver/ns_conn.man
M	include/ns.h
M	nscgi/nscgi.c
M	nsd/conn.c
M	nsd/queue.c
M	nsd/tclmisc.c
M	nslog/nslog.c

commit ff62bb72dad65c095f50362f44983f520bd0fc65
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-31

    nsssl: add module name to locak name to distinguish locks in case multiple nsssl drivers are loaded

M	nsssl/nsssl.c

commit 7ef216ad245e6bac1c7a13af1de9e885b4e2b4b4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-31

    add "UserInfoCacheSize" to sample config file

M	openacs-config.tcl

commit 4bc08a167f30de11ec1c7ebea9adb79828ea8a1e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-25

    improve spelling of proper names

M	NEWS
M	README
M	doc/src/manual/admin-install.man
M	include/nsthread.h
M	nsd-config.tcl
M	nsd/crypt.c
M	nsd/driver.c
M	nsd/log.c

commit 05964c4def74fff8c843b7fa965eaf794abf9ff4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-24

    ::ns_crypto::enc return a dict containing "bytes" and "tag" as the interp result (instead of just the bytes)

M	nsd/tls.c

commit 07cd89dafbe6e71fc1ac98c034c0ba3e5b63e864
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-24

    whitespace cleanup

M	nsssl/tests/modules/testhttps.tcl
M	tests/testserver/modules/client.tcl
M	tests/testserver/modules/listencallback-procs.tcl
M	tests/testserver/modules/testhttp.tcl

commit cd963430236f4949c915a311021d3e20e5ccb606
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-24

    improve comments

M	nsd-config.tcl
M	nsperm/htaccess.tcl
M	tcl/ns_crypto.tcl

commit f9359d9a61e1cc2f9ccd103b8ee7df6826c834f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-23

    remove of version dependency was too optimistic, reintroduce version define removed yesterday

M	nsd/str.c

commit 964a8140fc820be6fc236307a296dc3439bd9fe0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-22

    be more careful with pointern to size_t

M	nsd/tls.c

commit 7a644ec47b6f2420d7cae98e18d3076d4fa70c8b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-22

    fix compatibility issue in hkdf with linux (pointer to int vs pointer to size_t)

M	nsd/tls.c

commit f7e5648819b0fc545c62e670e1b1499a930ecde1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-22

    whitespace cleanup of .test and .tcl files

M	tcl/compat.tcl
M	tcl/file.tcl
M	tests/adp.test
M	tests/compat.test
M	tests/cookies.test
M	tests/encoding.test
M	tests/errordoc.test
M	tests/http.test
M	tests/http_byteranges.test
M	tests/http_chunked.test
M	tests/http_keep.test
M	tests/http_persistent.test
M	tests/init.test
M	tests/keylist.test
M	tests/ns_accesslog.test
M	tests/ns_addrbyhost.test
M	tests/ns_adp_compress.test
M	tests/ns_base64.test
M	tests/ns_cache.test
M	tests/ns_cond.test
M	tests/ns_config.test
M	tests/ns_conn.test
M	tests/ns_conn_host.test
M	tests/ns_crypt.test
M	tests/ns_crypto.test
M	tests/ns_driver.test
M	tests/ns_env.test
M	tests/ns_file.test
M	tests/ns_gifsize.test
M	tests/ns_hashpath.test
M	tests/ns_hostbyaddr.test
M	tests/ns_hrefs.test
M	tests/ns_httptime.test
M	tests/ns_image.test
M	tests/ns_info.test
M	tests/ns_jpegsize.test
M	tests/ns_limits.test
M	tests/ns_listencallback.test
M	tests/ns_log.test
M	tests/ns_md5.test
M	tests/ns_mime.test
M	tests/ns_nsv.test
M	tests/ns_pagepath.test
M	tests/ns_parseargs.test
M	tests/ns_parseurl.test
M	tests/ns_proxy.test
M	tests/ns_reflow_text.test
M	tests/ns_register_filter.test
M	tests/ns_register_proc.test
M	tests/ns_schedule.test
M	tests/ns_server.test
M	tests/ns_serverpath.test
M	tests/ns_set.test
M	tests/ns_sha1.test
M	tests/ns_sls.test
M	tests/ns_thread.test
M	tests/ns_thread_crash.test
M	tests/ns_urlencode.test
M	tests/ns_urlspace.test
M	tests/ns_uuencode.test
M	tests/ns_writer.test
M	tests/nsdb.test
M	tests/progress.test
M	tests/tclconnio.test
M	tests/tclresp.test
M	tests/timeout.test
M	tests/url2file.test

commit 797cb9b8eec91c1a3d541f7ada7e6b96b7086b25
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-22

    improve documentation in ns_crypto test file

M	tests/ns_crypto.test

commit 72d8c0d7a22e9c2707d8c36b05c70535be609737
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-22

    add regression tests for "::ns_crypto::md hkdf ..."

M	tests/ns_base64.test
M	tests/ns_crypto.test

commit d889d513cbe21c274deb09a17e284d6ec38767a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-22

    whitespace cleanup

M	tcl/ns_crypto.tcl

commit 8c36136f796e10a9866ac3ee586c2806e3543881
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-22

    make behavior of handling binary characters closer to Tcl

M	nsd/str.c
M	nsd/tclmisc.c

commit 2fc0dd4f393f53491d295f0f6c11727aaca71dae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-22

    extend base64 test cases, including 3-byte UTF-8 characters

M	tests/ns_base64.test

commit 2e66cdf40125f5239110e33afc422de36ef153a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-22

    ease association with partial operation in complex test case

M	tests/ns_cache.test

commit 957988519e190e55c625c4dd367fd89607d88a68
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-22

    collect all base64* tests in ns_base64.tst

A	tests/ns_base64.test
D	tests/ns_base64encode.test
M	tests/ns_mime.test
M	tests/ns_uuencode.test

commit c8ef7d68dcc37dd0ff59ebd9b5a3143e62147dc3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-22

    ease association with partial operation in complex test case

M	tests/ns_cache.test

commit 28f1e637f67e66a6b913e1bdebb4c192c49e5dec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-21

    make compiler and fb infer happy

M	nsd/tclimg.c

commit 9868b3e4316f4031a794d4c1a98de0339b70f0f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-21

    improve wordings

M	NEWS

commit 4289e7d714ff855e01bcc026407c4334c80ce4f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-21

    address differences with binary daty between tcl 8.7 and 8.6

M	nsd/str.c
M	nsd/tls.c

commit 62c0901071438e0ed656e17a3803bb363289ca91
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-21

    remove dead assignments

M	nsd/tls.c

commit 28331f617c697f51c99ae8d358efe01bdb421385
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-21

    add alternavite shared secret derivation based on EVP_PKEY based on recommended "high-level interface"

M	nsd/tls.c

commit b822d50d3f3c42cc97b89046a5e249426842ad9d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-20

    add "ns_crypto::eckey sharedsecret -pem ... -encoding ... PUBKEYSTRING"

M	nsd/tls.c
M	tcl/ns_crypto.tcl

commit 7c66e037cdd1177f7602d45442e99c459cb2d84e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-20

    improve documentation

M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/tcl-lib-file.man
M	doc/src/manual/tcl-lib-nstrace.man
M	doc/src/naviserver/ns_fmttime.man
M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_httpget.man
M	doc/src/naviserver/ns_ictl.man
M	doc/src/naviserver/ns_job.man
M	doc/src/naviserver/ns_kill.man
M	doc/src/naviserver/ns_mutex.man
M	doc/src/naviserver/ns_set.man
M	doc/src/naviserver/ns_sockopen.man
M	doc/src/naviserver/ns_sockselect.man
M	doc/src/naviserver/ns_time.man
M	doc/src/naviserver/ns_tmpnam.man
M	nssock/doc/mann/nssock.man
M	nsssl/dhparams.h

commit 08fb4c945b477de66e2b1de20572530b4b74a18b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-20

    improve comments

M	nsd/auth.c
M	nsd/driver.c
M	nsd/index.c
M	nsd/range.c
M	nsd/sock.c
M	nsd/str.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclsock.c
M	nsd/tclxkeylist.c
M	nsd/tls.c
M	nsd/urlspace.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c

commit 650c41d95ec53cd29d83393934e584de3fd5cbf0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-20

    adjust to current OpenACS

M	openacs-config.tcl

commit 2d81a78e9d3fdaac0ad7ca9f50dc634e29048f6f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-20

    - add log entry for debug(request) when connection closes

M	nsd/connio.c

commit 26546b6e8de9a18bac450631265a3e31ac49369b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-18

    remove unused variable

M	nsd/request.c

commit 267c6dab2936838f23eb71d5a7a31b3a41d72ca3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-18

    let naviserver compile with OpenSSL before 1.1.0

M	nsd/tls.c

commit 9d9d48d21f06dd74f780d2da84744bf2bd3171ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-17

    new function  ns_crypto::eckey generate -name prime256v1 -pem /tmp/foo.pem
    some minor refactoring

M	nsd/tls.c

commit b4ec97f1f8d58bd8c7679d1d1dbc562cf6418984
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-17

    improve spelling

M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_driver.man
M	doc/src/naviserver/ns_rlimit.man
M	doc/src/naviserver/ns_urlspace.man
M	doc/src/naviserver/ns_writer.man
M	nsd/log.c
M	nsd/server.c

commit 2766c132a9688bb20df0e4fe716549426967fa95
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-17

    use GetEckeyFromPem instead of GetPkeyFromPem

M	nsd/tls.c

commit 0384a1977385a82eaabe61bfa2c2108d573e0b00
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-16

    - extend crypto support for elliptic curves
      ease key handling and reformatting
        ns_crypto::eckey pub -pem /usr/local/ns/modules/vapid/prime256v1_key.pem -encoding base64url
        ns_crypto::eckey priv -pem /usr/local/ns/modules/vapid/prime256v1_key.pem -encoding base64url
        ns_crypto::eckey import -encoding base64url \
          -string [ns_base64urldecode BDwwYm4O5dZG9SO6Vaz168iDLGWMmitkj5LFvunvMfgmI2fZdAEaiHTDfKR0fvr0D3V56cSGSeUwP0xNdrXho5k]

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tls.c

commit 69000019abf4949b112d730b80ebc9148e7d4545
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-16

    fix output for encoding output option "binary"

M	nsd/tls.c

commit 62437b4f74f4247085690cba42a73103a6e1f440
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-15

    remove dead assignments

M	nsd/exec.c
M	nsd/set.c
M	nsd/tclimg.c
M	nsd/tclobjv.c
M	nsproxy/nsproxylib.c

commit 4c9380ee675b6d308ea9c7d3d1671cfb0956647f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-13

    don't write if-statements in a single line

M	nsd/url2file.c

commit fa9f8aea89af64b972279b42f2032a829bebd2b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-13

    remove dead assignments

M	nsd/adpcmds.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/connchan.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/log.c
M	nsd/queue.c
M	nsd/range.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/tls.c
M	nsd/unix.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsssl/nsssl.c

commit a9a84443ae19788fb042d67cec699e937518b434
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-13

    windows: Incorrect handle was used to perform operations on the process in Ns_WaitForProcess (many thanks to Oleg Oleinik)

M	nsd/exec.c

commit d76be1640f3a3d637b474c8899dd7fac6e5479a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-13

    make sure to create temporary files correctly under windows (many thanks to Oleg Oleinik)

M	nsd/fd.c

commit 4ce0ebc189ae58b293635fb74b0b8958361a60a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-13

    target of Ns_ObjvBool has to be int (bool can't be used, since converter assuems int). Many thanks to Oleg Oleinik.

M	nsd/conn.c
M	nsd/connchan.c

commit dd0dca5c0fd6d19ad7a2e921085771e2ad65fdc0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-13

    destination assumed to be int in Ns_ObjvIndex (many thanks to Oleg Oleinik)

M	nsd/urlencode.c

commit afe1ac24157785494142944210a50386bc7ba938
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-12

    fix regression thest for base64encode with embedded zeros

M	nsd/tclmisc.c
M	tests/ns_base64encode.test

commit 0b8c695cc7a05f825bbd772fbddec74672fc723a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-12

    prefer "fileName" over "file" as name of argument

M	include/ns.h
M	nsd/fastpath.c

commit 8ed9ba388ac2fbe5c92be4a7a98e06c39a415b7f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-12

    recomment "-Z" as default option for brotli

M	nsd-config.tcl
M	openacs-config.tcl

commit 4591d7f7e311e2bf41407c98c356b69090b142e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-12

    improve documentation

M	doc/src/manual/admin-install.man

commit 2ae6ce306dcdfe4261c7549b823cd9cfbb0a5c63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-11

    remove escaped printf statement

M	nsd/request.c

commit 9ad72f739cc48e6e69da1e7aae214ed422b2f7f7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-11

    Support brotli compression format (RFC 7932) for static content delivery
    
    Brotli achieves better result for compression for typical web
    content compared to e.g. gzip and is supported by most current
    servers. The definition of static content delivery is exactly
    the same as for static gzip content.
    
    new configuration options for ns/fastpath:
      brotli_static: should static brotli delivery checked?
      brotli_refresh: should outdated brotli compressed files be refreshed?
      brotli_cmd: OS-level command with options used for brotli compression
    
    -rw-r--r--  1 neumann  wheel   664 Jan  2 13:57 ns/pages/doc/naviserver/man.css.br
    -rw-r--r--  1 neumann  wheel  2242 Jan  2 13:57 ns/pages/doc/naviserver/man.css
    -rw-r--r--  1 neumann  wheel   843 May 11 12:28 ns/pages/doc/naviserver/man.css.gz
    
    new subcommand "ns_conn acceptedcompression" to return accepted
    compressions for the current connection

M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_return.man
M	include/ns.h
M	nsd-config.tcl
M	nsd/conn.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/request.c
M	nsd/tclmisc.c
M	openacs-config.tcl
M	tcl/fastpath.tcl
M	tests/ns_adp_compress.test
M	tests/ns_base64encode.test
M	tests/ns_conn.test

commit 1f7e8cbbd6f922169d16e183612046269d0a8b56
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-11

    reduce verbosity

M	tests/ns_reflow_text.test

commit 9f37fabe2a4acc77acca3a4d8574da40db45f934
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-11

    improve markup of default index page

M	index.adp

commit ae8f0de2d94f7fbb383e4ce6429354dfec5e74e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-11

    remove debugging output and remove unnecessary trailing NULLs

M	nsd/tls.c

commit c139524dbee68d48f9c144c5f1c0242959f788e2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-08

    fix position of break command

M	nsd/tclhttp.c

commit 1c67a537e85c6012e8f82d5e860f94e3480f6b91
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-07

    provide name for per-server urlspace lock

M	nsd/server.c

commit 3367b7a3e1d9b2738f640b1263bd19b012186409
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-05

    minor cleanuü

M	doc/src/manual/admin-install.man
M	nsd/connio.c

commit 42cd36ccdd70434dc60dc691cec2d81087d886cc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-05

    extend list of platforms for manual provisioning of __PRIPTR_PREFIX in case it is not defined

M	include/nsthread.h

commit 6695311068c96c9ab92595cb5f3c2db5317b73e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-05

    fix typo

M	nsd/tls.c

commit 0792df3860cd2f72990c7c9787a2d6728c9fb616
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-05

    improve documentation markup

M	doc/src/naviserver/ns_getcontent.man
M	doc/src/naviserver/ns_queryexists.man
M	doc/src/naviserver/ns_queryget.man
M	doc/src/naviserver/ns_querygetall.man
M	doc/src/naviserver/ns_quotehtml.man
M	doc/src/naviserver/ns_rand.man

commit 23eb61cd4c4440bad1432e989e8c46e1cea82d5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-05

    fix ns_parseformfile to handle also www-form-urlencoded (in additions to multipart/form-data)

M	tcl/form.tcl

commit f6440edcb269e051d9eba28cb04f137ab46ff047
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-05

    align output of "ns_set print" with documented behavior

M	nsd/set.c

commit cf0aec2b18fcbcb03dba3a315fb431c1bcf825ee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-05

    fix broken markup

M	doc/src/naviserver/ns_set.man

commit 566e5d95d8d636e1f7b6dc4957e0da0e2b103fa1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-05

    add cross reference

M	doc/src/naviserver/ns_parsequery.man

commit be97874ccc28a269fa6dff3b046195bd55b7c660
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-05

    improved man page

M	doc/src/naviserver/ns_getform.man

commit ab0ac5446e5bf3e7c0af34e56ca969bb0d22fb1b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-05

    add man page for previously undocumented command

M	doc/src/naviserver/commandlist.man
A	doc/src/naviserver/ns_getcontent.man

commit 5f32741c518854c9db7b1bb6fc8830660b276479
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-05

    add consolidated man page

A	doc/src/naviserver/ns_base64.man

commit 7d5d6470d9b1f7368a2472ecb7d7e626838010c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-04

    minor code cleanup

M	nsd/tclhttp.c

commit 1299ad34bb244c5f2de9a8aa0763ff3eb4a0cdb4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-04

    provide consistent spelling of proper names

M	include/ns.h

commit 88d0444acfc3ac69286fb9e96b3520cca08b8d6a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-04

    Provide consistent behavior for HTTP and HTTPS, when a connection to
    a valid host NOT listening on the specified port is tried.

M	include/ns.h
M	nsd/tclhttp.c

commit 5853328a8518ff53a7dddf72e009cd40018cfee5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-03

    use format macro PRId64 for variables of type int64_t

M	nsd/adprequest.c
M	nsd/connchan.c
M	nsd/dstring.c
M	nsd/queue.c
M	nsd/tclcache.c
M	nsd/tclmisc.c
M	nsd/tcltime.c
M	nsdb/dbinit.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsthread/mutex.c
M	nsthread/nsthreadtest.c
M	nsthread/thread.c

commit c9ecd7436e785a4df44d50c3a10dd19937109498
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-05-02

    document ns_base64urldecode and ns_base64urlencode in a common command page with ns_base64decode and ns_base64encode to show differences

M	doc/src/naviserver/commandlist.man
D	doc/src/naviserver/ns_base64decode.man
D	doc/src/naviserver/ns_base64encode.man
M	doc/src/naviserver/ns_sendmail.man
M	doc/src/naviserver/ns_uuencode.man

commit 6e0dda1fa6f20080c8589d88756e8373b8ab1ebe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-30

    improve grammar

M	nsd/request.c
M	nsd/url.c
M	nsd/urlencode.c
M	nsd/urlspace.c

commit 3c0200a66d288e711113d23fa813e228c86fe3bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-30

    improve grammar

M	nsperm/doc/mann/nsperm.man

commit 937b8725d6d549b663b020209e4c1350a0d2acdb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-30

    improve grammar

M	doc/src/manual/adp-overview.man
M	doc/src/manual/main-features.man
M	doc/src/manual/tcl-libraries.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_httpopen.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_urlspace.man

commit e13bd059dda702616b33e642c8bc01d219573a48
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-30

    reduce implicit conversions

M	nsd/cache.c

commit 633926dbc46db7b44e75413541cdf1994fb884a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-28

    make definition of argument after last typed argument more consistent

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/conn.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/info.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/pidfile.c
M	nsd/request.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/rollfile.c
M	nsd/server.c
M	nsd/tclcallbacks.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclsched.c
M	nsd/url.c
M	nsd/url2file.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsperm/nsperm.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit 673c1fc9231979692d8a126e766fbb709e54b37f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-27

    * add HMAC-based Extract-and-Expand Key Derivation Function (HKDF)
     RFC 5869 https://tools.ietf.org/html/rfc5869
         ::ns_crypto::md hkdf -digest sha256 ....
     -> requires compilation with OpenSSL 1.1.0 or newer
    * add binary output encoding for the crypto functions

M	nsd/tls.c

commit 6b6cfc618dd0bbf869255ca21a0602e69d78f48d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-27

    fix memory leak, return raw signature, minor cleanup

M	Makefile
M	include/Makefile.global.in
M	nsd/tls.c

commit 3980f39a04100b0a3a5c10e9e89c0aa426072eeb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-27

    implement ns_base64url{encode|decode} as native commands
    
    as alternative to the new commands, a flag would have been as well
    possible. however, since encoding commands are fed with often
    unpredicted data, encoding data starting with a dash might
    lead to confusions. so, for higher backwards compatibility,
    two new commands were added.
    
    extended regression test to cover interesting cases

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c
M	nsd/uuencode.c
M	tests/ns_mime.test

commit e824dd931bef0843c9d2393d9eb0a34a72687933
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-26

    Added "-encoding hex|base64url|base64" option for output encoding for
    the crypto function. Previously, all these functions returned the
    result in "hex" format. If the option is not specified, the result is
    the same as before (hex).  The encoding option was added to the
    following functions:
    - ns_crypto::hmac string
    - ns_crypto::hmac get
    - ns_crypto::md string
    - ns_crypto::md get
    - ns_crypto::md vapidsign
    - ns_crypto::enc
    
    The latter two functions are experimental
    TODO: documentation and test cases.

M	include/ns.h
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tls.c
M	nsd/uuencode.c
M	tests/ns_crypto.test

commit 6a62555f34bce0aa68a55afb97d272c362e3a151
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-26

    reduce implicit type conversions

M	nsd/tclmisc.c

commit d6dc017f15420e6c344d77cf81dcaa6aea76db46
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-25

    remove duplicated word

M	openacs-config.tcl

commit 203fe3652964514d0422dcf7229f46c7ddff4563
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-25

    improce source code documentation: remove duplicated words

M	include/ns.h
M	include/nsthread.h

commit ddb89857ac15406b02b336ac254dab9b4b9d86de
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-25

    improve documentation: remove duplicated words

M	nsdb/dbtcl.c
M	nsperm/nsperm.c
M	nsthread/nsthreadtest.c

commit 2e4731f4a8e491d13315ca32333f51cfd35d425e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-25

    improve source code documentation: remove repeated words

M	nsd/cookies.c
M	nsd/driver.c
M	nsd/set.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclobjv.c
M	nsd/tclset.c
M	nsd/urlspace.c

commit 7bbb13ed19f99acc7e2736b5faa335c9eae1af28
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-25

    improve documentation

M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_cookie.man
M	doc/src/naviserver/ns_hotp.man
M	doc/src/naviserver/ns_ictl.man
M	doc/src/naviserver/ns_job.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/ns_setexpires.man
M	doc/src/naviserver/ns_thread.man
M	doc/src/naviserver/ns_totp.man
M	doc/src/naviserver/nsv.man

commit d6a3b526b212b568c4adcf377eb0caaa9b1a5ec4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-24

    add standard environment variable to sample config file

M	nsd-config.tcl

commit 4a9bf68840f50c5775ba073ffdb63d2db34b8b6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-24

    set environment variable RANDFILE to a sensible value for NaviServer to avoid surprises, when openssl is called from the server

M	nsd-config.tcl

commit 7849f3c786d2eb87788398f6193b88d59005405d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-23

    implement deprecated ns_adp_eval and ns_adp_safeeval
    scripted based on the much more generic and flexible ns_adp_parse
    (was already changed in from documentation)

M	nsd/adpcmds.c
M	nsd/tclcmds.c
M	tcl/compat.tcl

commit 870838904550c3bf8b50f910cfe9ff7da93800b4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-23

    fix typos

M	include/nscheck.h
M	nsd/driver.c
M	nsd/random.c
M	nsd/tclxkeylist.c

commit 795422e3f293bc834ff3cc4841f2a7e7a9c3ca2e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-23

    Don't pass implementation-defined NULL after the last typed
    argument to a variadic function

M	nsd/tclcache.c
M	nsd/tclsock.c
M	nsd/tcltime.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c

commit ca13b8b2da557d36aebbc6567086013beae50a22
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-23

    move variable initializatiion aftr nonnull asserts

M	nscgi/nscgi.c

commit 865485ee5950f6bdf2aad65e6b3bad99d93a2578
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-22

    fix typo

M	sample-config.tcl.in

commit 6b54bc2e9d97e5fc4154e1e8e9e06dc879d4b21d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-22

    fix typo

M	contrib/examples/writer.tcl

commit c1445363883b9933c3440d21acaabd378a454482
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2018-04-18

    Added some copyright trivia.

M	nsd/tclimg.c

commit 0ff460a39191423da46897f8e8479b65c3bdd1cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-16

    improve documentation

M	doc/src/manual/adp-overview.man
M	doc/src/naviserver/ns_adp_argc.man
M	doc/src/naviserver/ns_adp_argv.man
M	doc/src/naviserver/ns_adp_bind_args.man
D	doc/src/naviserver/ns_adp_eval.man
M	doc/src/naviserver/ns_adp_info.man
D	doc/src/naviserver/ns_adp_safeeval.man

commit 41ba699c3de2ecb058ffbb366984b6be82e8c6c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-08

    modernize tcl code

M	bitbucket-install.tcl
M	contrib/examples/upload.tcl
M	nsd-config.tcl
M	nsdb/util.tcl
M	nsperm/htaccess.tcl
M	tcl/form.tcl
M	tcl/sendmail.tcl
M	tests/testserver/modules/client.tcl
M	tests/testserver/modules/testhttp.tcl

commit ea60916c8ab4ea15d8b0006619e2b25a4e1b1581
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-08

    reduce number of return statements before end of function

M	nsd/tclhttp.c

commit b08973fade1ff3ece7ebfa220e5b1684ebfa90ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-08

    report version of serializer during startup

M	tcl/aolserver-openacs.tcl

commit 468a0f08bee678024691e1d6c13f146d68b4305d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-04-01

    fix typos

M	nsd/nswin32.c
M	nsd/tclresp.c

commit 0b496143867f44f5080661292013ea21f5da0101
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-28

    fix typos

M	doc/src/naviserver/ns_register.man
M	nslog/nslog.c
M	nsperm/nsperm.c

commit a9a2d44ef99f36cf36a22f68f39df5339f989a64
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-15

    Omit first prefix when "-offset" is used

M	nsd/tclmisc.c
M	tests/ns_reflow_text.test

commit 2d3c0c8e00b7d1ac7846d43d3808d596a84453d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-15

    Extend ns_reflow_text with optional argument "-offset" to support e.g. incremental output

M	nsd/tclmisc.c
M	tests/ns_reflow_text.test

commit f33759bee8d557d67fba5e2a5389ec9ed58b2e45
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-13

    bump version number

M	configure.ac

commit 6415ce96ee7bae298dd0cec792b99559997df476
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-11

    fix typo

M	tests/ns_reflow_text.test

commit 9c70615ae0c66d5f45d22304aaa4315d05745217
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-09

    whitespace cleanup

M	nsd/cache.c

commit 5a96ff38fd0a5297356615254d4e4e1ef200d2fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-09

    improve warning message (it is easier to track hash keys than values)

M	nsd/cache.c

commit 5495fd591bd737346494265175986a32d90149db
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-09

    add comment

M	nsd/queue.c

commit c38c8b4f444e78391f19d4e8113476a4be60b61c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-05

    ns_reflow_text: Improve handling for overflow lines, extend regression test

M	nsd/tclmisc.c
M	tests/ns_reflow_text.test

commit ac9d695101fd6a547893da9c02494f8cc09c841b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-05

    fix typos

M	nsd/connio.c
M	nsd/tclhttp.c

commit 0c0de81049220ea39a7d9b5d9eb22a5ed9ce510e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-03

    Prefer Tcl_DString over Ns_DString

M	nsproxy/nsproxylib.c
M	nsssl/nsssl.c

commit c4496bd222dfce87d787a9624503c8d578a91363
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-03

    whitespace changes

M	nslog/nslog.c

commit 3f185685c8228367c0d7676f44d5037cf9430340
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-03

    prefer Tcl_DString over Ns_DString

M	nslog/nslog.c

commit 0809e426b9c1aeb643a18f35e8cf62ae1bb36852
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-03

    Prefer Tcl_DString over Ns_DString

M	nsd/config.c

commit a1c90c99a8a7a496c440f8df18ec49031876a654
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-01

    improve results of [ns_cache_stats -contents ...]
    
    - return key and list of values (to ease association between entry and statistics; previously, guesswork was needed)
    - return additionally reuse count
    
    One can easily now check,
    - what are the hottest entries in a cache (effected most by a long lock)
    - what are the lease used entries (is it worth caching these?)
    - what are the largest entries in a cache, etc.
    
    Example usage:
       set stats [ns_cache_stats -contents util_memoize]
       join [lsort -decreasing -integer -index 2 $stats] \n

M	include/ns.h
M	nsd/cache.c
M	nsd/tclcache.c

commit a99af278b7765a80a61e5b451d32592aaf90bf3e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-01

    extend regression test

A	tests/ns_reflow_text.test

commit d2a7aeccfe9ea036b1d52585b231afb52f10eb5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-03-01

    Add experimental command ns_reflow_text, since Tcl solutions are surprisingly slow on largish input

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c

commit cf3ebbedc77330f8901428aed1d33dfff1307589
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-22

    add "pure" attributes, sort prototypes for Ns_Conn alphabetically

M	include/ns.h
M	nsd/cls.c
M	nsd/nsd.h
M	nsd/sls.c
M	nsd/tclcache.c
M	nsd/tclmisc.c
M	nsd/tclvar.c
M	nsthread/thread.h

commit debee23ba23cc373d04af40ca90610736fd18204
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-19

    provide subsite based error pages

M	openacs-config.tcl

commit 4076bae3ebcfb72198e8b243dbeecac7e762cf9e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-19

    add "pure" specifier

M	include/ns.h
M	nsd/form.c
M	nsd/nsd.h

commit efc0391bbe5c27fcf663db962af6f2d765da96da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-19

    align format speficier to avoid warnings with most recent changes in tcl 8.7a2

M	nsd/driver.c

commit 38704ffb0f8e4b9021f823dc4e01b7db7ed0e37a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-14

    bugfix for deprecated command: fix fetching of handle

M	nsdb/dbtcl.c

commit fb45bbec2083840ea47d3109354e6ada1a4c8fe7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-14

    Make sure, a non-null assertion is not violated in error case

M	nsd/tclhttp.c

commit 00dfe30c8def2d6fd8a8086d6932916479a2d2ce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-13

    reduce implicit conversions

M	nsd/tclhttp.c

commit f602484f40f527fe9b40678d926d7ce554a90721
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-13

    Provide compatibility with Tcl 8.7.2 (removed CONST and VOID macros)

M	include/ns.h
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/info.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/progress.c
M	nsd/queue.c
M	nsd/quotehtml.c
M	nsd/random.c
M	nsd/set.c
M	nsd/sls.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclconf.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/tls.c
M	nsd/url.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsdb/dbtcl.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsssl/nsssl.c
M	nsthread/nsthreadtest.c

commit c024a5ea2ceee9a24a599e2586163877b20d9648
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-12

    experimental support for "ns_http stats"

M	include/ns.h
M	nsd/task.c
M	nsd/tclhttp.c

commit 618e6b20105dc5c5bcb0b7f32f82acf66fb46977
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-12

    Fix quoting in man page for ns_quotehtml, add keyword "encoding"

M	doc/src/naviserver/ns_quotehtml.man

commit 601fb2218eba27155dbd0223a81cd296c9e77e2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-05

    bump version number to 4.99.17d1

M	configure.ac

commit 08a9dc17c4ff42f9a9b844889a5a7ef723b0151c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-05

    return uniform results for "ns_http wait" and "ns_http run" in form of a list of attribute/value pairs (dict)
    
    Background:
    Previously, the commands returned different results, depending on the options
    - "ns_http run" returned the name of the queued command
      (which was completely useless, this the queued command was already terminated)
    - "ns_http wait" returned sometimes the body of the reply (when the reply
      was not spooled) or empty (spooled) or "1", when the option "-R" was specified
    
    Now the result is always a dict, maybe mirroring the result of the (optional)
    output variables, which continue to work.
    
    Since the results were irregular and not documented in the man pages,
    the backward compatibility should be high. Also the regression test
    of NaviServer was not effected.

M	doc/src/naviserver/ns_http.man
M	nsd/tclhttp.c

commit 7b9ec869b5e6f165d9cfe6aacb3ca1c096fc44f5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-05

    prefer boolean over int when appropriate

M	nsd/nsd.h
M	nsd/return.c

commit 636ae19cbd915a1982837415e47ff6e7fef8507c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-05

    prefer boolean over int when appropriate

M	nsd/connio.c
M	nsd/crypt.c

commit f04c53ccbde3b72fecfe63a83083c59906f98fe1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-05

    prefer boolean over int when appropriate

M	nsperm/nsperm.c

commit ad4942567392f3348b0e39d9d3fe14c87cbd1412
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-05

    add nonnull assertion, prefer boolean over int when appropriate

M	nsd/driver.c

commit 1c5f3ec64dfd7422aaec25d98b4cc4ecdbea1686
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-05

    reduce implicit conversions

M	nsd/conn.c

commit d82acb5f486d00ac3cc0b56feea01128b4cf6b18
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-04

    reduce verbosity

M	nsd/tclhttp.c

commit 74cdd6a6a36d4d244510571674adc19ca07f6cab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-04

    reduce verbosity

M	nsd/tclhttp.c

commit f82cf95f730908ff7607e44624be780eb53c84da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-03

    Add option "-outputfile" to "ns_http run" and "ns_http wait", provide a more sensible output to "ns_http run"
    
    - by specifying the option "-outputfile" the received file will be always
      written to the disk, no matter how large it is.
    - the command "ns_http run" did previously return the http handle,
      which was useless, since the named task was already finished at this
      time. Now it returns the ns_set of the reply_headers.

M	doc/src/naviserver/ns_http.man
M	include/ns.h
M	nsd/tclhttp.c

commit c8e4711c8d9ada3a886712cd4680ea6593cb5b57
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-03

    improve error message

M	nsd/tclset.c

commit 84d8c190cc42f843601be5cb024de654ed3ddc47
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-03

    whitespace changes: switch to vertical layout of argument lists, as this is as well preferred by tcl guide-lines

M	nsd/tclhttp.c

commit 28c769734fed870487c70d195571f0924f0b9b7a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-02

    new feature: provide means for storing downloaded data in a named file
    
    THe command "ns_http wait" has now an additional option "-body_file" (simiöar
    to "ns_http queue" which can be used to specify a filename for the downloaded content"

M	doc/src/naviserver/ns_http.man
M	include/ns.h
M	nsd/tclhttp.c

commit 50b160a1edb1bf87c71db713cf2ba3fb32b76ac2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-02

    use HTTP instead of http

M	tests/ns_server.test

commit 23cb9a5a30280d97c911166a190b4e5f4d9807d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-02

    keep lowercase

M	nssock/nssock.c

commit b2c94a08460fbdef134cbe6433204107914466a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-02

    fix typo

M	doc/src/naviserver/ns_set.man

commit baad3b42124ffd52dd1ae2b08d02f557aa513d2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-02

    fix typos

M	nsd/driver.c
M	nsd/mimetypes.c
M	nsd/queue.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/urlspace.c
M	nssock/nssock.c
M	nsthread/thread.c
M	win/cgitest/main.c

commit affa23570f6075a7da4ecf4b2d482c6e804a2b13
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-02-01

    fix typos

M	nsd/cache.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/queue.c
M	nsd/sched.c
M	nsd/sock.c
M	nsd/tclcache.c
M	nsd/tclvar.c
M	nsthread/winthread.c

commit e0ca427906c62d3da94a36e6c77c2f780bc458cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-31

    silence static checker

M	nsd/conn.c

commit fe8871bbfabf3b03a4f88da996dd18e7724f656a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-22

    don't try to serve redirected files in case the connection is already closed (will lead only to confusing messages)

M	include/ns.h
M	nsd/returnresp.c

commit 89542ec15df94eb58bfc306a08ece2129cf35c01
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-22

    try to deal with "fall-though" checking in newer gcc versions (e.g. 7.1)

M	nsd/adpeval.c
M	nsd/log.c

commit 3ce875500d5acbdca40db549fecbec598d5de4be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-22

    Improve type cleanness

M	nsd/driver.c
M	nsd/tclobj.c

commit ee705fad01cda002b959f14760b4e3036eb3ec21
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-22

    code smell reduction: CHECK_FUNCS can check multiple functions

M	configure.ac

commit 5df973ec32aac076dfc129c0c6232e8a6b72e31a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-20

    Extend sample config file for OpenACS

M	openacs-config.tcl

commit e6f1113c7e5033c6aa6c6eb465777a00a6736ba6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-20

    add missing fetch commands for obtaining handles (on obviously seldomly used subcommands)

M	nsdb/dbtcl.c

commit 1c76fff1998fccd9c3f712b078a11a9d3d174782
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-20

    avoid potential NULL dereference in error case

M	nsd/tcljob.c

commit 4d8bb4485d76207475a13f786e22a18939e44832
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-20

    avoid potential NULL dereference and simplify logic

M	nsd/rollfile.c

commit c5758ca02a89f5dcecc4557efe4d0667f6e9206b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-20

    Avoid potential NULL dereference

M	nsd/adpeval.c

commit 700414a2699df0efa1d251af9932ae504abb4989
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-02

    - use same initialization for enablelclpages when configured over "ns/server/$server"
      or over "ns/server/$server/adp" to avoid subtle differences on global variables
    - use more consistent log entries (mentioning the server)

M	nscp/nscp.c
M	nsd-config.tcl
M	tcl/config.tcl
M	tcl/file.tcl

commit f5d0948c29dec7fe0270f6765b7dca3d16e2798d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2018-01-02

    bump version number to 4.99.17d0

M	configure.ac

commit 92afbd62808c1793e7c63dd7fb96c771c6c45883
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-29

    Added tag naviserver-4.99.16 for changeset 8c1d0715d066

M	.hgtags

commit cedc7270c76484a6f4829ea81311f7e677aecf32
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-29

    Update version numbers

M	configure.ac

commit e9fa9751997853c57255e5a185cab4790c8733a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-29

    update docs

M	NEWS
M	README

commit 0a9b5f71a51a6059443594d487dfd66790f6dc06
Merge: fc40d858 bb03e0ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-29

    merge

commit fc40d85899a3b15b0263b85c1074d1fb8e9a870f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-29

    Provide compatibility for macOS High Sierra
    
    macOS High Sierra raises "Broken pipe: 13" errors for the
    http.test regression test. It seems to ignore the setting
    
        ns_sigmask(SIG_BLOCK, &set, NULL);
    
    in unix.c where "set" contains SIGPIPE. Therefore, we turn
    off SIGPPIPE directly on the socket.

M	nsd/sock.c

commit 9e7f6a2f505e854f8f668c7e241ffc400b2d6f15
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-29

    Make fall-though comments more regular

M	nsd/adpeval.c
M	nsd/log.c
M	nsd/tclthread.c
M	nsdb/dbutil.c
M	nsthread/winthread.c

commit 069863ba9dc638400e4ee1ef12c78f2f17ba2aa6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-29

    Fix over-eager assertion

M	nsd/set.c

commit bb03e0ace33b02a91d7c7b828533ef0af06f1289
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-25

    Fix assert

M	nsd/set.c

commit cbbb0d4b339d8d82dcb73adf78e1575e8929ddd3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-24

    make implicit fall through comments more regular

M	nsd/adpeval.c
M	nsd/log.c
M	nsd/tclthread.c
M	nsdb/dbutil.c
M	nsthread/winthread.c

commit d961da5087892e0e7e41ddcd45c46880d6d943be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-22

    Update News and bump version number to 4.99.16b3

M	NEWS
M	configure.ac

commit 71988117cd59ac9a8df5583e04c7449ce95c212c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-22

    Fix typos

M	doc/src/naviserver/ns_limits.man-retracted
M	include/Makefile.win32

commit 3ee666e77740c9fee6516e60e983403b0b92319f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-22

    Restrict value range to make sure that no buffer overflow can happen

M	nsd/rollfile.c

commit 8b4d950a5d4db0e1220912e2fffd89f7bdf1644f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-22

    Use snprintf() instead of sprintf() to protect better against buffer overflows

M	nsd/connio.c
M	nsd/driver.c
M	nsd/log.c
M	nsd/rollfile.c
M	nsd/server.c
M	nsd/tclhttp.c
M	nsd/urlspace.c
M	nsproxy/nsproxylib.c
M	nsthread/memory.c
M	nsthread/nsthreadtest.c
M	nsthread/reentrant.c

commit 52fad77969ae5bb9a2333a3b0d534ded5b6e30c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-22

    Improve robustness of bytearray operations (having string representations)
    New API function NsTclObjIsEncodedByteArray() to determine, whether Tcl_UtfToExternalDString() is required to get the binary content

M	include/ns.h
M	nsd/nsd.h
M	nsd/str.c
M	nsd/tclmisc.c
M	nsd/tclobj.c
M	nsd/tls.c

commit 351e44cdf9d7f72b1e9f010e572be171d6bf07f7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-22

    Use old style initialization for LibreSSL

M	nsd/tls.c

commit 46772465754de0902a8fbdd2a610b26df59a0fea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-22

    Add support for LibreSSL 2.6.4 (releasd on Dec19)

M	nsd/tls.c

commit 234e1b77e7b44ab9cb228ae98e2e02c43004667c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-22

    Provide minial upport for LibreSSL

M	nsd/tls.c

commit 24dba0bd2f58bcc76452f924f81d46ee4d00a4e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-22

    deal with systems having no RLIMIT_AS

M	nsd/tclmisc.c

commit 2f9b362c07ef4d544cabca0e4b6fb140a6e31cac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Update version numbers for release candidate

M	NEWS
M	configure.ac
M	include/nsconfig.h.in

commit 6c8c2654fc331eaea29e5e5e962b4d07606b778d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Updated NEWS for release candidate

M	NEWS

commit eaf07f2b4d5afc531c7aa576ae06787e2c9b8fc7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    fix typos

M	nsd/cache.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/queue.c
M	nsd/server.c
M	nsd/sock.c
M	nsd/tcltime.c
M	nsproxy/nsproxylib.c
M	nsthread/cslock.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	nsthread/thread.c

commit a13ea82e129fd010db926d9df8e58a05d99b82de
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Fix typos

M	nsd/cache.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/queue.c
M	nsd/server.c
M	nsd/sock.c
M	nsd/tcltime.c
M	nsproxy/nsproxylib.c
M	nsthread/cslock.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	nsthread/thread.c

commit 5afd034d6f2e0cb51ccf91cd5ab5d52f878a9af1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Fix typos

M	doc/src/manual/adp-overview.man
M	doc/src/manual/main-standards.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_env.man
M	doc/src/naviserver/ns_guesstype.man
M	doc/src/naviserver/ns_info.man
M	doc/src/naviserver/ns_mutex.man
M	doc/src/naviserver/ns_runonce.man
M	doc/src/naviserver/ns_truncate.man

commit d8d92129e7b526b52df95647865fefa5f98d5c11
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Fix markup

M	doc/src/naviserver/ns_runonce.man

commit 535bd65e1c3f1acb883c4540111ad83d5b8e6684
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Add section about Cache Transactions

M	doc/src/naviserver/ns_cache.man

commit a222c71c9d06cd6928cb5c78025e7c7ca10d3545
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Fix typos in source files

M	nsd/adpparse.c
M	nsd/cache.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/queue.c
M	nsd/server.c
M	nsd/sock.c
M	nsd/tclobjv.c
M	nsd/tcltime.c
M	nsproxy/nsproxylib.c
M	nsthread/cslock.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	nsthread/thread.c

commit 3306dd04f9663fe7d9918c8d6f0ebf16f4decf11
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    update date in template

M	NEWS.template

commit 7c70db4e7b2b9ad9e826ede7c96266d12c060599
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Fix typo

M	nsd/queue.c

commit db59de6fa40aa2921e3e9e4ba147f5aef6b11dcb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Include "ns_conn chan" in man page (command still experimental)

M	doc/src/naviserver/ns_connchan.man

commit 2896c494dcc978256408434a085cd30ec191af3f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Fix broken example and broken markup

M	doc/src/naviserver/ns_adp_include.man

commit d49a4ee23aea2eb1a8a73903f2dc56b09f3be6f9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Reduce verbosity

M	nsd/set.c

commit 8126aa6165cb8bae2037756651c1039474c025e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-21

    Reduce verbosity

M	nsd/connchan.c

commit a0f30cf210cb0eda7adeee919e212355cfade73d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-20

    Removed dead assignment

M	nsd/tclhttp.c

commit e7e35473c45523ab6ffaf095f84ac3ca5ca48984
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-12

    make new behavior (reject NsConnRequire() operations on already closed connections) optional (enabled by default, but give people a chance to fix their code)
    
    Introduced ns/parameter config value "rejectalreadyclosedconn", which is per default true.
    added parameter to sample config files

M	nsd-config.tcl
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit 77f99804a32c4d38cd9c9bb6f0246c197c2fc3b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-12

    Improve debug message

M	nsd/driver.c

commit 560bfd616bc4fec44b6ff3dafe364deb00923bc9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-12

    White space changes: trim trailing spaces

M	nsd/connio.c

commit 8095b27b2f3c6484f99e7d69cad55ddd20037e50
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-12

    fix variable name

M	nsd/driver.c

commit 703a9ddaa8684cf781908b4415956c84fa579f78
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-12

    provide more details about the broken read operation

M	nsd/driver.c

commit aa9a4907b55c7afecc5ee90a276203763143be93
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-11

    Check status of ns_parsetime: still performance wise useful for current versions of Tcl

M	nsdb/util.tcl
M	tcl/util.tcl

commit 75f53fbf07258dd3807e0a5d1e3a3fb6037c44e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-11

    Improve compatibbility with ancient versions of OpenSSL

M	nsd/tls.c

commit fff1150d6b38db57c92c82012a43c0fccb5907e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-11

    Improve compatibility with ancient versions of OpenSSL

M	nsssl/nsssl.c

commit e55f733e3726c0a4ae0168ec1716703ccdb060c8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-11

    Remove duplicated definition block

M	include/nsthread.h

commit 6a48a0887c9135f363c9b09026f1beb4f7b470a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-10

    return NS_ERROR from NsConnRequire() when called on a closed connection.
    
    Background: one sites returns sometimes a "Fatal: Tcl_RegisterChannel: duplicate channel names"
    from Tcl 8.5 or Tcl 8.6. Up to my understanding on possible way for this to happen is, when
    a C extension or NaviServer closes a file descriptor owned by Tcl. Being more carefule
    on operations on closed connections might help to simplify complex error situations.

M	nsd/conn.c

commit 4a7b76742e757fac7aea8949ff9a41c5b61dfa8a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-10

    whitespace changes

M	nsd/connchan.c
M	nsproxy/nsproxylib.c

commit 9fe79ca447da9f76e28b6c768b3a16456d6f3460
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-10

    ns_proxy service:
    - bring subcommands into alphabetical order to ease consistency checks with docs
    - reduce size of mega switch statement
    - document undocumented functions
    - fix typos in documentaton

M	nsproxy/doc/mann/ns_proxy.man
M	nsproxy/nsproxylib.c
M	tests/ns_proxy.test

commit 3a1081352fde8a867bc4f4c449abd48550122b7a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-10

    Fix bracket in man page

M	doc/src/naviserver/ns_http.man

commit da8b9b56222ace7b9109848cb7e957380fa11e87
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-08

    Bump version number to 4.99.16b1

M	configure.ac

commit 790c599ddb18b62a97f9b6666301b4c81063dee3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-08

    whitespace change: use unix style lf (like in all other files) instead of crlf

M	nsssl/README.md

commit cbdf38e6a1b147fa55b999f2da952dcc9a1eadf6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-08

    Improve documentation of new features

M	nsssl/README.md

commit 3ede34193459f72cf83f53c9c2b7237fe64bc644
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-08

    Added support for client side Server Name Indication (SNI) in ns_http via new parameter "-hostname"

M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_httppost.man
M	include/ns.h
M	include/nsconfig.h.in
M	nsd/tclhttp.c
M	nsd/tls.c
M	nsssl/README.md
M	nsssl/nsssl.c

commit 709df224546a84704aad4285248dd87e431e96b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-08

    Improve man page and add cross reference

M	doc/src/naviserver/ns_writer.man

commit ddb898eff52fbff7866efe25af01fa88a1e1c023
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-03

    reduced mismatched essential type categories for binary operator

M	nsd/tclresp.c

commit ac98a7646fac3a8d0cd3506f76e473230801ddcc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-03

    use consistently boolean for "fetchingRows"

M	nsdb/dbinit.c
M	nsdb/nsdb.h

commit 7efa47049f45a6d942df385eb00ec62f1bb66670
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-03

    use INTCHAR consistently in strchr()

M	nsd/adpparse.c
M	nsd/fastpath.c
M	nsd/request.c
M	nsd/tcltime.c

commit 768802a6644c6b474577f34acba4fe55bc0c7287
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-03

    fix argument type (*NewBooleanObj receives int)

M	nsd/tclcache.c

commit f3c1923cf6ec0c6bada0dfe3865bceb74e04e3c8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-03

    Improve formatting

M	nsd/event.c

commit de06206cf7bf64f87422637d8be798fbda7a1d07
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-03

    remove constness die to external prototype

M	nsd/nsconf.c

commit 93fe7c7aac74679e26ec4f5c17147ecf6a105968
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-03

    Use consistently uintptr_t for thread ids, prefer bool over int

M	nsd/tcljob.c

commit 3987b1d335f55a57609d4c6c9b3df4ba99bff9e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-02

    further documentation cleanup: use [option] more consistently

M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_adp_append.man
M	doc/src/naviserver/ns_adp_ctl.man
M	doc/src/naviserver/ns_adp_include.man
M	doc/src/naviserver/ns_adp_parse.man
M	doc/src/naviserver/ns_adp_puts.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_chan.man
M	doc/src/naviserver/ns_choosecharset.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_cookie.man
M	doc/src/naviserver/ns_env.man
M	doc/src/naviserver/ns_htmlselect.man
M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_httppost.man
M	doc/src/naviserver/ns_job.man
M	doc/src/naviserver/ns_kill.man
M	doc/src/naviserver/ns_moduleload.man
M	doc/src/naviserver/ns_parseargs.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/ns_runonce.man
M	doc/src/naviserver/ns_schedule.man
M	doc/src/naviserver/ns_schedule_daily.man
M	doc/src/naviserver/ns_schedule_proc.man
M	doc/src/naviserver/ns_schedule_weekly.man
M	doc/src/naviserver/ns_sockcallback.man
M	doc/src/naviserver/ns_sockcheck.man
M	doc/src/naviserver/ns_sockopen.man
M	doc/src/naviserver/ns_sockselect.man
M	doc/src/naviserver/ns_symlink.man
M	doc/src/naviserver/ns_truncate.man
M	doc/src/naviserver/ns_writer.man
M	doc/src/naviserver/nsv.man
M	nsproxy/doc/mann/ns_proxy.man

commit 3c74c398be3201ec231a275325462ee6425ae6ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-02

    documentation improvements
    
    - provide for every module the name of the module as keyword
    - fix missing and deprecated commands in nsperm

M	doc/src/naviserver/commandlist.man
M	nscgi/doc/mann/nscgi.man
M	nscp/doc/mann/nscp.man
M	nsdb/doc/mann/ns_db.man
M	nslog/doc/mann/ns_accesslog.man
M	nsperm/compat.tcl
M	nsperm/doc/mann/ns_perm.man
M	nsperm/doc/mann/nsperm.man
M	nsproxy/doc/mann/ns_proxy.man
M	nssock/doc/mann/nssock.man
M	nsssl/doc/mann/nsssl.man

commit 62024c114213c90d1fdac01cb4823c7ba216ae66
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-02

    prefer expand operator over eval

M	tcl/util.tcl

commit 13f62b3dbda73dc8e9b34252015fdf45f3c34e01
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-01

    Provide error message when check fails and fix check

M	doc/src/naviserver/ns_adp_include.man
M	doc/src/naviserver/ns_http.man
M	nsd/tclhttp.c

commit 80dc2434e54c3aec89c93af3b2a55106d57aa0ec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-01

    provide better error message, when test fails

M	tests/http.test

commit 1b01fd8994301f65eaff686da264378f1f04cdf2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-01

    Fix typo in man page name

R091	doc/src/naviserver/ns_setprivileges.man	doc/src/naviserver/ns_setprivileges.man

commit 958c7aedf34c9d4346169f2f3711865c02c6aed6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-12-01

    move ns_updateheaders (undocumented function) to deprecated commands, since it was deprecated with AOLserver 3.0

M	doc/src/naviserver/commandlist.man
M	tcl/util.tcl

commit c72c0f644529a3a71a7988ee8df129c195bdeb29
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-30

    Code cleanup:
    
    - reduce number of returns before end of function
    - prefer Ns_ReturnCode over int

M	include/ns.h
M	nsd/unix.c

commit cf12041675f9b2125db1f67d85610a82224d87dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-29

    Add notice, when auto-closing db-handles to ease debugging of potential problems with closed/broken db connections

M	nsdb/dbinit.c

commit 9281d795ccc77a9d0867e8311e9c1dd2600ab9cb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-24

    Documentation improvements:
    
    add descriptions for
    - ns_quotelisttolist
    - ns_getcsv
    - ns_dberrorcode
    - ns_dberrormsg
    - ns_dbconfigpath
    - ns_pooldescription
    
    mark builtins from modules as per-server

M	nsdb/doc/mann/ns_buildsqldate.man
M	nsdb/doc/mann/ns_db.man
M	nslog/doc/mann/ns_accesslog.man
M	nsperm/doc/mann/ns_perm.man
M	nsperm/nsperm.c
M	nsproxy/doc/mann/ns_proxy.man

commit dd1b966ddc32ce5cf08de687f59930d89e61c386
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-24

    Improve robustnaess, when invalid URLs aer given

M	nsd/tclhttp.c

commit c42334526fb96093bf6ce5406abfb8adca7e2337
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-24

    Fix man-page generation

M	doc/src/naviserver/commandlist.man

commit 1a6229869c7a55e060eaf8d1ac7075f1231f196f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-23

    Robustness improvement: don't Fatal on invalid URLs passed to NSDriverClientOpen, but spit out a warning

M	nsd/driver.c

commit d87cb155ef53c9695d343a22b7da870f9c477afa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-21

    Change in debugging entry, when mutexlocktrace is activated:
    
    Use thread name instead of hex ID to further ease matching of entries

M	nsthread/mutex.c

commit 46d58eb68d80b1a76a14854ccc82077976ecee28
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-21

    Added new config parameter for nslog: "logthreadname"
    
    When the parameter is specified, the thread name is placed as second
    field in the access.log.  This eases debugging, since one can now link
    the lines in error.log caused by a request with the line in the
    access.log without the need of guessing. The thread name contains the name of the connection pool and a connection id.

M	nsd-config.tcl
M	nslog/nslog.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit 25ee2a218f78175abc88b31525cb4f087bf38174
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-18

    Further documentation updates

M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_driver.man

commit 45211c6641aa09c9ef3c5b991a44f4ce9bc14454
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-18

    Resolve potential naming conflict
    
    The command NsTclEnvObjCmd() is/was registered twice, once as "ns_env"
    and once as "env". Since the latter is not documented, adds no functionality
    over "ns_env", does not follow the usual naming conventions and poses
    therefore a potential naming conflict, mark it as deprecated.
    The C implementation of "env" was replaced by a Tcl one, which will complain.

M	nsd/tclcmds.c
M	tcl/compat.tcl

commit b9db5457c9118d8987f7c39b9d7cf4ad50a6fbc3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-18

    Make sure, the buffer is large enough to contain string terminator

M	nsd/tclobj.c

commit 1fd0e32e98c2cd0b80adcd55c7ab6c1e352eac42
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-17

    add keywords for "global builtin" and "server builtin"

M	doc/src/man3/Ns_Sls.man
M	doc/src/naviserver/keyl.man
M	doc/src/naviserver/ns_absoluteurl.man
M	doc/src/naviserver/ns_addrbyhost.man
M	doc/src/naviserver/ns_adp_abort.man
M	doc/src/naviserver/ns_adp_append.man
M	doc/src/naviserver/ns_adp_argc.man
M	doc/src/naviserver/ns_adp_argv.man
M	doc/src/naviserver/ns_adp_bind_args.man
M	doc/src/naviserver/ns_adp_break.man
M	doc/src/naviserver/ns_adp_close.man
M	doc/src/naviserver/ns_adp_ctl.man
M	doc/src/naviserver/ns_adp_debug.man
M	doc/src/naviserver/ns_adp_dir.man
M	doc/src/naviserver/ns_adp_dump.man
M	doc/src/naviserver/ns_adp_eval.man
M	doc/src/naviserver/ns_adp_exception.man
M	doc/src/naviserver/ns_adp_flush.man
M	doc/src/naviserver/ns_adp_info.man
M	doc/src/naviserver/ns_adp_mime.man
M	doc/src/naviserver/ns_adp_mimetype.man
M	doc/src/naviserver/ns_adp_parse.man
M	doc/src/naviserver/ns_adp_puts.man
M	doc/src/naviserver/ns_adp_register.man
M	doc/src/naviserver/ns_adp_return.man
M	doc/src/naviserver/ns_adp_safeeval.man
M	doc/src/naviserver/ns_adp_stats.man
M	doc/src/naviserver/ns_adp_tell.man
M	doc/src/naviserver/ns_adp_trunc.man
M	doc/src/naviserver/ns_after.man
M	doc/src/naviserver/ns_atclose.man
M	doc/src/naviserver/ns_atexit.man
M	doc/src/naviserver/ns_atshutdown.man
M	doc/src/naviserver/ns_atsignal.man
M	doc/src/naviserver/ns_base64decode.man
M	doc/src/naviserver/ns_base64encode.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_cancel.man
M	doc/src/naviserver/ns_chan.man
M	doc/src/naviserver/ns_charsets.man
M	doc/src/naviserver/ns_checkurl.man
M	doc/src/naviserver/ns_cond.man
M	doc/src/naviserver/ns_config.man
M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_conncptofp.man
M	doc/src/naviserver/ns_cookie.man
M	doc/src/naviserver/ns_critsec.man
M	doc/src/naviserver/ns_crypt.man
M	doc/src/naviserver/ns_encodingforcharset.man
M	doc/src/naviserver/ns_env.man
M	doc/src/naviserver/ns_event.man
M	doc/src/naviserver/ns_filestat.man
M	doc/src/naviserver/ns_fmttime.man
M	doc/src/naviserver/ns_ftruncate.man
M	doc/src/naviserver/ns_gifsize.man
M	doc/src/naviserver/ns_gmtime.man
M	doc/src/naviserver/ns_guesstype.man
M	doc/src/naviserver/ns_hashpath.man
M	doc/src/naviserver/ns_hostbyaddr.man
M	doc/src/naviserver/ns_hrefs.man
M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_httptime.man
M	doc/src/naviserver/ns_ictl.man
M	doc/src/naviserver/ns_imgmime.man
M	doc/src/naviserver/ns_imgsize.man
M	doc/src/naviserver/ns_imgtype.man
M	doc/src/naviserver/ns_info.man
M	doc/src/naviserver/ns_internalredirect.man
M	doc/src/naviserver/ns_job.man
M	doc/src/naviserver/ns_jpegsize.man
M	doc/src/naviserver/ns_kill.man
M	doc/src/naviserver/ns_library.man
M	doc/src/naviserver/ns_localtime.man
M	doc/src/naviserver/ns_locationproc.man
M	doc/src/naviserver/ns_log.man
M	doc/src/naviserver/ns_md5.man
M	doc/src/naviserver/ns_mktemp.man
M	doc/src/naviserver/ns_moduleload.man
M	doc/src/naviserver/ns_modulepath.man
M	doc/src/naviserver/ns_mutex.man
M	doc/src/naviserver/ns_normalizepath.man
M	doc/src/naviserver/ns_pagepath.man
M	doc/src/naviserver/ns_parseargs.man
M	doc/src/naviserver/ns_parseheader.man
M	doc/src/naviserver/ns_parsehttptime.man
M	doc/src/naviserver/ns_parsequery.man
M	doc/src/naviserver/ns_parseurl.man
M	doc/src/naviserver/ns_pause.man
M	doc/src/naviserver/ns_pngsize.man
M	doc/src/naviserver/ns_purgefiles.man
D	doc/src/naviserver/ns_puts.man
M	doc/src/naviserver/ns_quotehtml.man
M	doc/src/naviserver/ns_rand.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_requestauthorize.man
M	doc/src/naviserver/ns_resume.man
M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/ns_rlimit.man
M	doc/src/naviserver/ns_rollfile.man
M	doc/src/naviserver/ns_runonce.man
M	doc/src/naviserver/ns_rwlock.man
M	doc/src/naviserver/ns_schedule.man
M	doc/src/naviserver/ns_sema.man
M	doc/src/naviserver/ns_server.man
M	doc/src/naviserver/ns_serverpath.man
M	doc/src/naviserver/ns_serverrootproc.man
M	doc/src/naviserver/ns_set.man
M	doc/src/naviserver/ns_setprivileges.man
M	doc/src/naviserver/ns_sha1.man
M	doc/src/naviserver/ns_shortcut_filter.man
M	doc/src/naviserver/ns_shutdown.man
M	doc/src/naviserver/ns_sleep.man
M	doc/src/naviserver/ns_sls.man
M	doc/src/naviserver/ns_sockaccept.man
M	doc/src/naviserver/ns_sockblocking.man
M	doc/src/naviserver/ns_sockcallback.man
M	doc/src/naviserver/ns_sockcheck.man
M	doc/src/naviserver/ns_socketpair.man
M	doc/src/naviserver/ns_socklisten.man
M	doc/src/naviserver/ns_socklistencallback.man
M	doc/src/naviserver/ns_socknonblocking.man
M	doc/src/naviserver/ns_socknread.man
M	doc/src/naviserver/ns_sockopen.man
M	doc/src/naviserver/ns_sockselect.man
M	doc/src/naviserver/ns_striphtml.man
M	doc/src/naviserver/ns_symlink.man
M	doc/src/naviserver/ns_time.man
M	doc/src/naviserver/ns_truncate.man
M	doc/src/naviserver/ns_upload_stats.man
M	doc/src/naviserver/ns_url2file.man
M	doc/src/naviserver/ns_urldecode.man
M	doc/src/naviserver/ns_urlencode.man
M	doc/src/naviserver/ns_urlspace.man
M	doc/src/naviserver/ns_uudecode.man
M	doc/src/naviserver/ns_uuencode.man
M	doc/src/naviserver/ns_write.man
M	doc/src/naviserver/ns_writecontent.man
M	doc/src/naviserver/ns_writer.man
M	doc/src/naviserver/nsv.man
M	doc/src/naviserver/returnstatus-cmds.man

commit 6578fc076ebdeded9466a7fba41a944aec7a9898
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-17

    Fix broken/unfinished man pages

M	doc/src/naviserver/ns_locationproc.man
M	doc/src/naviserver/ns_serverrootproc.man

commit 5112c94a1e38bc6765b96b07e775c77db7b81edd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-17

    make deprecated command ns_returnadminnotice a Tcl proc and mark it explicitly as deprecated

M	nsd/tclcmds.c
M	tcl/compat.tcl

commit 2d1a1d050b9d25729d6218a173341cb2336d3fd0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-17

    fix typo in command name

M	doc/src/naviserver/returnstatus-cmds.man

commit 70af3168af3544bccb049d6156ed2187e28720b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-17

    Fix broken formattimg: part of the return values was listed as argument of function

M	doc/src/naviserver/ns_gmtime.man

commit 5b02722e3319195cfccb56aa7cc1cb00a8b4693f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-17

    implement deprecated command "ns_puts" as Tcl proc and complain on its usage

M	nsd/tclcmds.c
M	tcl/compat.tcl

commit 293f38d2666d4efa50d60105033c235460e1bcd5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-17

    Fix borken man page (command should be probably deprecatted).

M	doc/src/naviserver/ns_cancel.man

commit e0b3513e53eb3f2848111161fefd05a82363e36d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-17

    fix broken markup in man page

M	doc/src/naviserver/ns_adp_exception.man

commit 0d06c206593c8f6b62ad90735091106db5425c6a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-17

    improve documentation (add grouping for ns_set and keyl*, add crossrefs)

M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/keyl.man
M	doc/src/naviserver/ns_adp_mime.man
M	doc/src/naviserver/ns_adp_mimetype.man
M	doc/src/naviserver/ns_findset.man
M	doc/src/naviserver/ns_job.man

commit b7e03b5abce3b1968ccc9cc3aad911262c728f06
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-16

    minor cleanup (move line around, fix comment)

M	nsd/tclobj.c

commit 076e2f2de68d76293d5ed8ec53a589cb2a7bfaec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-16

    deactivate test depending on tcl8.6 builtins when using earlier tcl versions

M	tests/http.test

commit 8b50f3e0b62c10ba0a8f10028ada0c4b74a10bef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-15

    more bytearray work: testcases and tcl 8.7 compatibility
    
    The regression test handlels now the somewhat tricky cases of impure bytarrays.
    Improved the documentation to make intentions clear

M	nsd/tclobj.c
M	tests/http.test

commit 51d914ce13d26ad0f5e48e113d2440c3293746e2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-15

    Improve docs: more uniform handling of keywords and "see also"

M	doc/src/naviserver/ns_job.man
M	doc/src/naviserver/ns_schedule.man

commit 6f1aedd5301310ba683259d54bfba333238449cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-15

    Use Boolean expression

M	nsd/tclresp.c

commit b290222ba42456c2bf3e5961976f2a06e28b64ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-14

    - behave more like  TclIsPureByteArray() to avoid surprises, when a Tcl_Obj contains a bytearray AND a string rep

M	nsd/tclobj.c

commit 993ee52cd9d4fd3adaf8157b579c31d08afc4e1a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-13

    Improve man page
    
    - distinguish between constants (subcommand) and arguments
    - add example

M	doc/src/naviserver/ns_job.man

commit 66e28085e37a8f1f0e7c212a9708ad051213d554
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2017-11-08

    Ns_TclGetOpaqueFromObj is now clever enough to obtain the address
    of the object by just looking at the object's string rep.

M	nsd/tclobj.c

commit 429fd022d504c25c27ca147feba385ac025a1209
Merge: be70548d c146fd99
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-08

    Merge

commit be70548d8603beb21b14be196eca63a3ee016110
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-08

    Increase maximum number of driver threads to 64

M	nsd/driver.c

commit e38e78a2e2c157d81be5ab5ca7e843251b3cf2f5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-11-08

    white space changes

M	nsd/binder.c

commit c146fd99be2524bd4c0d9552a28eb790c7b63898
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2017-11-07

    Reduce log severity from Notice to Debug at some frequently
    visited places, otherwise the log gets cluttered.

M	nsproxy/nsproxylib.c

commit 6cf6e8247f446b5bab92806c32479cdf4c1b0e6a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2017-11-07

    Silenced some compiler warnings in cache.c.
    Have Ns_HttpMessageParse use correct Ns_ReturnCode's.

M	nsd/cache.c
M	nsd/tclhttp.c

commit 3e0d0b5ce459ec7f1c71dbc1f0720cd7c34f8d48
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-31

    fix typos

M	nsd-config.tcl

commit c887d36e437519cfada9198c2ea7172d68c04b33
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-31

    Prefer Boolean tests

M	nsd/nswin32.c

commit a1fb5e47a1383e482ca5c21871e2e2e619f89f43
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-29

    Reduce verbosity

M	nsd/tclhttp.c

commit d20891e33dfda76c78a19f42365b0300ee89fff1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-27

    Small reform of HTTP header parsing:
    
    - new API function: Ns_HttpMessageParse() for parsing a (potentially
      incomplete) HTTP message bbased on old HttpParseHeaders() operation
    - the function Ns_HttpMessageParse() is as well useful of UDP based
      HTTP transfers
    - reduce number of strlen() operations when parsing HTTP headers

M	include/ns.h
M	nsd/tclhttp.c

commit 5696c9f3694c367a59215fa754024cc7bb372a64
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-27

    reduce verbosity

M	nsd/driver.c

commit 70b0effbe4def068c7bb2d4fa7dd619f646f459a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-25

    update sample log file and make it work out of the box

M	sample-config.tcl.in

commit d6def9bbff5aa996d9fa7e5ac4a5db521dec289a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-25

    relax condition, since one has to care for error cases as well here

M	nsd/driver.c

commit 6f3fc9ef1c7e40fff86acef695ab2585f82db6dd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-25

    Improve debugging on NsWriterQueue() with dropped connections

M	nsd/driver.c

commit f4c5b65d7cf3434fa43ca66f98f91d21b398b947
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-24

    allow usage of global defserver; avoid double DriverClose calls for UDP

M	nsd/driver.c

commit db901444d82e28f11416bfbfcc4a2955bef341f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-20

    Remove duplicated entry

M	nsproxy/nsproxylib.c

commit 2c79bd26c591e00fe2e1449445e1cac006c05146
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-20

    whitespace changes: trim trailing spaces

M	nsproxy/nsproxylib.c

commit baaf5e1c0f42376b20c314036ca0d692f500547a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-20

    adapt regression test for new subcommand

M	tests/ns_proxy.test

commit 8796dd91c89d25f151a0ea20668472c9aaf34a14
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-20

    nsproxy: new subcommand "ns_proxy stats"
    
    Provide usage and runtime statistics per nsproxy pool

M	nsproxy/nsproxylib.c

commit a5212bdbea88c43708eff2720b0178329e980ec8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-20

    nscgi: new config parameter "allowstaticresources"
    
    The new parameter "allowstaticresources" allows one to control whether or
    not static resources can be delivered from a cgi-bin directory.
    
    Background: when cgi scripts are called from a cgi-bin directory
    without an explicit extension mapping to a script interpreter
    (e.g. Perl, Bash, ...)  the script has to be set executable. If this
    is not the case, the cgi-script is delivered in source code, which
    might reveal unwanted information. The reason for this behavior was,
    that one can so deliver also static resources (e.g. images) from a
    cgi-bin directory. Now this behavior con be controlled with the
    configure parameter "allowstaticresources", which is by default off.
    If an application depends on this behavior, please turn it on in the
    config file (in the nscgi section).

M	nscgi/doc/mann/nscgi.man
M	nscgi/nscgi.c
M	nsd-config.tcl
M	openacs-config.tcl
M	sample-config.tcl.in

commit c7f7bc4ad9edbe4bbb1c7131cabff115ea2f620e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-16

    Make name of traceepochmutex mutex distinguishable by adding server name as suffix

M	tcl/nstrace.tcl

commit f2eeee9d34eff2c3d28fa794786d7cd96c322236
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-16

    keep nsd: prefix

M	nsd/server.c

commit 801bff1969124de46de1d0a644535845df83d6e3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-16

    Whitespace changes: strip trailing spaces

M	nsd/server.c

commit b6ddee3a71c3925df11dcac8eb8f4940014758e3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-16

    Make mutex name distinguishable when multiple servers are used

M	nsd/server.c

commit 233476732128d1fa9b4f9b310912b9b90a2eab9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-16

    Align variable names in prototype with definition

M	include/ns.h

commit 0e3335af0a28b6abc19e079f689b2b7175ff6659
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-11

    Reduce verbosity for common cases

M	nsd/set.c

commit f05f856a4bebe939c00ffe4ae286550c574ef086
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-11

    White space changes: remove trailing spaces and fix typos in comments

M	nsd/set.c

commit a6eefdb9d1fba41a6b7ede163be2192051324d1e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-11

    Performance improvement: remove the need of 3 malloc/free pairs pre requests
    
    With this change, every request saves typically
    three ns_malloc operations per request:
     1) the Ns_Set structure
     2) the set name (it preserves the old name)
     3) the field set

M	include/ns.h
M	nsd/queue.c
M	nsd/set.c

commit 7f5607782fbf29031a259039a17a393457175e0f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-11

    Improve code documentation

M	nsd/server.c

commit e042f4c225ac25c18da5b2a0ec6247e2870750c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-11

    Improve documentation

M	doc/src/naviserver/ns_job.man
M	openacs-config.tcl
M	sample-config.tcl.in

commit 09792f1631c803520deed45a70475b6f69f4fde7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-10

    Reform of ns_server active|all|queued
    
    Better handling of querying data from concurrent threads.
    A certain problem are semi-parsed requests: these are not
    "queued", but not all information is available for querying it.
    We do the best effort to report on fields that are trusted.
    
    Remove option "-checkforproxy" from "ns_server queued", since
    such request neve have such information available.

M	doc/src/naviserver/ns_server.man
M	nsd/queue.c

commit ee076fbfba2dd888f76d40eb667005bf6108c08d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-06

    Introduce global local for connPtr to protect against concurrency issues from different pools

M	nsd/queue.c

commit 06735b3a3491a745051255e065281b19c0adb745
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-06

    Bug fix: protect contents of connPtr against concurrent operations (e.g. in "ns_server ... active")

M	include/ns.h
M	nsd/queue.c

commit a47f2d53d78ccf43aceeb2ab0a5a9df24698ab85
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-05

    Protect call of Ns_SetIGet against NULL headers and output debug line.
    
    The output of the debug line is just transitional to figure out, when exactly
    the function is called without header fields

M	nsd/queue.c

commit 273f6275506e95dbaf890347c97992e3457ad62e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-05

    Revive verbose member in handle and use it for "logsqlerrors" settings

M	nsdb/dbinit.c
M	nsdb/nsdb.h

commit 442c8114d37ba94736f5d3766f5d668b6675ea7e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-05

    Fix potentially uninitialized variable

M	nsdb/dbtcl.c

commit d3e4ccad3da972c860778ca35e3ad9f8b87565eb
Merge: c2b1f821 37a742ce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-03

    Merged in davidqc/naviserver (pull request #17)
    
    flip logic on null check

commit 37a742ceab80ad6bde988764411916e3bcaa4afc
Author: David Osborne <david@qcode.co.uk>
Date:   2017-10-03

    flip logic on null check

M	nsd/queue.c

commit c2b1f8217abc73fa59ddbd30bf96353e5a6959de
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-03

    Don't warn about URL fragment marker in Ns_UrlEncodingWarnUnencoded()

M	nsd/urlencode.c

commit e889cbdef98076256dc0080cb901f5f0943ecf9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-02

    Change severity level of NS_CONN_ENTITYTOOLARGE message from debug to notice
    
    Intention: provide information about possible misconfigurations or attacks in the error log

M	nsd/driver.c

commit de5f0a82633dc74040809aebe0579fa13e8429af
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-10-01

    Optimization: avoid 1 char loops with Ns_DStringNAppend

M	nslog/nslog.c

commit 961a418d27576363cf54ad98574a72fc7b76aa70
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-30

    Whitespace changes: remove trailing spaces

M	nsd/queue.c

commit 05c7a36628650d5a31b56241bfd159e7746b7239
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-30

    Refactor "ns_server active|queued|all -checkforproxy"
    
    - Move "-checkforproxy" to the last position. Otherwise,
      it would be a useless but accepted option for all
      "ns_server" subbcommands (and shown as valid in
      error messages, etc.)
    - extend regression test
    - extend documentation

M	doc/src/naviserver/ns_server.man
M	nsd/queue.c
M	tests/ns_server.test

commit d83e1e4da4ad5ed4e442f52fc9df1636f7d91c37
Author: David Osborne <david@qcode.co.uk>
Date:   2017-09-29

    backout earlier commit

M	nsd/queue.c

commit 16696d3c5b8a030b0d6995062e6855887427d79a
Author: David Osborne <david@qcode.co.uk>
Date:   2017-09-29

    backout earlier commit

M	nsd/driver.c

commit 94b93533dce1f3dbde27fc65acfff3a7d0a71a3e
Author: David Osborne <david@qcode.co.uk>
Date:   2017-09-29

    Remove duplicate init

M	nsd/queue.c

commit 4d4e17bcd73e9178345e9fbfaa78e5192b0938ae
Author: David Osborne <david@qcode.co.uk>
Date:   2017-09-29

    Add checkforproxy switch

M	nsd/queue.c

commit 272357251ccd91d3ecffba9626ea210379eefbfa
Merge: 1dc56c71 7d368093
Author: David Osborne <david@qcode.co.uk>
Date:   2017-09-29

    Merged naviserver/naviserver into default

commit 7d3680935392da0a62e83bceb3ec971b7675add5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-28

    Ease configuration for nsssl by simply setting https port in sample configuration

M	openacs-config.tcl

commit 5e7aad1574a10f9fb38b62234895df35dbac8c1d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-26

    Extend regression test for "ns_getcookie -all"

M	tests/cookies.test

commit cf5281732180adb59450dc89e30d63b953b6bab5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-26

    Performance: don't force stlen() when length is known

M	nsd/urlspace.c

commit 7d97afd5037cac96b202b714bc1861ff7f156986
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-26

    Fix typos in documentation

M	doc/src/naviserver/ns_cookie.man

commit 4f41161e693bee84694a65c58f8884ac5ed0a6ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-26

    Fix potential loop in "ns_getcookies -all true ...."

M	nsd/cookies.c

commit a5430687f123a197e9fb5fe4cd9ebbdf4c40ba57
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-24

    Remove "expirted++" line. No need to count rollbacked values in "expired" statistics

M	nsd/cache.c

commit 15eeee0ba1db6f0db71f8ebf2d5f59b526e98997
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-20

    improve speed of line-counting by about a 2x

M	nsd/adpparse.c

commit 8a409d3cb58f348a6eae7b9e91dfa2d4b2ddd993
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-19

    Prefer US spellings

M	nsd/event.c
M	nsd/server.c
M	nsd/tclvar.c
M	nsd/urlspace.c
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c
M	nsthread/pthread.c
M	nsthread/winthread.c

commit 2478cce16e0a63e67b9fdce8235533b590a5c7d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-19

    Whitespace changes

M	nsd/tclinit.c

commit 372c1538039c4c63f35c2dc78d3bb4c7f0af0c4e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-19

    Prefer Boolean value

M	nsd/tclinit.c

commit 878182c17d1ebdd4b9438d13a27eb27aca748301
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-18

    Performance improvement for ns_quotehtml
    
    ns_quotehtml is one of the most frequently called functions
    of NaviServer, when used e.g. with OpenACS. This performance
    improvement avoids creation of unneeded Tcl_Objs for frequently
    called cases yielding about 15% performance increase.

M	nsd/quotehtml.c

commit b9cc1edda0b85956e78fa52f5674d019375ccb29
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-18

    Undo potential crlf-translations in the body of requests with content-type www-form-urlencoded
    
    Background: if e.g. hidden form fields contain a line-breaks,
    these might transformed into CRLF by current browsers in POST requests.
    In this step the value of the hidden form-fields might become larger on every
    iteration. The change tries to undo this effect on UNIX-like systems.
    
    HTML5 defines atually the value field of FORM fields as "string without line breaks"
    http://w3c.github.io/html-reference/input.text.html
    ... but in real life applications, such value fields exist

M	nsd/form.c

commit 64ebe64e28b200eeaf57c2a2eee0d8404250af66
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-17

    Add detection for TLS handshakes on plain connections

M	nsd/driver.c

commit 0b3a0eecac403814c95d48a3ef9fe0f2000ca1a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-16

    Fix typo in function name

M	include/ns.h
M	nsd/cache.c
M	nsd/tclcache.c

commit 3397a01de57a3c948585037583863a3ad9a1e4a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-16

    whitespace changes: remove trailing spaces

M	nsd/tclobj.c
M	nsd/tclresp.c

commit 8b2d101f6c69ad72e8e7f0afe3d132cd81fc7dc8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-16

    Fix compatibility with Tcl 8.7a1
    
    Starting with Tcl 8.7a1, Tcl has actually two different
    types for bytearrays, the old "tclByteArrayType" and a new
    "properByteArrayType", where both have the string name "bytearray".
    NsTclObjIsByteArray() is now extended to handle both types.

M	nsd/tclobj.c

commit ee8977d5f325675f2a529743d8421638aa77c02f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-15

    Fix potential bug, when "/servers" section is missing

M	nsd/config.c
M	nsd/driver.c

commit b2e5773ee76c0f9ce1b7902bb9e8d26d38541b31
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-14

    reduce variable scopes

M	nsd/tclcache.c
M	nsd/tclfile.c
M	nsd/tclvar.c

commit 77b72974f445ff8af9130573319d5ee81860a58e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-14

    whitespace changes

M	nsd/tclxkeylist.c

commit 445cf65103836746499893c5c5eac5ed064c469d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-12

    Replace calls to decpreacted function Tcl_DStringTrunc() by Tcl_DStringSetLength()

M	include/ns.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/tclcache.c
M	nsd/tclhttp.c
M	nsd/tclthread.c
M	nsdb/dbtcl.c
M	nsdb/dbutil.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsssl/nsssl.c
M	nsthread/nsthreadtest.c

commit 9236a9e2f7e7299ca637fb21f2c769d88770889f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-12

    Whitespace changes: remove trailing spaces

M	nsd/tclvar.c

commit 687082b3ffca4a4e4ae189199a09acf4f0bf9d47
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-12

    bugfix: don't complain, when "-nocomplain" is used in "nsv_unset".

M	doc/src/naviserver/nsv.man
M	nsd/tclvar.c

commit 9774dee1fbd95da0d447e017b3784c6c08c82bad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-12

    Virtual server reform
    
    - new feature: Make mapping of host entries in the virtual
      server definition more intelligent to avoid newbie gotchas and
      hard to find mis-configurations (entries in e.g. nssock/servers)
      a) add automatically an entry with the port, when non is given
      b) complain, when driver is not listening on the specified port
      c) add automatically an entry without the port, when the driver
         listening on the default port
      Old configurations (doing a-z manually) should continue to work,
      non RFC compliant (test) cases have to be fixed (when a driver
      uses a nondefault port, and the request contains no port)
    - Added documentation
    - bugfix: Avoid potential double-initialization of driver modules when
      multiple servers are used.
    - bugfix: Postpone registration of virtual servers until all servers
      are defined. Before it was possible that NaviServer boot was
      terminated, when a default server of a driver was not yet defined.

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nssock/doc/mann/nssock.man
M	nsssl/doc/mann/nsssl.man
M	tests/ns_conn_host.test
M	tests/ns_pagepath.test
M	tests/ns_serverpath.test
M	tests/test.nscfg

commit 366740ffa19ac7fc156ca43a28f7fab0367010e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-08

    Whitespace changes: trim trailing spaces

M	nsd/url.c

commit 492e77717b7a086db3dbe4848ba0b6e9f35edb88
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-08

    Improve comment

M	nsd/url.c

commit ce49b3ebbcdbfc9ab08d52447a2851f83fb00eb5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-08

    Avoid adding square braces in Ns_HttpLocationString when no port and defPort is provided (we assume, the host component can e used as provided)

M	nsd/tclhttp.c

commit 15a46029186f5f34d48265d04f3dcff937b79e33
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-08

    speedup: use Tcl_CreateHashEntry instead of Tcl_FindHashEntry since the first uses the latter.

M	nsd/tclvar.c

commit c29faceb5eb1339d503e47510f4d4c28d536bf20
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-08

    Reduce variale scope and improve debug message

M	nsd/driver.c

commit 94107ab06646a7ac6683bbfdf6e5428599917709
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-08

    Add log debug entry, when lookup of virtual server fails and driver uses fallback

M	nsd/driver.c

commit c586d1a0918c4258ce901795b4232c81e9548833
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-07

    Improve comment

M	nsd/quotehtml.c

commit 580e381884fcc07e51c981dc19d6154526473d5a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-07

    eliminate variable

M	nsthread/pthread.c

commit d24a5a2247a47aac3211aebab1eac040fbee1222
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-06

    Improve performance of ns_quotehtml
    
    This function is in real-world application on the most frequently used
    functions of NaviServer. This change improves the performance of ns_quotehtml
    by about 40-60% by avoiding per-character calls to *DStringAppend

M	nsd/quotehtml.c

commit 844768da1a9d7806a9282d2d5dac1d2888761433
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-05

    Improve documentation

M	doc/src/naviserver/ns_cache.man

commit 76b5a2e545d22594ef1154589774e1223a8a4874
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-04

    bump version number

M	configure.ac

commit de7493cdb16ab1e183b06a503f2d6b2eb5aeeb98
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-04

    Improve performance:
    
    Improve performance by replacing the slow "snprintf(... %d ...)"
    function by the new functions ns_uint32toa() and ns_uint65toa().
    This change improved the performance of EnterSet() by nearly a
    factor of 2.5. Before, snprintf() took in this function 3x (!) as
    long as Tcl_CreateHashEntry(), thew new ns_u32toa() is about 6x
    faster as Tcl_CreateHashEntry().
    
    Before:
        196,229  => nsd/tclset.c:EnterSet (165x)
        831,510  => nsd/tclset.c:EnterSet (710x)
    
    After
        81,390  => nsd/tclset.c:EnterSet (165x)
       337,050  => nsd/tclset.c:EnterSet (710x)
    
    
    New functions:
      int ns_uint32toa(char *buffer, uint32_t n) NS_GNUC_NONNULL(1);
      int ns_uint64toa(char *buffer, uint64_t n) NS_GNUC_NONNULL(1);

M	include/nsthread.h
M	nsd/dstring.c
M	nsd/log.c
M	nsd/queue.c
M	nsd/tclcache.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclset.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsdb/dbtcl.c
M	nsthread/memory.c
M	nsthread/mutex.c
M	nsthread/thread.c

commit 5f725bf8332cc6884abdec61a3f0f3e587af4ab7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-04

    whitespace changes

M	tests/ns_info.test

commit 6ed8afa08f4666ec92f71fa456a51d5875a4c667
Merge: 827e14b4 3b9e559c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-03

    merge

commit 827e14b46005370d37f4e3d18be04a8b4f37a75f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-03

    relax nonnull annotation

M	include/ns.h

commit 5358aa1c3b70f1e28fbb26d2be3763912355457d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-03

    Whitespace change

M	nsd/tclcache.c

commit 38f5d4bdfb1ee3d48bd876404592345556eb4f18
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-03

    update documentation

M	doc/src/naviserver/ns_cache.man

commit 03c0d65c809f9463b97178e4df1f29fe1c89132f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-02

    Fix typos

M	nsd/tcljob.c

commit 4564d432e8ac7f72b7e47c2d40286f0a873cdf5a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-09-02

    Whitespace changes

M	nsd/tcljob.c

commit 3b9e559c09c98946267b9ba0a463d6688e6aedfc
Merge: 57f52d58 4c4df83e
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2017-08-31

    Merge Gustaf's 2017-08-29 changes.

commit 57f52d588f70558a6bc3fd0a38081848d8d4b696
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2017-08-29

    Use local time (with timezone) instead of UTC in Date header.

M	tcl/sendmail.tcl

commit bc36f702acd46217bd92ad87057a0e690d167333
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2017-08-29

    For the deprecated warning, do not write entire body of email to the log!

M	tcl/sendmail.tcl

commit 4c4df83e59e40f8ca9bf31b268787f6d9abe7d9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-29

    align documentation with source code

M	nsperm/doc/mann/ns_perm.man

commit 305e308c40669e425ee9f26d2f89aca979ac7fe3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-29

    Improve documentation

M	doc/src/manual/tcl-overview.man

commit 91a2fbec131f24cfaa4286054d0e74b41d77c887
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-29

    Fix error message, when the named cookie is not found

M	tests/cookies.test

commit 8493692e91bfe76487380501dfa29cf2895b24cf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-22

    Fix asserton as pointed out by Andrew
    https://bitbucket.org/naviserver/naviserver/commits/92267b60389ffa694dbbfa2f661d7c0914890bc2

M	nsd/conn.c

commit 8f6239e212d5847d5563be067c283a9f8418fbe3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-21

    fix indentation and nonnull constraint

M	include/nsthread.h

commit 4df460574ad6d0fdbd5cc616b23dbe9c78a66c33
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-21

    Fix variable scope

M	nsd/driver.c

commit bf4d7f63541360ac02468dc2423b524954de40ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-21

    Improve safety

M	nsd/cache.c

commit e0a760a1645cf0444ccb3667f5017d598351baaa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-21

    Fix variable scope

M	nsd/listen.c

commit d2b3b71398584724cf2c036ffa29051a068bc45d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-19

    Improve documentation: rewrite obsolete parts

M	doc/src/manual/admin-maintenance.man

commit 0f9f1ff68abd9eeaa080bc2156e2cff690a009e5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    White-space change: untabify

M	nsthread/reentrant.c

commit d49ce769bb72e5134360a7c9e8a75bb63af0b583
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    Remove over-eager asserts

M	nsthread/reentrant.c

commit 94bb80ab91d57ddb8477807c8861b98755ae5ccc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    White-space changes: untabify

M	include/ns.h

commit dffe2905e67ad85ec52812ae736e5eed834c90f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    White-space change: break some overlong lines

M	nsd/driver.c

commit 47cafb40c91d75ba822a27c85f8a7f0cc8861c2a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    Remove redundant declarations

M	include/ns.h

commit f1e7d84adaf1491af2f6ca6b0103a79b08f67788
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    White-space changes

M	nsd/driver.c

commit 89943ab0e55ecf82f15b3dc8b6f8a11116492628
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    Add assertion to ease life of static checker

M	nsd/driver.c

commit 2393bf0e127f3fe7ffb867fb44c9a702b68930cf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    White-space changes: untabify, break overlong lines, trim trailing spaces

M	nsd/cookies.c

commit 94a0b140ff0a167b153f089910c9f7ecc9c2aa9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    Fix loop for "ns_getcookie -all ..."

M	nsd/cookies.c

commit 0234740788004b972a22823bc0bf153d98cf4539
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    Whitespace changes: strip trailing spaces, break overlong lines

M	nsd/urlencode.c

commit 4f62481b69da7d135a367fcff5401625758ba253
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    Whitespace change: untabify and delete trailing spaces

M	nsd/conn.c

commit 6079e2af856dbfee89f55a3b18bd44ff3d0e30c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    Make assumptions explicit and help static code checkers

M	nsd/conn.c

commit aef9f127092fbbf53d99340057870f8c6e6ce473
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    Reduce variable scope

M	nsd/auth.c

commit ff27b245bd4e8a2ebd06353fbcc55014a7d91ecb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    Improve info message to include information about configure options of nsf

M	tcl/aolserver-openacs.tcl

commit af5a6db65bf3b76af816a43233f6f7b852213d85
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-15

    Fix: make message a warning, improve message

M	tcl/nstrace.tcl

commit 819d9f88bf311c73035947a965eb5ef1906e9648
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-14

    Fix possible interaction between test cases: cleanup of more temporary variables

M	tests/http_persistent.test

commit 705b24df5350bacc7a83bc1b0f9c99734ea7825c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-14

    Fix possible interaction between test cases: cleanup "result" variable after test cases

M	tests/http_persistent.test

commit 52b8f073dc5865ecb3f4c353ef48d8a2f550fbd2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-08-08

    Add option "-all" to ns_getcookie
    
    Background: By using a cookie domain, it is possible that a cookie with a specified name
    is given two value, one from e.g. the parent domain, one from the current; this can
    lead to situation not easy to debug, when e.g. domain cookies are introduced from
    other applications in the same domain. The "-all" option provides instrastructure
    support to detect such situations by returning potentially multiple values for the cookie.

M	doc/src/naviserver/ns_cookie.man
M	nsd/cookies.c
M	tests/cookies.test

commit 3707a93b578ad06531e19aba834a096e6b9313d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-27

    Fix potential memory leak, when an entry with uncommitted value is unset

M	nsd/cache.c

commit 0fdd87fef2ab4a07e50dddc228d2f0e2d487f644
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-26

    revert escaped changes

M	nsd/connchan.c
M	nsd/listen.c

commit b0706937f9ec714658654d20e7f7f5f9a5bf8ed2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-26

    minor cleanup (remove debugging line, ...)

M	nsd/cache.c
M	nsd/connchan.c
M	nsd/listen.c

commit a052cb3752cc9fd9ea0a4e79bbebb496978886d6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-26

    Improve performance when uncommitted entries are committed or rolled back:
    - use a separate hash table to make commit / rollback operations
      independent of the number of entries in the stack
    - reduce performance dependency on number of caches significantly
    
    Improve source code documentation

M	include/ns.h
M	nsd/cache.c
M	nsd/tclcache.c

commit 7bd0f7be5508d6f8a59b2451a492fa424a568f47
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-24

    Bumping version to 4.99.16d9

M	configure.ac

commit 243bf7b24d03170ff00bb6b76001defa278255e2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-24

    make sure, nameLength is always initialized in Ns_MutexSetName2()

M	nsthread/mutex.c

commit 07c5cf086c91af903a100397095b6330c0b9aa1c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-24

    update interface

M	nsd/dns.c

commit 04bfb1c3f905f4f8584e884f17f362481e8c2ee1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-24

    adding "ns_cache_transaction_rollback -all" to ns_cleanup

M	nsd/init.tcl

commit 0146ea43f6a54220c6ec75f8ac828f727fb006eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-24

    Adding transaction semantics for ns_cache*
    
    Background: when ns_cache_* commands are used within a DB transaction
    (e.g. in OpenACS), it might occur, that partial results of the
    transaction are cached before the transaction is committed. When the
    transaction is rolled back, invalid values might be kept in the stack
    leading to erroneous and hard to debug behavior. Furthermore,
    information about committed changes might leak into other threads via
    the cache.
    
    The new cache transaction semantics is implemented via the
    three commands
    
       ns_cache_transaction_begin
       ns_cache_transaction_commit
       ns_cache_transaction_rollback
    
    When no ns_cache_transaction* commands are used, the
    behavior is exactly as before. When cache transactions
    are used (initiated by an ns_cache_transaction_begin
    and ended via ns_cache_transaction_commit or
    ns_cache_transaction_rollback, the ns_cache commands
    provide in essence the following functionalities:
    
    a) The ability to rollback of the values since the matching
       ns_cache_transaction_begin
    b) Isolation of behavior: cached values from incomplete cache
       transactions are just visible from the current thread, but not
       from other threads.
    c) Nesting: transactions can be nested
       (up to a compile time constant, currently 16)
    d) Introspection: the statistics about cache commits and rollbacks
       are included in the cache statistics.
    
    Implementation: The implementation is an extension of the pre-existing
    update semantics and follows as close as possible the existing
    model used in ns_cache_eval. The "value" of a cache entry is NULL
    until a commit is performed, other threads competing for the same
    cache entry have to wait for the "commit" operations.
    
    The old C-API continues to work as before. The new transaction
    aware interface is implemented over the following commands
    
      Ns_CacheFindEntryT()
      Ns_CacheFirstEntryT()
      Ns_CacheGetValueT()
      Ns_CacheNextEntryT()
      Ns_CacheWaitCreateEntryT()
    
    In order to avoid potential unwanted long-time locks on cache entries
    when cache transactions are not properly closed (e.g. in error cases),
    "ns_cleanup" is now extended to roll back all changes.
    
    The following ns_cache commands are now cache transaction aware:
    
     ns_cache_get
     ns_cache_eval
     ns_cache_incr
     ns_cache_append
     ns_cache_lappend
     ns_cache_keys
     ns_cache_flush

M	include/ns.h
M	nsd/cache.c
M	nsd/nsd.h
M	nsd/tclcache.c
M	nsd/tclcmds.c
M	tests/ns_cache.test

commit b9eceb2dcbde83782efa4a986982953c75fe5bfd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-17

    Improve cleaness of compilation with gcc 7.1.1 under FC26

M	nsproxy/nsproxylib.c

commit 161f3cdaf5d271799cc85326d391133e2faed088
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-17

    Improved cleanness for compilation with gcc 7.1 under FC26

M	nsthread/tls.c

commit f80ba6c6b26406a98bbf8f266db7afce079bb3ba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-12

    prefer boolean value over int

M	nsd/tclcache.c

commit 4f74e318b05ab4b0e7c18d5cfa913207c56cf515
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-03

    Fix variable name in config file

M	openacs-config.tcl

commit 88e3ed64a0cd6a262eeeb960850b5b01374ee5a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-01

    - include the connID in the thread name to ease debugging, when multiple requests are processed by the same connection thread and it is not clear, where the first ends and the next starts
    - reduce the number of returns before the end of the function
    - improve documentation

M	nsd/queue.c

commit 49b7a83b00a4ca922a870db78361fdd34568de7f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-07-01

    - don't use equal comparison on boolean functions
    - improve branch prediction

M	nsd/cache.c

commit faccad62b99d639652812a8e4952eac29d3e4a51
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-21

    minor cleanup

M	nsd/driver.c

commit 31830b48662b678d3f3ca53df19a691dec9cf33a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-21

    Honor provided method name

M	nsd/driver.c

commit 445eb484d52c66c14c5a1d97dc860a64e3a1117c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-21

    Ns_SockListenCallback(): don't set the port to 0 before calling bind(). Not sure, why this was done before.

M	nsd/listen.c

commit 56f0fda047769ec78727d69368a4512dede563f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-21

    Improve symmetry for V4MAPPED addresses. ns_inet_pton() returns an IPv4 address (family AF_INET) for an IPv4 address. however, a reverse lookup over getsockname() might result in a V4MAPPED address, leading the a different IP string, which is valid but different to the former. With this change, ns_inet_ntop() returns for V4MAPPED addresses as well the plain IPv4 string.

M	nsd/sockaddr.c

commit 3e39243e5e56af39eeef85587ac54a38cfcacc18
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-21

    Add debugging lines

M	nsd/sock.c

commit dd8a7aaf129126fe13c92f3e97b83cd66e7a5d26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-21

    Return as well IP address [ns_connchan listen] in result dict (needed e.g. from PASV in FTP server implementations)

M	nsd/connchan.c

commit 6be9e6c279afa0f9667a42429d95862c6ba49331
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    User proper undefined IP-address, such we can make fist arg of Ns_SockListenCallback mandatory

M	include/ns.h
M	nsd/listen.c
M	nsd/tclsock.c

commit 9e1e4c9883440a9e96863359ae65c4c909baf544
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    Use proper default server, when no servername can be determined

M	nsd/connchan.c

commit 0aeba30faee867a4ecb0304309429c34aae7f63a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    Bump version number to 4.99.16d8

M	configure.ac

commit 4bdb8457265f8fc5ef1461bd1fbd33eec8ca88dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    Add infer-out to ignore files

M	.hgignore

commit a3a131ee35df415ea2a221070616c47a08b3daa2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    - Ns_SockListenCallback:
      alter interface to (a) return the listensocket and (b) to be able to
      bind to the fresh socket. This is necessary for e.g. FTPD's passive
      server connections, where the server offers a freshly bound socket
      to the client to connect to (EPSV, extended passive mode).
    
    - driver.c:
      * factor out LookupDriver() to improve reusability
      * new function NSDriverSockNew() to create an initialized driver Sock structure,
    
    - connchan.c:
      * new subcommand "ns_connchan listen"
      * missing:
        + implementation of ssl variant via specifying "-driver"
        + handling of "-server" (and obtaining defaultserver)

M	nsd/listen.c

commit 03a2940f85f351d4fad32397d46691e1d6ec388b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    - Ns_SockListenCallback:
      alter interface to (a) return the listensocket and (b) to be able to
      bind to the fresh socket. This is necessary for e.g. FTPD's passive
      server connections, where the server offers a freshly bound socket
      to the client to connect to (EPSV, extended passive mode).
    
    - driver.c:
      * factor out LookupDriver() to improve reusability
      * new function NSDriverSockNew() to create an initialized driver Sock structure,
    
    - connchan.c:
      * new subcommand "ns_connchan listen"
      * missing:
        + implementation of ssl variant via specifying "-driver"
        + handling of "-server" (and obtaining defaultserver)

M	include/ns.h
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sock.c
M	nsd/tclsock.c
M	tests/ns_conn.test

commit 50f7ef3ff7bd16ec8dd1056177be2c065f8da114
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    Reduce variable scope

M	nsd/url2file.c

commit eec3f877a8f52eb640f0ea1a0f85e6576e755923
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    Improve man page

M	doc/src/naviserver/ns_base64decode.man

commit e11fcedb5d4bf89922562e79a0e653b7d212c8a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    Don't alter permission on every "Make install"

M	Makefile

commit f2fc9a70bf1b1c0de031a60ce1274f481e1e269d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    whitespace change: remove trailing spaces

M	nsd/urlspace.c

commit d799fbce184d0bccff9223e3b812e4a88a9c9d83
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    remove unneeded assert

M	nsd/urlspace.c

commit fb71d36ddd4393c320e06f658f1fda72c2750df9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-06-20

    Improve comment, white space change

M	nsd/tcljob.c

commit a22fab88cfaf2cfecb21b64cc36573e5be45b269
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-30

    Add comment

M	nsd/return.c

commit 7979266ed6eff72689166930e887a868b21fd355
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-30

    Reduce verbosity

M	nsproxy/nsproxylib.c

commit 883a1bdf2639ef96582b65b6f812e954ec824513
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-29

    Fix potential crashes as flagged by fb infer.

M	nsd/config.c
M	nsd/driver.c
M	nsd/tclcache.c
M	nsd/tclfile.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tcltime.c
M	nsd/urlencode.c
M	nsthread/mutex.c
M	nsthread/rwlock.c
M	nsthread/tls.c

commit 888447e21d7f03ad645026ece3087d757bb7cfaf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-27

    NsGetServer() can return NULL (in error cases); don't assume in the code, that the result is not NULL.

M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/filter.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/tclcache.c
M	nsd/tclinit.c
M	nsd/url2file.c
M	nsd/urlspace.c

commit 06999fbb82f056737e5d8cb86b6f2d6d0504bfbc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-25

    Improve error handling in nsproxy:
    - new function Ns_WaitForProcessStatus(): this function allows handling
      the received signal by the calling client. This way, a misleadinng
      error in the log file can be avoided.
    - Ns_WaitForProcessStatus: disambiguate variable "status" into wait-status and return-status.
    - mark Ns_WaitProcess() as deprecated. This function was replaced years ago by Ns_WaitForProcess()
    - fine tune output for eval-timeouted nsproxy with writing much output
      (avoid unneeded zombie and killing log entries)

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/exec.c
M	nsproxy/nsproxylib.c

commit bb0f7aff80585d0fbf070177ddb6a7ab97a7d37b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-25

    Fix typos

M	openacs-config.tcl

commit 92862e274a5a3dc9c9bb764e49e926fcd2e5851a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-21

    Add setting of OpenACS kernel parameter "NsShutdownWithNonZeroExitCode" in sample config file

M	openacs-config.tcl

commit fa7baeb12cf9b4e3dab670667f3e81d07ffdd8c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-18

    Improve man page of ns_shutdown (include option "-restart")

M	doc/src/naviserver/ns_kill.man
M	doc/src/naviserver/ns_shutdown.man

commit b9f095b3f3fc3f0a462d424d0b8bd9d49a0c0fa7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-18

    Include global parameter shutdowntimeout in somple config file

M	sample-config.tcl.in

commit cfbbdb460a704f7c062a5fc73988332938b95f34
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-15

    make proxy shutdown more robust

M	nsproxy/nsproxylib.c

commit 45f772fecb5689c4e5330072a809f127a17f7967
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-14

    Improve man page

M	doc/src/naviserver/ns_urlencode.man

commit 899353e76d75bfc78d40e0ffc6d5788175b8f390
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-14

    replace all occurrences of strcpy() with a more safe variant

M	nsd/crypt.c
M	nsd/sock.c

commit c62589075587e53d229081874bf3895101b638c1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-13

    Bump version number to 4.99.16d7

M	configure.ac

commit 5c3f8365f520bb831d022a44e4f1f2c2baed2c93
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-13

    Avoid potential hangs of nxproxy in cases the evaltimeout is very small and the client is writing much data causing blocking write operations

M	nsproxy/nsproxylib.c

commit f8dcae1be70e235d98ccc9a3635378a49936056c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-10

    address issue of pipe between starting process and child in watchdog mode (as reported by Zoran)

M	nsd/nsmain.c

commit f24beef7e86117c5d89992d951ec0f22ef7786d4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-10

    allow fully qualified domain names in host header field (as allowed in RFC 2976)

M	nsd/driver.c

commit 43d38405375edf84cca35816f89f98317a9bb074
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-10

    Silence clang 4.0 (with full set of warnings)

M	nsd/httptime.c
M	nsproxy/nsproxylib.c

commit 7a9be10d0f7d4831082133699e205de876ae3bdc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-10

    Improve man page

M	nsproxy/doc/mann/ns_proxy.man

commit e05446e3d59db6ec6b35d5f7a886ae72f0f81e79
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-07

    Improve man page

M	doc/src/naviserver/ns_http.man

commit 50cd0f013071c899ebe9e99b33e4f415513f62a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-07

    Improve cleanness of compilation under windows

M	nsd/nswin32.c

commit af11be56b7feb48a98ec33dba348d76558978fb8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-05-07

    Improve handling of invalid input

M	nsd/rollfile.c

commit b811947dd185dfc1d3777a71c71f9151c0dabcf5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-29

    Make to access nonnull-values only after assert

M	nsd/cache.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/fastpath.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/op.c
M	nsd/range.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/tclinit.c
M	nsd/tclthread.c
M	nsdb/dbinit.c
M	nsthread/cslock.c
M	nsthread/memory.c
M	nsthread/rwlock.c

commit 3d797573faa4c6a11cf1fd471cf86123a8f8ea82
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-29

    Make sure to dereference pointer after assert

M	nsd/task.c

commit 987f356f0f342e92657b03c58c6b8c47ded1c9d9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-26

    Fix comparison

M	nsd/rollfile.c

commit b4f1a91c295c98672316b30d5ffc363d61e37e1c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-26

    Silence static checker

M	nsd/driver.c

commit 4b63c71a972ba6c07ba15e0c62af877bf3cc4fda
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-26

    remove code smell expression assigned to a narrower or different essential type under windows

M	nsd-config.tcl
M	nsd/binder.c
M	nsd/sock.c

commit 4ba707ed5ac6c69e6bf53970b962bac207b2d1d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-25

    Make sure "ns_server serverdir" and "ns_server pagedir" return normalized paths to avoid potential confusions

M	nsd/fastpath.c
M	nsd/url2file.c

commit f1fd0add1f525939bd5c2cb31041277fa9fb0bb1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-25

    add strict-transport-security to sample config file

M	openacs-config.tcl

commit 5a20366b1dabffcc6f0f0248926898bbec90a556
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-25

    streamline terminology

M	nscgi/nscgi.c

commit ebb0567f9352b928c7cb637bbca5d4806bbfbebe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-24

    Improved sample config file for OpenACS: allow one to specify the actual user in the access log

M	openacs-config.tcl

commit f0fffdd8cf2e1564c986c71dc4186bf0174173c9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-24

    Make sure to initialize variables on all possible paths

M	nsd/httptime.c
M	nsd/tclmisc.c
M	nsproxy/nsproxylib.c

commit c7ddddbc8538199671e03caf762df36eacbfe219
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-24

    Prefer void* over legacy caddr_r

M	nsd/binder.c
M	nsd/exec.c

commit f637d5de338df857ac986f9bff200fe8a102a762
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Standardize spelling of names of products (Tcl, AOLserver, PostgreSQL, NaviServer)
    More spelling fixes

M	bitbucket-install.tcl
M	doc/src/manual/admin-tuning.man
M	doc/src/manual/adp-overview.man
M	doc/src/manual/c-driverdb.man
M	doc/src/manual/main-faq.man
M	doc/src/manual/main-standards.man
M	doc/src/naviserver/ns_adp_exception.man
M	doc/src/naviserver/ns_mutex.man
M	doc/src/naviserver/ns_write.man
M	doc/src/naviserver/returnstatus-cmds.man
M	include/ns.h
M	nsd-config.tcl
M	nsd/adpcmds.c
M	nsd/cache.c
M	nsd/filter.c
M	nsd/log.c
M	nsd/tclinit.c
M	nsd/tclobjv.c
M	nsd/urlencode.c
M	nsdb/doc/mann/ns_db.man
M	nssock/doc/mann/nssock.man
M	openacs-config.tcl
M	tcl/aolserver-openacs.tcl
M	tcl/nstrace.tcl

commit 12781354f6aff2f0772e949362214007e599e3ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Use uniform spelling of "Tcl"

M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/admin-tuning.man
M	doc/src/manual/tcl-lib-file.man
M	doc/src/naviserver/ns_adp_parse.man
M	doc/src/naviserver/ns_info.man
M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/nsv.man

commit 769dd6618448e18f9f95086827e4e11ee85ebced
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Use uniform spelling of "Tcl"

M	include/nsconfig.h.in

commit b7c85ae6c1f620d7d05b29e63cc8d792767e8c41
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Use uniform spelling of "Tcl"

M	nsd/adpcmds.c
M	nsd/adpparse.c
M	nsd/driver.c
M	nsd/listen.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsperm/init.tcl
M	nsperm/nsperm.c
M	tcl/aolserver-openacs.tcl
M	tests/testserver/modules/client.tcl

commit 78a1a5acde638c4d18c71fa0271553e8eb72d8e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Fix spelling errors

M	bitbucket-install.tcl
M	doc/src/manual/admin-tuning.man
M	doc/src/manual/adp-overview.man
M	doc/src/manual/c-driverdb.man
M	doc/src/manual/main-faq.man
M	doc/src/naviserver/ns_adp_exception.man
M	doc/src/naviserver/ns_mutex.man
M	doc/src/naviserver/ns_write.man
M	doc/src/naviserver/returnstatus-cmds.man
M	include/ns.h
M	nsd/cache.c
M	nsd/driver.c
M	nsd/filter.c
M	nsd/log.c
M	nsd/tclobjv.c
M	nsdb/doc/mann/ns_db.man

commit ca8ef23de36145a8d1b5d0fa8df2c94513b344bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Improve variable names

M	nsd/adpcmds.c

commit b87e4b5af0aefe9d1d7983f7802e0297c3f1106d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Use uniform spelling of "Tcl"

M	configure.ac

commit 60d8d61ef62f1a574f6b28d28323cb5c01693391
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Use more straightforward Tcl idiom to access first character of a string

M	nsperm/init.tcl

commit 87794e2b3b1ea851192b5119db673a2075a195c8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Use safe variant of "file delete"

M	tcl/compat.tcl
M	tcl/form.tcl

commit 59b993a2696f2c1deb6d4200821178dc815c5413
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Fix spelling error

M	tcl/nstrace.tcl

commit c6751ea8c262927c6e97bd97133a5a04eff814dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    fix typo in variable name

M	tcl/charsets.tcl

commit 32e0900b7fab4438e7d89f421129ecda3b705bff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Use safe variants in man pages

M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/ns_http.man

commit 64a6eb5d622686ca1410c6fc448d4e34a9b71d0a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Reduce return statement before end of function

M	include/ns.h
M	nsd/rollfile.c

commit dc992d674f867c5a578e061dc645dc0ed612ccef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-22

    Group int declarations

M	nsd/conn.c

commit e7ef4ea4e1a72e0b164e306c7be9fd8732e6a9eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-21

    Fix spelling errors

M	NEWS
M	doc/src/naviserver/ns_limits.man-retracted
M	include/Makefile.global.in
M	include/nsthread.h
M	m4/misc.m4
M	m4/usermgt.m4
M	nsd/init.tcl
M	nsd/nswin32.c
M	nsd/progress.c
M	nsd/queue.c
M	nsd/request.c
M	nsd/return.c
M	nsd/sls.c
M	nsd/str.c
M	nsd/task.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclobjv.c
M	nsd/tclresp.c
M	nsd/tclset.c
M	nsd/tclxkeylist.c
M	nsd/urlspace.c
M	nsdb/dbinit.c
M	nsperm/nsperm.c
M	nsproxy/doc/mann/ns_proxy.man
M	nsproxy/nsproxylib.c
M	nsssl/ChangeLog
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	nsthread/rwlock.c
M	nsthread/tls.c
M	nsthread/winthread.c
M	openacs-config.tcl
M	sample-config.tcl.in
M	tcl/file.tcl
M	tcl/form.tcl
M	tests/cookies.test
M	tests/http.test
M	tests/ns_server.test
M	tests/tclresp.test

commit 06e6a3a7e4a36ee44b0a3220cae24a0e61b275b3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-21

    Reduce implicit conversions

M	nsd/sock.c

commit 1a95977d46233ee6b7c691f67038ae803b0a4649
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-21

    Reduce implicit conversions

M	nsd/binder.c

commit 6755e42ab9f83a4c9d17062f9e91f65e9bfb829f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-20

    Fix spelling errors

M	nsd/nsmain.c
M	nsd/nsthread.c

commit f95e82df6ac041de64613480e327f33a1c4016bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-20

    Fix spelling error

M	nsd/form.c

commit a630048fd0ecd9d47650680784e468347e4bf093
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-20

    Fix spelling errors

M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/admin-tuning.man
M	doc/src/manual/c-driverdb.man
M	doc/src/manual/main-standards.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_adp_info.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_cookie.man
M	doc/src/naviserver/ns_mktemp.man
M	doc/src/naviserver/ns_parseheader.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_setprivileges.man
M	nscp/nscp.c
M	nsd/callbacks.c
M	nsd/compress.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/connio.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/event.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/info.c
M	nsd/log.c

commit 69e9beb6586ff909d7e04cd8f1773b73af4b72fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-20

    - define typedef for NsDb_DriverInitProc
    - define typedef for NsDb_ReturnCode

M	nsdb/nsdb.h
M	nsdbtest/nsdbtest.c

commit 3a3962e132c3d7f8b0e3889bf131ee08e7a3cc34
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-20

    Reduce implicit conversions

M	nsd/urlspace.c

commit f7e974510b7344bec6c4b13f3cac87bcfa17e578
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-20

    Reduce implicit conversions

M	nsd/tclsock.c

commit e3d5ab9dce8c3b4fb7dfedca4fa41f7446a8939f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-20

    Reduce implicit conversions

M	nsd/dstring.c

commit 1dc56c713aab2c20de9cef85c1663c1ea56415e4
Author: David Osborne <david@qcode.co.uk>
Date:   2017-04-19

    Try to populate request->port from Host header

M	nsd/driver.c

commit c81197e984754a456e0a251988a12ed26575fd32
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-17

    improve warning message text

M	nsd/urlencode.c

commit 920804e94271a9c985d416ab094e5e601e75ff85
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-17

    urlencode reform:
    - simplify logic
    - avoid malloc/free
    - improve performance in common cases by about a factor of 2
    - extend regression test with security relevant case

M	include/ns.h
M	nsd/encoding.c
M	nsd/tclinit.c
M	nsd/urlencode.c
M	tests/ns_urlencode.test

commit fff6361d54b8bd09e904cb011fcc895fc3b9494a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-16

    Use URL encoding, if no charset is given. This fixes an old (at least 10 year old) bug which can allow one to sneak in binary nulls into query variables, which provide an injection attack vector

M	nsd/urlencode.c

commit cff0552a6b23aff13a086aa58ea4945718914e48
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-15

    Bump version number to 4.99.16d6

M	configure.ac

commit ee1f046b28b1719b602b04bea88a23b8e16e44cf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-15

    align cookie test with code

M	tests/cookies.test

commit da8dca4044fefee7e025bd2570437abc89e3de3d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-15

    Reduce number of goto statements

M	nsd/conn.c

commit 1e90f585dc8c76b754c3f1045f9dd9d480cbca2d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-15

    fix newly inserted assertion

M	nsd/url.c

commit d77e2a93f21c9a55b443ab067c50d5d3ede4769c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-15

    reduce implicit conversions

M	nsd/sock.c

commit 02ebbd9da8fbfaec980859255704d6b5ecaa2835
Merge: db10ea9f d648a31a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-14

    merge

commit db10ea9f61f8aa52e0f616b9dfe973d39c194031
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-14

    make assumptions explicit

M	nsd/url.c

commit 6dc25207f3b44fe0af8ab7362a08e7a135cdb772
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-14

    Reduce variable scopes

M	nsd/info.c

commit d648a31a312b387c7383f74378e4e6e6b349ce73
Author: David Osborne <david@qcode.co.uk>
Date:   2017-04-13

    Add disposition option to ns_parseheader

M	doc/src/naviserver/ns_parseheader.man

commit 246ddf1e50e9a09cdcfced3aa836a009f4143874
Author: David Osborne <david@qcode.co.uk>
Date:   2017-04-12

    Add ns_connchan exists doc entry

M	doc/src/naviserver/ns_connchan.man

commit e4c4c707d519f068fd36978729936cb707737c0e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-12

    Align and extend regression test

M	tests/cookies.test
M	tests/ns_urlencode.test

commit 1bfb9292382c50fd24354a0224807791d33a3fe1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-12

    Encode percent sign (indicator for percent-encoded octets) although it is not required by RFC 6265.
    Elsewise a raw string "%20" would be encoded as "%20" (no need to encode anything) but decoded as " " (space).

M	nsd/urlencode.c

commit 7000b6596a57499dc1349d1af3fa2e899c3a063c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-12

    Prefer type bool over int for Boolean values

M	nsd/dns.c

commit 8a74bcde16fb3bdeb324cfc0a9bee4496d58f63f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-12

    Reduce number of returns before end of function

M	nsd/driver.c
M	nsd/info.c

commit 456045af24ffb54b47121291b0bb4dda361a33d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-12

    Fix usage message

M	nsd/nsmain.c

commit cca843586c376616e9c89f9aa9e4cf4e73fb66ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-11

    Improve documentation

M	doc/src/naviserver/ns_info.man

commit 66cfe7ffdab33b28f615587fa6d28a92afac2023
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-10

    fix typo

M	NEWS

commit 0ca1f9fa04ebd5086301c27c4e5b356d52c4eb20
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-10

    Reduce Usage of goto statements

M	nsd/pathname.c

commit ff0a2327ea36f6c7e0ea3e38a6ec349a533c9cff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-10

    Improve error message

M	nsd/urlspace.c

commit 05526b0ede7699436cad1fd27a2ed70638683fd1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-08

    make nsproxy compileable under windows

M	nsproxy/nsproxylib.c

commit d7d3067ab9a73e6b2c320b254345f4a841bca170
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-08

    Be explicit on type conversions

M	nsd/log.c

commit 6fa01f489534a3961eaf2db56233deb89b7f85b0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-08

    Reduce number of returns before end of function

M	nsd/sls.c
M	nsd/tclthread.c
M	nsd/urlspace.c

commit 8bf81f75fea7022ae783511a0021d958b409c485
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-08

    Improve type cleanness

M	nsd/crypt.c
M	nsd/sched.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclresp.c

commit 92328477b4eb6c9acba57fc13746dad4e0d332a3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-08

    Improve type cleanness

M	nsd/dns.c

commit 57edd41f3b0702e0eafb697a6ac055fba22fc7be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-08

    Improve documentation
    - Group streaming HTML commands
    - Remove deprecated command ns_connsendfp from documentation

M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_write.man

commit 00564f7a19aa2c250716ee11b5d661d677e540b4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-08

    Improve manpages: make distinction between input argument "when" and the reported condition more clear.

M	doc/src/naviserver/ns_chan.man
M	doc/src/naviserver/ns_sockcallback.man

commit 1c850dd2ee644d25e8a275668f2f14068a4586f2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-07

    add error handling

M	nsssl/nsssl.c

commit 73e98d8cfa50cbfa73d5c7ee8ad3aef2c42acbcb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-07

    Remove unneeded variable

M	nsd/urlencode.c

commit 835f14befbb75892a8d4616fa15bdca8b591f92b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-07

    Fix bug with hinging close operations (SSL_shutdown hangs). This was an old back dating back to the initial version of nsssl in 2006 bug cahsed an "ns_connchan close" operation to hang.

M	nsssl/nsssl.c

commit 036040dbdfc54f1d69803f45f0acf47a9efeab58
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-05

    factor out redundant hex character decodings from ByteKey arrays.

M	nsd/urlencode.c
M	tests/ns_urlencode.test

commit c9293fa408812ef2649fa59df782a3149edd49fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-05

    Implement cookie encodings as defined in RFC 6265 (HTTP State
    Management Mechanism, 2011).
     * New API functions:
         Ns_CookieEncode()
         Ns_CookieDecode()
     * Additional accepted value for parameter "-part" in "ns_urlencode"
       and "ns_urldecode": one can specify in addition to "query" and "path"
       now "coockie" to request cookie encoding/decoding.

M	include/ns.h
M	nsd/cookies.c
M	nsd/urlencode.c

commit 96a422c584e670cf295e1736615671ed1394ea3e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-05

    fix compilation issue under Debian 8.6 (see Davids comment)

M	nsd/sockfile.c

commit ad611dbca7c14b5985b54dd3bd3ab60453000df8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-05

    fix sample config file and move "enabletclpages" to the section, from where it is used in the startup files

M	nsd-config.tcl

commit b6d19222a8f842a710e3c2bcc0705edf9d675f63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-05

    Add const declaration

M	nsd/request.c

commit f5bc65061944ee28388f418bbd754f4c5e2493a3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-05

    Improve type cleanness for windows

M	nsd/binder.c

commit dd27ceaf4723a911baf48c40d1b2174a152cdf66
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-03

    Improve type-cleanness under windows

M	nsd/sock.c

commit 44b4f4190438c537a370ebdc2387517bd28964ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-03

    windows cleanup: use ns_sockerrno macro instead of duplicating the logic

M	nsd/sock.c

commit 3d28a2e3af2d636b1d2abe45e48e2a849f593c2a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-03

    Improve cleanness of compilation under windows

M	nsd/binder.c

commit 2766e29ce6e84caf13a300920f9cd00ea2d717da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-02

    Keeping the correct hierarchy of a URL as impled by RFC 3986 in [ns_conn urlv]
    (For details see https://sourceforge.net/p/naviserver/mailman/message/35762900/)

M	include/ns.h
M	nsd/conn.c
M	nsd/request.c
M	tests/ns_urlencode.test

commit ddfe72e5b221c713ec399def0e352ed70fba4516
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-02

    Improve Windows support for recent versions of visual studio (versions after visual studio 2010) by introducing NS_EINPROGRESS and NS_EINTR for abstracting from the raw constants (many thanks to Maurizio for the input)

M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/binder.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/sockfile.c
M	nsd/tclsock.c
M	nsd/unix.c
M	nsd/watchdog.c
M	nsproxy/nsproxylib.c
M	nsthread/pthread.c

commit b87614795b8b3ab47a24e0bfb6f406ed7ce837ec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-02

    improve comment

M	nsd/httptime.c

commit c52f9cd834a907e25a7cac44d23b8519bed1a11a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-04-02

    improve comment

M	nsd/request.c

commit 5ee88355d6abacf467f2ea8a7d0efcd19de87e54
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-29

    minior restructuring

M	nsd/url2file.c

commit f3926871d7f4bcac03a7f9501f0ce8f5d9eb287a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-29

    Improve type cleanness under windows (should probably make NS_MSG_IOVLEN_T a type)

M	nsd/sock.c

commit 2ebde2fff1c88a8aecbe276a0c993fc4b993d457
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-29

    Use NS_GNUC_PRINTF on more occasions

M	include/ns.h
M	nsd/nsmain.c
M	nsd/watchdog.c
M	nsthread/nsthreadtest.c

commit 932350543056357baa5d142f70e0bd19ed476b7b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-29

    Introducing ns_sockerrno_t to sort out different error types between windows and unix

M	include/ns.h
M	include/nsthread.h
M	nsd/binder.c
M	nsd/nswin32.c
M	nsd/sock.c

commit 7b3b4748cad228e4d26101105a7c1531b3fc5d11
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-26

    To make query-component encoding usable for encoding/decoding cookies, the characters "," and ";" have to be percent-encoded as well.
    uppercase percent escape decoding was already implemented, not need to check this twice

M	nsd/urlencode.c

commit 2e837fbca3af2c3cf63f9da24cf4ca958c239d49
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-25

    make sure that only valid hex codes are converted

M	nsd/urlencode.c

commit 0da16b9278308c22015774c8547ab1e410725121
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-25

    Use DString instead of plain buffer

M	nscp/nscp.c

commit 6b5e1443efc7f1b45982ab843b980b585a595d06
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-25

    Reduce number of returns before end of function

M	nsd/httptime.c

commit 6a259867fffce24327d774c0633c11faff888392
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-24

    Remove dibugging code

M	nsd/urlencode.c

commit 45f4bf27d2867212d025d84937f1afb276a8ccf2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-24

    fix lengh of specially handled blank

M	nsd/urlencode.c

commit 5511316ebe4622c44ae7c0aad34808129b1634a3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-24

    make sure to null terminate encoded string

M	nsd/urlencode.c

commit c4a986db7f9e486f02ede4fddf751b2b66988406
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-24

    Don't warn on unencoded '=' characters

M	nsd/urlencode.c

commit e85f33d0f368f0609069c6d8b83080417a7aff4a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-24

    fix variable name

M	nsd/urlencode.c

commit a355d5394c8e11fc3e74ac3c8cd66d6d65eb1650
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-24

    Bump version number to 4.99.16d5

M	configure.ac

commit f3968c78cdab679528b9efca7a0ebe8fecaeda69
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-24

    urlencode reform:
    
    - The new code conforms to RFC3986 (2005), which has a more precise
      and differently structured definition (e.g. no 'unwise' characters)
      of characters encoded in URLs. The coding of the query part is
      actually defined in the HTML 4.01 definitions.
    
    - Coding of space (" ") in the path and query part is still different
      as in older versions of NaviServer (spaces are coded as "*" in the
      query part and "%20" in the path segments. This distinction is not
      not necessary according to the RFCs.
    
    - The coding tables are documented in detail, containing design
      considerations.
    
    - A new flag "-uppercase" added for supporting encoding for OAuth
      (RFC 5849); note that the "path" segment encoding has to be used to
      avoid coding space as "+".
    
    - A warning is produced now, when a URL is passed to the location
      field (e.g. ns_returnredirect), which is not properly encoded.
      Only characters, which have to be always coded, are flagged.
    
    - One can obtain the previoius encoding behavior when compiling with
      "RFC1738" defined.

M	include/ns.h
M	nsd/returnresp.c
M	nsd/urlencode.c

commit ffc0f293a2f83f30563ba3a0f9f72b0ee80da3f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-21

    Improve type cleanness and prepare for potential debugging

M	nssock/nssock.c

commit 8a8bd2bf57df153b60b7ca95ef5216b721d8b618
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-20

    Improve print formats for windows (visual studio 2017)

M	include/nsthread.h
M	nsthread/thread.c

commit ecaa6f8034f791b2b72878d0b0c4fb88578c6081
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-20

    Cope with changes in Universal CRT in Visual Studio 2015 where
    e.g. vsnprintf() is no longer identical to _vsnprintf().

M	include/nsthread.h
M	nsd/dstring.c

commit 670d00431140729c08b65503b9c4fc416d07a145
Merge: 39086349 76de55e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-12

    merge

commit 3908634911d2b56792e96bcb8d0375fd99b7bb92
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-11

    Improve robustness of ConnChanOpenObjCmd in failure cases

M	nsd/connchan.c

commit 76de55e0e6e5145edd5ff10bd79da203c7e7e91e
Merge: 51909216 d2c35c8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-10

    merge

commit 519092163eeab938c4f458e0d9dc9b0d50ccdc4a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-10

    - add debugging hooks for Maurizio

M	nsd/sockfile.c

commit d2c35c8cf880bad3cc1f36419879b791be4af686
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-05

    Reduce number of returns before end of function

M	nsd/sock.c

commit 86caa5e9757cd1414c424209323bac0d4e1afb4c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-05

    Add (commented out) debug statement to help to fix potential problems in windows port

M	nsd/proc.c

commit 5f2b07ae52e8b9bd3f38a65b7790abd88af4a60d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-05

    Move definition of ns_snprintf() from nsd/nswin32.c to
    nsthread/error.c, since nsthread uses ns_snprintf.
    Add status lines about -ticker- thread to make life-time clear.

M	nsd/nswin32.c
M	nsthread/error.c

commit 1b596c1e3190244fb362814a8f73a4b07904c93d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-05

    don't pass address of a const as a non-const pointer

M	nsd/config.c
M	nsd/tclimg.c
M	nsd/tclmisc.c
M	nsd/urlencode.c

commit 6d2276511db2ebda21922648e66e94701ff1be1e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-05

    Remove debugging code

M	nsthread/mutex.c

commit 393680a5fffd441aed7e76f6a9fd05f1c03fe809
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-05

    Fix indentation

M	nsthread/thread.c

commit 4e4fe7d89a46b819f71e2c996317fbb16c323a0f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-04

    Improve cast of 32bit value

M	nsd/nswin32.c

commit a8807e2f2f2942f4452ddaa2297e3ecdb7a8f3a2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-04

    Fix macro definition

M	include/nsthread.h

commit 136e650d8a589b99eac50729aab3da4920021b73
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-04

    Document "ns/parameters tmpdir" in openacs sample config file. Change the default for P_tmpdir to "c:/tmp" for _WIN32

M	include/nsthread.h
M	openacs-config.tcl

commit af0914105ca583c1a1a0aa4d406d8083002d4305
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-04

    Starting with VS2010 EWOULDBLOCK is defined in errno.h != WSAEWOULDBLOCK, so we have to abstract to NS_EWOULDBLOCK to cope with earlier versions and to provide cross_platform support

M	include/nsthread.h
M	nsd/sock.c
M	nsproxy/nsproxylib.c

commit 5a176020b4504b6e909d0bced63e87b9cc839554
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-03

    Reduce variable scope

M	include/Makefile.global.in
M	nsd/tclset.c

commit bd10dc0350980c3392502ab2aff24348a7730736
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-01

    Reduce number of goto statements.
    Reduce number of returns before end of function and reduce variable scopes.

M	nsd/tclenv.c

commit b3e9b300729f4760646640d4d330f90e4138f6ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-01

    Reduce number of returns before end of function and fix indentation

M	nsd/tclset.c

commit aec1c74fa51d65728f62d4a66a8d1efdac23eafa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-01

    Fix spelling of command name

M	nsd/log.c

commit 0ada2a236e1db39ab9e4d9fdbdd8a15a64428912
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-03-01

    Reduce variable scope

M	nsd/log.c
M	nsd/tclvar.c

commit 936a6b48a084750458e3e4b546a4abd828561002
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-26

    Bump version number to 4.99.16d4

M	configure.ac

commit 6935327abd4ca82e2122e1e60aaa55ab31305a26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-26

    Reduce number of returns before end of function and reduce variable scopes

M	nsd/tclvar.c

commit 921b95991ca41ab7206675c1f848dd863eba35c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-26

    align test results (sorted options)

M	tests/ns_log.test

commit f3dfe484cbc5e92d541081950cfb00bf4feb413a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-26

    Whitespace change: replaces tabs by spaces, strip trailing spaces

M	nsd/tclset.c

commit e6e0ba84a1331a090290f6ee1de4f9df696a7851
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-26

    Reduce number of returns before end of function and reduce variable scopes

M	nsd/tclset.c

commit 6c0915fe563aba98b56cb447edcef1b12f3bb62c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-26

    Remove useless and undocumented subcommand "ns_set idelete"

M	nsd/tclset.c
M	tests/ns_set.test

commit 9d658c8dbd6e7b2218ef0a824728c0e8fb0c0186
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-26

    Remove unreachable labels (this branch is only reached with different labels)

M	nsd/tclset.c

commit ee1fb140b3722870d5b75bb37f567e22b015ecb1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-26

    Split large function NsTclLogCtlObjCmd().
    Reduce number of returns before end of function

M	nsd/log.c

commit 2ebd17d8f5c7d1baf45ab2b066ef4916b1263ac0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-26

    Reduce number of returns before end of function and reduce variable scopes

M	nsd/connchan.c

commit d24c3427f2749dc1392b0b57b55ccc8e9b26c2c3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-26

    document result code of ns_cache_create

M	doc/src/naviserver/ns_cache.man

commit a6dd1691b38e6aa22844d081e7cc2dec014d2aea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-24

    - Reduce number of returns before end of function
    - user variable names more constently

M	nsd/tls.c

commit e9f7bf9b1c19bfbd17a83c8a54bfd7a87e981e1b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-24

    Return the computed returncode (fixes potential crash as reported by David Osborne)

M	nsssl/nsssl.c

commit 32688bcba4f9873c777b970fbe6fe2e85071a08e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-24

    Reduce verbosity for return status communication, mystery solved (systemd kill parent process due to too small timeout)

M	nsd/nsmain.c

commit 12a8bf0c97e1ba27e45ae2a51175a8bc8a4a801e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-23

    - reduce size of NsTclCacheCreateObjCmd
    - setting SetErrorCode more consistently
    - ns_cache_create returns now boolean instead of exception to provide
      better support for concurrent thread creations (after
      ns_cache_create, it is guaranteed that the cache exists, this eases
      usage scenarios together with [ns_cache_exists]
    - improve comments

M	nsd/tclcache.c
M	tests/ns_cache.test

commit 59a36a6ecde90459f76a4bbe37bb1b59c68407e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-23

    Improve comments

M	nsd/driver.c

commit ab84b85f3616a140afe93b9be3728b8a35a8d22f
Merge: 278416c0 4c36688c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-23

    merge

commit 278416c0bbcacd09c5f20c40a8d5a8b25efb6c74
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-23

    Provide more detailed debugging info, when communications between parent and forked child fails

M	nsd/nsmain.c

commit 4c36688c9aaa38ab9315984d4b6e7358dbd02df7
Author: David Osborne <david@qcode.co.uk>
Date:   2017-02-23

    Even if protocol matches, carry on searching drivers until non-null driverName also matches

M	nsd/driver.c

commit e14c829ed51ec9fa72a4bdf88c30e618c2a2f117
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-22

    Added prototypical "-driver" option to "ns_connchan open"

M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h

commit 6c6ffa51f8167cee9709f42475e2d8e95a5eeb53
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-22

    Provide debugging hints for startup problems under systemd

M	nsd/nsmain.c
M	nsd/tclcache.c

commit 4b75ef451e208f33125e6f52d2dec647a4df78c8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-22

    Add extraheaders to sample config file for openacs

M	openacs-config.tcl

commit 1fc17a85755f808a8dc4655d02c9d4a993812278
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-21

    Add new command "ns_cache_exists". It is more than an order of magnitude faster than [expr {"foo" in [ns_cache_names]]

M	doc/src/naviserver/ns_cache.man
M	nsd/nsd.h
M	nsd/tclcache.c
M	nsd/tclcmds.c
M	tests/ns_cache.test

commit 1129ed22510b88104f935ea4f4dbe5b8098d8d48
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-21

    Always set the pipefd to 0 after closing it

M	nsd/nsmain.c

commit 2c44f6f38599717e0f3a00caf8ae3f50cd58d3d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-21

    Don't ignore length parameter in ns_nsprintf

M	include/nsthread.h
M	nsd/nswin32.c

commit ccfa84476f89542d56a187088981115ebc8c3a10
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-21

    Reduce implicit conversions

M	nsd/tclimg.c

commit d1247a194ff64b6a4535297ac2803e9da01dda85
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-20

    - Remove duplicated line
    - Bump version number to 4.99.16d3

M	configure.ac
M	nsd/nsmain.c

commit 06ed18259cf220f6b1b881597e81d2b605a9fa2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-20

    Don't produce warning on warn_unused_result (on write() operations) or on unreachable code (after Fatal under macOS)

M	nsd/log.c
M	nsd/nsmain.c

commit 55edb7db12a9728fd7b13a2d9b18dd44dc18da08
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-20

    Reduce number of returns before end of function and reduce variable scopes

M	nsd/lisp.c
M	nsd/tclimg.c

commit 71e3633f5519ae5a346bea29b1443795a329f554
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-20

    - Reduce number of returns before end of function and reduce variable scopes
    - add nonnull constraints
    - Reduce function size

M	nscp/nscp.c

commit 13188b906044a1a3155c50b9542e0fdb0a9c116b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-19

    Add documentation for ns_cache_configure

M	doc/src/naviserver/ns_cache.man

commit 781f66013a177257c41c4bef85efc2519ebc899e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-19

    When the server is starting in a forking mode, return a nonzero
    return code, when initialization of the server went wrong.

M	nsd/log.c
M	nsd/nsd.h
M	nsd/nsmain.c

commit 8a6fd7af355fb49b5a4f7c650658b23560f863b8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-19

    Move flag "-f" (foreground flag) to the end

M	Makefile

commit fd841fa822197de0818c658c3881e14213a38cb7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-18

    Provide error message rather than crashing when compiled against a version of Tcl compiled with Apple's Core Foundation support

M	configure.ac
M	include/nsconfig.h.in
M	nsd/nsmain.c

commit 5e1d33ae7982ffab5064e12af5ea51a63630e791
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-18

    Reduce number of returns before end of function and reduce variable scopes

M	nsd/adpparse.c

commit 5e3c47caca4fa19a1dbbe519bad2bb7db43fa3f7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-18

    Fix typo

M	nsd/adpcmds.c

commit 9999fcd2af4e9959fd782cbfdb446857d53b309e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-17

    Reduced mismatched essential type categories for binary operator

M	nsd/modload.c
M	nsdbtest/nsdbtest.c

commit 795a3ee4a1c499e605d09a5cfcae404edfed3ef6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-17

    Add NS_GNUC_RETURNS_NONNULL for path-generating functions

M	include/ns.h
M	nsd/pathname.c

commit e68be724b9c2ae164c503f577c47226dfd6651d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-17

    Provide ns_nsprintf to reduce code smells under windows

M	include/nsthread.h
M	nsd/nswin32.c

commit 6d5d8dca7612dee3a733291799d0938b7049be57
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-17

    Reduce variable scopes

M	nsd/log.c

commit 79e1f71912d1378542012ab392383a4e5b2caef4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-16

    Improve type cleanness

M	nsd/tclcache.c

commit 3aeb1aa775dbcf26d4f4af151e1b383de1f507c3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-16

    Improve handling of requests in ancient (pre HTTP/1.0 1996) HTTP requests in combination with writer threads.
    Previous versions could run into a too restrictive sanity assert, assuming that reply headers must be always present (which is not the case in the rather informal HTTP versions before HTTP/1.0)

M	nsd/driver.c

commit 5755038e251932f3c3ffa1f5c4097083f8602228
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-15

    Ease debugging with potentially invalid encoding names

M	nsd/encoding.c

commit 306e4f59d56252989752ad1ac0ced48e8523229d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-15

    Cast to unsigned int (as required by tcl 8.6)

M	nsthread/memory.c

commit 7efee20b3c8e69f9025b044fb744f33387679e61
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-15

    Initialize cPtr for error cases

M	nsd/tclcache.c

commit bf7d29c083082db926bc7fa9cbe25bc1f8ce24cc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-15

    Drop flags not everywhere available

M	include/Makefile.global.in

commit 0007533b6390fd6e6d413b0b0a1b427888b5e1ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-15

    - case to unsigned int (as required by tcl 8.6)

M	nsthread/memory.c

commit dc3f8e6570b58ab28bddfc56d31e7e042bf01601
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-15

    ns_cache_* overhaul:
    - make sure cPtr is always initialized (defined value in error cases)
    - pass clientData to ObjvCache in case, the Tcl_Obj has to be created
    - don't crash in ObjvCache, when server is not available
    - extend regression test with test cases for ns_cache_configure

M	nsd/tclcache.c
M	tests/ns_cache.test

commit 0f1ee773fc4dd412d3bc77ff3e550dabd97c068d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-15

    Don't spit out errors, when trying to CORK on invalid (closed) files

M	nsd/sockfile.c

commit caa104b82745101d3f019c0349c9c3fa88e8d518
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-11

    Stop using readdir_r() unless it is forced via compile flag. Background:
    - readdir_r() was deprecated in glibc in 2016 (version 2.24)
    - readdir_r() was removed from tcl in 2005 (http://www.rkeene.org/projects/tcl/tcl.fossil/tktview?name=1095909)

M	nsthread/reentrant.c

commit 896a4e3765f91b048ccbf570e5afe21b1bb1a41f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-09

    More changes for OpenSSL 1.1.0
    - deactivate registration of CRYPTO_set_mem_functions() since OpenSSL
      interface of malloc() functions has changed. Registring our own
      functions does not seem necessary
    - fix various interface changes (no access to DH members, removal
      of SSLLock and SSLThreadId, SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS)

M	include/nsconfig.h.in
M	nsd/tls.c
M	nsssl/dhparams.h
M	nsssl/nsssl.c

commit 71c861a607a65089d2fcff166f9d061e5e3ab87d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-07

    Initialization for OpenSSL 1.1.0 has changed. Extend m4 macros for testing and alter initialization

M	m4/openssl.m4
M	nsd/tls.c

commit 94ff44cc74952b994bf1dd104af67eb1d88c0f4d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-06

    Prefer type bool over int for Boolean values

M	nsd/connio.c

commit 561392150436cc76bb032fac7c23e32645680983
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-06

    Use plain assignment for setting flags

M	nsd/fd.c

commit 171f850bfa25df470e92004b488745f4fbf48ed7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-06

    Initialize Ns_ReturnCode properly with NS_OK;

M	nsd/driver.c

commit 4317c3bc376191beecacdf16deaf0edbb9d26b19
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-06

    Reduce variable scope

M	nsd/connio.c

commit d1a4cf97e725222aa595e88948c7feb3b9ece7ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-03

    nsdb: provide interface to session_ids. When implementing e.g. prepared statements over the nsdbpg driver, the prepared statement is just valid for one session. by providing the session_id on the Tcl layer, prepared statements can be provided selectively on the Tcl level.

M	nsdb/db.h
M	nsdb/dbinit.c
M	nsdb/dbtcl.c

commit 8416fc468fb4c667d56319fdf631cbd132e9a23c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-02

    Don't rely on dirty write operations (many thanks to Zoran!)

M	include/ns.h
M	nsd/cache.c
M	nsd/dns.c
M	nsd/tclcache.c

commit 299eecbb1f59f3ca44ef9018cdf5bd6241748e95
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-02

    Write always const qualifier before type

M	include/ns.h
M	nsd/sockcallback.c
M	nsd/tclmisc.c

commit d61e9b5be1e4c71eed6ae3ada61d820101f03d49
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-02

    White space change: remove trailing spaces

M	nsd/fd.c

commit c9d6b63565cf8855db0313aa2a7bfaea7a7328e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-02

    White space change: remove trailing spaces

M	nsd/driver.c

commit 599c69450703a30c3aaa9cad28890897a6e41d78
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-02

    Reduce number of returns before end of function and reduce variable scopes; improve comments

M	nsd/driver.c
M	nsd/fd.c

commit c6a5f8513571b2260b2f7e8b183d603fd2c297bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-02

    Prefer type "booltype " over type "inttype " when variable is logically Boolean

M	nsd/driver.c

commit 67b8eb88e75f0eb2b10722c8e90c67a9ebddbf05
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-02

    Reduce number of returns before end of function

M	nsd/adpcmds.c
M	nsd/connio.c
M	nsd/dns.c
M	nsd/driver.c

commit f42c1f8d5665c72a2b93778a9ca0467c32393d87
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-02-02

    Reduce variable scope

M	nsd/cookies.c

commit 31a7c95c27caeb3c52353050cc4e24608bd8a482
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-31

    Bump version number to 4.99.16d2

M	configure.ac

commit 2803482a59d44d1774ea7051fa6f039bfa1f108b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-31

    Switch to the recommended way of creating detachted threads via pthread attribute
    (see e.g. https://docs.oracle.com/cd/E19455-01/806-5257/6je9h032l/index.html)

M	nsthread/pthread.c

commit 2aa434ff932943a022c5054e06ea5a9ea2279d8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-31

    Provide arguments in alphabetical order

M	nsd/tcljob.c

commit 6e8b5741a20f6c2042b757b3714050ce0cec6a14
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-31

    - Reduce number of returns before end of function
    - Check arg vector before connection state

M	nsd/tclfile.c

commit 423721ee888a6e025c88a64da2a20b66b1913536
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-31

    Reduce number of returns before end of function

M	nsd/cookies.c

commit d63da5534a96d9c5e7ed271756e4030b02819a67
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-31

    Reduce number of returns before end of function

M	nsd/cookies.c

commit 5f439b09a5b8764a19aca1ef3293f1cd4b5265f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-31

    Prefer Ns_TclPrintfResult for result generation

M	nsd/adpcmds.c

commit 27300214f925a87c14c0ced4b53f0a4b3a4dd332
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-30

    Added command to change cache parameters at runtime:
    
        ns_cache_configure /cache/ ?-timeout T1? ?-expires T2? ?-maxentry E? ?-maxsize S?

M	include/ns.h
M	nsd/cache.c
M	nsd/nsd.h
M	nsd/tclcache.c
M	nsd/tclcmds.c

commit 9c65204214877da7142e63bf3bbb6844ca3ab093
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-28

    Make sure that internal counters are reset, when creating a thread
    failed; remove unneeded static function JoinConnThread()

M	nsd/queue.c

commit cf057a359f8bb5e3741b843e2850718a4494ae29
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-28

    Allow caches larger than 2GB

M	nsd/tclcache.c

commit c938f80a9b538692006024a95cd2ecb624c2f6f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-28

    - improve spelling

M	NEWS

commit a80b1dd3b55c5391f47ef0bfba7dab304a60f643
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-28

    - fix markup

M	doc/src/naviserver/ns_job.man

commit bc0b89c90547d4ec5b28924fb5a4559a6f98b7df
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-27

    Improve banner of online manual pages:
    - make url protocol agnostic
    - use new .io domain of sourceforge

M	doc/src/header.inc
M	doc/src/man.css

commit fe38c5aaac9c7b615c83e902ff372c5caaaf7587
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-27

    Improve man page:
    - add missing glags
    - bring subcommands to alphabetical order

M	doc/src/naviserver/ns_job.man

commit f2b65f366897b2a61ef15edb0c8037fca66a5e48
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-23

    Align test cases

M	tests/cookies.test
M	tests/ns_sls.test
M	tests/tclresp.test
M	tests/url2file.test

commit b163e554c97e3166349309835bc9527c90ab54e6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-23

    Make behavior in error case more uniform: check first syntax, then connection

M	nsd/cookies.c

commit 778d52c4b1a4b8220868917e3d302d0f524dc7ae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-23

    Improve error message: ns_set is here "invalid" but not "illegal"

M	nsd/tclresp.c

commit 5ca211727b480de026701c705bc89f127f81e30e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-23

    - Prefer usage of Ns_ParseObjv over manual parsing/error message generation
    - Reduce number of returns before end of function

M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/auth.c

commit dd16c26c8bede6b70d7c3a07e9ea4871d9a1f5bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-23

    Use NsConnRequire instead of static variants

M	nsd/driver.c
M	nsd/tclfile.c
M	nsd/tclinit.c
M	nsd/tclresp.c

commit 43175c18e5b04f2ccc3f70e063e98c217013499e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-23

    Reduce variable scopes

M	nsd/cookies.c

commit d1dad3824de7916cbe0031537bbfd28bba833ffc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-23

    New API function NsConnRequire() to make handling of required connections and error results more regular.

M	nsd/conn.c
M	nsd/cookies.c
M	nsd/nsd.h

commit 70bde8c335508e3eb69282fef3d965d41c9c8c90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-22

    Don't pass implementation-defined NULL after the last typed argument to a variadic function

M	nsd/driver.c
M	nsd/pathname.c

commit 45272f681e7a2b22fe4c77a1f51bcb63fced6399
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-22

    Generate error messages with Ns_TclPrintfResult
    Prefer Tcl_SetObjResult over Tcl_SetResult

M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/callbacks.c
M	nsd/cookies.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/sls.c
M	nsd/url2file.c
M	nsdb/dbtcl.c

commit dfac9f4677bec069bd62610ace012a986ae6f972
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-22

    Prefer Tcl_SetObjResult over Tcl_SetResult

M	nsd/auth.c

commit 4f85bbd30424a53d977ae2ecf05e38f0d0de95b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-22

    Reduce number of returns before end of function

M	nsd/adpcmds.c

commit 0311b201006645717299851e27282072f76ecdcf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-22

    - simply casts

M	nsd/crypt.c

commit e45ab1b917a22caf1a1da481aa6d50639ddd8cff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-19

    White space changes:
    - replace tabs by spaces
    - remove trailing spaces

M	nsd/adpcmds.c

commit d906cbd54c0113144b3010d3b17b2fa7e877f938
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-19

    - Prefer usage of Ns_ParseObjv over manual parsing and error message generation
    - Reduce number of returns before end of function

M	nsd/adpcmds.c

commit ceaa173ed061d284876c3f899b52e56e281f9950
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-19

    use NS_TRUE/NS_FALSE instead of 1/0 for boolean variables

M	nsd/nsmain.c

commit 00877c9c2050a42c0243a27b68a341028a1e70fe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-19

    extend regression test for ns_urlspace

M	tests/ns_urlspace.test

commit 268745e05a5d61a269626b9bbee1e00d45bafa97
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-18

    Add test file used for sorting out problems with the tcl initialization for forthcoming tcl version 8.7

A	tests/ns_thread_crash.test

commit ed132271145191e43fea12dd9df074cc1aa4d47b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-18

    Avoid a potential race condition

M	nsd/tclthread.c

commit a67a6121d2303bd5b585ab311674784d4b28684a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-18

    Reduce scope of lock when registering a filter

M	nsd/filter.c

commit 8ef309ce9b0cedca13cbd955736ecde5ed59be44
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-18

    - added parameter "defaultextension" for adp section in config file. Can be set e.g. to ".adp" to test for FILENAME.adp, when adp is mapped to FILENAME

M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/nsd.h
M	tests/test.nscfg

commit f808f142c42595d79e4937d22b93513e50e25eb1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-18

    reduce number of returns before end of function

M	nsd/adpcmds.c

commit d8b6adedb074e34d2686613819814172e4bedc21
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2017-01-16

    Added explicit notifier init for forked process with Tcl 8.4.
    This solves the problems when an loadable extension creates
    threads using Tcl API but never creates any Tcl interpreter
    per thread.
    All later versions of Tcl init the notifier on-demand.

M	nsd/nsmain.c

commit 8a99c5c80a74f830f2e2913c659d432e85ad1985
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-16

    - don't rely on undocumented behavior

M	nsd/adpcmds.c
M	nsd/form.c
M	nsd/queue.c
M	nsd/tclmisc.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c

commit 32f64df8216d192afa493f22c5c05dd3937e400a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-16

    - mark argument as unused (under Linux)

M	nsd/sockfile.c

commit 0c5e2633c0be638101b1d1f4a7eb534c96aad1b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-16

    - Don't pass implementation-defined NULL after the last typed argument to a variadic function

M	nsd/tclobjv.c
M	nsd/url2file.c

commit eacb212a4bebf5fcbac18a5754c3f08a642159ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-16

    - add tidy cflags for conveniant testing

M	include/Makefile.global.in

commit c3dcdd021b38a9794b64e854ba3d2a4ea62acc54
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-16

    - align argument name of prototype

M	nsproxy/nsproxylib.c

commit 4f49ac6ad2ace913d49c61279904a0b092c91944
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-15

    - use NULL for comparison with pointer

M	nsperm/nsperm.c

commit 078a7b299d3f9603a8e9d1a44c363d8bbe782243
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-15

    - prefer bool over int

M	nsd/tclobjv.c
M	nsd/unix.c
M	nsd/watchdog.c

commit 1e0e1e0e7150d88d738887cf7bc63000efaa7a56
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-15

    - prefer bool over int

M	nsd/tclcallbacks.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c

commit 9a85e4696f803bc8ccb5e6f7e8e1272cdb7bbee2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-15

    - white space change

M	nsd/request.c

commit 7f7494de814df7f4988d25d78c79757285a59b04
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-15

    - prefer bool over int

M	nsd/random.c

commit 03df1193d8db60caed1aa3b13cc8bdc53ae2f4ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-15

    - prefer bool over int

M	nsd/nswin32.c
M	nsd/queue.c

commit 4923b61ad00c15b0c928943af24db5cb94f99805
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-15

    - reduce implicit conversions from signed to unsigned

M	nsd/cookies.c
M	nsd/sockfile.c
M	nsd/watchdog.c
M	nsproxy/nsproxylib.c

commit 52e2fa153d660b07481ae0e785f843f01df0e947
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-15

    - prefer bool over int

M	nsd/cookies.c

commit ae43429a96a8fc405f2b8271723e83d59b69a441
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-15

    - prefer bool over int

M	nsd/config.c

commit ebd52a2601866421fb9639283f5b948b5ab8b284
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-15

    - prefer bool over int

M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/callbacks.c

commit 2732e09b9b08ede0a19357006a52b617b84e36eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-15

    - prefer bool over int

M	nsd/adpeval.c

commit dd7dd4efe2595d0d6c900342d389841b410aa0a3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    White space change:
    - strip trailing spaces

M	include/ns.h
M	include/nsthread.h
M	nsd/adpcmds.c
M	nsd/auth.c
M	nsd/callbacks.c
M	nsd/crypt.c
M	nsd/driver.c
M	nsd/mimetypes.c
M	nsd/tclcallbacks.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclobjv.c
M	nsd/tcltime.c
M	nsd/tclxkeylist.c
M	nsd/unix.c
M	nsdb/nsdb.c
M	nsthread/mutex.c
M	nsthread/reentrant.c
M	nsthread/thread.c
M	nsthread/winthread.c

commit 38f003c0c00ff82be2aea0b91c84101d52501f10
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    Unify code initialization:
    - use bool instead of int
    - use variable name "initialized"

M	nsd/mimetypes.c
M	nsd/tclcallbacks.c
M	nsdb/nsdb.c
M	nsthread/cslock.c
M	nsthread/master.c
M	nsthread/pthread.c
M	nsthread/thread.c
M	nsthread/winthread.c

commit c78aae448210463666d007e237be057eda398fa7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - improve padding, especially on 64bit machines

M	include/ns.h
M	nsd/nsd.h
M	nsthread/reentrant.c

commit 8c74f326c71c5a2e22cf03b955087d7e4b112c55
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - reduce implicit conversions (gcc7)

M	nsd/crypt.c

commit 84027ed3f2689a59cd7ed38bac4107fcffc6bce4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - align with more precise error messages

M	tests/ns_config.test
M	tests/ns_env.test

commit f2f2ea0dec77cdfd2745b6aeb1a2d784becea9a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - remove old style function definitions

M	nsd/callbacks.c
M	nsd/fastpath.c
M	nsd/tclinit.c
M	nsd/tclobjv.c
M	nsd/tcltime.c
M	nsd/tclxkeylist.c
M	nsd/watchdog.c
M	nsproxy/nsproxylib.c

commit 996be182cd15fe87b6ce07321b90e87f3af2ca17
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - remove old-style function definitions

M	nsssl/dhparams.h
M	nsssl/nsssl.c

commit e774cc8d5df841c0ac1942c7284b89515d4e13fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - improve the compilation with -Wwrite-strings
    - reduce shadowing of local variables
    - add const declarations

M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/info.c
M	nsd/tclconf.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclresp.c
M	nsd/tclsock.c
M	nsd/watchdog.c

commit f256383fe382e8692e20a402f74a58ccefbca38b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - adding missing prototypes
    - sort prototypes alphabetically

M	include/ns.h

commit 0413d896cab5e1f0db92f14106bda789cd4fe46f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - add prototypes

M	nsssl/dhparams.h
M	nsssl/nsssl.c

commit 9d8b50115924f947e6416f75d5a9afc20bf1bdea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - add prototype for GetPwUID()

M	nsd/unix.c

commit 3f1f67621b58396c433347d9f74911d9a5bafccc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - don't shadow variable
    - don't pass variables of type "const char *" to functions declared with "char *"

M	nsd/tclset.c

commit 581e431321c71f6f4712497f61c62c79b9d8001f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - adding missing prototype for NsTclReturnTooLargeObjCmd()

M	nsd/nsd.h

commit db8ae939785b2817ad7003b83d5efa53c3cbe462
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-14

    - remove shadowing conflict of variable "optind" with global variable optind of command line parser (e.g. https://linux.die.net/man/3/optind)

M	nsd/config.c
M	nsd/nsd.h
M	nsd/nsmain.c

commit 471de4a5dddf50fdb3a9499909e562e6369b2176
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - reduce shadowing of variables
    - improve the compulation with -Wwrite-strings

M	nscp/nscp.c
M	nsdb/dbtcl.c
M	nslog/nslog.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c

commit faa2ed6f8b3a4c3f91ced0665c781f9f83e91f35
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - add missing protypes

M	nsthread/thread.h

commit 11dc6426109f9f0063de7e9f0b3e379067e29731
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - add const declarations

M	nsthread/error.c
M	nsthread/thread.h

commit c2c5e4a7883448f6a4f748ac9a9ac9383c45fe44
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - don't shadow local variable

M	nsd/tls.c

commit 70cd17a53e493561b78dff46cef36dca7612cbb9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - don't shadow local variable

M	nsperm/nsperm.c

commit 2e29d1c234ee5e2cb364c6047a793a7c544ff646
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - add missing prototype

M	nsdbtest/nsdbtest.c

commit 1b062212a8f5069b1f1ebbb1123c242f450be2e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - adding missing prototype

M	nsproxy/nsproxy.h

commit c448368cc5ddb5f47ea42905e0f2e5065860b955
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - improve the compulation with -Wwrite-strings

M	nsd/exec.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/pathname.c
M	nsd/sls.c
M	nsd/stamp.c
M	nsd/url.c
M	nsd/url2file.c
M	nsd/urlspace.c
M	nsperm/nsperm.c

commit 9fdc438b3daf305ac4dbfe86585c9d14ca464551
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - mark unused arguments as UNUSED

M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/compress.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nsd/watchdog.c
M	nsdb/dbtcl.c
M	nsdb/nsdb.c
M	nsperm/nsperm.c
M	nssock/nssock.c
M	nsthread/nsthreadtest.c

commit 17491cb2481adea9ec14dbfbe7fa49d8a47407c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - mark member key of Ns_ObjvSpec as const

M	include/ns.h
M	nsd/tclobjv.c

commit 12302009d8f0efc709b77872b7b79a3c404fe7e5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - makr unused arguments as UNUSED

M	nsssl/nsssl.c

commit 149ad78b813e79d822b19a2358ddfc7a072670a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    Use same conventions in nsproxy module like in other modules
    - make unused arguments with UNUSED
    - add const declarations

M	nsproxy/nsproxy.c
M	nsproxy/nsproxylib.c

commit 48c81bb695e2e4774c0f35d2ba3858f8dc7f3b9d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - adding const declarations
    - adding nonnull asserts

M	nsd/nsmain.c

commit d383a488e2db9c5f2e4b33a3ed991cb23ee2e102
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - remove the call to Tcl_InitNotifier(), which is not needed

M	nsd/nsmain.c

commit b5aae89febe5da9eb83b41362cde8b9a3ea1c1fe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-13

    - bumpt version number to development version 4.99.16d1

M	configure.ac

commit 797f65591e0e349635fa891178b490def99e5c8a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2017-01-12

    Refactor the code w.r.t thread-exit so it can be better re-used
    among platforms.

M	nsthread/pthread.c
M	nsthread/thread.c
M	nsthread/thread.h
M	nsthread/winthread.c

commit edd25c043d38fd5fa9f5bf8733934295a1d13fc2
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2017-01-12

    Align Win port to the latest TLS cleanup changes.

M	nsthread/winthread.c

commit 48c355a1be572e7d9ca134e382f975cf7be36228
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2017-01-12

    Rework way we handle TLS cleanup; align it to the Tcl practices.
    Add compatibility for Tcl 8.5- w.r.t notifier-thread init after
    the fork.

M	nsd/nsmain.c
M	nsthread/pthread.c
M	nsthread/thread.c
M	nsthread/tls.c

commit 7c0996a577e1f22cd2c487ffe94d20fef44f058c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-10

    Added tag naviserver-4.99.15 for changeset e045cbe91217

M	.hgtags

commit a8a73b6f08560a9c4c99b4789c135d17de3b6c9a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-10

    - bump version number to 4.99.15

M	NEWS
M	README
M	configure.ac

commit 07ae3aee09af7d2478daa117e422ca56c8d0ec39
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-10

    - update news file

M	NEWS

commit 3afa308847c53e4518f94bbaee14f76a83328a5f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-10

    - remove backup-files from dist

M	Makefile

commit 613d897e516f4ab55e1aaf276ba0d7751eb94bb5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-10

    - rebuilt with TEA 3.9

M	include/nsconfig.h.in

commit 2405a9817e0c36c3a1c8a800d0e58a58ce4f6015
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-10

    - use recent version of install-sh

M	install-sh

commit 8d5efeee36a700eac2ca8a59dd8226c6e46569ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-10

    - use TEA 3.9 (TEA 3.10 causes currently problems, don't do experiments before the release)

M	m4/tcl.m4

commit 28c5ba275822e6020575fbf6a2f90b1a1d2af525
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-10

    - upgrade to TEA 3.10

M	include/nsconfig.h.in

commit d803dcb803d5c7f833db2bda2a6bdb2ca1f8200d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-10

    - Upgrade to TEA 3.10

M	m4/tcl.m4

commit 70f9573acbceb070b6feebaf5b047381f65df2e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-09

    - moved Ns_MutexInit() and Ns_MutexSetName() past Nsthreads_LibInit()

M	nsd/init.c

commit b9066701cf553eb5dd61d469c09c9c37ac93aea5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-09

    - updated NEWS entry

M	NEWS

commit 7057aca7edfc6309080119519f708d5e54254527
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-09

    - align argument names in prototypes and function definitions

M	include/ns.h
M	nsd/adpcmds.c
M	nsd/binder.c
M	nsd/compress.c
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/unix.c
M	nsproxy/nsproxy.h
M	nsproxy/nsproxylib.c

commit 8d785f87857ceca5f56f9459bc578105b132b23b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-08

    - bump version number to 4.99.15b4

M	configure.ac

commit 4fe1c1cf82cb590dc42704548d615b13f8174148
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-08

    Ease compilation under windows:
    - don't pass "const char*" as member dest of Ns_ObjvSpec
    - add compatibility type "suseconds_t" for windows
    - define NS_NAVISERVER for windows (no configure script)
    - move conditional definition of P_tmpdir after the .h files are loaded
    - fix type in macro PTR2UINT in windows code

M	include/nsthread.h
M	nsd/adpcmds.c
M	nsd/adprequest.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/info.c
M	nsd/limits.c
M	nsd/modload.c
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/quotehtml.c
M	nsd/tclcache.c
M	nsd/tclconf.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/url.c
M	nsd/url2file.c
M	nsd/urlspace.c
M	nsdb/dbtcl.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsthread/mutex.c
M	nsthread/signal.c
M	nsthread/winthread.c

commit a76b0a7a3554c1e3c8b3e2935388830b5638c417
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-07

    - improve type cleanness

M	nsd/tclsock.c

commit bbd90e8c2ccadc2cc42464ed354dcff50b750b83
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-07

    - improve variable naming

M	nsd/tclhttp.c

commit 46b14768c5f8747582f5116d8e4eab80650253f2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-07

    - pass interp to Tcl_ListObjAppendElement()

M	nsd/url.c

commit 31f660f85942bc645c8702bef661ec03d0833dc5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-05

    - bump version number to 4.99.15b3

M	configure.ac

commit b75fe3d087120374a3b252422ede7b2e3e249168
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-05

    - check as well for pkg-config when "--with-openssl" is used via defaults (i.e. not explicitly specified)

M	m4/openssl.m4

commit 0b63d0ddc06fe97057b948f7bde7120d57aa498e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-05

    - improve minimal sample config file

M	simple-config.tcl

commit db3a23f2b98f3e294c6591719fb64b917c3399f7
Author: Zoran Vasiljevic <none@none>
Date:   2017-01-04

    Added more comment on Tcl_FindExecutable calling position.

M	nsd/nsmain.c

commit 41d4748a48ff369a75943bf1e5d675d7c49cc8e3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-04

    - use NS_IP_UNSPECIFIED in case no bind address is specified

M	nsd/driver.c

commit bc64c0fbf00906a15d85c0dfaccb4ef5bacfc0c9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-02

    - make compression test result robust against changes between zlib 1.2.8 and zlib 1.2.9

M	configure.ac
M	tests/ns_adp_compress.test

commit d807cce3b6531fe6a95740c7d16b88010dde9f0e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-02

    - keep Tcl_FindExecutable(argv[0]) after the fork - otherwise tclconnio-3.1 leads to a Fatal after thread::create

M	nsd/nsmain.c

commit 1262163c991b1efb9c63deb468c8acaa914f76ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-02

    - no need to have TCL_NO_DEPRECATED twice in defines

M	include/Makefile.global.in

commit 8ab0e3967a32cf5c31cdd02805bb889dc05244fa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2017-01-01

    fixes for tcl 8.7:
    - make sure to call Tcl_FindExecutable() before any Tcl call

M	nsd/nsmain.c
M	nsproxy/nsproxylib.c

commit 5c1ce8b7f6597eda777812be036535959c47c5e3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-31

    - use "unsigned short" consistently for ports

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/conn.c

commit 05d8835103cda5b25802701b99c224cf8e924726
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-31

    - white space changes

M	nsd/binder.c
M	nsd/fd.c
M	nsd/httptime.c
M	nsd/queue.c
M	nsd/tclconf.c
M	nsd/tcljob.c
M	nsdb/dbinit.c
M	nsthread/reentrant.c

commit 23cb6af47b9f8443974116998c1bf3b9044ab372
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-31

    - Don't pass implementation-defined NULL after the last typed argument to a variadic function

M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/nsmain.c
M	nsd/tclcache.c
M	nsd/tclobjv.c
M	nsd/url2file.c
M	nsproxy/nsproxylib.c

commit 0a6f29434703bf56f0534d22ea7ff3be577aaba9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-31

    - white space change

M	nsd/conn.c

commit 89ee6a5ecaa04dc311fad5d11d944e102c0461a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-31

    - reduce number of returns before end of function

M	nsd/conn.c

commit 74bd502742672de40fa682a7b21385f95eb26af4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-31

    - reduce usage of Tcl_AppendResult()

M	nsd/conn.c

commit 7a60a096089b18b562ce0aaa8165fafb54cd65e3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-31

    - reduce number of returns before end of function
    - add const declarations

M	nsd/cache.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/log.c
M	nsd/tclset.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsd/uuencode.c

commit 4b1029b2ac75b2c82b1d17b7b7fb1059e75cdad6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-31

    - replaced remaining Tcl_CmdProcs into Tcl_ObjCmdProcs

M	nscp/nscp.c
M	nsd/config.c

commit 68ddd4ccf67803d2ca5d2abb83e6752469443d64
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-30

    - Make it possible to pass alternative implementation of CPPCHECK
      to Makefile

M	Makefile
M	NEWS
M	include/Makefile.global.in

commit 13c2d03c46dc49f4424ed7bbcb9595bca6bcb4de
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-30

    - bump version number to 4.99.15b1

M	configure.ac

commit 9cb15eb470b321f4ab846b3b3090c8c2df07786d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-30

    - updated NEWS file (preliminary release notes for 4.99.15)

M	NEWS

commit 311d856afe0a3815a7bbca80d1edfe0da935c952
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-30

    - remove typos

M	doc/src/naviserver/ns_server.man

commit 09dfce960eb23d1ab2b50a6776e295aa5147f0dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-30

    - add documentation of "ns_conn partialtimes"

M	doc/src/naviserver/ns_conn.man

commit 218c8c86f4b5d4bba0b42310bed6885fcd76c8cb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-30

    - add "resuseport" description
    - improve keywords

M	nssock/doc/mann/nssock.man

commit c3f44cfbc3e1f4270df6a610b1311c2775fad35c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-30

    - remove spurious words from documentation

M	doc/src/naviserver/ns_driver.man

commit f39999fbd0ba3583a50e3d6f1ef89ec2af9140f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-30

    - document mutexlocktrace in sample config files

M	nsd-config.tcl
M	openacs-config.tcl
M	sample-config.tcl.in

commit 7cda1b998008218f2e98ba8eed67242ab3e5ba06
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-30

    - fix typo in variable name

M	nsd/binder.c

commit 92529be6f156534abba3830366ba8233d31b77aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-30

    - fix typos

M	doc/src/naviserver/ns_server.man

commit 86804a5c25d13b29deee8d9ac9796e18d40c6901
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-30

    - add the following subcommands to ns_server man page
          ns_server ?-server /s/? ?-pool /p/? map ?-noinherit? ?/mapspec/?
          ns_server ?-server /s/? mapped ?-exact? ?-noinherit? /mapspec/
          ns_server ?-server /s/? ?-pool /p/? unmap ?-noinherit? /mapspec/

M	doc/src/naviserver/ns_server.man

commit 2e2a40b4ec400f3cae11ff27ee37811654432619
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-29

    - prefer uppercase spelling for HTTP and HTTPS

M	doc/src/manual/admin-install.man
M	doc/src/naviserver/ns_connchan.man
M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_httpopen.man
M	doc/src/naviserver/ns_ictl.man
M	nssock/doc/mann/nssock.man

commit e52b243441342e8a039e27335daf5739b0bbbffd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-29

    - fix typos

M	nssock/doc/mann/nssock.man

commit f9f8811d14bd018f9f4a2be6d9a42fd8edd27466
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-29

    - document parameter "driverthreads"

M	doc/src/manual/admin-maintenance.man
M	nsd-config.tcl
M	nssock/doc/mann/nssock.man
M	nsssl/doc/mann/nsssl.man
M	openacs-config.tcl
M	sample-config.tcl.in

commit 5eddedc7975aa33d5b837db059e4759bb6e7682a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-28

    - bump version number to 4.99.15d2

M	configure.ac

commit 99b0d03bb244213e034f4ce53538daba96a620c7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-28

    - add tests for ns_driver

A	tests/ns_driver.test

commit 7390fce78277d563ac58dae22daafe3c190e6d24
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-28

    - add man page for ns_driver

A	doc/src/naviserver/ns_driver.man

commit 8ee3c641274bc92eb7360dc0bd542c18bc9980fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-28

    - return error messages, when ns_driver subcommand is called with too many arguments

M	nsd/driver.c

commit 99bd29481d3b793d870e3d1e4a9b738cfa377378
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-28

    - remove spurious space when Ns_ParseObjv() is called with opts and args NULL but arguments are provided (unsurfaced old bug).

M	nsd/tclobjv.c

commit c39f423a89ab9c71b8711905e2abb473f2a5e22a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-28

    - prefer spelling "Tcl" over "TCL"

M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/tcl-lib-file.man
M	doc/src/manual/tcl-lib-nstrace.man
M	doc/src/naviserver/ns_filestat.man
M	doc/src/naviserver/ns_sendmail.man
M	doc/src/naviserver/ns_set.man
M	doc/src/naviserver/nsv.man
M	naviserver.rdf.in
M	nsd/adpeval.c
M	nsd/tclcache.c
M	nsd/tclset.c
M	nsd/tclxkeylist.c

commit 23f94e0d1567ca0ecf775a0c98f87d3b9f036072
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-23

    - mark argument as unused

M	nsd/queue.c

commit c78c2a2f10ad7266af33d73dfb1f9400f5804e2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-23

    - Passing 0L after the last typed argument to variadic function

M	nsd/tcljob.c

commit 113b3267fb57006fd6833f1dc4e6818306203fdc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-23

    - replace suffix "l" by "L" to avoid potential confusion with digit "1"

M	nscgi/nscgi.c
M	nsd/tcljob.c

commit 6175473c17e561228a97a5db89db59d2cdc33f79
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-23

    - use default readahad buffer size

M	nsd-config.tcl

commit 3017ce2090e802afeed7ba2e2dade1c109f51a8e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-21

    Continuing driver reform:
    - make distinciton explicit between
        driver type (e.g. "nssock"),
        driver name (e.g. "nssock1"), and
        driver thread name (e.g. "nssock1:1")
    - allow reuseport for Ns_SockListenUdp()
      in the same way as for TCP listen interface
    - new subcommand "ns_driver info" showing config
      info per module

M	include/ns.h
M	nsd/binder.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h

commit c0282eeed7ce7f18e4bb920a3e3c0ffe5d24312a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-14

    - removed unused arguments
    - mark arguments as  unused when needed

M	nsd/driver.c
M	nsd/nswin32.c
M	nsd/queue.c

commit e6d37b8a86be054bbec844a0c5af22950b636af7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-13

    - improving sentinel argument

M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/tcljob.c

commit 0e2c116126b3d529efd5b9470e9fd13d3ccbf576
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-13

    - silence checker

M	nsd/httptime.c

commit 542d9b099662edcccf298f128468819a633000bc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-13

    - adding const declarations

M	nsd/driver.c
M	nsd/queue.c

commit ba7b763d52fbc695f55f368bb9fcb657813168e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-13

    - Prebind structure is not used under windows

M	nsd/binder.c

commit 75b5b98b400c5717843799c8bce420dd9908636a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-13

    - add missing (implied) static declaration

M	nsd/driver.c

commit 9bb558dc0dc1aea4ff7460a284c7b42f125dc644
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-13

    - don't pass function to macro

M	nsd/queue.c

commit 1ebe4e3ec03a1082f512de550ff3ebe73efa4590
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-13

    - add missing argument in windows code

M	nsd/nswin32.c

commit 0519916c0a6da7332fee70c8ef0a5ff0c0ecc0e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-11

    - reduce variable scopes
    - reduce number of return statements inside functions

M	nsproxy/nsproxylib.c

commit 838c0a830f55e469f2a8574928e210fbb2b7b609
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-11

    - don't write "nsproxy ping" like eval cmds

M	nsproxy/nsproxylib.c

commit cfd9430f6eb52509805909ba8d1a37bd7ab42b1c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-11

    nsproxy:
    - don't reset timeout for reaper when slaves already expired
    - improve debug messages

M	nsd/binder.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c

commit 0087456de437b3fb125a1c4451b79a8985f2db6c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-10

    - make startup more robust, when called with invalid arguments

M	nsd/nsmain.c

commit e4f4f6da13e2167d2331322aeaf48fad1dfc6484
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-10

    - document number sign in prebind command

M	doc/src/manual/admin-maintenance.man
M	doc/src/template.man

commit ce57f820c533a06545da87fe7ba213b5bd6f3eeb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-10

    - white space changes

M	nsssl/nsssl.c

commit f16f5065c164c7860e24b110a92470c102f3cc82
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-10

    - added optional #number suffix on prebind argument to allow the usage of SO_REUSEPORT on privileged ports.
     one can use now e.g.
     ....  -b '[2001:628:404:74::31]:80#2' ...
     on the command line to prebind 2 sockets such that the option "driverthreads" can be set to 2

M	nsd/binder.c

commit 4db12efcee4908bbf6f2eaa4d0a8167998001d6b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-10

    - whitespace changes

M	nsssl/nsssl.c

commit a790598bff22cc204708d5c1851814152536daf0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-10

    - fix typo

M	nsd/binder.c

commit 584586aaccc90eb7ae8561fca9dfbd75c62086e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-07

    - silence static checkers

M	nsd/connchan.c
M	nsd/tclcache.c
M	nsd/tcljob.c

commit eb56e1d706548efb55408977c0810a3e60cc28bc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-07

    - don't mess around with FD_SETSIZE

M	include/nsthread.h
M	nsd/nsmain.c

commit f366d1b8126e9cdc33570477660bc173bcd48960
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-07

    - make sure that URLs in result of walk callback are proper list elements

M	nsd/urlspace.c

commit f7fdffa8a643eb6513e621e9270a8ccd9ff2c052
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-06

    - improve naming of output fields

M	nsd/driver.c

commit b0d5d9d2e14354cab9b1c957894ee7286f72f36c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-06

    - silence static checker

M	nsdb/dbtcl.c

commit c85e8e461626327877e78bdc238b63a6df325dbf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-06

    - reduce variable scope

M	nsd/tclxkeylist.c

commit ebae06830bf4c9fc4f3fbce9416d63b4137dcc9a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-02

    new ns_driver subcommands
     -  ns_driver names
     -  ns_driver threads

M	doc/src/naviserver/commandlist.man
M	nsd/driver.c

commit 9d728422bfba77ee669d927755409d9ac6dd5a8e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-02

    - don't advertise deprecated commands

M	doc/src/manual/admin-maintenance.man

commit a4597d6e65268d42ff119a95e9dbff652a6ed9e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-02

    - reduce verbosity

M	nsd/queue.c

commit 49f85a5611746f21f1356543890d1bd9d4970116
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-02

    - provide more details for debugging nsproxy

M	nsproxy/nsproxylib.c

commit be02ca2a9ad0be87e10f2f34b927239b77a537ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-02

    - move definition of type "bool" from ns.h to nsthread.h to make boolean types as well available in nsthread implementation
    - added a new global parameter (defined in "ns/parameters") named "mutexlocktrace"for turning on/off tracing of long mutex calls
      Example:
         ns_section "ns/parameters"
         ns_param   mutexlocktrace  true

M	include/ns.h
M	include/nsthread.h
M	nsd/nsmain.c
M	nsthread/mutex.c

commit d3c6914df0d31eea15e6085ff87ad04c8c8b87e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-02

    - improve comment

M	nsd/config.c

commit 0e8e6a0fc68c9cbc8706d88292fffa0a8f176177
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-12-02

    - add ability to turn on debug messages of nsproxy selectively with
          ns_logctl severity Debug(nsproxy) on
    - provide hints via debug, when reaper becomes active and tries to shut down slaves

M	doc/src/naviserver/ns_register.man
M	nscgi/doc/mann/nscgi.man
M	nsproxy/nsproxylib.c

commit d3d1071c1164e060535cbe58a938967f8af6aefc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-30

    - move mutex unlock before JoinConnThread() to reduce locking duration

M	nsd/queue.c

commit db5e0ba23c788585a222904d900af317f297415a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-29

    - use urlspace.lock instead of pools.lock for urlspace locking

M	nsd/queue.c

commit 1ce3d926788b0b16fe0b8bb3f8836be82f334cf9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-29

    - defined new subcommands for ns_server
    
         ns_server ... map ?-noinherit? ?mapspec?
         ns_server ... mapped ?-exact? ?-noinherit? mapspec
         ns_server ... unmap ?-noinherit? mapspec
    
    - reduce size of huge switch statement by defining the following
      subcommands as sepearate functions
    
         ServerMaxThreadsObjCmd()
         ServerMinThreadsObjCmd()
         ServerMapObjCmd()
         ServerMappedObjCmd()
         ServerUnmapObjCmd()
    
    - provide uniform handling of mapspecs
    - added flags to NsMapPool() to be able to specify inheritance
    - extend regression test

M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c
M	nsd/tclobjv.c
M	tests/ns_server.test

commit 53553fac9dcf5f0b3b7c44a8572cf7ee0a6c9e00
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-28

    - add logging of long lock durations

M	nsthread/mutex.c

commit 8878ca06cd2deaa96c58702e38acb99b6aae7891
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-28

    - add pool name to hint
    - fix typo in message

M	nsd/queue.c

commit 66ecfa34f2bbc34adc77f454014483784fe09772
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-27

    - add tests for mapping and unapping of requests

M	tests/ns_server.test

commit 1b1e42c65ce7f75122dfcdc06c52a21695f474a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-27

    - add "ns_conn partialtimes" returning the partial times for a request (similar to the per-pool timing statistics in "ns_server stats")

M	nsd/conn.c
M	tests/ns_conn.test

commit 89817d58bca75aee10746c1464a715270eb7406a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-27

    - improve the documentation of ns_parseargs

M	doc/src/naviserver/ns_parseargs.man

commit 0b66140b900003a4e4d34d2f8ac3761e60c34a1c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-27

    - added "ns_server ... unmap ..." in symmetry to "ns_server ... map ..."

M	nsd/nsd.h
M	nsd/queue.c
M	tests/ns_server.test

commit 542b2c6e3dfa577e846788553240cac9d729db09
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-27

    - improve sample config file

M	openacs-config.tcl

commit f3a017c6a6c717d312b1731d4d2e22eb700f198d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-19

    - don't tell the user we are accepting connections, when this is not true

M	nsd/driver.c

commit d2c4646eb99320f0474b2a2539287740bb688a4e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-19

    - return Ns_ReturnCode from NsPrebind to terminate, when prebind fails

M	nsd/binder.c
M	nsd/nsd.h
M	nsd/nsmain.c

commit e6c38051825e08c06302e19bf4a367681a3c6781
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-19

    - remove debug message

M	nsd/driver.c

commit b17fa16ecd441f533f3ddc4036eea3e1f0d92309
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-19

    - add support for driverthreads and global servers

M	nsd/driver.c

commit d2ef4f62b874e4cfe5a0761601a7982f34fbd7b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-19

    TODO: check, if someone is already listening on port, doc (driver
          config and nsd_driver), sample configs
    
    - Implemented driver option "driverthreads" in analogy to
      "writerthreads" or "spoolerthreads". This option can only be used
      when "SO_REUSEPORT" is supported by the operating system
    - New command "ns_driver stats": return statistics about driver usage

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/tclcmds.c
M	nssock/nssock.c

commit 0de9ff66e2bbd3da9e34480118ab8b48433b775a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-18

    Support for option reuseport (https://lwn.net/Articles/542629/):
    - This option allows multiple drivers threads listening on the same
      port (potentially improved throughput)
    - Configuration: new boolean parameter "reuseport" for driver section
      (default: false)
    - Changes:
       additional argument for Ns_DriverListenProc(), Ns_SockListenEx(), Ns_SockBindUdp(), Ns_SockBind()
    - TODO:
      prebind handling, doc, handling of ns_socket reuseoption, other
      cases of Ns_SockBind(*,NS_FALSE), other drivers

M	include/ns.h
M	nsd/binder.c
M	nsd/driver.c
M	nsd/listen.c
M	nsd/nsd.h
M	nsd/sock.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit 13cf76d9f5b9ca8433a3e7221cba32f316c62f8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-18

    - document parameter listenbacklog via config files

M	nsd-config.tcl

commit 9884366ad60a490d3e008ace98fad4c5648b79c6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-18

    - changing version number towards 4.99.15

M	configure.ac

commit 65d7936ca2184f5355063a7c489dbcc1e8bd9b91
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-18

    Added tag naviserver-4.99.14 for changeset b905737d2876

M	.hgtags

commit 1abe578258bb62edc34a45298df589a76262b113
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-18

    - removed empty sections

M	NEWS

commit 408fff1439e0da389fcdd0993232f0d615c9d1f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-18

    - updated NEWS file

M	NEWS

commit 17af1b20031cd1e17b7662b2083878402bc160f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-18

    - bump version number to 4.99.13

M	configure.ac

commit 93d03171e062e77792fa2c7333b6e0e44538e30b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-18

    - update README file

M	README

commit 1849e37e51db8b4a38e9d97c91cb97eb096bdb16
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-18

    - silence compiler about potentially uninitialized variable (gcc7)

M	nsproxy/nsproxylib.c

commit 2e9d5be35d635bfbc635c7efa78ec95176d254a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-17

    - Return the current mappings just in the case, when "ns_server ... map" was called without the optional argument.
    - return just the elements from the queried  pool.

M	nsd/queue.c

commit 3d7259adbf03d003bbee2a0569abb7222b4b0884
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-17

    - include pool name in result of meap subcommand

M	nsd/queue.c

commit 3f7417df1f1e33cca5ab29c3a558860082eb98ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-15

    - fix typo in documentation

M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_register.man

commit 9f1aa6c50ba2b23f1006798e445d3c2745db62bc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-15

    - added experimental subcommand "map" to "ns_server" to list and
      extend mapping to connection pools

M	nsd/queue.c
M	tests/ns_server.test

commit 51c4e999823489a6acb5c0adb16b653474e9db41
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-15

    - improve comments

M	nsd/urlspace.c

commit 33f51f552d3790d07e533d3a9b2ead70a7003a13
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-15

    - use function type for walk callback

M	nsd/url2file.c

commit a735c3115741bbb89ac8b58e689eaa9514f4bb42
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-15

    - add common usage of ns_register_proc to the example section

M	doc/src/naviserver/ns_register.man

commit 08590325550ea3af0dc646d297985d2a833d2bd7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-13

    - updated NEWS file

M	NEWS

commit 3eb77f665405a18040a48bbcd9ba43fa41b87652
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-13

    - bump version number to 4.99.14b2

M	configure.ac

commit 597d80085b755f18b35161ee4c2178cc0a32fb2e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-13

    - don't use implementation defined NULL as last argument of variadic function Ns_HomePath(()

M	nsd/fastpath.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/pidfile.c
M	nsd/tclinit.c
M	nslog/nslog.c

commit 8c3a2a555dbca77aa64b692a53649f837bfc8b47
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-13

    - don't use implementation defined NULL as last argument of variadic function Ns_MakePath(()

M	nsd/adpeval.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/info.c
M	nsd/pathname.c
M	nsd/url2file.c

commit 7fba5b212727294d8b2366aaa35297aa33ed5293
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-13

    - don't use implementation defined NULL as last argument of variadic function Ns_DStringVarAppend(()

M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/config.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/log.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/request.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/rollfile.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/url.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsdb/dbdrv.c
M	nslog/nslog.c
M	nsperm/nsperm.c

commit 9ee00666cd3f8c09de9dda53ce6daaf30169c214
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-13

    - don't use implementation defined NULL as last argument of variadic function Ns_TclEvalCallback()

M	nsd/url2file.c

commit 364069dd7039d7df1a207b2a6e8d3bd5ba37c79f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-13

    - avoid consistently implementation defined NULL as last function of Ns_ConfigGetPath()

M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/pathname.c
M	nsd/returnresp.c
M	nsd/server.c
M	nsd/tclinit.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c

commit ec2f253344d37fcd9e04c2a2f4f26a0fd07eaa2b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-13

    - update beta version

M	configure.ac

commit baa9c91ea3e33e01835fab827d0f7d64588733a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-13

    - reduce variable scope

M	nsdb/dbutil.c

commit f868074d83f733cb9017de0bf51eef565f48ffef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-13

    - remove commented out code

M	nsperm/nsperm.c

commit 81eca2f81f9e203819ab1e4d771e19e3cbc5fb29
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-11

    - remove debug message

M	tests/ns_urlspace.test

commit d6874e1d0ddf235d5305d9a74091324719ffb609
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-11

    - update NEWS

M	NEWS

commit 0ebad3899ed7f28cd5ffd9dfb388b9049fa900ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-11

    - don't throw error message, when doing an install from a Bitbucket checkout and no documentation was generated locally

M	Makefile

commit e9eb6ae79c3f0e2b5ad7fe0a9eb064bb98f21399
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-10

    - ensure NULL result in case auf failure

M	nsdb/dbutil.c

commit fdebc4c418580123a4038f61d11e6c89d14b048e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-09

    - improve output of "make help"

M	Makefile

commit 56f83c1355794bb42fdba75253c0512cab4dd32c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-09

    - bump version number to 4.99.14b1

M	configure.ac

commit a05a5105a01d625ce8a7c93a65e4b493a3f407b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-09

    - Solaris does not define s6_addr16, so we have to help outself with a brutal  macro

M	include/nsthread.h
M	nsthread/reentrant.c

commit 44f7b907e3f75d33b5a07fc22598a7240fa3bb83
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-08

    - align prototypes and function definitions

M	include/nsthread.h
M	nsthread/thread.c

commit bdb2f93a58e658a94c02cc3c5e4d766c32b2a14b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-05

    - reduce number of return statements before end of function

M	nsd/tclxkeylist.c
M	nsdb/dbinit.c
M	nsdb/dbutil.c

commit 4319f851d2634494d675cbc37e27f1c807f731d2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-05

    - use parens around boolean expression

M	nsd/sched.c

commit 54c82e19bbd53a8b811b07e1adb57319e5623fdc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-05

    - add const declaration

M	nsd/connchan.c

commit dfc853a72289f21fa870abcb0365c42de7a8386c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-05

    - Ns_DbInterpretSqlFile() align function prototype with definition

M	nsdb/nsdb.h

commit 3a61db6c8ad988db7a90f267cad0a2088f0bef91
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-05

    - improve documentation

M	nsd/tclfile.c

commit ade81ae57bd0fe723507226f82403e362c17374c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-04

    - improve cleanness of compilation with type warnings under gcc7

M	nsd/crypt.c

commit 8774ee82a4f95b78ae70bd3697e84a655b40727a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-04

    - make run time statistics more complete by including trace times,
      which includes the time after running the main task of a connection
      and freeing the connection thread. This time includes the trace
      filters and the server traces (e.g. producing access.log entry) as
      well as the time deallocating per connection resources.
    - include value "tracetime" in [ns_server stats]
    - split Ns_ConnTimeStats into two separate functions
      NsConnTimeStatsUpdate() and NsConnTimeStatsFinalize(); no need for a
      "Ns_" prefix.

M	include/ns.h
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/queue.c
M	tests/ns_server.test

commit 8ec458d3b798af0e4cb6e12653a7db35213e74df
Merge: b78ca6f2 00c97acc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-03

    Merged in hanzer/nsfork (pull request #11)
    
    Spelling correction.

commit b78ca6f257c541eef085a4aede609fa88c499121
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-03

    - collect statistics before traces are run (e.g. access.log writing); fixes bug reported by David Osborne about incorrect partial times
    - add more sample entries to nsd-config.tcl

M	doc/src/naviserver/ns_ictl.man
M	nsd-config.tcl
M	nsd/queue.c

commit 0dd6b31c0674f9e3dfae3212fcb79d64f4f69836
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-03

    - remove extra space

M	nsd/dstring.c

commit 00c97acca943d9a18db57a4592ad4e3ccdb8490b
Author: Adam Jensen <hanzer@riseup.net>
Date:   2016-11-02

    Spelling correction.

M	contrib/examples/writer.tcl

commit 85b3a89ab762ac1e2457aac271670b156b2ab0bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-01

    - make code more rubust against canceled requests
    - improve source code comments

M	nsd/connchan.c

commit 4943854fe8619aeee97b04cda86864b37445d604
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-01

    - improve source code comments

M	nsd/sockcallback.c

commit b850317eabef7f6296b85836db785d54184b5f8d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-01

    - bump version number to 4.99.14d2

M	configure.ac

commit fe4ac795e37c4b491c671bcfa6d7bf5073b14e25
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-11-01

    - prefer Tcl_Obj interface over string based interface
    - reduce the number of returns before function end

M	nsd/tclxkeylist.c

commit 8f6c880bac8126565ce7aa167f7396a5b98fbbe1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - modernize txlxkeylist
    - use naviserver memory management routines
    - fix several bugs (returning break)
    - add regression test

M	nsd/tclxkeylist.c
A	tests/keylist.test

commit bbfa8da6e25d7bfb42c8effd013e4f99c973f7f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    connchan.c:
    - make freeing of connection channel more robust
    - simplify and fix logic for partial write operations

M	nsd/connchan.c

commit 0d39d19a0486646fbec93b9162bcb60fda72a0ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - use datatype "int" for parameters passed with Ns_ObjvBool (rather than bool, which causes invalid values on gcc 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3))

M	nsd/urlspace.c

commit ee4a0544f50b3fa6c24d5a7ef5c3ac507b336de1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - improve type cleanness on gcc 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3)

M	nsd/tclmisc.c
M	nsd/tclobj.c

commit 597e0db7dc3a138e63437b25bb8593129c551db3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - make test more robust: don't raise exception in case of failure

M	tests/ns_urlspace.test

commit 3378fcedac6dea259ad05d3109973aff1b1a4338
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - improve usefulness of "nsd -c":
      in case the environment variable NAVISERVER is not set,
      and bin/init.tcl is not found under the running binary,
      fall-back to the configured install directory as "home"
    - add preprocessor variable NS_NAVISERVER to point to the configured
      install directory (can be used as last resort to find configuration data)

M	include/nsversion.h.in
M	nsd/nsmain.c

commit 130419e5ec064cd0057e456d5975be30ca92d289
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - turn ns_tmpnam into a proc
    - get rid of call to deprecated C library function tmpnam()

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclfile.c
M	tcl/compat.tcl

commit fce91d8f26ba63026c9fdeab66fe33482e569cce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - add test cases for ns_mktemp

A	tests/ns_file.test

commit 74ae6948a01e65f4d5525d793a8acccf014fd531
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - improve man page

M	doc/src/naviserver/ns_mktemp.man

commit 875c05c8eaf3debe542aa29d440e1ec14d3d6190
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - make windows variant of ns_mkstemp() more compatible with unix/mac (remove  _O_TEMPORARY flag)

M	nsd/nswin32.c

commit c8b28d503250d7b0e22b1586939a72ac26fdaf05
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - improve wording in README file

M	README

commit 994ac11494be40e13f2e6b66d35c864927453a7e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - adjust sample file parameters

M	nsd-config.tcl

commit ff85e2b732ef5f049aff0152aa4bdc0c38543e11
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - general overhaul of the contrib/example scripts

M	contrib/examples/index.adp
M	contrib/examples/upload.tcl
M	contrib/examples/writer.tcl

commit 8b83bd5c37900e96bbf4517344cc298e4a60faf1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - added const declaration
    - removed printf debug statement

M	nsd/connchan.c

commit c57cb8300ccd7c3054541c4fdba0c70834d9a022
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - remove unneeded cast

M	nsd/tclfile.c

commit 0e9192bfa94a59259b8e8ce9cd23c8086a978399
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-31

    - fix indentation

M	nsd/tclhttp.c

commit 01ca67de80254320c7a520e6cd392afc5d2461c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-30

    - comment current behavior

M	nsssl/nsssl.c

commit 16b037273d526ceef213fb61ce5ee4d0fb776e0b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-30

    - fix bug #77 (introduced in 4.99.13)

M	nsd/tclfile.c

commit 2ab754f9112f509bc07fe26262c85afe7ccebd82
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-28

    - make sure, the tests are running with expected locale and encoding

M	tests/all.tcl
M	tests/test.nscfg

commit 144d0cf73a6566e0eea8b4503632fbc6aa2bac07
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-28

    - fix potential race condition in test

M	tests/ns_conn.test

commit c771ce7c74d41fd677e4eeaf9668c2c36d10afe7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-28

    - ns_connchan: allow callback changes without invoking socket-shutdown machinery

M	nsd/connchan.c

commit 4279bc530886d720790c5b2cdba1e4b92886f004
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-27

    - add support for partial write operations to "ns_connchan write" and "ns_connchan open"

M	nsd/connchan.c

commit 0b41eabdfa38b19aead2b4126350830d51e92d92
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-26

    ns_connchan:
    - add flag "-version" to "ns_connchan open" to specify HTTP version
      (default 1.0)
    - make sure, channel is writable before we are writing to it
    - generate error messages in case of failure directly from
      DriverSend(), since callers can't distinguish error cases
    - update documentation

M	doc/src/naviserver/ns_connchan.man
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h

commit 5efa6ec5f3b12e690fbfff569348a8d6fafe8fbe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-26

    - improve comments

M	tests/ns_conn.test

commit 56ba49f408323a5079bd92ee994359d4e37b4012
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-26

    - white space changes

M	nssock/nssock.c

commit c6a5fe08864029d6f75051f6f6aa57ed43793ef9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-26

    - add likely() and rearrange variable initialization

M	nsd/sock.c

commit 9569331fde0d364dd430dc47a08a2fa065e20d98
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-25

    - don't complain about uncorking, when user has already closed the connection

M	nsd/sockfile.c

commit 17886885681d5b42ad532cc573114e8d524f7438
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-25

    - unify conventions

M	openacs-config.tcl

commit 47945f3af415b0cfcfd53a22b1cc0843a8f94b11
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-25

    - reduce number of return statements before end of function

M	nsd/log.c
M	nsd/modload.c
M	nsd/nswin32.c
M	nsd/op.c

commit ee4148604b168b80641fdffb9ab7f8b3892a0662
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-24

    - mark argument as unused

M	nsd/connchan.c

commit b5aa1fb1f38097c518e88518ac56c650b44b9822
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-24

    - make static checker happy

M	nsd/driver.c

commit fa7370ceea74bee77fa1695ada4eba0bb99a234f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-24

    - simplify logic

M	nsd/rollfile.c

commit 44391ed6077a707c780176649689c4a9d19868ae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-24

    - add config parameter "concurrentinterpcreate" to sample config files

M	nsd-config.tcl
M	openacs-config.tcl

commit fbbe33be3b59e80af74f4e22c8cf5de1df02bf49
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-24

    - add section with sample configuration for systemd
    - improve typesetting

M	doc/src/manual/admin-maintenance.man

commit 70daf30956b1c38cb4766797cbbe931d4e304801
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-24

    - add documentation of "ns/parameter" option "concurrentinterpcreate"
    - minor cleanup

M	doc/src/manual/admin-tuning.man

commit 401d5fb88524c75def924e3f6c349451282b2278
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-24

    - fix white-space problem

M	doc/src/naviserver/ns_connchan.man

commit a18c98413d51ba006a38fc1b36a7511d5ec437cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-24

    - Add new config flag "concurrentinterpcreate" to "ns/parameters" to allow optionally concurrent creations of Tcl interpreters.
      Concurrent creations of tcl interpreters was a problem with Tcl 8.5, but seems to work with Tcl 8.6. Per default, this flag is deactivated.

M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/tclinit.c
M	tests/test.nscfg

commit 3b74c17650c02b3bcb8be9a68512bb4be313bcf9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-24

    - when NaviServer is started with -c or -f (i.e. logging to stderr), don't "roll away" the log file on Ns_LogRoll.

M	nsd/log.c

commit c9f2edfe0a6ddecd1e4287938376813bd6853a63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-23

    ns_connchan:
    - freeChannel: change direct free operation into a callback to avoid race conditions
    - reduce goto statements

M	nsd/connchan.c

commit 3483ea40f2f62bb1016c6e04a0160a6b79d0ecc6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-23

    NSDriverClientOpen
    - remove goto statements
    - reduce variable scopes

M	nsd/driver.c

commit fd958eee38e3cdb28e24c1546f64506139e002a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-23

    - remove debug statements

M	nscp/nscp.c

commit 5c4a4c202cdf312b5adfed2c7cfe43383029e91a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-23

    - make sure, status is always initialized
    - removed goto statement

M	nsd/rollfile.c

commit 3c0deb220e62b4423f4a5f846e1f866daa173ba1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-22

    NSDriverClientOpen:
    - don't start url with // when path starts already with a /
    - keep request lines uniform (no crlf)

M	nsd/driver.c

commit 21af686697bf4510562bae414978fbb0fe2a33ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-22

    - provide a better explaining variable for hashtable

M	nsd/sockcallback.c

commit b8f592bdf1f2da73e9b90be0a4bbb67ac25a83bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-22

    - add documentation for "ns_connchan open"
    - clarify format in which timeouts can be specified

M	doc/src/naviserver/ns_connchan.man

commit 0b8e447d36ba90ef150a94468a331544c1e0b442
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-21

    - don't update interp in "ns_ictl cleanup", when no defer callbacks were executed

M	nsd/tclinit.c

commit 1a878f0550e370859038430b36f764b55942af13
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-18

    - reduce number of return statements before end of function

M	nscp/nscp.c
M	nsd/op.c
M	nsd/request.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/set.c
M	nsd/sock.c
M	nsd/sockaddr.c
M	nsd/str.c
M	nsd/tclmisc.c
M	nsd/tclxkeylist.c
M	nsd/url2file.c
M	nsd/urlopen.c
M	nsdb/dbdrv.c

commit 5e42b70a72914d72c2c123230aece62ee5af7240
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-18

    - make version number as development version (4.99.14d1)

M	configure.ac

commit a510ef55513330ce9bfe3324c6ec043ebc4df3d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-15

    - minimal cleanup in NEWS

M	NEWS

commit 6f931b4e4d6ebb57ec685a9f8bad31d2847d129b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-15

    Added tag naviserver-4.99.13 for changeset c749993e27e1

M	.hgtags

commit b5678a5ff3ee2f2cfae2463e36ce97f798984212
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-15

    - updated news file

M	NEWS

commit d371d77b187f85e1d7eb6126a730ae3a1ecd3438
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-15

    - bumped version number to 4.99.13

M	README
M	configure.ac

commit 7f39f36734df7c7faccef7109b80fc0af24e9b35
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-15

    - make result of test independent from length of version number

M	tests/http_persistent.test

commit dbf3651bc587d63bb7a6de5ccc137389326ec368
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-15

    - reduce variable scope

M	nsd/limits.c

commit 4825f6dde1710ce25ddc3e4b4dc1331bd7416860
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-14

    - reduce variable scopes

M	nsd/binder.c
M	nsd/limits.c

commit 115c28766c9960378e46ae58838cfa66047dbcbb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-14

    - add thread id to warning message

M	nsthread/mutex.c

commit 451c527fa15536c66a0244a1447f6cc0b2c97c63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-14

    - use ad_log instead of ns_log to warn about long cache locking operations

M	tcl/aolserver-openacs.tcl

commit 134e0d72bb95be43f627535e3d96db8c16917670
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-11

    - Reduced number of return statement before end of function
    - improved comments
    - bumped version number to 13b2

M	configure.ac
M	include/ns.h
M	nsd/limits.c
M	nsd/log.c
M	nsd/request.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/sockaddr.c
M	nsd/tclmisc.c
M	nsd/urlopen.c
M	nsdb/dbinit.c

commit 87fd9630f8d3eba5ca68f81178810f5f54f45b83
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-11

    - reduce variable scope
    - improving comments

M	nsd/binder.c

commit 0a80c42b65191a80e7a574d882d30c4edf881fec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-10

    - cosmetical change

M	NEWS
M	NEWS.template

commit 0c2b6bd7a0566cef2e486e207c0602c62e7b37fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-10

    - update NEWS and README
    - bump version number to 4.99.13b1

M	NEWS
M	README
M	configure.ac

commit 6b6671df859ba8b2f105ce34331a5d896d3f7b68
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-09

    - prepare NEWS file for next release

M	NEWS

commit cc7453244f80927e7315a86f95922a526c2d7ea3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-09

    - add man pages for ns_absoluteurl and ns_parseurl

M	doc/src/naviserver/commandlist.man
A	doc/src/naviserver/ns_absoluteurl.man
A	doc/src/naviserver/ns_parseurl.man
M	doc/src/naviserver/ns_url2file.man
M	doc/src/naviserver/ns_urldecode.man

commit f1ba68ea7bb145f3111ab2afb58630d44cd48161
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-09

    - use simply "port" instead of "portstring" in resulting dict of ns_parseurl

M	nsd/url.c
M	tests/ns_parseurl.test

commit e5d78de15e6193695f053040be7bdc205da820eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-09

    - ignore return value of RollFileFmt(), Ns_LogRoll() succeeds, when LogOpen() succeeds

M	nsd/log.c

commit 80a8497f44c53ea74e58a49a2e423be5c49c397c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-09

    - change "recommended" logrollfmt

M	doc/src/naviserver/ns_log.man
M	nsd-config.tcl
M	openacs-config.tcl

commit aa2a5cd0edfaef7ac54070202c940820f4f78c13
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-08

    - bump version number to 4.99.13d5

M	configure.ac

commit 7712ba22d05e4f8fd23c646d496137de7e6ec337
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-08

    new option for error.log: logrollfmt (section ns/parameters)
    - This option has the same interpretation as for access log (and
      shares the implementation) and provides timestamp based log file
      naming. This option can reduce back-up demands for large error.logs
      significantly (since the names are stable) and increases the
      orthogonality of options (in respect to access.logs).
    - added option to sample config files
    - added description to man page

M	doc/src/naviserver/ns_log.man
M	include/ns.h
M	nsd-config.tcl
M	nsd/adpcmds.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/rollfile.c
M	nsd/unix.c
M	nslog/nslog.c
M	openacs-config.tcl

commit a15bfc3cf785d4dc7138d82760c835a1fed97a36
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-08

    - add picky compile flags as sample to the Makefile

M	include/Makefile.global.in

commit 292ed6a96b8f61ef47152cd5029c90f6332891d4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-08

    - limit interpretation of numeric entities to printable characters

M	nsd/tclmisc.c

commit 02b46021ef8f661f3c1849f5d3ce2f32e773c7fd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-08

    - ns_striphtml: honor numeric entities between 1 and 255 instead of ignoring it

M	nsd/tclmisc.c

commit c5586cef80ee48d0a261aa01755919c784e142b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-07

    - fix typo in last commit

M	include/nsthread.h

commit b443bb20dad3f06a639bdbc5d97a1007c76248ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-07

    - remove implicit conversions and comparisons between different types also for Linux

M	include/nsthread.h
M	nsd/adpparse.c
M	nsd/sock.c
M	nsd/sockaddr.c
M	nsd/sockfile.c
M	nsd/tclmisc.c
M	nsd/unix.c
M	nsproxy/nsproxylib.c
M	nssock/nssock.c
M	nsthread/nsthreadtest.c
M	nsthread/thread.c

commit 5671aad704a8db0873fa55da03cd1575c5a22b49
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-07

    - remove implicit conversions and comparisons between different types
    - compiles now clean with  -Wconversion -Wsign-conversion -Wfloat-conversion -Wsign-compare

M	include/Makefile.global.in
M	include/ns.h
M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/binder.c
M	nsd/compress.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/event.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/index.c
M	nsd/log.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/returnresp.c
M	nsd/sock.c
M	nsd/sockaddr.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsd/tls.c
M	nsd/unix.c
M	nsd/watchdog.c
M	nsdb/dbinit.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nssock/nssock.c
M	nsssl/nsssl.c
M	nsthread/memory.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	nsthread/thread.c
M	nsthread/thread.h
M	nsthread/time.c
M	nsthread/winthread.c

commit eff73cf4d342ed03ce2f8df83e9b29ecfe54da6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-02

    Make NaviServer compileable with -DTCL_NO_DEPRECATED
    - remove usages if ANSI_ARGS macro
    - get rid of TCL_PARSE_PART1: flag is deprecated at least since tcl 8.4 and has no effect. The part1 is always parsed whenever the part2 is NULL

M	nsd/tclmisc.c
M	nsd/tclxkeylist.c

commit 2b39037bfa0fecef1bb65bdae1b5a082fda33576
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-02

    - fix variable name in NONNULL assert

M	nsd/tclcallbacks.c

commit 2007623b9be3ca4bec62672d4f80fc897eaa7d64
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-02

    - remove a few gotos and a premature return

M	nsd/config.c

commit 1bed1d29772b9762c1e15e49d1a00032caacac72
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-02

    - fix in url-parser test case with port and ip literal notation
    - extend regression test
    - remove one more premature return

M	nsd/url.c
M	tests/ns_parseurl.test

commit 433cf93a92be6f87fe760cc829d62c22f6994fbf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-02

    - bump version number to 4.99.13d4

M	configure.ac

commit e3314ef663b5b2156e1322f351af6a2b657fd20c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-02

    Improve url generation:
    - new command ns_absoluteurl make Ns_AbsoluteUrl() functionality available
      on the Tcl layer (compose an absolute url based on a relative url
      which is completed with parts from an base url)
    - fix bug in Ns_AbsoluteUrl() in connection with IP literal notation
    - added regression test cases for ns_absoluteurl

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/url.c
M	tests/ns_parseurl.test

commit d97665b7694427060ad564d90853b3478a77544c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-01

    - reduce number of premature returns
    - reduce variable scopes

M	nscgi/nscgi.c
M	nsd/nswin32.c
M	nsd/range.c
M	nsd/request.c
M	nsd/server.c
M	nsd/set.c
M	nsd/sock.c
M	nsd/str.c
M	nsd/tclconf.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclthread.c
M	nsd/tclxkeylist.c
M	nsd/url.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/nsdb.c
M	nsdbtest/nsdbtest.c

commit 053c69ac036605fea2153d30a097f0803649a25e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-01

    - replace tcl "eval" by expand operator

M	tests/compat.test
M	tests/encoding.test
M	tests/errordoc.test
M	tests/http_byteranges.test
M	tests/http_keep.test
M	tests/init.test
M	tests/ns_accesslog.test
M	tests/ns_adp_compress.test
M	tests/ns_cond.test
M	tests/ns_config.test
M	tests/ns_conn.test
M	tests/ns_conn_host.test
M	tests/ns_crypt.test
M	tests/ns_env.test
M	tests/ns_hashpath.test
M	tests/ns_httptime.test
M	tests/ns_limits.test
M	tests/ns_log.test
M	tests/ns_mime.test
M	tests/ns_pagepath.test
M	tests/ns_parseargs.test
M	tests/ns_proxy.test
M	tests/ns_register_filter.test
M	tests/ns_register_proc.test
M	tests/ns_schedule.test
M	tests/ns_server.test
M	tests/ns_serverpath.test
M	tests/ns_sls.test
M	tests/ns_thread.test
M	tests/ns_urlencode.test
M	tests/ns_writer.test
M	tests/nsdb.test
M	tests/progress.test
M	tests/tclconnio.test
M	tests/tclresp.test
M	tests/timeout.test
M	tests/url2file.test

commit dd7eb2657a37e8cf7bca4d02eac9f300be766342
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-01

    - reduce number of return statements per function

M	nsd/progress.c

commit 89531e89994df33feee33f2fb57d0e79d87cd86e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-01

    - adhere to usual comment formatting rules
    - improve variable name
    - reduce number of return statements per function

M	nsd/request.c

commit 4f15094aa98198e556e0f4e0c186b4e043f3316b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-01

    - silence checker about potential uninitialized variables

M	nsd/log.c
M	nsd/tclset.c

commit 1bfbe26a918edc3eb88a28e1cd6faf76f9b1e213
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-01

    - reduce number of return statements per function
    - reduce variable scopes

M	nsd/sockfile.c
M	nsd/task.c
M	nsd/tclcallbacks.c
M	nsd/tclobj.c
M	nsd/tclsched.c

commit d3917c66fca2cb48cd3db82645fd023d6e8def65
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-01

    - follow usual comment formatting rules
    - reduce number of return statements per function

M	nsd/tclmisc.c

commit 8704179bffc6eebf8b9ae5efe1a2e063e0348e9e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-10-01

    - reduce the number of return statements per function

M	nsd/returnresp.c

commit 18fcbf6788ae3713b9fcc701d57a2900fb8e2e36
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-30

    - reduce the number of returns per function

M	nsd/random.c
M	nsd/returnresp.c

commit 9fb3aaa133b7800cbb75ddbb5f1de0e2c94775ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-30

    Use for all Tcl cmds Tcl_Obj interface:
    - converted all remaining Tcl_CmdProc to Tcl_ObjCmdProc
       NsTclAdpStatsCmd -> NsTclAdpStatsObjCmd
       NsTclCrashCmd -> NsTclCrashObjCmd
       NsTclHrefsCmd -> NsTclHrefsObjCmd
       NsTclLibraryCmd -> NsTclLibraryObjCmd
       NsTclMkTempCmd -> NsTclMkTempObjCmd
       NsTclParseHeaderCmd -> NsTclParseHeaderObjCmd
       NsTclQuoteHtmlCmd -> NsTclQuoteHtmlObjCmd
       NsTclStripHtmlCmd -> NsTclStripHtmlObjCmd

M	nsd/adpeval.c
M	nsd/info.c
M	nsd/nsd.h
M	nsd/quotehtml.c
M	nsd/tclcmds.c
M	nsd/tclfile.c
M	nsd/tclmisc.c
M	nsd/tclset.c

commit 0a080ce4480d1c5c3aa1d0b58621e7d61d702e8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-30

    - reduce the number of return statements per function

M	nsd/connio.c
M	nsd/log.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/pathname.c

commit 273a967be77f4c08a641e3bd2b786374ddd34917
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-30

    - pollfd members events (and revents) are defined by posix as short. make typeconversion explicit.

M	nsd/event.c
M	nsd/nswin32.c
M	nsd/sock.c
M	nsd/sockcallback.c

commit 198909cb83cc7715996578bb71a644030cacf99d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-30

    - adjust type of argument to current practice to reduce code smells (when a char is passed, use char as argument type)

M	include/ns.h
M	nsd/binder.c

commit c17d52fc75927f6f9c459e5e8b5db48716664fd9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-30

    - adjust tests of regression test to http-only flag when deleting cookies (to improve result from security scanners)

M	tests/cookies.test

commit 692ab1115092e5b29b9cbecf8a42110ca4e85e3f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-30

    - white space changes (remove tabs)

M	nsd/fastpath.c

commit 1ca0c380e6edc9b4acdd6330b88d07d68e4a7fee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-30

    - add test cases for static gzipped files

M	tests/http.test
M	tests/test.nscfg
A	tests/testserver/pages/test.html
A	tests/testserver/pages/test.html.gz

commit 491574f1e1c1a71d8376dec27df23c45ae99fa69
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-30

    - bump version number to 4.99.13d3

M	configure.ac

commit f127c72ae808ca9c15439fa2ed12862bc17c009f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-30

    - bug fix for mime-type in fastpath, when gzip is activated (mime type was incorrectly set to application/gzip, when the static gzipped file was returned). many thanks to David Osborne for reporting.

M	nsd/fastpath.c

commit a0cb1985bd7c589b549762e9302825d1ec45fc9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-29

    - don't use boolean arguments to comparison operator

M	nsd/driver.c

commit e4c9d20d14aa595428f1dee6408d6835d8b6734e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-29

    - use consistently NS_POLL_NFDS_TYPE for pidx

M	nsd/nsd.h

commit b3f32614f0b1a235c56f60ad5c85604b74746377
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-29

    - pollfd members events (and revents) are defined by posix as short. make typeconversion explicit.

M	nsd/driver.c

commit 0c9df640b3ce01366ce5c0916e35f957765ee588
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-26

    - if Tcl is fixed (duplicate call of TclpFreeAllocCache(), the shudown-bypass is not needed anymore (will be updated, when it is clear, when this is the case and how it can be detected)

M	nsthread/tls.c

commit 12c0b054fb28b46901c64c42357b5f1810bd71f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-22

    - moke callback more robust, in case, some ther proc has already performed a nsf::finalize operation

M	tcl/aolserver-openacs.tcl

commit d3ecd6454c0b3f3d4419d87fa7f4a90764652832
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-22

    - bump version number to 4.99.13d2

M	configure.ac

commit e9efd0af56c363835cb2b8e65366df5ed5d2484b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-22

    - get rid of Tcl_EvalFile() which is going to be deprecated by Tcl

M	nsd/nsd.h
M	nsd/tclinit.c

commit 5f105f9adfabc9c4c3a68ef7e8f89e2a8f9ddd0f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-22

    - remove automatic run in "lldbtest" target (to be able to configure lldb)

M	Makefile

commit 4c65f09d823fb4c12e23b4b19235aae9760b6a9e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-22

    - register delete trace to run nsf::finalize in a safe state (before any other c-based finalize handler are fired)

M	tcl/aolserver-openacs.tcl

commit b0d818335008fd8206cb5f855f0f4479a3c53758
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-22

    - avoid regular expression (to avoid as well the registration of the regexp-thread-local storage initialization)

M	nsd/init.tcl

commit fbae5010b7332eb132a34a2a7f59576c3ac17c4e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-14

    - fix chartype comparison for Linux

M	nsd/url.c

commit 49950e217d136141a2373fb28849a7163e0600a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-10

    - remove return from middle of function

M	nsd/tclfile.c
M	nsd/tclinit.c

commit c4220dd1cff60f45cf313ba7d3eef217d2e3b876
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-10

    - improve source documentation

M	nsd/tclfile.c

commit 25b580cfd847d93e52a8d9e1d4edceff865104bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-10

    - add "UNUSED" declaration

M	nsd/url.c

commit 5ba8b9930102fdbf92a1f0342011dad43d606883
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-09

    Improve url parser:
    - new command ns_parseurl make Ns_ParseUrl() functionality available
      on the Tcl layer
    - make URL parser more restrictive: distinguish between colon for protocol and other colons
    - add support for protocol relative (protocol agnostic) URLs (as
      contained in RFC 3986)
    - added regression test cases

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/url.c
A	tests/ns_parseurl.test

commit bfb18b059a62389e95510e5d88cf058e9d980551
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-09

    - ns_deletecookie: make delted cookie non-scriptable to improve ratings on security scanners

M	nsd/cookies.c

commit 0f75041a31548c590479ab7f3e0a4c8654678d85
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-09-02

    - fix for [naviserver:bugs] #76: ns_configsections returns incomplete results

M	nsd/tclconf.c

commit d62b4239decc0c94356e635515b695bc88813bcb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-30

    - bump version number to 4.99.13d1

M	configure.ac

commit 8c426f04ddea0aa6ec1714d2c2b4212133fd969e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-21

    Added tag naviserver-4.99.12 for changeset 74ebbd617f03

M	.hgtags

commit ff461252c6820b31b932d7b334698b0d179ae4dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-21

    - bump version number, update NEWS

M	NEWS
M	README
M	configure.ac

commit 87cb376b6e453d25cdc2da034614aed669749e3e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-21

    - remove conditions which are always true

M	nsd/httptime.c
M	nsd/tclmisc.c

commit e016b62891dcf695bac70443fa363f069a2c0fd2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-19

    - reduce the number of returns per function
    - improve comment density

M	nsd/tclthread.c

commit 68c62e0e49c1edf0e819a494d40f7aa18a827eb9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-19

    - improve comment density

M	nsd/tclfile.c

commit d897953ee928d01a03f2b48cfb9898b22c1eb3bd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-19

    - cast boolean value explicitly to "int" for printf

M	nsd/queue.c

commit 78a0aee429df15dbb703f0f583f2eaafd562544a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-18

    - reduce number of returns per function

M	nsd/nswin32.c

commit a7cac1361aa1d7b11d14f89ee0a8726b684db03b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-18

    - reduce number of return statements per function

M	nsd/queue.c

commit 069be081c5cee87d558b832454c88ca2036918f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-18

    - brace expression

M	nsd/str.c

commit 86d61b4e651123b8ea0d759c68a5bf25f2319fca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-18

    - prefer bool over int

M	nsd/queue.c

commit ff7b821b9d93bebd11684fc0a4b098755e0f45be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-18

    - remove unneeded cast

M	nsd/urlopen.c

commit 96b52fbb88469f6f84edf028a1c5f6552010994b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-18

    - prefer "for" loop over "while"

M	nsthread/mutex.c

commit 735336fb35531626a5505abf8d2333b7385891c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-18

    - improve comments

M	nsd/tcljob.c

commit 470ba429382762c13ada81c6e71adb14d3f65bb2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-18

    - use boolean for itPtr->deleteInterp

M	nsd/adpeval.c
M	nsd/nsd.h
M	nsd/tclinit.c

commit a1cb54ef3f139140fca9a1640aff8a547f372dba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-17

    - changed type of condition to boolean

M	nsd/connio.c

commit 22698803f71961be4d5030e47cac3be4afeb0937
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-17

    - adding const declaration

M	nsd/driver.c

commit a619250041a4552f477230b1f067af33e3b31e4e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - bumped version numbers to 4.99.12b1

M	README
M	configure.ac

commit ecafa03dc6f78c6f44eae9635597efeca5f27bfe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - updated NEWS with features of 4.99.12

M	NEWS

commit f0c423b3f9d177b645ae4996d650cee0bc9f384e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - reduce cast from non-struct type to struct type
    - reduce cases, where pointer arithmetic on non-array variables relies on memory layout, which is dangerous (use array variable instead)

M	NEWS
M	include/ns.h
M	nsd/driver.c
M	nsd/lisp.c
M	nsd/random.c
M	nsdb/dbtcl.c

commit f57e0d3009621c3cc1994f9635468b543645931b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - improve comment

M	nsd/tclcache.c

commit fe4b4c30c0b5a0b2bfd128bfcfccca5248de50a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - prefer bool over int
    - reduce implicit conversions

M	include/ns.h
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/fastpath.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/range.c
M	nsd/sched.c
M	nsd/tclxkeylist.c

commit c49f30f198a0c3bbd7c46eaaf8bd3197d63ee8b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - reduce number of returns per function
    - reduce variable scopes

M	nsd/connio.c
M	nsd/index.c
M	nsd/limits.c
M	nsd/lisp.c
M	nsd/modload.c
M	nsd/nsmain.c
M	nsd/sock.c
M	nsd/tclrequest.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsdb/dbtcl.c

commit 1034e7451e6b07b962a62241a0cc56986fa49886
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - reduce implicit conversions leading to potential loss of sign

M	nsd/crypt.c

commit 801a6bec3e8b88bfafc7de43394d7d1edd1ab983
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - whitespace changes

M	nsd/tclfile.c

commit 759cbba5a2bde3877a4e3c6412c3c1653f0695b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - whitespace changes

M	nsd/tclfile.c

commit 301286fca47e8c2d6fb8380e85d3afa394f8c16f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - reduce number of returns per function

M	nsd/tclmisc.c

commit e73aea4761e83fc600c07af5f5d91ffbf04e24b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - reduce number of returns per function
    - reduce variable scope

M	NEWS
M	nsd/tclhttp.c
M	nsd/tcljob.c

commit 094dd2b68266cec0bb5dd9187558f86268697833
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-15

    - add UNUSED declarations

M	nsd/driver.c

commit e56f371509ccbb4494bb1a2813a3441c244506cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-14

    - add const declarations
    - reduce implicit conversions

M	nsd/driver.c
M	nsd/tclcache.c

commit b9a0eaa6d61bba159a023bdb5ccba708e7b2b973
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-14

    - fix implicit conversions

M	nsd/tclmisc.c

commit 959856d1b5925788886c8de5175fb50a6f21205c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-14

    - minor cleanup: remove unneeded static var, silence static checker

M	nsd/tclxkeylist.c

commit dbb4edb5b2fec797e8375c7f0577826c722c73c2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-14

    - silence static checkers about potential uninitialized variables

M	nsd/fastpath.c
M	nsd/info.c

commit 41ce7acee38b91998623deca8e80a28eeb8356a3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-14

    - fix indentation

M	nsd/tclset.c

commit d76027a745d1cdd25c6d39f7891f8455d4efb2f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-14

    - improve code comments

M	nsd/fastpath.c
M	nsd/log.c
M	nsd/tcljob.c

commit 2034d7ea56f6f2281adebc168f620f1ffffccaa9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-14

    - align argument names of function defines for Tcl_ObjCmdProc with the names used in Tcl

M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/info.c
M	nsd/modload.c
M	nsd/queue.c
M	nsd/tclcache.c
M	nsd/tclmisc.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclset.c
M	nsd/tclthread.c
M	nsd/url2file.c
M	nsd/urlopen.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c

commit b4f86583af85522da5a6a28ced163c5b63857247
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-13

    - added man pages for ns_md ns_hotp ns_totp

M	Makefile
M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_hmac.man
A	doc/src/naviserver/ns_hotp.man
A	doc/src/naviserver/ns_md.man
M	doc/src/naviserver/ns_md5.man
M	doc/src/naviserver/ns_sha1.man
D	doc/src/naviserver/ns_sha2.man
A	doc/src/naviserver/ns_totp.man
M	tcl/ns_crypto.tcl

commit ead0e621b8f8accf510e9d33ffb166234cf0457a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-13

    - reduce number of calls to Tcl_AppendResult()
    - reduce number of return statements per function

M	nscp/nscp.c
M	nsd/tclmisc.c
M	nsd/tclxkeylist.c

commit e28d3a3d13d46b2c93404604cfd9782d6992228e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-13

    - reduce number of calls to Tcl_AppendResult()
    - reduce number of return statements per function

M	nsd/auth.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/quotehtml.c
M	nsd/tclconf.c
M	nsd/tclimg.c
M	nsd/tclobj.c
M	nsd/tclxkeylist.c

commit ebd7b6d81c3fa5ce6bbf87e5c497fd7fb93a9a90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-13

    - eliminate all calls to deprecated call Tcl_AppendElement()
    - reduce number of calls to Tcl_AppendResult()

M	nsd/conn.c
M	nsd/encoding.c
M	nsd/limits.c
M	nsd/queue.c
M	nsd/tclcache.c
M	nsd/tclfile.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsdb/dbtcl.c
M	nsproxy/nsproxylib.c

commit 35e608d1996566504ae49f88bc2c9de79403b85f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-12

    - add missing space

M	nsd/log.c

commit 56749feec0d126073a01e1eed47e8911487415ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-12

    - no need to call Ns_DStringFree() after Tcl_DStringResult()

M	nsd/log.c
M	nsd/pathname.c
M	nsd/tclfile.c

commit b2c65dc16e0ba9082363225c42c6d1d0fc1bb513
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-12

    - reduce number of calls to deprecated Tcl_AppendResult()

M	nsd/info.c
M	nsd/log.c
M	nsd/tclenv.c
M	nsd/tclobjv.c
M	nsd/tclset.c
M	nslog/nslog.c

commit a9f2fb23f311298389f3acbb8fa39242823e1511
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-12

    - reduce number of multiple returns of functions
    - reduce variable scopes

M	nsd/range.c
M	nsd/request.c
M	nsd/sls.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c

commit d5c800327884245ce47fc2dd583e3665f21b27c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-12

    - use consistently INT2PTR(NS_TRUE) as argument in  Ns_ObjvBool converter registrations

M	nsd/limits.c
M	nsd/tcljob.c
M	nsd/tclrequest.c
M	nsd/tclsched.c
M	nsd/tclvar.c
M	nsd/url2file.c

commit 18cde6f666b53cca94f1c15d5a5037bd042dfbf9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-11

    - reduce number of calls to deprecated Tcl_AppendResult()

M	nsd/adpeval.c

commit 4d8266b7584f3d1b213bbf42f5f950b6b19e5c67
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-11

    - reduce number of calls to deprecated Tcl_AppendResult()

M	nsd/adpcmds.c
M	nsd/conn.c
M	nsd/pathname.c
M	nsd/tclcache.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsdb/dbtcl.c

commit b957065a350c50108d3a97ea3969afecf92acc10
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-11

    - reduce number of calls to deprecated Tcl_AppendResult()

M	nsd/adprequest.c
M	nsd/tclobj.c
M	nsd/tclsock.c

commit 35e94e020812bf688bce39b3e59ded3b2f2da7a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-11

    - reduce number of calls to deprecated Tcl_AppendResult()

M	nsproxy/nsproxylib.c

commit 06bf213cd51bee14bd75ed2fa6d6a5f7f3eaa4e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-11

    - modernize argv interface
    - reduce number of returns per function

M	nsproxy/nsproxylib.c

commit 7877939267229f3b139f977f8b6a889d6c6d7631
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-11

    - fix flag "-timeout" for NsTclSockOpenObjCmd()
    - reduce number of returns per function

M	nsd/tclsock.c

commit 5b824dd76fe6efabf0809982a5e69953a19071bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-11

    - make arguments to Tcl_GetChannelHandle() type clean

M	nsd/driver.c

commit f10b773efa5c846deca757540b16190e2b6500f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-10

    - reduce variable scopes

M	nsd/encoding.c
M	nsd/mimetypes.c
M	nsd/tclinit.c
M	nsd/tcljob.c

commit 91dbdcbeb66483731cfde435839f895e9778b64e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-10

    - prefer variable name "mimeType" over "type"
    - reduce number of multiple returns from functions/switches

M	nsd/fastpath.c

commit d204467886f326e3bb385981542a7e7c3ffd68f7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-10

    - use NS_INVALID_SOCKET instead of -1
    - remove test for Ns_ConnSockPtr() again (warn on a higher level)

M	nsd/return.c

commit 5fe0f02cd733b1f95a767ff751a8e1099528ff60
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-10

    - order subcommands alphabetically

M	tests/ns_writer.test

commit cb9b9916764035bf4a3dc6d0a03d702bc96bfd5e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-10

    - split large switch statement of NsTclWriterObjCmd using Ns_SubcmdObjv()

M	nsd/driver.c

commit 40ebbb6eafb2e54e674b36695beecb8eab3948cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-10

    - issue error messages with cmds without arguments are issued with arguments
    - added const declarations
    - marked unused arguments with UNUSED

M	nsd/dns.c
M	nsd/driver.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tls.c
M	nsthread/mutex.c

commit e93ed68c0998e3955c69ba2d967405eddce0203f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-09

    - terminate ReturnOpen() when Ns_Conn has no associated sockPtr

M	nsd/return.c

commit 0545349c62903fa1db49475cd563eb1a2efd9114
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-09

    - reduce number of returns per function

M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/mimetypes.c

commit f00f4ff8c483fdeb763505dadacf37c0c3b08f36
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-09

    - reduce variable scopes

M	nsd/conn.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclsock.c
M	nsd/tls.c
M	nsd/urlspace.c

commit 940b62fd030743384d3907e8327588308545ec58
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-09

    - add casts for printf statements

M	nsperm/nsperm.c

commit 44fb9eb47df3db698f6628cb424beed3e5eb13af
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-09

    - reduce number of returns per function
    - ns_write submitfile: bail out earlier, when no sockPtr is available (when e.g. client has closed already the connection)

M	nsd/driver.c

commit 2b3b0095595812269229c2a331eccb9afee81c1a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-09

    - reduce number of calls to deprecated Tcl_AppendResult()

M	nsperm/nsperm.c

commit de215da45e1d1164b84cd63ec9ae2045464c966d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-09

    - reduce number of calls to deprecated Tcl_AppendResult()

M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/limits.c
M	nsd/queue.c
M	nsd/tclcache.c
M	nsd/tclfile.c
M	nsd/tcljob.c
M	nsd/tclresp.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c

commit 109de62d16efeed6b6f98b8c139e75af504633cf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-09

    - reduce number of multiple returns per function
    - modernize argv parsing

M	nsd/httptime.c

commit b027743f3a2db5be5faac6b73257c1ac799a099f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-09

    - reduce number of multiple returns from functions/switches
    - prefer Ns_TclPrintfResult() over Tcl_AppendResult() for error
      messages (Tcl_AppendResult is deprecated)

M	nsd/tclhttp.c

commit 0df42c3a29268ad9cc290ecfa46fc0cf90532e84
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-08

    - split large switch() statement into smaller units using using Ns_SubcmdObjv()

M	nsd/tclhttp.c

commit 394e66a03a3da36be597508553957216320f85d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-08

    - update documentation
    - add deprecated log statements
    - prefine single returns from functions

M	doc/src/naviserver/ns_ictl.man
M	nsd/tclinit.c

commit fde3d7f14b1edcdff82958e27d4a08ae8da7d362
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-08

    - don't use boolean args for comparison operator
    - removed unneeded function

M	nsd/tclinit.c

commit 45e49d1331d780a7e5dd452848c5fda200cae8ba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-08

    - bump version number to 4.99.12d6

M	configure.ac

commit 9cd7b32425872f1f90380dc98c27fe45c46fded4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-08

    - split huge switch statement using using Ns_SubcmdObjv()

M	nsd/tclinit.c

commit c5ea9329f8987b8676fc8999a00fc00345596907
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-08

    - fix typo in comment

M	tests/ns_crypto.test

commit 1e0f7ad22ac7fe3d282f626599e1f268ee32f1af
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-08

    - fix typo in error message

M	m4/openssl.m4

commit 22aba0c9b6b6cb0aecf7903628226600867e9407
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-07

    - add prototypes

M	nsd/urlspace.c

commit b5c4b04882f63725666b22e211128108f5b66eed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-07

    - Don't exit the script, but let ns_shutdown take care about terminating everything.
      Otherwise it is possible that the shutdown mechanism of NaviServer conflicts with
      Tcls shutdown (both ThreadExitProc and an ExitProc might be called on the
      same interp).

M	tests/all.tcl

commit add7a32fda5155ae394f3eab5d441e878049dfe5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-07

    - split large function NsTclUrlSpaceObjCmd() into 5 small ones using Ns_SubcmdObjv()

M	nsd/urlspace.c
M	tests/ns_urlspace.test

commit af298ac3bb049381aea71b17e915b7a8b1eb149c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-07

    - reduce variable scope

M	nsd/tcljob.c

commit 75639e295a25dbce008f7b5c93b3369e32822d20
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-07

    - use Ns_ParseObjv() instead of manual argv parsing
    - improve documentation

M	nsproxy/nsproxylib.c

commit 5aa34107637eaef3edb6beb33253354efe26da68
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-07

    - reduce variable scopes

M	nsd/tls.c

commit 8c501847c906998d706328b12d0b0a2e98a6944d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-07

    - reduce variable scope

M	nsd/dns.c

commit 39d623b85847e3ca23fd0c8b1fddb6b937331b63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-06

    - add const declarations

M	nsd/tls.c

commit acfb96aa2eb32840fb12cf3dbb3305a11c654e74
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-06

    - improve comments
    - white-space changes

M	nsd/tclobjv.c

commit 55642c80dea6f47f6c1e8d157db5831b4e90b7c6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-06

    - split huge function NsTclJobObjCmd() into 14 small ones using Ns_SubcmdObjv()
    - add objv converter ObjvQueue()

M	nsd/tcljob.c

commit 7581d6874cf80da835f3bd576684fae3230ca245
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-06

    - don't use boolean values as arguments of comparison
    - improve comments

M	nsd/tclfile.c

commit 088a6badc1885fa39f0041e31b0577ead79c3f93
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-06

    - prefer single returns from functions

M	nsd/dns.c

commit 1d7d5db8bd2261764814af39dcca6c350ade9247
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-06

    - improve comments

M	nsd/connio.c

commit bf8898d91cf53fa46267cfcf5e0b5f97cbd2ed1f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-06

    - add const declaration

M	nsd/connchan.c

commit daed8d9b60b1081badbce64156bee716a4a48b1d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-06

    - prefer NS_TRUE over 1 for boolean value

M	nsd/adpcmds.c

commit 8484d184e1399b9d14277489838f5a8d94f496cb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-05

    New infrastructure support for commands with subcommands:
    - instead of long switch statements with nested structures
      with often many returns, one can now specify Tcl_ObjCmdProcs
      for subcommands. The command with subcommands can be
      defined as:
    
        const Ns_SubCmdSpec subcmds[] = {
            {"callback", ConnChanCallbackObjCmd},
            {"close",    ConnChanCloseObjCmd},
            {"detach",   ConnChanDetachObjCmd},
            {"exists",   ConnChanExistsObjCmd},
            {"list",     ConnChanListObjCmd},
            {"open",     ConnChanOpenObjCmd},
            {"read",     ConnChanReadObjCmd},
            {"write",    ConnChanWriteObjCmd},
            {NULL, NULL}
        };
        return Ns_SubcmdObjv(subcmds, clientData, interp, objc, objv);
    
    - advantages: more modular, smaller functions, improved
      locality
    - used so far in crypto support, ns_chan (a 200 function was split
      into 5 functions up to 50 lines), ns_connchan (a 500 line function
      was split into 8 functions up to 120 lines). There are more of
      these large switch statements in the code.

M	include/ns.h
M	nsd/connchan.c
M	nsd/tclfile.c
M	nsd/tclobjv.c
M	nsd/tls.c
M	tests/ns_conn.test

commit f867edfc258b70162e2cf6933e9d5a421cd07699
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-04

    - prefer single returns from functions

M	include/ns.h
M	nsd/tclfile.c
M	nsd/tclresp.c
M	nsdb/dbtcl.c

commit 508534d8589c170a08c7b1dcf0e1c3c068a19fa8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-04

    - minor changes (whitespace, comments)

M	nsd/driver.c
M	nsd/tclhttp.c
M	nsd/tclobjv.c
M	nsd/tclresp.c

commit 42aad7e89d59003bd8e4d1e74fb7cd00975d0bac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-04

    - prefer single return from functions

M	nsd/tclsock.c

commit 3e7087d35c4c99c76709859105e64ed4090f3dbf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-04

    - prefer single return from function
    - fix typo

M	nsd/tcljob.c

commit 4da26bf5d874c04cb07402d0d9e6bdeaa48af027
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-04

    - correct return value

M	nsd/connio.c

commit c72fcc0ed87729ce9d14bbc7100bdcc89cd31b26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-04

    - fix bool value

M	nsd/config.c

commit f055b3ec5ff2c2f978d70812c3536805d787ba07
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-04

    - adding const declaration

M	nsd/adpparse.c

commit 00baa995898acaba0ee6928048214f893b195b21
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-03

    Improved crypto support:
    - ns_crypto::hotp: Implementation of HMAC based One-Time Password
      algorithm as defined in RFC 4226
    - ns_crypto::totp: Implementation of a Time-Based One-Time Password
      algorithm as defined in RFC 6238
    - extended regression test with test vector from the RFCs

M	tcl/ns_crypto.tcl
M	tests/ns_crypto.test

commit 874c7358b2501cbdf7cad04bc6620be9a6e77ed4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-03

    - use spelling "NaviServer" consistently

M	Makefile.win32

commit 7eab343915fe374719efb5cdd8d5345cfe1a51f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-03

    - allow one to run nsf code also in the testserver

M	tcl/aolserver-openacs.tcl

commit 6e8abc35939eb28606ffda638762b3b563b09c3f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-03

    - simplify code

M	tests/ns_hostbyaddr.test

commit b133d2da6d973adef416e5a3879815d0653bac48
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-02

    - prefer single returns from functions
    - get rid of alloca() in case c99 is available
    - split up NsAdpParse() into AdpParseTclFile() and AdpParseAdp()

M	nsd/adpparse.c
M	nsd/cache.c
M	nsd/callbacks.c
M	nsd/config.c
M	nsd/nsd.h
M	nsd/range.c
M	nsd/return.c

commit 06d3c5962b190e80552afec9a95919e70289174a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-02

    - add const declaration

M	nsd/driver.c

commit 4bcf50385bcfc9144c01968754d13146ba5ab9c8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-02

    - reduce variable scope

M	nsd/connio.c

commit 10cea90581433df9ad412d61aef1ef191c8f742c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-02

    - use unsigned short for port
    - prefer single returns from functions
    - add const declaration

M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/driver.c
M	nsd/tclobjv.c
M	nsd/tclresp.c
M	nsd/tclsock.c

commit 5ad8112959802ab5053138598ab0a76a09b89480
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-02

    - use uppercase "L" as suffix to avoid possible confusion with 1

M	nsd/tcltime.c

commit efc8ec136914b9dffba48145348ef7ff641fbe1a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - ignore result explicitly

M	nsd/tclhttp.c

commit b8635e4899dddce6aedab06473ba214f30b86cee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - prefer single returns from functions

M	nsd/adpcmds.c

commit 95e9b245a6cb0418161a5866c89ea077acc2ec58
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - remove check for missing configuration, since defaults are provided

M	nscp/nscp.c

commit 932753a10b97ca2a16f9debb394f9c5f7d90f2fd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - fix port type from unsigned int to unsigned short

M	include/ns.h

commit 0ec97c3f39507d1c625cb9c51f982606a9a9c4f2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - silence checker

M	nsd/conn.c

commit b6df4c080ba6add4f4f9f80322d8dadde4c9394b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - add comment lines

M	nsd/tclobjv.c

commit 3d490d9c2d5bfbd3a12cdc3faa867d222d3f8e0a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - prefer single returns from functions

M	nsd/connio.c
M	nsd/tcljob.c

commit 7cabc03deb4afe5e10c0c4b4f2c37a349a842d10
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - reduce implicit conversions

M	nsd/driver.c
M	nsd/sockaddr.c

commit 1666360dfc1aa98d3dcb8a8bbd53a6abfca34c9b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - adding const declarations

M	include/ns.h
M	nsd/connio.c
M	nsd/proc.c
M	nsd/progress.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c

commit d7da26a0273b8d79edd419bae0e96e3947759356
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - refer single returns from functions

M	nsd/tclresp.c

commit 58ef7afa2f5309bde09113f6097c53fc103a6808
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - prefer single return from functions

M	nsd/tls.c

commit 2cb86dace214a52e19312a2a49a92eedfd52ed29
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-08-01

    - reduce implicit conversions (implicit sign loss)

M	nsd/compress.c

commit a85cbd52fe54bb9f47960bfe3f2179e7df63a2a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - add new testfile for ns_crypto::* commands

A	tests/ns_crypto.test

commit d4fbb313558bbb1954f656c5300a226e66d10ab0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - reduce implicit conversions

M	nsd/driver.c

commit 2e70bcaf3ed8006448eaf73f9058f1a07cbdc423
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - adding const statements

M	nsd/tcltime.c

commit 270b9a3bd399300b0790f56b1f8b6f353d2f167f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - prefer bool over int
    - use unsigned short for ports
    - use namespace ::ns_crypto::* instead of ::crypto::*

M	nsd/tclcmds.c
M	nsd/tclhttp.c
M	tcl/compat.tcl
R069	tcl/crypto.tcl	tcl/ns_crypto.tcl
M	tests/ns_sha1.test

commit ab85d356b450ece66a4bf72fa15dea8a86ae6a56
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - additional objv-converter Ns_ObjvUShort() for unsigned short (used for ports)
    - additional DString formatter Ns_DStringAppendTime() to provide
      unified formatting of Ns_Time structs
    - fix more occurrences for using unsigned short for ports
    - modernize tcl argv parsing for
       * NsTclSockCallbackObjCmd(),
       * NsTclSockListenCallbackObjCmd,
       * NsTclSockListenObjCmd(), and
       * NsTclSockOpenObjCmd()

M	include/ns.h
M	nsd/dstring.c
M	nsd/sock.c
M	nsd/tclobjv.c
M	nsd/tclsock.c

commit 4e6e04b7f7d0fb5a0d165c0e1b8a95059f127fb3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - produce boolean tcl value from boolan member

M	nsd/tclsched.c

commit be11faa0d25af85cf7b1e1e0f481f2104d0789f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - use unsigned short for ports

M	nsd/binder.c
M	nsd/driver.c
M	nsd/nswin32.c

commit 7c09573035c792046b8ea7f906337fea7c324b32
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - keep "int" as result of SpExecProc

M	nsdb/dbdrv.c

commit 8b4580f496d0bf82f7b808acfc053cc38a74a4e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - use boolean constants

M	nsd/log.c

commit 16fddd5e8203c202aa5391a5beaf10d12e6db4b3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - use boolean constant

M	nsd/connchan.c

commit bd5f80138d3f818130a19fc04947feccc128b865
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - use bool instead of int

M	nsd/adpcmds.c

commit eae131102afefa57f217fdaec447d6888389b8ce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - use unsigned short for port

M	nscp/nscp.c

commit 9e467b1fbbe9037de5fd6c75d840aaf10f3a0ed1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - remove unneeded return statement

M	nsd/tcltime.c

commit 1d137479a58d782d18014976a06265ba84797971
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - improve source code docuemntation
    - fix potential bug in error conditions

M	nsd/tcltime.c

commit 5bd499dc98b70bc50c3c65a24032a186570b7a86
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - new API call Ns_DStringAppendTime() to ease uniform printing of
      Ns_Time structs into DStrings

M	include/ns.h
M	nsd/driver.c
M	nsd/queue.c
M	nsd/sockcallback.c
M	nslog/nslog.c

commit 75f9c1a23d50439ffc5ed323f41526dc6590c1c1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-31

    - silence static checker

M	nsd/conn.c

commit e541432ebfbb5e6bbc80ec58bb64c231822c5e07
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-29

    - fix typos
    - use camel case in "NaviServer" consistently

M	doc/src/manual/admin-install.man
M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/tcl-libraries.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_requestauthorize.man
M	include/Makefile.win32
M	nsd-config.tcl
M	nsd/adprequest.c
M	nsd/pathname.c
M	nsdb/dbtcl.c
M	nsproxy/doc/mann/ns_proxy.man
M	nsproxy/nsproxymod.c
M	openacs-config.tcl
M	simple-config.tcl
M	tcl/init.tcl

commit 67ff3d1d17fb0e75f77848cae93769c47091a058
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-29

    - reduce number of functions with multiple returns

M	nsd/conn.c
M	nsd/connchan.c
M	nsd/tclimg.c

commit 0c55bd426352dafab159ab5364e5bbb57cb439b7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-29

    - prefer single returns from functions
    - reduce variable scopes

M	nsd/tclcache.c

commit c6d0b9d73bfb6f20c58205bb32bf5f6a0f172507
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-29

    - modernize tcl argument parsing
    - prefer single returns from functions

M	nsd/tclimg.c

commit 6eea0b9ea8309d2e7aa3225a640bb93dd16379da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-28

    - follow Tcl conventions: rename optional argument for selective testing from TCLTESTARGS to TESTFLAGS

M	Makefile
M	nsssl/Makefile

commit 2e89e1552d22eb0b158229ee18fda8227fa9616c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-28

    - reduce verbosity

M	tests/testserver/modules/listencallback-procs.tcl

commit 742ce4d985c8e656fa285670e59b9b620e2cb25f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-28

    - prefer single return from functions
    - reduce variable scopes

M	nsd/config.c
M	nsd/tcltime.c
M	nsd/tls.c

commit a028ce4caa8c277e2255682b40a5ce7b44ca4b80
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-28

    - modernize tcl argument parsing
    - prefer single returns from functions

M	nsd/tcltime.c
M	nsthread/time.c

commit d7bd1cd31ba70db0888c23265b8629ade9da6c6a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-27

    - prefer single return from function

M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/config.c
M	nsd/encoding.c
M	nsd/fastpath.c

commit bd79023a1c971ae87f2017353e68740926134648
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-27

    - prefer bool over int

M	include/ns.h
M	nsd/adprequest.c
M	nsd/filter.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/tclrequest.c
M	nsd/tls.c

commit b459d7e13126518451b8f504d820d04f29e03722
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-27

    - use consistently unsigned short for ports
    - don't call ns_sock_set_blocking with a non-socket file descriptor
      under windows
    - prefer bool over int
    - reduce implicit conversions

M	include/ns.h
M	nsd/binder.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/listen.c
M	nsd/sock.c
M	nsd/sockaddr.c
M	nsd/sockcallback.c
M	nsd/sockfile.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclxkeylist.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsd/uuencode.c
M	nsdb/dbdrv.c
M	nsdb/dbtcl.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit 7a996fe4c7872d8fb550ce28af653fb02193c6be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-27

    - add ns_rlimit call to sample config file

M	openacs-config.tcl

commit f70f0bce821641fc6933b3599736d2e358ad74c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-24

    - add one more usage of macro INTCHAR

M	nsd/driver.c

commit 5822eefb8933fac6a340d0d69804760dffb70325
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-24

    - fix in request parsing of pre-HTTP/1.0 requests (no request header fields, old bug)

M	nsd/connio.c
M	tests/testserver/modules/testhttp.tcl

commit 14c075c9404a4a8e65ca5d552e1220a753f3df47
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-24

    - introduced macro INTCHAR to pass "char" to library functions
      requiring "int" to avoid code smells of expressions assigned to a
      narrower or different essential type, MISRA 2012 Rule 10.3)

M	include/ns.h
M	include/nsthread.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/mimetypes.c
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/request.c
M	nsd/return.c
M	nsd/rollfile.c
M	nsd/tclenv.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tclxkeylist.c
M	nsd/url.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsdb/dbinit.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsthread/nsthreadtest.c

commit 9ae6d41263968c0f6ff5f6a73af77beffae0c74a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-24

    - use Tcl_NewBooleanObj for boolean results.
    - turn more "int" into Ns_ReturnCode

M	nsd/connio.c
M	nsd/tclset.c
M	nsdb/dbtcl.c

commit 2c18d0bc42631017668a49527bdb8d93f4b4d4bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-24

    - use NsWriterStreamState consistently

M	nsd/driver.c
M	nsd/nsd.h

commit e486dc66bfbab5bceb617c1370a483dbcb8db2b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-24

    - must keep int instead of Ns_ReturnCode for the time being.

M	nsdb/dbdrv.c
M	nsdb/nsdb.h

commit d6b6eb99176c089f82acce9906c139455fa0b1b2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-23

    - reduce implicit conversions
    - prefer single returns from functions
    - silence checker

M	nscgi/nscgi.c
M	nsd/adprequest.c

commit 4b2b89438803cbd7108c10b1b84bb16b5f75a31c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-23

    - turn more "int" into Ns_ReturnCode
    - reduce implicit conversions

M	nsdb/dbinit.c
M	nsdb/nsdb.h

commit 7c8e7027efbf899ee776e92b73a7aa5fae3de5b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-23

    - turn more "int" into Ns_ReturnCode
    - prefer bool over int
    - reduce implicit conversions

M	include/ns.h
M	nsd/connio.c
M	nsd/driver.c
M	nsd/log.c
M	nsd/set.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/url.c
M	nsdb/dbdrv.c
M	nsdb/nsdb.h

commit 40d465088f90b34b7ba2edaeebc3233e6cd9811e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-22

    - fix potential crash while producing error message for certain invalid requests

M	nsd/driver.c

commit 050844218d17ea8e6b0423372172289623f30d7f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-22

    - turn defines into enum NsWriterStreamState
    - prefer bool over int
    - ad nonnull assert

M	include/ns.h
M	nsd/adpparse.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/range.c
M	nsd/request.c
M	nsd/return.c
M	nsd/tclfile.c
M	nsd/tclresp.c
M	nsd/tclvar.c
M	nsd/url2file.c
M	nslog/nslog.c

commit 9376f1ae59729209481930fa6defdb7f0d8aa1e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-20

    - flag bad request, that looked like end of headers, as bad request

M	nsd/driver.c

commit e5be0e0ab4f10912298f69916655a1cbc72e904e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-19

    - make the ns_crash cmd available

M	doc/src/naviserver/ns_rlimit.man
M	nsd/nsd.h
M	nsd/tclcmds.c

commit 89d6b3909e62f08e679b43f900eaecdb906bdd21
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-19

    - prefer bool over int

M	nsd/driver.c

commit 23caf5cc8f9e5b81332fccd8abfb630d3bb04f3d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-19

    - cast type explicitly

M	nsd/tls.c

commit 5dd5609548c6ae595764a7d30570c690609f236b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-19

    - fix result of "dev" member in ns_filestat command
    - cast numeric members of stat to Tcl_NewWideIInt to avoid surprises with platform specific types (like ino_t, dev_t, etc.)

M	nsd/tclmisc.c

commit e356c660220879257af6f86575e9497dd6285c88
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-18

    - fix implicit conversions from 0 to NULL

M	nsd/driver.c
M	nsd/limits.c
M	nsd/nswin32.c
M	nsd/tclcache.c
M	nsd/tcljob.c

commit 71f4b786e8a1e71b4bb166af7a0c0eba1ced93bc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-18

    - adding const declarations

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/adprequest.c
M	nsd/connio.c
M	nsd/event.c
M	nsd/fastpath.c
M	nsd/nswin32.c
M	nsd/proc.c
M	nsd/return.c
M	nsd/sockaddr.c
M	nsd/task.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsdb/db.h
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/nsdb.h

commit 44358680a9e6d1e2d4f3b874d7ccce9c06b7ae39
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-18

    - reduce implicit conversion
    - ignore results explicitly

M	nsd/compress.c

commit 5ef591951f8b0c66fdfbd28e93af1f95292c2209
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-18

    - follow usual naming conventions
    - adding const declarations

M	nsdb/dbtcl.c

commit 2f2af0f976e4f8a967ee2bd0054e72d5ca1cf85e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-18

    - remove unneeded define
    - reduce implicit conversions

M	nsd/compress.c

commit 24223a62f4c802cde2d6d895cd38b6ce88c7b531
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-16

    - add changes for Visual Studio 2015 (as indicated by Maurizio)

M	include/nsthread.h

commit e05a65d042674e82821a2416fb53bc9e8821b815
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-15

    - adding const declarations

M	include/ns.h
M	nscp/nscp.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/dns.c
M	nsd/event.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/index.c
M	nsd/info.c
M	nsd/limits.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/proc.c
M	nsd/range.c
M	nsd/returnresp.c
M	nsd/rollfile.c
M	nsd/server.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclcallbacks.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclsched.c
M	nsd/tclset.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/nsdb.h

commit 95a2d8b06a13c9d554687a56b84b358b388f0d96
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-14

    - relax nonnull assertions

M	include/ns.h
M	nsd/tclobjv.c

commit f2c029ca2fdcc25fa112f4a0c955271325cb97c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-14

    - add const declarations

M	include/ns.h
M	nsd/cookies.c
M	nsd/encoding.c
M	nsd/mimetypes.c
M	nsd/op.c
M	nsd/proc.c
M	nsd/progress.c
M	nsd/queue.c
M	nsd/sched.c
M	nsd/set.c
M	nsd/sls.c
M	nsd/sockaddr.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tclresp.c
M	nsd/tclthread.c
M	nsd/tclxkeylist.c

commit 560c83339bbd4a3e1accbe25f37935e23b436849
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-14

    - prefer single returns from functions
    - reduced variable scopes
    - add const declarations

M	nsd/tclobjv.c

commit f635d2be482e6879b41ae8a4bea08d03011398f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-13

    - add const declarations

M	nsd/config.c
M	nsd/return.c
M	nsd/server.c
M	nsd/tclmisc.c
M	nsd/tclsock.c

commit e1cb4b3316691cc31d059167a529f01b0065a4cc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-13

    - adding const declarations
    - prefer bool over int

M	nsd/auth.c
M	nsd/callbacks.c
M	nsd/cls.c
M	nsd/connio.c
M	nsd/filter.c
M	nsd/tclcache.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclrequest.c
M	nsd/url2file.c

commit 205518b425d7b7be88b29843f6e563f290f38d48
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-13

    - use Ns_ReturnCode for functions in db driver where appropriate

M	nsdb/db.h
M	nsdb/dbdrv.c

commit 24e9222b795716a0f50b6fc671e073ac522e70c1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-13

    - prefer bool over int

M	include/ns.h
M	nscp/nscp.c
M	nsd/config.c
M	nsd/driver.c
M	nsdbtest/nsdbtest.c

commit d19095e91e38697a683fc8cc918781dc8774c9a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-13

    - reduce implicit conversions

M	nsd/connchan.c

commit dd14e05bde839269febe016752a8d3ad7e6d44aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-12

    Ns_ReturnCode reform (part 5): use Ns_ReturnCode on the following functions:
    
    NsUrlToFileProc
    Ns_ConnReturnEntityTooLarge
    Ns_ConnReturnUnauthorized
    Ns_DriverRequestProc
    Ns_FetchPage
    Ns_ReturnCode
    Ns_RollFile
    Ns_SetServerRootProc
    Ns_TclDetachedThread
    Ns_TclThread
    Ns_WaitForProcess
    Ns_WaitForStartup
    Ns_WaitProcess

M	include/ns.h
M	nsd/auth.c
M	nsd/compress.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/random.c
M	nsd/return.c
M	nsd/rollfile.c
M	nsd/sock.c
M	nsd/sockaddr.c
M	nsd/tclenv.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclsched.c
M	nsd/tclthread.c
M	nsd/url2file.c
M	nsd/urlopen.c
M	nsdb/dbdrv.c
M	nsdb/dbutil.c

commit e6e8fe85efe5956d82a807624f2e8646ffbbf161
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-12

    - use calloc rather than initializing members with 0/NULL

M	nsdb/dbinit.c

commit 9adbcfb4479e363443f3d8e8d6023dfebea87165
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-12

    - avoid mismatch between tcl result code and ns result code
    - reformat switch statement

M	nslog/nslog.c

commit 70c6ad6dc4578e27794e9eb6ba55dd649a649ede
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-12

    - ignore result explicitly

M	nsproxy/nsproxylib.c

commit 7319e044a347c90939835b98f919c9c2359ff245
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-12

    - prefer boolean over int

M	nsd/str.c

commit 16cb9750eb0200f65de12d7a54364b0e67dfbf3b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-12

    - prefer Ns_ReturnCode over int
    - reduce variable scope

M	nsd/log.c

commit 4b4766f4e82ecdb5ac9ad9f0384c506837b88f9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-12

    - align result-codes of Ns_EventEnqueue() and Ns_RunEventQueue();
      return bool in both cases

M	nsd/event.c

commit 171d828db1dbf2ac71707e53f82bdc8a1d24e223
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-12

    - clean up NS_OK vs. TCL_OK
    - align results of "ns_writer submit" with "ns_writer submitfile",
      document meaning of result

M	doc/src/naviserver/ns_writer.man
M	nsd/driver.c

commit 55354c60849c5d053dd6e1d52861c008ca611c94
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-12

    - fix typo in code-section when no zlib is available

M	nsd/compress.c

commit d94479ec0297aa8bb3bd67cec6370864a02b0f1e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-11

    - prefer Ns_ReturnCode over int
    - don't compare beeloean values with ==

M	include/ns.h
M	nsd/config.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/queue.c

commit c3033ee24aee956d84eba4e051cf36f762e41a39
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-11

    - fix potential memory leak for "ns_mutex eval"
    - proivde parens for expressions

M	nsd/tclthread.c

commit c436beb2300ecad9b7f07b104df546c959a40ccd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-11

    - provide alternate candidates for addresses

M	openacs-config.tcl

commit 8ea619fa0043d7c03b02cf100327b7fdf903537f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-11

    - name mutex in syncobjs
    - reduce variable scope

M	nsd/tclthread.c

commit 43e745182791c80d77fe35547fc7b9469fc39a93
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-09

    - improve cleanness of compilation with Tcl 8.6

M	nsd/connchan.c

commit 6a5c38a9644282e560fb09cf19280ebba9f9abd8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-09

    - provide explicit names for more mutexes
    - initialize static variables
    - prefer bool over int

M	nsd/binder.c
M	nsd/cache.c
M	nsd/driver.c
M	nsd/init.c
M	nsd/nsconf.c
M	nsd/nsmain.c
M	nsd/random.c
M	nsd/server.c
M	nsd/tclenv.c
M	nsd/tclvar.c
M	nsdb/dbinit.c
M	nsproxy/nsproxylib.c
M	nsthread/cslock.c
M	nsthread/mutex.c

commit 451a0580b7d25f48add246787b7aa1293eb7e33f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-08

    - provide a name for mutex 12

M	nsd/tclinit.c

commit 862dac61498114a7470f0fac18d04042dbb1361e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-08

    - use Ns_ReturnCode instead of int when appropriate
    - add nonnull assertions
    - fix indentation

M	nsdb/db.h
M	nsdb/dbdrv.c
M	nsdb/nsdb.h

commit d31f6b922a865a8c14d16838fc9a4bb063629894
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-08

    - move load specs of OpenSSL libraries to the end of the link path to
      minimize interference with other load paths

M	include/Makefile.global.in

commit 832d0641a1718396b9ff5c1fb0fc94acb24a4f3c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-04

    - reduce variable scopes

M	nsd/modload.c

commit aa04f2c105dbddbd5f21f8927cf0071875d242a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-04

    - add missing commands

M	doc/src/naviserver/commandlist.man

commit 9dea6dd085180b31d743bd00f8163c0f112c8c58
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-07-04

    - make list of commands more canonical

M	doc/src/naviserver/commandlist.man

commit 3b3d8e8a3d4c15cb6d725a2a2441fe20dd9e6531
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-30

    - factored out function Ns_GetBinaryString() to obtain from a Tcl_Obj the binary representation if available, otherwise the string representation
    - Ns_ReturnCode reform (part 4): use Ns_ReturnCode on the following functions:
    Ns_AbsoluteUrl
    Ns_ParseUrl
    Ns_TaskCancel
    Ns_TaskEnqueue
    Ns_TaskWait

M	include/ns.h
M	nsd/auth.c
M	nsd/driver.c
M	nsd/sched.c
M	nsd/str.c
M	nsd/task.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tls.c
M	nsd/url.c

commit eaf5228b1082e1d2cd143b818946997da50580f5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-29

    Ns_ReturnCode reform (part 3): use Ns_ReturnCode on the following functions:
    
    NsConnectService
    NsInstallService
    NsMemMap
    NsMountUrl2FileProc
    NsRemoveService
    NsShortcutFilterProc
    NsTclFilterProc
    NsTclUrl2FileProc
    Ns_FastUrl2FileProc
    Ns_FilterProc
    Ns_GetSockAddr
    Ns_LogFilter
    Ns_ModuleLoad
    Ns_SetConnLocationProc
    Ns_SockCallback
    Ns_SockCallbackEx
    Ns_SockCancelCallbackEx
    Ns_SockCloseLater
    Ns_SockListenCallback
    Ns_SockPipe
    Ns_SockSetBlocking
    Ns_SockSetNonBlocking
    Ns_SockTimedWait
    Ns_SockWait
    Ns_TclEval
    Ns_TclRequest
    Ns_Url2FileProc
    Ns_UrlToFileProc

M	include/ns.h
M	nscp/nscp.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/fastpath.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/pathname.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/tclinit.c
M	nsd/tclrequest.c
M	nsd/tclsock.c
M	nsd/tls.c
M	nsd/unix.c
M	nsd/url2file.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit 9c4a4a9fbb5246efed5ae9ee6caecdb1505b0fd5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-28

    Ns_ReturnCode reform (part 2): use Ns_ReturnCode on the following functions:
    
    NsAsyncWrite
    NsWriterQueue
    Ns_AuthorizeRequest
    Ns_CompressBufsGzip
    Ns_CompressGzip
    Ns_CompressInit
    Ns_ConnClose
    Ns_ConnCopyToChannel
    Ns_ConnCopyToDString
    Ns_ConnCopyToFd
    Ns_ConnCopyToFile
    Ns_ConnFlushContent
    Ns_ConnReadHeaders
    Ns_ConnReadLine
    Ns_ConnSendFileVec
    Ns_ConnWriteChars
    Ns_ConnWriteVChars
    Ns_DriverInit
    Ns_FetchPage
    Ns_FetchURL
    Ns_InflateBufferInit
    Ns_InflateEnd
    Ns_InflateInit
    Ns_ModuleInit
    Ns_ModuleInitProc
    Ns_ParseHeader
    Ns_ParseObjv
    Ns_ParseRequest
    Ns_RequestAuthorizeProc
    Ns_ServerInitProc
    Ns_StrToInt
    Ns_StrToWideInt
    Ns_TclInitInterps
    Ns_TclInitModule
    Ns_TclRegisterAtCleanup
    Ns_TclRegisterAtCreate
    Ns_TclRegisterAtDelete
    Ns_TclRegisterTrace
    Ns_WriteCharConn

M	include/ns.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/auth.c
M	nsd/compress.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/filter.c
M	nsd/main.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/request.c
M	nsd/returnresp.c
M	nsd/str.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclobjv.c
M	nsd/tclresp.c
M	nsd/tclset.c
M	nsd/tclvar.c
M	nsd/url2file.c
M	nsd/urlopen.c
M	nsdb/nsdb.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxymod.c
M	nssock/nssock.c
M	nsssl/nsssl.c
M	tests/ns_sha1.test

commit b661f40bcee5bca160c929df21e05e080a5fcd2e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-28

    - document return values of "ns_writer submitfile"

M	doc/src/naviserver/ns_writer.man

commit 20e564315da122c6d6705d9f6180adec80bd6e9f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-27

    - bump version number to 4.99.12d5

M	configure.ac

commit 75eeaa89095b67a25c8e69a0a9fa3d37dd1013ec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-27

    Ns_ReturnCode reform: since the code basis containing at least two cases, where Tcl and NaviServer return codes were confused (e.g. comparing a result with TCL_OK, which is a naviserver return code, returning NS_OK, NS_ERROR, ...) i've defined an enum type for NaviServer return codes to make the distinction clearer and to allow code smell checker to locate suspicious places. The changed version is binary compatible on every sane platform with the purely "int" based interfaces.
    
    The following functions return now Ns_ReturnCode:
    NsAdpPageProc
    NsConnRunProxyRequest
    NsRunFilters
    NsTclRequestProc
    NsUrlToFile
    Ns_AdpRequest
    Ns_AdpRequestEx
    Ns_CacheTimedWait
    Ns_CacheWait
    Ns_CloseOnExec
    Ns_CondTimedWait
    Ns_ConnPuts
    Ns_ConnRedirect
    Ns_ConnResetReturn
    Ns_ConnReturnBadRequest
    Ns_ConnReturnCharData
    Ns_ConnReturnData
    Ns_ConnReturnFile
    Ns_ConnReturnForbidden
    Ns_ConnReturnHeaderLineTooLong
    Ns_ConnReturnHtml
    Ns_ConnReturnInternalError
    Ns_ConnReturnInvalidMethod
    Ns_ConnReturnMoved
    Ns_ConnReturnNoResponse
    Ns_ConnReturnNotFound
    Ns_ConnReturnNotImplemented
    Ns_ConnReturnNotModified
    Ns_ConnReturnNotice
    Ns_ConnReturnOk
    Ns_ConnReturnOpenChannel
    Ns_ConnReturnOpenFd
    Ns_ConnReturnOpenFile
    Ns_ConnReturnRedirect
    Ns_ConnReturnRequestURITooLong
    Ns_ConnReturnStatus
    Ns_ConnReturnUnavailable
    Ns_ConnRunRequest
    Ns_ConnSendChannel
    Ns_ConnSendDString
    Ns_ConnSendFd
    Ns_ConnSendFp
    Ns_ConnWriteData
    Ns_ConnWriteVData
    Ns_DbCancel
    Ns_DbDML
    Ns_DbExec
    Ns_DbFlush
    Ns_DbGetRow
    Ns_DbGetRowCount
    Ns_DbResetHandle
    Ns_DbSpExec
    Ns_DbSpReturnCode
    Ns_DbSpSetParam
    Ns_DbSpStart
    Ns_FastPathProc
    Ns_LogRoll
    Ns_NoCloseOnExec
    Ns_PurgeFiles
    Ns_RollFileByDate
    Ns_UrlToFile
    Ns_VarAppend
    Ns_VarGet
    Ns_VarSet
    Ns_VarUnset
    Ns_WriteConn
    
    Ns_OpProc

M	include/ns.h
M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/adprequest.c
M	nsd/cache.c
M	nsd/callbacks.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/filter.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/queue.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclfile.c
M	nsd/tcljob.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsd/url2file.c
M	nsdb/dbinit.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	nsthread/winthread.c

commit 3958da9c8a5bc5e1a14eee97dabba7caa58f95d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-27

    - prefer Ns_ParseObjv() interface for consistency
    - prefer single return statements from functions

M	nsd/tclresp.c
M	nsd/tclset.c
M	nsd/tclvar.c
M	nsd/urlspace.c

commit 21681244d9768259c2640ed4caa7039251190707
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-27

    - generalize print format

M	nsd/connchan.c

commit a996890e57163a91c2caa3d857b9ef0168e491ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-25

    - remove unneeded assertion

M	nsd/queue.c

commit 763e51458ccead2e3fdca4e7da5216c5c8836889
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-25

    - don't build shared library libnssock.dylib (or .so) for sharing driver functions (rather copy functions if necessary)

M	nssock/Makefile
M	nssock/nssock.c
D	nssock/nssock.h

commit ad5ceda7fcda3a41728c3c59d1f5c0d6ae3f77b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-25

    - mark argument as unused

M	nsd/queue.c

commit 3e7923781ba1a88172be15787f1cca797fa4b47c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-25

    - make result of NsQueueConn() boolean
    - prefer single return statement

M	nscgi/nscgi.c
M	nsd/adpcmds.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c

commit 83cc3f2e681267fa7bc8d0c138d40096dbc93ddb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-25

    - reduce implicit conversions

M	nsd/sockaddr.c

commit 69edaae8c7399140b361935edd46366ce6ce901e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-24

    - move definition of s6_addr16 and s6_addr32 to nsthread.h to reduce redundancy

M	include/nsthread.h
M	nsd/sockaddr.c
M	nsthread/reentrant.c

commit e3bb56b437fcece6d30790cff50fd534e365b197
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-24

    - let NsTclObjIsByteArray() be true whenever we have a tcl obj of type byteArrayTypePtr

M	nsd/tclobj.c

commit faf2afb1972392f989f834636e43d49a4cd84f79
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-24

    - try to improve portability for *BSD systems

M	nsd/sockaddr.c

commit e2a53a15d558b142885a6bcc370448da88877f45
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-23

    - add const declaration

M	nsd/tclfile.c

commit d915d33893b7b1ea407db9aca4aad0d5e5a5e6ca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-23

    - fix typo

M	doc/src/naviserver/ns_rlimit.man

commit ba3985717f8eafcfa024c619b046a8569a5f61a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-23

    - use the Makefiles from the build tree rather than these of the installed code

M	nsssl/Makefile

commit 0ac424217d31d91b033525e4b3a39d0c31280847
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-20

    - new command "ns_rlimt" to get/set various resource limits from the
      operating systems. A typical use case for this command is to query
      or set e.g. the core size via the NaviServer startup file or to
      change it at runtime in a syntax independent from the naming and
      conventions in the various startup scripts (e.g. upstart, systemd,
      ...).

M	doc/src/naviserver/commandlist.man
A	doc/src/naviserver/ns_rlimit.man
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c

commit dcee337922d74099cf57a9730f6cd13e2cb3a5bd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-17

    - don't fail hard, when smtpusestarttls is not set

M	tcl/sendmail.tcl

commit 674a6610895e80015794b75d9eb95165a016ce24
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-17

    - reduce implicit conversions
    - added const declarations

M	include/ns.h
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nswin32.c
M	nsd/sockfile.c
M	nsd/tclsock.c
M	nsdb/dbtcl.c

commit 61ab5d0346e256ffaaeb3338c14361d5c0fc28a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-17

    - adding const declaration

M	nsdb/dbinit.c
M	nsdb/nsdb.h

commit 4d2f15e3dcb2306064dd65de497b59183a548cc0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-17

    - remove always true expression

M	nsd/queue.c

commit e9b215ddbb151ccb59b41fa305bc966fd45265ca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-17

    - reduce implicit conversions

M	nsd/tls.c

commit e729acf63dbc686a86a9613f81e8e2a0e7739e18
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-17

    - adding const declaration

M	nsd/adprequest.c

commit 41ed41bf462a6acc103d8d810e48ed92933a6b16
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-17

    - reduce verbosity

M	nsd/driver.c

commit 0485f490b5dd14a7d19bbb621dc86fa5935a393c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-15

    - use ns_poll everywhere instead of poll()

M	nsd/tclhttp.c

commit e6395e3497cf61a64d7f6dbfe0b953133ab56abd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-15

    - make assertion test boolean

M	nsd/tclhttp.c

commit 12e24627c22b9adcc66ab551331c6e897b45a6c3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-15

    Fix for a serious bug in cookie management which could lead to false
    positives in ns_getcookie:
    
    - Previous versions of NaviServer searched the Cookie and Set-Cookie header files for
      "NAME=" and returned the value provided after this string, when
      found.
    
    - However, the Cookie and Set-Cookie header fields have different
      a different syntax (see https://tools.ietf.org/html/rfc6265
      section 4.1.1 vs. 4.2.1), such as e.g.
        Cookie: cookie1="value1"; cookie2="value2"; style=null; ...
        Set-Cookie: cookie1="new-value"; Expires=Fri, 01-Jan-2035 01:00:00 GMT; Path=/; HttpOnly
    
    - Therefore, searching in Cookie e.g. for a cookie named "tyle" lead
      to a success as well as a search in Set-Cookies for e.g. a cookie
      named "Expires".
    
    The fixed version uses now two different parsers for these purposes,
    the regression test was extended.

M	nsd/cookies.c
M	tests/cookies.test

commit 97502ff00b6673de39271987723c7a7c31660b54
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-14

    - prefer ssize_t over int as result of read operations
    - use boolean values in expressions
    - reduce implicit conversions
    - use NULL for null-pointer assignments

M	include/ns.h
M	nsd/connchan.c
M	nsd/driver.c

commit b88f120c9a59e3a30e9a2b12ef265067d6f88d07
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-14

    - make sure that we clear the returned SSL_clx and free it, when
      Ns_TLS_CtxClientCreate() or Ns_TLS_CtxServerCreate() fails.
    - use for(;;) as idiom for endless loops
    - use UNUSED on more occasions

M	nsd/tls.c

commit 1f1e45ad3e492b77bf027cf80f01ba9ae804c1a2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-14

    - add comment
    - minor Tcl cleanup

M	tcl/sendmail.tcl

commit 0da46da153c871159320b1675effe988d66d0973
Author: Constantin Șerban-Rădoi <costashsrc@gmail.com>
Date:   2016-06-13

    Add Ns_TLS_CtxServerCreate and Ns_TLS_SSLAccept functions into tls.

M	include/ns.h
M	nsd/tls.c

commit 36c176455a6aa517a0c19d3aa564f66db47d3f44
Merge: 94a71c68 fe4b939d
Author: Constantin Șerban-Rădoi <costashsrc@gmail.com>
Date:   2016-06-13

    Merge upstream changes.

commit fe4b939d19d8a3569a4238426ac18c5140ce086b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-13

    - remove duplicated if-clause

M	nsdb/dbinit.c

commit 94a71c68fe8c7983dbb6bed7cf4ce67555ab6923
Merge: 76f9ee87 e58b257a
Author: Constantin Șerban-Rădoi <costashsrc@gmail.com>
Date:   2016-06-12

    Merge upstream changes.

commit 76f9ee879e7f99bdb9522e280f206942dec253ea
Author: Constantin Șerban-Rădoi <costashsrc@gmail.com>
Date:   2016-06-12

    Implement STARTTLS functionality for ns_sendmail command.

M	tcl/sendmail.tcl

commit e58b257a71ac1f91e835e1fd8e6b313a1848f6f2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-11

    - further bool cleanup

M	nsd/config.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/info.c
M	nsd/nsconf.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclresp.c
M	nsd/tclsock.c
M	nsdb/dbinit.c

commit 6eadbbd8611fdc5f3403f9ffbed6f9b231bdcec5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-11

    - add missing space

M	nscgi/nscgi.c

commit ba690aec1af46cac9e9f4b9a00e3237b30aac3cb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-11

    - add const declarations

M	nsd/adpparse.c
M	nsd/adprequest.c

commit 031c42de88342016af3dee1b563bb6d026195b39
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-11

    - use bool without extra operator

M	nsd/adpeval.c

commit 6457bc06c9fc1abfc50f61ca2ae2d7e824ce17fa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-11

    - don't't pass Boolean argument to equal or not equal operators

M	nsd/compress.c
M	nsd/config.c
M	nsd/connchan.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/index.c
M	nsd/info.c
M	nsd/log.c
M	nsd/nswin32.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/sched.c
M	nsd/server.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/sockfile.c
M	nsd/task.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tclresp.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsperm/nsperm.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit fca46a7f1eaa252fb8286e68d8a1d550c5f4dc3a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-10

    - improve error message

M	nsssl/nsssl.c

commit a42e110df81d16e428976512f71fbbeaa496e953
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-09

    - Fix ns_set management of headers (which was broken since the
      introduction of the leftover management when requests are
      pipelined). The problem was that the "static" ns_set for headers
      is needed in the driver (sockPtr->reqPtr->headers), since the driver adds header field to
      it) and of the connection connPtr->headers. Since the reqPtr in the
      driver releases the request quite early, the request headers might
      be freed before these were used in the connection run. The changed
      implementation makes a copy of the sockPtr->reqPtr->headers for the
      connection, which can manage it now freely.
    - New function Ns_SetRecreate() which is a combintion of a create and
      a move operation, but avoiding malloc operations on all keys/values.

M	include/ns.h
M	nsd/driver.c
M	nsd/queue.c
M	nsd/set.c

commit d73e6b9245db563fb4dd715dd5e90a65365d325a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - don't pass boolean to equal operator

M	nsd/tclhttp.c
M	nsd/urlspace.c

commit 3362fa1c421f44d4bd9a3459209a12df71fc52ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - reduce implicit conversions

M	nsd/event.c
M	nsd/info.c
M	nsd/tclmisc.c
M	nsd/uuencode.c

commit c399c803ed7157524e296573800da9f2f95bdbdc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - use bool instead of int

M	nsd/nsd.h

commit 588f2c67bc5bb9c1c3c6016d2dd2e0d7356dc560
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - adding const declaration

M	nsdb/dbinit.c

commit 3593b0275178341e1a71c5ac7883df406448ae4d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - don't pass boolean argument to equal

M	nsd/config.c

commit 0f520dda4c7ee49075426272300050f867ce04c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - add const declarations

M	include/ns.h
M	nsd/adpcmds.c
M	nsd/cache.c
M	nsd/conn.c
M	nsd/pathname.c

commit 8e09daa59d7e3a3318311542138767da89a9f268
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - pass boolean values

M	nsd/tclset.c

commit cfbff847edd45f73b9c7a18042ee07274d31017e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - shorten error handling cascade after Tcl_ListObjAppendElement()

M	nsdb/dbinit.c

commit 4b425ebcda4d0b10b21ca6a4eacba3ca4c1891aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - define storage class before type

M	nsd/mimetypes.c

commit 67ce3621ef2b8b691a0644576131e15b80f76535
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - move sanity check into debug mode

M	nsd/request.c

commit 13c794f4b46d0c566af25bc5f172e39ce54c1d90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - use boolean comparisons

M	nsd/op.c

commit f6b6b337ee898b143cdede21729147cb5a1aabff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - add reply headers to debug(request) output ... especially useful when debugging (false) result of vulnerability scanners

M	nsd/return.c

commit 190c7a566fbabad1c1c678b99a39c6588cc0d74b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - fix typo (many thanks to Cesáreo García Rodicio for reporting)

M	doc/src/naviserver/ns_return.man

commit 485129d544e90310da9db2ee01165ab755ad1109
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-08

    - fix typo (many thanks to Cesáreo García Rodicio for reporting)

M	tcl/fastpath.tcl

commit 614d548f9acf58ece34f9b0b4bbcf43bb2c679c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-06

    - fix stupid bug introduced in previous change 2276638

M	nsd/config.c

commit 3ecb984ae69b1431bc7dea358ce21697aa2ffa77
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-06

    - use "bool" as result of Ns_HomePathExists(), Ns_InfoShutdownPending(), Ns_InfoStarted(), Ns_InfoServersStarted(), Ns_EqualProc, Ns_EqualProc
    - use "for (;;)" as idiom for inifine loops
    - make conditionals boolean expressions

M	include/ns.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/crypt.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/info.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/returnresp.c
M	nsd/sls.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/str.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclfile.c
M	nsd/tclimg.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsd/urlspace.c
M	nsd/uuencode.c

commit 143477bdbce3e9df5df65bd302eaa8f9e39d9991
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-06

    - use type "bool" (rather than "int") in Ns_ConfigBool(), Ns_ConfigFlag(), and Ns_ConfigGetBool()

M	include/ns.h
M	nsd/config.c

commit 81364e9b6701a784d1725fee3e7266ccacfe5a5e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-06

    - adding const declarations

M	include/ns.h
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/connchan.c
M	nsd/crypt.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/nsmain.c
M	nsd/tclcache.c
M	nsd/tclmisc.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsdb/dbtcl.c
M	nsdbtest/nsdbtest.c

commit 8e1afeafb293e95482fb460c32bab1ab7ec12259
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-06

    - reduce boolean arguments to equal comparison

M	nscgi/nscgi.c
M	nsd/adpcmds.c
M	nsd/binder.c
M	nsd/conn.c
M	nsd/driver.c

commit 8c9460550bea3b8e95b6ea520d358ce1d8e31e5b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-06

    - reduce variable scope
    - make loop construct more clear
    - add const declaration
    - reduce implicit type conversions

M	nsd/conn.c
M	nsd/driver.c
M	nsd/tclconf.c
M	nsdb/dbinit.c

commit ad0572f97e306d1eee04bd02c4dea48d12bb7aee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-05

    - fix freshly introduced bug leading to TCL_ERROR in success case

M	nsd/tclconf.c

commit 88afadecb027e9a7739d220df0231ea8110914af
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-05

    - ignoring results explicitly
    - adding editor hints

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/dns.c
M	nsd/listen.c
M	nsd/nsmain.c
M	nsd/sockaddr.c
M	nsd/tclcache.c
M	nsd/tcljob.c
M	nsd/tclset.c
M	nsd/tcltime.c
M	nsd/urlencode.c
M	nsdbtest/nsdbtest.c

commit fa38447f9cad45b6cd04357cfaf812ff6ea0b3d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-05

    - handle result of Tcl_ListObjAppendElement() in most cases explicitly

M	nsd/adpcmds.c
M	nsd/connchan.c
M	nsd/form.c
M	nsd/tclcache.c
M	nsd/tclenv.c
M	nsd/tclvar.c
M	nsdb/dbinit.c

commit 1d7b16fa1d2bb4e6265e0d8ba44cbf2c7dcda73f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-05

    - ignore results explicitly

M	nsdb/dbtcl.c
M	nsproxy/nsproxylib.c

commit b5341d52583f1439e78439bd0edad5d3c8c98644
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-05

    - ignore results explicitly

M	nsd/adpeval.c
M	nsd/driver.c
M	nsd/log.c
M	nsd/return.c

commit 818b6946489b9538ca143e6caaa90f1c15519561
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-05

    - ignore result of Ns_SockTimedWait() explicitly

M	nsd/sock.c
M	nsd/tclhttp.c
M	nsd/tls.c

commit 170957c445f19a33b013fbb6e7a0ff2d332208a2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-05

    - ignore result of Tcl_SetVar2Ex() explicitly

M	nsd/tclmisc.c

commit ff694a8671f8d741370e8097ee2bd01123962807
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-05

    - don't ignore result of Ns_TclEnterSet()

M	nsd/conn.c
M	nsd/form.c
M	nsd/tclconf.c
M	nsd/tclhttp.c
M	nsd/tclset.c
M	nsd/urlopen.c
M	nsdb/dbtcl.c
M	nsproxy/nsproxylib.c

commit 3ff55fd7ca7f6881884d535c60a55a4c9e88a9df
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-03

    - make use of the 2nd argument of strtoll()

M	nsd/driver.c
M	nsd/range.c

commit 5f502e2f38f4f035d5660cc92a9ef948371da138
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-03

    - replace deprecated atoll by strtoll

M	include/nsthread.h
M	nsd/range.c

commit 2ef32f0d93f9ebc9d9bec80b6ce6a24a05a86a5b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-03

    - silence static checker

M	nsd/tclcache.c

commit a3e70a07941951a469cca47e7a1d976cd3fdb202
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-03

    - adding "const" declarations

M	doc/src/naviserver/ns_addrbyhost.man
M	doc/src/naviserver/ns_hostbyaddr.man
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/cache.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/pathname.c
M	nsd/tclvar.c
M	nsd/urlspace.c

commit cf672a03d1ff0ac62ea87ada973cd76406e3fa8e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-06-02

    - don't complain in errorlog when stat() is called on a file in a non-existing directory

M	nsd/fastpath.c

commit 181eb92dc4401c42957c2f21278f7439d835cbe4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-31

    - simplify code

M	nsd/dns.c

commit aae0303b428fd6394883ebd97b3d26fd295ebdfd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-31

    - protect against response splitting attack

M	nsd/request.c

commit f02f2ffecd26383fc4531509da8f18044228ae4a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-31

    - bump version number of nssock

M	nssock/nssock.c

commit 476d1327163c6bc7ae07227044bf3678474627c2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-23

    - remove ns_sha2 command in favor of more general crypto::md functions from OpenSSL

M	nsd/Makefile
M	nsd/nsd.h
D	nsd/sha2.c
D	nsd/sha2.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c
M	tcl/compat.tcl
M	tests/ns_sha1.test

commit fdebb6a635d900a7323ac8b93a9d6e62361e6356
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-22

    minor code cleanup
    - reduce implicit conversions
    - add parens
    - remove ignored comma

M	nsd/tls.c

commit abe661fbbe5f7b7378519dd6b7bb9acc564863de
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-20

    - fix typo in sample config file

M	openacs-config.tcl

commit 991e1b1491edc63036ce1665a9f0279fdcdf0d91
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-20

    - bump version number to 4.99.12d4

M	configure.ac

commit 6a906c9531c806bf8e78f4214addfa5dd6cb8d54
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-20

    - fix as well the commented out line for nsssl

M	openacs-config.tcl

commit 335e254520dbd1c80fb4e61fa80f9fc77fb9763a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-20

    - generalize and fix sample config file

M	openacs-config.tcl

commit c7e5c315698752fa54ecd25a14675247272d428a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-20

    - added same interface to crypt::hmac / ns_hmac as for crypt::md / ns_hmac.
      One can use now HMACs as well incrementally and on large files
      without bloat.
    - refactor crypto code a little to avoid more redundancy

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tls.c
M	tcl/crypto.tcl

commit aaa98785619ef058aae52761d27076d6da738be2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-20

    - add missing file

A	tcl/crypto.tcl

commit 4c0f4dc95f6380aa359aceff00eb64562d15e64d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-20

    - added crypt::md from OpenSSL (support a wide range of message digest
      algorithms), supports as well incremental commands
    - let Ns_HexString() return the character string (a pattern, used by
      many other character string commands as well)

M	include/ns.h
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c
M	nsd/tls.c

commit 8f476f2ef7029146193af963d59fe5acc235a1bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-19

    - factoring out GetString()
    - update documentation (replace ns_hmac_sha2 by ns_hmac.man, add hs_hmac to function list)

M	doc/src/naviserver/commandlist.man
R061	doc/src/naviserver/ns_hmac_sha2.man	doc/src/naviserver/ns_hmac.man
M	doc/src/naviserver/ns_md5.man
M	doc/src/naviserver/ns_sha1.man
M	doc/src/naviserver/ns_sha2.man
M	nsd/tls.c

commit 56c1af1b9a57bf8ec688a89fa1ff7d9c7224785b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-18

    - replace the HMAC computations based on sha2 by the more generic version from OpenSSL
    - provide backwards compatibility
    - adapt regression test

M	nsd/Makefile
D	nsd/hmac_sha2.c
D	nsd/hmac_sha2.h
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c
M	tcl/compat.tcl
M	tests/ns_sha1.test

commit 3469e64ad9f6adcc535e0e835aebb06895105033
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-18

    - add version dependencies for OpenSSL 1.0.0 and 1.1.0
    - return names of available MD algorithms in case of error (when supported by OpenSSL)

M	nsd/tls.c

commit 93f460904b60820eff38e84ea7efdda1ce964cf2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-17

    - add new ns_hmac implementation based on OpenSSL

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tls.c

commit e72dd7ee53053db9dcc5ee8726327fcbbc770b58
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-17

    - improve comments

M	nsd/form.c

commit 7d515b05ee89e6404489d96a00703680ec9bd316
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-15

    - minor code cleanup

M	nsd/driver.c
M	nsd/pathname.c
M	nsd/sockaddr.c
M	nsd/tclhttp.c
M	nsd/tls.c

commit cc9e86ecd38b7f5bb05795e9bd09109c08d8726a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-15

    - fix indentation

M	nsd/tls.c

commit 847cdae6be5c85f69bc289b4a24fab1d0cc047bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-13

    - nsssl.c: export Ns_ModuleVersion also when compiled without OpenSSL support

M	nsssl/nsssl.c

commit d4c4b8408f4404cbb631133ccce9c26b07d018d2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-13

    - add compilation support for --without-openssl

M	include/Makefile.global.in
M	include/ns.h
M	nsd/connchan.c
M	nsd/tclhttp.c
M	nsd/tls.c
M	nsssl/nsssl.c

commit 85c61337489ca3deace1aa9174bae691a84c098c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-12

    - bump version number to 4.99.12d3

M	configure.ac

commit fbb1156221a04d0da7aa1e742447b2a08323bf7e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-12

    - add man page for nsssl

M	nssock/doc/mann/nssock.man
A	nsssl/doc/mann/nsssl.man

commit 84c6d7a8306b7b0d730b97964ea740e5e0a20d04
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-12

    - add nsssl to the list of subdirs

M	Makefile

commit 20a1595625b932dd1db6e902cec72d14d22ab85d
Merge: 9474c4eb d7dc5b9a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-12

    - merged nsssl into naviserver repository

commit 9474c4ebea936a2f6b3d6e59479f929580324bbb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-12

    moved nsssl content to nsssl directory (part of merge)

R100	ChangeLog	nsssl/ChangeLog
R100	LICENSE	nsssl/LICENSE
R100	Makefile	nsssl/Makefile
R100	Makefile.win32	nsssl/Makefile.win32
R100	README.md	nsssl/README.md
R100	dhparams.h	nsssl/dhparams.h
R100	nsssl.c	nsssl/nsssl.c
R100	tests/all.tcl	nsssl/tests/all.tcl
R100	tests/config.tcl	nsssl/tests/config.tcl
R100	tests/etc/openssl.cnf	nsssl/tests/etc/openssl.cnf
R100	tests/modules/testhttps.tcl	nsssl/tests/modules/testhttps.tcl
R100	tests/nsssl.test	nsssl/tests/nsssl.test
R100	tests/pages/123	nsssl/tests/pages/123

commit d7dc5b9a76900bb66e6dad681f8ff8a61000baba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-12

    Minor code cleanup
    - reduce implicit conversions
    - add const declarations
    - add parens

M	nsd/tclhttp.c

commit 7eff0f0005f9f8a407141bf31602c8304332a297
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-12

    - removed shadowed variable

M	nsd/connchan.c

commit ea19088ecf1f65752ac930c3b845d99501e8a594
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-11

    Cleanup:
    - remove Ns_TaskProc HttpsProc (since included already in ns_http)
    - make use of ns_http instead of ns_ssl in regression tests
    - update README

M	Makefile
M	README.md
M	nsssl.c
M	tests/modules/testhttps.tcl
M	tests/nsssl.test

commit e1befe833de5d3b0e5e18d3b74c0962f697086e6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-11

    - include https documentation in ns_http command

M	doc/src/naviserver/ns_http.man

commit 536653898b7a55516fe32a9fb3fc1ae64df1d9fd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-11

    - remove redundant word OpenSSL (since this is included in the message)

M	nsd/tls.c

commit b4ac1e3cddb3a257db0e7203ac9c7ae7f4fbf866
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-11

    - provide a deprecated stub-function for ns_ssl to provide backward compatibility for the migration

M	tcl/http.tcl

commit a8bbd55e28461aa5f9f9b78f53f15f9768d4075a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-11

    - bring options into an alphabetical order

M	nsd/connchan.c

commit ac94876ec1d877927999e175e2fec5934d0824ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-11

    - reflect latest changes in regression test

M	tests/ns_conn.test
M	tests/ns_info.test

commit 24625c930c466698c3e8b97a511fe9b27f4825f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-11

    - make testing more robust, when IPv6 is available, but turned off by the kernel

M	tests/test.nscfg

commit 2c10938ba4d72136b82a9d020b9dbd29db308fa1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-11

    - remove debugging output

M	nsd/tclhttp.c
M	nsd/tls.c

commit bc133c48a811b73f836a6c1f64657901f31af21a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-10

    - added subcommand [ns_info ssl] to indicate, if the binary was compiled with OpenSSL support.
    - updated documentation

M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_info.man
M	nsd/info.c

commit 9b506fa8d82dece872024b2cbc0c35ae9fb18c06
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-10

    - adapted to OpenSSL reform

M	nsssl.c

commit 89e3eea6b0138fa3f36e41b865b2fd984aa4b064
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-10

    OpenSSL reform (part 2)
    - refactored tclhttp.c and nsssl.c, such that ns_http can handle
      both, http and https
    - https client requests can be used now also, when nsssl driver
      is not loaded.
    - nsssl.c can be now substantially reduced by removing all
      Ns_Task stuff, not done yet
    - simplified request line construction in NSDriverClientOpen()
    - renamed Ns_TLS_CtxCreate() -> Ns_TLS_CtxClientCreate()
    - renamed Ns_TLS_SSLCreate() -> Ns_TLS_SSLConnect()
    - renamed Ns_DriverInitData.defport -> Ns_DriverInitData.defaultPort

M	include/ns.h
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/tclhttp.c
M	nsd/tls.c
M	nssock/nssock.c

commit ccd4475ed5e22c4661f81b90caebe76056d69de0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-09

    - fix variable name in Makefile for LD_LIBRARY_PATH under fakeroot (Many thanks to Héctor Romojaro for the fix).
      There is still the problem that a "make test" runs against installed binary when rpath is set

M	Makefile

commit 16ce06657d0c4e1730b7a730a0f8f8f4e8e164a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-09

    - adapted to OpenSSL reform (NaviServer 4.99.12d2)
    - bumped version number to 2.0

M	Makefile
M	README.md
M	nsssl.c

commit 7a5bdf163397ff55c77efbea3c4cf3d2c67bbfdd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-09

    OpenSSL reform
    - provided --with-openssl?=path? option to configure
    - new functions NsOpenSSLInit(), Ns_TLS_CtxCreate() and
      Ns_TLS_SSLCreate() to provide reusable SSL/TLS support.
    - new abstract types NS_TLS_SSL_CTX and NS_TLS_SSL
      (also available, when no OpenSSL support compiled in)
    - removed Ns_ClientConnectionContext introduced by last patch
    - adapted connchan and nsssl to new structures
    - bumped version number to 4.99.12d2

M	configure.ac
M	include/Makefile.global.in
M	include/ns.h
M	include/nsconfig.h.in
A	m4/openssl.m4
M	nsd/Makefile
M	nsd/connchan.c
M	nsd/init.c
M	nsd/nsd.h
A	nsd/tls.c

commit a661e9ff7f5e4095ac48c38a28195f74a767525e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-09

    - added editor hints

M	nsd/compress.c

commit e726611384e14fc638b36e4f0617cc47b3a0fc0a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-09

    - add parens
    - use usual comment style

M	nsd/form.c

commit 51de0e593899c8173aa237c6def94f069ca5a8b2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-09

    - reducing variable scope
    - adding const declaration
    - reduce implicit conversions

M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h

commit 255a8f7d04e4695f25fe4939b4438593c1051d80
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-07

    - Provide information for driver version 4
      (clientInitProc, protocol and default port)
    - refactor code to be useful for Https task and
      client driver sockets

M	README.md
M	nsssl.c

commit d1bc517383e00842eae0a4c35078ccc773573f6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-07

    Adding support for ns_connchan to handle https connections
    - support for client functionality of
      non-plain-text protocols requires initialization of
      connection, which in turn requires parameterization.
      Therefore,
         - a new proc Ns_DriverClientInitProc can be registered
           to the drivers
         - the parameters have to be passed to the client
           init proc via a fixed api. For this
           purpose, Ns_ClientConnectionContext was introduced
    - let driver provide a protocol string (like e.g. "https", or "udp")
      and a default port via Ns_DriverInitData
    - bumping driver version to 4

M	include/ns.h
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h
M	nssock/nssock.c

commit ed58894b6f7a9c0d95f503fd5a0e6ac5c4b60b93
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-07

    - bump version number to 4.99.12d1

M	configure.ac

commit 2cb4aa17a3818f4dc1e95971be74f5926215b287
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-06

    - fix man page (this fix is as well necessary for reproducible builds)

M	nsproxy/doc/mann/ns_proxy.man

commit c49741dd77ba9e936ff8f7db667971b979473bf6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-06

    Extending ns_connchan to support http-client functionality via driver
    channels. The new subcommands could be used for tcl-clients as well
    for tunneling incoming requests (should also be suited for tunneling
    web sockets).
    
    Current limitations: In the current state, the SSL-initialization for
    https is missing, client-connections are forced to HTTP/1.0.
    
    Details:
    - new subcommand "ns_connchan open ?-method m? ?-headers h? ?-timeout t? /url/"
      Open a client connection and send request line and specified
      headers
    - new subcommand "ns_connchan exists /channel/"
      Check if the specified channel exists
    
    - Made naming of static functions more regular:
      * FreeRequest() renamed to RequestFree()
      * SockPrepare() renamed to RequestNew()
      * factored out SockNew(drvPtr);
    
    - new debug severity Debug(connchan)

M	nsd/connchan.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sock.c

commit 1e159bda815b715c206a56a177209b68a67c9507
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-05

    - fix typos

M	nsd/pathname.c
M	nsd/progress.c
M	nsd/queue.c
M	nsd/sockaddr.c
M	tests/ns_hashpath.test

commit 77ee8e6257be9a73313d02755b0fa709df0bc6e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-05

    - use ns_send instead of send

M	nsd/tclsock.c

commit 2fecd5ad2e335ccf169d8131cc67757e107276d9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-03

    - handle .gzip (and .tgz) like .gz

M	nsd/mimetypes.c

commit 5fb04fcc6afb67650490efe4c915993b89aece23
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-02

    Added tag naviserver-4.99.11 for changeset 78dc7c7de219

M	.hgtags

commit 65431a654a16381e90a546a5826eaba26ebf5d8d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-02

    - commit NEWS
    - bump version number to 4.99.11

M	NEWS
M	README
M	configure.ac

commit 52fcbd97ee1d6b49ef0f03edd59a09a98f75573c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-05-01

    - provide more detailed error messages in case corking fails

M	nsd/sockfile.c

commit 5a1080d7dff1a352ae1bd79616955a5eaff7f93f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-29

    - form-parser: guard plain content parsing by checking, if the content type contains www-form-urlencoded. Otherwise a POST request where the content is no form might lead to strange results, when [ns_getform] is used.

M	nsd/form.c
M	tcl/form.tcl

commit fc8ad66beded2384e03f0eb7b8d4a25ddad69933
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-28

    - minor code cleanup (adding parens, removing implicit conversion)

M	nsd/dstring.c
M	nsd/fastpath.c
M	nsd/tclhttp.c

commit 9f9396dfbba20240151015142fda954d85c2e87d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-26

    - bump version number to 4.99.11b2

M	README
M	configure.ac

commit 5499b9a4963db20a1442aac5bebd90c849c77ed6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-26

    - fix whate-space that breaks documentation generation

M	doc/src/naviserver/ns_http.man

commit 78bdeab2893b9ef6986ab9349a947f38bb936c1f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-26

    - curon needs (at keast under linux) the "-g" flag to accept IPv6 addresses

M	tests/http.test

commit 263080e6f225664cb1af0a656e5cecb0ac20e7fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-26

    - testserver: making response parser more robust by requesting more data, when not enough content is available

M	tests/testserver/modules/client.tcl

commit 8a8627b7f3da43cbb1fa5c171c7bde788fd7cf4b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-26

    - adjust re-use limit for request buffer to power of two

M	nsd/driver.c

commit 6b1a601cea1fad748ba1f06d7e1df639a44293c1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-26

    - reduce memory hunger on large request buffers and potential memory leak.

M	nsd/driver.c

commit efde54038f239b878afd83e636950b79004b9d88
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-26

    - prefer lowercase CONST

M	nsd/progress.c

commit a7fcffa431c640c6d205a662eea029cb5756b52d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-26

    - make sure to clean output headers

M	nsd/tclhttp.c

commit dcb3ca0804bd63a74907b22bb6f8d5e149a0dad5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-24

    - use constant CHUNK_SIZE instead of hard-wired number and explain background

M	nsssl.c

commit 18051ca62503d2d38941a6d91b3d7ce1339e85e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-24

    - bump version number to 4.99.11b1

M	configure.ac

commit 5d3dc21e2da05d075037ac0066212e1e2dfc66c9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-24

    - factor out Ns_DStringAppendPrintable() from driver.c and move it to
      dstring.c
    - prefer lowercase unsigned suffix

M	include/ns.h
M	nsd/driver.c
M	nsd/dstring.c

commit 0170cf1d73b2f77c8b01165c5fd7d5509fb803ca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-23

    Whitespace changes:
    - in all tcl files: replace tabs by spaces, add editor hints to avoid tabs

M	nsd/init.tcl
M	nsdb/util.tcl
M	nsperm/compat.tcl
M	nsperm/htaccess.tcl
M	nsperm/init.tcl
M	tcl/aolserver-openacs.tcl
M	tcl/cache.tcl
M	tcl/charsets.tcl
M	tcl/config.tcl
M	tcl/fastpath.tcl
M	tcl/form.tcl
M	tcl/init.tcl
M	tcl/nstrace.tcl
M	tcl/sendmail.tcl
M	tcl/util.tcl

commit c8ac4436046012c3bf4c191be33778630d045aae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-23

    - minor editing

M	nsd/queue.c
M	nsd/tclmisc.c

commit f4edb9a8f3abf85b5e4a9eeb83c5e393bf740ec5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-23

    - add common copyright stanza

M	nssock/nssock.h

commit 12400ad6549a720512255e3807a87f277505ab3c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-23

    - added a man page for ns_hmac_sha2
    - updated cross references of related pages

A	doc/src/naviserver/ns_hmac_sha2.man
M	doc/src/naviserver/ns_md5.man
M	doc/src/naviserver/ns_sha1.man
M	doc/src/naviserver/ns_sha2.man

commit fe2f00a0fec125e0487031cc3ade9507b6369d63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-22

    - terminate argument list of Tcl_AppendResult properly with NULL

M	nsssl.c

commit 84a3736301ebe9bd20173987b2ea4865f47bbeee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-22

    updates for "-body_file" for ns_http:
    - updated documentation
    - improved error message
    - extended regression test

M	doc/src/naviserver/ns_http.man
M	nsd/tclhttp.c
M	tests/http.test
A	tests/testserver/pages/123

commit 7398ba518e123857efb8654f69b143574d7cddef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-22

    - updated documentation
    - improved error message
    - extended regression test

M	README.md
M	nsssl.c
M	tests/nsssl.test
A	tests/pages/123

commit de1757d170bd69a94f30c678e750ee7ac1021a3a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-22

    - add parameter -body_file to ns_nsssl to specify a file for
      transmission (doc updates are still missing)
    - add nonnull annotations

M	nsssl.c

commit f5067e9e775c8e92df34ba404bbca2e70c758652
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-22

    - remove unneeded line

M	nsd/tclhttp.c

commit e07d95ce209827a33fa83eb06158c4285bc61baa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-22

    - expose FastStat() from fastpath.c as Ns_Stat() to make it reusable
      in other file.
    - add parameter -body_file to ns_http to specify a file for
      transmission (doc update and ns_ssl is still missing)
    - prefer lowercase u as unsigned suffix

M	include/ns.h
M	nsd/fastpath.c
M	nsd/tclhttp.c

commit 704920519b495f0b69a3c53568c1122a0da2c3e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-21

    - ns_getcontent: new function (somewhat similar to ns_getform), which
      gets the transmitted content from a request.
      Background: when upload spooling is activated, the [ns_conn content]
      might be empty, but the content might be provided as [ns_conn contentfile].
      The contentfile is always binary, while [ns_conn content] might
      return the content binary or not depending on its flags. The
      function ns_getcontent was introduce to reduce the burden of an
      application developer to handle spooling/nonspooling binary/nonbinary
      content multiple times.

M	tcl/form.tcl

commit 1421222211193cfed8c910f6edf842436879b3f7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-21

    - remove debug comments (//-comments)
    - bump version number to 11a5

M	configure.ac
M	nsd/binder.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/form.c
M	nsd/queue.c
M	nsd/sock.c
M	nsd/sockaddr.c
M	nsd/tclhttp.c

commit 25037dd4b719fc1874f1cbfc97d1a1cd20667aa1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-20

    - make NS_TCL_SET_STATIC and NS_TCL_SET_DYNAMIC an enum
      (Ns_TclSetType), since the values are mutual exclusive
    - Set the last argument of Ns_TclEnterSet to type Ns_TclSetType
    - Remove misleading documentation about NS_TCL_SET_STATIC and NS_TCL_SET_DYNAMIC

M	include/ns.h
M	nsd/tclset.c

commit f42d90945a1099dfa1fd88958b7c3ecbe3b57eac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-20

    - provde more information what ns_cleanup does

M	doc/src/naviserver/ns_set.man

commit 53ec6337be8b464f7905cdff15f7a74c4fd7032b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-19

    - make NsHexString configurable for upper and lowercase
    - use lowercase hex strings for ns_*sha2 functions
    - add test cases for ns_hmac_sha2

M	include/ns.h
M	nsd/tclmisc.c
M	nsperm/nsperm.c
M	tests/ns_sha1.test

commit 0ea5aec38b02ff3a8d77ef50128970c69c3e6fcc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-18

    - rename function Ns_CtxString() to Ns_HexString()
      to make it easier to understand its intention.
    - provide source code documentation for Ns_HexString()

M	include/ns.h
M	nsd/tclmisc.c
M	nsperm/nsperm.c

commit 5a923c7f5226934ab223f989d4542490ce5525c1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-18

    - reduce implicit sign conversions
    - don't loose const declarations via cast

M	nsd/tclmisc.c

commit f9cf660a63bfaca641c1f69c6c77c38cf5e42645
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-18

    - fix Makefile entry

M	nsd/Makefile

commit 6e37085652b8c11bb395447cf66802aa114c3be0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-17

    - new command implementing Hash-based message authentication code
      (based on sha2): "ns_hmac_sha2 ?-length L? /key/ /message/"
      The crypto-code is from https://github.com/ogay/hmac

M	nsd/Makefile
A	nsd/hmac_sha2.c
A	nsd/hmac_sha2.h
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c

commit b8a82d0fe8bebb0b67cf3188484d378b477b3a09
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-17

    - ns_sendmail:
      * provide new interface based on non-positional arguments
      * mark old interface based on positional arguments as deprecated
      * update documentation

M	doc/src/naviserver/ns_sendmail.man
M	tcl/sendmail.tcl

commit 5df3d76fe8d39d0f2ac0f99849d579a15d48b59a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-17

    - improve debug messages

M	nsd/driver.c

commit a6744d327515cf86ead9905cb7992f2f240f14b3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-17

    - update ns_sha2 tests to include -length 224

M	tests/ns_sha1.test

commit 885a8c11d9b142d20f545f72a951268087ce3e93
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-17

    - Make driver i/o-functions reusable via shared library
    - the library contains the following functions
        Ns_DriverListenProc
        Ns_DriverSockAccept;
        Ns_DriverSockRecv;
        Ns_DriverSockSend;
        Ns_DriverSockClose;

M	nssock/Makefile
M	nssock/nssock.c
A	nssock/nssock.h

commit 994ea558987dbaf9126b811da3773ebf320c1f0c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-17

    - resurrect handling of non-HTTP drivers (having drvPtr->requestProc set)

M	nsd/driver.c
M	nsd/queue.c

commit 3bfe8df7a985fba2a8d7b3c2a0a52b24bac9fa22
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-17

    - fix comment

M	nsd/conn.c

commit d0f79f3c8c8c019defef6d35818a6b1c6adf3f04
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-15

    - update documentation for ns_sha2

M	doc/src/naviserver/ns_sha2.man

commit 79a9cf4b088b8e552f610f85d8f59c9dc76c3c5f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-15

    - use implementation of sha2 from Olivier Gay <olivier.gay@a3.epfl.ch>
    - add option "-length 224"
    - updated regression test

M	nsd/sha2.c
M	nsd/sha2.h
M	nsd/tclmisc.c

commit a281dfe3177feeab9edbcb05802bf13b3965e5eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-15

    - fixed ns_sha2 hex computation

M	nsd/tclmisc.c
M	tests/ns_sha1.test

commit e26656ee1594b301bc1089c8b50de93c8b0f6650
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-15

    - adding man page for ns_sha2

M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_sha1.man
A	doc/src/naviserver/ns_sha2.man

commit 67f3a10f4d0fb7ff5a236c461b3debd60f4d50ce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-14

    - added new command "ns_sha2 ?-length length? data" based on the SHA2
      implementation of Aaron Gifford
      (http://www.aarongifford.com/computers/sha.html)
    - extended regression test

M	nsd/Makefile
M	nsd/nsd.h
A	nsd/sha2.c
A	nsd/sha2.h
M	nsd/tclcmds.c
M	nsd/tclmisc.c
M	nsproxy/nsproxymod.c
M	tests/ns_sha1.test

commit 82f54ee88d41f976d9030c5539ffea3cf80167ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-14

    - improve error message

M	nsd/sockaddr.c

commit 2e8848202bbb1a8abc490cd11343b4d22464d0d6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-14

    - improve error message

M	nsd/driver.c

commit 5b09d34e8941875e51853a2f285b21ec83a85cad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-14

    - white space change

M	nsdb/nsdb.c

commit dd2990b768f413fdfe67734932838738d4f3273d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-14

    - white space change

M	include/nsthread.h

commit b6f8e422f2154b3c6c82220c21dcb3d13b74d1a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-13

    - use type Ns_TclTraceProc for functions registered voa Ns_TclRegisterTrace()

M	nsssl.c

commit daf158a748d501e14e09192b3b0e3a0d0e56d25b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-13

    - use typedef Ns_ModuleInitProc for Ns_ModuleInit()
    - bump version number to 1.0

M	README.md
M	nsssl.c

commit 8bfb0d64e9f57afabba5d12e4cc05d2e04726160
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-13

    - use typedef Ns_ModuleInitProc for Ns_ModuleInit()

M	nscp/nscp.c
M	nsdb/nsdb.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxymod.c
M	nssock/nssock.c

commit bf92947494627b9bcb0d96b61a846cb0c0778299
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-11

    - provide sample config file for openacs for IPv4 and IPv6

M	openacs-config.tcl

commit d2d53f2592c9ed695f8174272c6f2b6f1c56afa5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-11

    - LogBuffer(): better handling of chars > 127
    - reduce implicit conversions
    - reduce variable scope
    - add parenthesis

M	nsd/connio.c
M	nsd/driver.c
M	nsd/filter.c
M	nsd/queue.c

commit a2901067067af051f25f2a4fdd834e7af7339f10
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-11

    - avoid sign extension

M	nsd/driver.c

commit 52779f3497b0959d079abbf77285d6daafbacf40
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-09

    - reduce verbosity

M	nsd/queue.c

commit 26bee830c7e231581946fe0c78f2c21fa7e7ffa5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-09

    - prefer lowercase unsigned suffix

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/cache.c
M	nsd/compress.c
M	nsd/cookies.c
M	nsd/encoding.c
M	nsd/event.c
M	nsd/exec.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/progress.c
M	nsd/queue.c
M	nsd/random.c
M	nsd/range.c
M	nsd/returnresp.c
M	nsd/sls.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsd/url2file.c
M	nsd/urlopen.c
M	nsd/uuencode.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdbtest/nsdbtest.c
M	nsperm/nsperm.c
M	nsthread/mutex.c
M	nsthread/reentrant.c
M	nsthread/rwlock.c
M	nsthread/thread.c
M	nsthread/winthread.c

commit 92583ff26f37d5f63eae36f8d0ad4569043512d2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-09

    Driver reform:
    - implement leftover management for persistent connections
    - some (newer?) clients (e.g. under iOS) send sometimes multiple
      HTTP requests in a single chunk of data (i.e. arriving in a
      single recv() operation), which is certainly allowed
    - until now, NaviServer (or AOLserver) just processed the first
      request of the reveive buffer, ignoring the reminder, causing
      missed (hanging) requests or invalid followup requests.
    - The new version handles such situations correctly-
      As a consequence, the receive buffer management (and the
      livecycle of request buffers and structures) had to be
      reworked, since the reveive buffer was cleared after every
      request and bound to the Sock structure. In the new version
      the parsed requests (struct Ns_Request) is part of Ns_Conn
      and Ns_Sock and Request to decouple connection thread
      concerns from driver concerns and to allow concurrency
      (reveived more bytes in a pipline while a connection
      thread is working already on the first requests)
    - Extended the testing infrastructure to simulate requests
      arriving in multiple chunks (new file tests/testserver/modules/client.tcl)
    - De-spaghetti driver code, remove obsolete code.
    - Improve source code documentation
    - Improve more error logging, report errors in more error conditions
    - Prefer bool over int variables for logical variables
    - Extend regression test to including buffering cases in http/1.1
    - Bump version number to 4.99.11a4

M	configure.ac
M	include/ns.h
M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/queue.c
M	nsd/request.c
M	nsd/return.c
M	nsd/tclmisc.c
M	nsd/tclsock.c
M	nslog/nslog.c
A	tests/http_persistent.test
A	tests/testserver/modules/client.tcl
A	tests/testserver/pages/1
A	tests/testserver/pages/2
A	tests/testserver/pages/3

commit 84c61bc7bba034620bc5dc8e797bc6015fa66d0f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-08

    - improve documentation

M	doc/src/naviserver/ns_log.man

commit 0bea863a59f04af478fe8af5f65139a327c18b15
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-07

    - provide better visual separation between test items
    - avoid eval

M	tests/http_chunked.test

commit 5d29cb7e92485dda49e369754f1bdc5e6dc7e6bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-07

    - improve spelling

M	doc/src/naviserver/ns_log.man

commit 1cb0caeab3f1b2404753e7d4a1911486ce2a0e4b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-04-07

     - improve formatting of man page

M	doc/src/naviserver/ns_sockselect.man

commit 596351f76ad8bd8f5b98be820d655fb184ac49d9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-29

    - improve comments

M	nsd/log.c

commit 8e18028c4d9a0df771fe7d4468792301e43af16c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-29

    - fix typo

M	nsd/driver.c

commit c0395fb6904c4fbea09cc99e5b92eb96db4f1752
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-29

    - add nonnull asserts and document (strange) argument list for Ns_ModuleLoad() in NsDbLoadDriver()

M	include/ns.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/modload.c
M	nsdb/db.h
M	nsdb/dbdrv.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxymod.c
M	nssock/nssock.c

commit 5705d965142d019d164dff7ed5b613185fa11b7f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-29

    - relax gcc6 test, since gcc6 behavior is apparently fixed

M	include/nscheck.h

commit c39190f8df063503dea1a7effc73ecc80cf146ef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-26

    - keep query parameter after directory induced redirect in fastpath
      (bug report of David Osborne in the NaviServer list)
    - setting 2nd argument of Ns_OpProc to nonnull

M	include/ns.h
M	nsd/adprequest.c
M	nsd/fastpath.c
M	nsd/tclrequest.c

commit 770058188db088fd0c013a60f14ea7c8f121129b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-25

    - deactivate request debugging in nsd-config.tcl

M	nsd-config.tcl

commit 9606f584350f0c35a0c0e862ee2a421adce6bef8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-25

    - undo clearing optimization of last commit

M	nsd/request.c

commit 6416175e3ac0a021662f53d3ea2802f53d644e4e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-25

    - added severity Debug(request) to receive in the log file entries for
      begin and end of requests (useful especially for concurrency of
      long-running requests.
    - added non-null constraint for Ns_ResetRequest() since this function
      is intended to be called always on embedded structures.
    - improve source code documentation
    - added nonnull asserts to ChunkedDecode()

M	include/ns.h
M	nsd-config.tcl
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/request.c

commit d63cc55a1e6b98e26af62b01db667c307cae5a9f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-25

    - added target: "lldb-sample" to ease calling the sample config under lldb

M	Makefile

commit 90ffd95b0ef50b744e6a8d70831937834e6fe9d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-25

    - define NONNULL for NsFreeRequest

M	nsd/nsd.h

commit e636e2891951e9441f9952f243e670180e5a1593
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-25

    - call NsFreeRequest only when reqPtr not NULL

M	nsd/queue.c

commit 74a6666fab481932ce77c04c0c8c1a893c9db8b8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-25

    - remove redundant definition

M	nsd/mimetypes.c

commit 357b8626abfde94773bbce55d3e250b38cd3421c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-25

    - minor improvements

M	nsd/sock.c

commit da30cdc6f3557d90c90c5b469c903886d7db7477
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-25

    - prefer dsPtr over ds + address operator

M	nslog/nslog.c

commit 2c9a04f3b4e3dfff1a72947c8e082ca225437efb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-20

    - added likey/unlikey hints for the compiler
    - add comment lines
    - improve man page

M	doc/src/naviserver/ns_log.man
M	nsd/log.c

commit 29c9a96240a8d4e104a390e4b56aea6a6dad111a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-19

    - fix encoding problems in ns_parseformfile

M	tcl/form.tcl

commit 5deb1e863d6b48ded0f37c2aaff8e4d123b29838
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-18

    - lowercase mime types, since mime types are case insensitive (http://tools.ietf.org/html/rfc2045)

M	nsd/mimetypes.c

commit de831a5230f08c6e6c29d59a811b48b0ca8a66b3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-18

    - add parens

M	nsd/conn.c

commit 5e672b1396858219bf33547147333cef3375703d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-17

    - remove hack to map POST requests into GET requests for large uploaded content, since it (1) confuses applications querying the HTTP method and (2) it is apprarently not necessary any more.

M	nsd/driver.c

commit c0b2edf242d838da36e1f25437ae4c27f7a67584
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-17

    - completing mimetypes according to http://www.iana.org/assignments/media-types/media-types.xhtml

M	nsd/mimetypes.c

commit 471240093ec1cea5560808ceefd710f5f2ceaff1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-15

    - Add support for HTML5 file attribute "multiple":
      HTML5 allows for uploading multiple files under the same INPUT name.
      Previous version of NaviServer just accepted the first file with the
      given name.
    
    - Consequences:
      1) the following support functions
           [ns_conn fileoffset $name]
           [ns_conn filelength$name]
           [ns_conn fileheaders $name]
         return for the specified name potentially a list of values instead
         of scalar values
      2) The ns_set returned by [ns_getform] will contain multiple
         entries for the file, as well multiple entries for $name.tmpfile
         and $name.content-type

M	doc/src/naviserver/ns_conn.man
M	nsd/conn.c
M	nsd/driver.c
M	nsd/form.c
M	nsd/nsd.h
M	tcl/form.tcl

commit 6911c72dd3de57392b520e8042e81230d8e2b34b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-15

    - improve comment

M	nsd/returnresp.c

commit 776f8461c52be3e6ddc90db2077f3d0ac68185eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-15

    - prefer boolean value over 0/1

M	nsd/log.c

commit d102f34aa925aba28b3edcff8cc85a1161cfaf6c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-15

    - Ns_SockaddrSameIP(): new function for testing, if two IP addresses are equal

M	include/ns.h
M	nsd/sockaddr.c

commit f108bfe0bdfbac9613da88bfc2b33287c7286d91
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-15

    - prefer lowercase number suffix

M	nsd/tclset.c

commit f1a0c46cd1a126fb1450950bd23e4f9a8dce7b1f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-14

    - bump version number to 4.99.11a3

M	configure.ac

commit 2d497275d8f9475d22efcedc5c3006dc07deda04
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-14

    - align style and logo of default web server configuration with style of man pages
    - improve validity of HTML

M	contrib/examples/index.adp
M	index.adp

commit 03c186c697a976b07743ff08a7da22fda73b4c42
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-14

    - improve error handling: return "invalid method" instead of "file not found" when method is invalid
    - new function Ns_ConnReturnInvalidMethod()
    - new function Ns_HttpLocationString() to unify generation of host and location strings
    - removed unused sockstate SOCK_SERVERREJECT
    - provide better driver debug messages to list more interesting cases, improve provided context in debug messages
    - SockSetServer(): align documentation with actual behavior, fix return value
    - prefer lowercase "u" suffix
    - add nonnull asserts
    - extend regression test

M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/returnresp.c
M	nsd/tclhttp.c
M	tests/http.test

commit 7f8e953cde6f967773f5ad0184ac40eca3da65cb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-14

    - fix typo in comment

M	nsd/server.c

commit 51d23232de17c2e5ad32c3f5bf28bb7dc951cba5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-14

    - Ns_ParseRequest(): provide better error messages for invalid requests (instead of
      assuming HTTP/0.9 in most cases and handle cases silently)
    - delaying cleanup of struct Request in error situations to be able to provide better error messages
      (in most cases NsFreeRequest() handles now success and error cases)
    - improve source code documentation

M	nsd/request.c

commit 23bfe9276a7ec85af973d5bb68d5af3a07d664d6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-14

    - add sample debug statements

M	nsd-config.tcl

commit 40a7cb1a9ecfaa7abbba46a7fec50e677ba86514
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-13

    - fix typo

M	doc/src/naviserver/ns_register.man

commit 01b306302ccdeddebb53a9ddaf67572a53bdf2a1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-13

    - improve validity of returned HTML

M	nsd/returnresp.c

commit 2d05f3e83cf55208eb0d5cee2be85a027d6ae305
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-13

    - prefer IP-literal notation

M	nscp/nscp.c
M	tests/testserver/modules/testhttp.tcl

commit f6c833d1aabec16e47d9e7617f0ff66d91211a9e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-06

    - pass consistently NULL to time() (instead of "0")

M	nsd/httptime.c
M	nslog/nslog.c

commit 3e4376767b03a7a9e96c267f4cc99a08698d4bb3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-06

    - include peer address in error message about invalid requests to ease debugging
    - single error message for SOCK_BADREQUEST and SOCK_BADHEADER sufficient

M	nsd/driver.c

commit 299c5e712c1904ed1f340c4e3d38efc9b42abb6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-05

    - fix documentation bug

M	doc/src/naviserver/ns_cookie.man

commit 00bedf3f19d300e338e7e0113f1255ff7f30dc9a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-05

    - listen in sample config file on every IP address, not only on loopback. This has the advantage, that when listening on ipv6, the urls in the dirlisting (based on host) work, even when they are IPv4 addresses.

M	nsd-config.tcl

commit c63802c636277a0754fb6af17c753e7b9382f10d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-04

    - add more comments
    - prefer boolean over 0/1 coding

M	nsd/log.c

commit aece2a0a52918d1ff7def2b8cc6e7548f4206f05
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-03

    - don't ignore all SOCK_READERROR since it is possible to swallow error conditions
    - improve of signaling close from peer by clearing the errno (and return -1 as before)

M	nsd/driver.c
M	nsd/sock.c
M	nssock/nssock.c

commit 8956f36d594af198c4bd0eda87a1f3c88d88640a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-03

    - handle EAGAIN as SOCK_MORE

M	nsd/driver.c

commit 9ab2020d3fdc7390f0457c7f916be5576d384f52
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-02

    - report driver generated replies in the error.log (access log would be better)

M	nsd/driver.c

commit d83bc7cf5740f7f3b86684c9214332e14ab18018
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-02

    - prefer boolean results over 0/1

M	nsproxy/nsproxylib.c

commit 2c06228763446b2ea81d90841c5540f768cc34fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-03-01

    - hide man page of ns_limits, since the command is in premature status

R100	doc/src/naviserver/ns_limits.man	doc/src/naviserver/ns_limits.man-retracted

commit 15d1d960ccaa6d5c0d285514dff9b2c08a3d7f05
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-29

    - a failed reverse lookup is normally not an "error", but just worth a "notice" in error.log

M	nsd/dns.c

commit b2e23af390f06f09bd01cc5a83fc68a6462f6b1c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-28

    - make sure that the local and of a SockConnect is of the same address family as the remote end

M	nsd/sock.c

commit 947a5986ac5aed4b9441331d0ddde6eb3beb1ebe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-28

    - set maxupload in OpenACS sample config file

M	openacs-config.tcl

commit fba8a2da3df3ee9f08f0ae3bf634d73d24b60b7c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-28

    - fix typo in comment

M	nsd/url.c

commit 622f5df7b7422ac6110a360fcd45bf876688c70e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-28

    - improve documentation of parameters

M	nssock/doc/mann/nssock.man

commit f509d3de96267333171cd290398c3deb85e82c57
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-28

    - provide a warning, when parameter maxupload has to be adjusted

M	nsd/driver.c

commit 7bea48fe5e47b5b820f478c13598f0e3187c0133
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-27

    - white space change

M	nsd/binder.c

commit 48c5dec5b6252ec50ae0b8b264888942b1dacd7e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-27

    - reduce scope of variable

M	nsd/dns.c

commit 25869a4a3b9557f329eeb43fbc53739dd3574fb6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-27

    - don't shadow variable

M	nsd/driver.c

commit 7904b63535d611ba878992af4f44919ba05ad916
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-26

    - improve code safety

M	nsssl.c

commit 5b07e6e2580e9628cecdd66f17d76922f203940e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-26

    - fix more issues with prebind
    - increase verbosity for prebind

M	nsd/binder.c
M	nsd/sockaddr.c

commit 52716c3f71f71aec138301916f5595f2181974aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-26

    - improve tests for deactivated IPv6 in demo config file nsd-config.tcl

M	nsd-config.tcl

commit 580d9dd305e13f1562a6c06432a9d4225b1dfba7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-26

    - add missing prototype
    - add more parens

M	nsd/driver.c
M	nsd/nswin32.c
M	nsd/sock.c
M	nsd/str.c

commit b5cfd748e1352b4c8b10683187a1e94dc0c88da6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-26

    - use parens for sockaddr consistently

M	nsd/driver.c
M	nsd/queue.c

commit b3c34ce5d80d90da77e50f3e64ab446a10f289c2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-26

    - remove for claus irregularity

M	nsd/request.c

commit 4f8ffc57ff1cd844cf05b021ea27c447f83d6ff3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-26

    - enable IPv6 per for MSCV
    - remove local version of inet_ntop()
    - mark HAVE_INET_NTOP and HAVE_INET_NTOP as defined for MSCV
    - adjust raw printing of IPv6 addresses for MSCV (using u.Word)

M	include/nsthread.h
M	nsd/nswin32.c
M	nsd/sockaddr.c
M	nsthread/reentrant.c

commit 8181fde55169d8485931ce1ae65956009d5eed8a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-26

    - reduce type conversions
    - declare variables at the begin of a block

M	nsd/driver.c

commit 48e7e04cd65f53feb2a9d926e09204e5f3280fa5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-26

    - add missing NS_EXTERN

M	include/ns.h

commit e67be527258d06c168d5d33620e85919c99e3aa1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-25

    - fix typo (just visible, when compiled with assertion on)

M	nsssl.c

commit 1ca6370a3faad0d6cf3249ff09f9a1b71b8cb3e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-25

    - fix typo

M	nsd/binder.c

commit 950131702055442db5af70928a2d3ebbf0220b98
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-25

    - adjust members of windows specific address bits for IPv6 addresses
    - fix typo

M	nsd/nswin32.c
M	nsd/sockaddr.c

commit 408cc4b4554d0c4a8de8334e6a2e029f04c4ab3e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-25

    - make sample config script more robust:
      * don't hard-code IP address
      * if an IPv6 version of NaviServer is used, check, if IPv6 is enabled
        and set address accordingly

M	nsd-config.tcl

commit b02b4e3f098911bab75915c1c6b100db90ffcc22
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-25

    - don't try binder when addresses cant be resolved
    - avoid hangs from the binder
    - don't hard-code unspecified IP address

M	nsd/binder.c

commit fb86abeca8022a6c918af29a621763368561d75a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-25

    - improve readability of error message

M	nsd/tclsock.c

commit faba2a593ada8a5629bb9b06f924a5a6dfed2b6f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-24

    - make changes for IPv6 (and testing with IPv4)
    - bump version number

M	nsssl.c
M	tests/config.tcl
M	tests/nsssl.test

commit 6876e2e51b87f39570989ef934e44e32fd3590a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-24

    IPv6 support for NaviServer
    - Added a amall Abstraction API for IP-version agnostic calls:
      Ns_LogSockaddr(), Ns_SockaddrGetPort(),
      Ns_SockaddrGetSockLen(), Ns_SockaddrMask(), Ns_SockaddrMaskBits(),
      Ns_SockaddrSetPort(), ns_inet_ntop(), ns_inet_pton()
    
    - Replaced in interface more places where "sockaddr_in" (the IPv4
      version of the sockaddr) with the generic (version agnostic)
      sockaddr (also in IPv4 code to obtain API consistency when no IPv6
      is available): Ns_BindSock(), Ns_ConnSetPeer(), Ns_GetSockAddr(),
      Ns_SockBind(), Ns_SockBindUdp()
    
    - The Ns_Sock structure contained sockaddr_in, which is not sufficient
      to store IPv6 addresses. Therefore, it was necessary to change
      that to "sockaddr_storage" which guarantees to be large enough
      to keep all kind of addresses. This affects as well driver modules
      which communicate via the NaviServer managed sockets. Old drivers
      might crash with the new structure. Therefore, I've bumped
      NS_DRIVER_VERSION to 3 such that driver modules (also binaries)
      can communicate that they support IPv6. In IPv6 mode, NaviServer
      refuses to work with versions <3.
    
    - Replaced all usages of ns_inet_ntoa() by ns_intet_ntop()
      (except for legacy an minimal library support)
    
    - Added log file warnings on various places, where NaviServer
      was ignoring error states in socket communications silently.
    
    - Transformed hash table for open listen ports to string keys
      (the old code used 32bit IPv4-addresses as keys in hash tables)
    - added test for ns_listencallback
    
    - Ns_HttpParseHost: new abstraction for parsing host and port number.
      Reason: IPv6 literal notation contains many colons, parsing
      IP-literal notation according to RFC 3986 section 3.2.2 is necessary
      (removed places where code was searching for ':' to expect the port)
    
    - Added [ns_info ipv6] to obtain information whether the binary
      supports IPv6 or not
    
    - Added configure flag --disable-ipv6 to build NaviServer just with
      IPv4 support.
    
    - provide defines for core differences between IPv4 and IPv6
    #ifdef HAVE_IPV6
    # define NS_IP_LOOPBACK     "::1"
    # define NS_IP_UNSPECIFIED  "::"
    # define NS_SOCKADDR_IN     sockaddr_storage
    # define NS_IPADDR_SIZE     INET6_ADDRSTRLEN
    #else
    # define NS_IP_LOOPBACK     "127.0.0.1"
    # define NS_IP_UNSPECIFIED  "0.0.0.0"
    # define NS_SOCKADDR_IN     sockaddr_in
    # define NS_IPADDR_SIZE     INET_ADDRSTRLEN
    #endif
    
     - nsperm:
      * Aligned implementation with the documentation
        (hosts.allow/deny have comma-separated entries)
      * Added submask specification in the form /xxx
        (e.g. ::1/64)
      * Use binary IPv4 and IPv6 values for hash and mask lookup
      * Generalizing masking functions
      * Refactor code to avoid memory leaks
      * Updated documentation
    
    - modules:
      * nsudp and nsssl are now IPv6 aware/compliant
    
    TODOs:
    - more platform testing
      (probably changes for Windows necessary, help is appreciated)
    - remove commented out debug statements
    
    - make more modules IPv6 compliant
    - documentation updates

M	configure.ac
M	include/ns.h
M	include/nsconfig.h.in
M	include/nsthread.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd-config.tcl
M	nsd/Makefile
M	nsd/binder.c
M	nsd/conn.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/info.c
M	nsd/listen.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/queue.c
M	nsd/request.c
M	nsd/sock.c
A	nsd/sockaddr.c
M	nsd/str.c
M	nsd/tclhttp.c
M	nsd/tclsock.c
M	nsd/unix.c
M	nsd/url.c
M	nsperm/doc/mann/nsperm.man
M	nsperm/hosts.allow
M	nsperm/htaccess.tcl
M	nsperm/init.tcl
M	nsperm/nsperm.c
M	nssock/nssock.c
M	nsthread/reentrant.c
M	tcl/form.tcl
M	tests/ns_addrbyhost.test
M	tests/ns_conn.test
M	tests/ns_info.test
A	tests/ns_listencallback.test
M	tests/test.nscfg
A	tests/testserver/modules/listencallback-procs.tcl
M	tests/testserver/modules/testhttp.tcl

commit efef51fa768a07e12fef241871cdd40f8c79b1e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-24

    - remove test with deprecated "ns_startcontent"

M	tests/tclresp.test

commit eea4baf751688d3c76baf3b0ff2770ceb70a07ec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-24

    - replace deprecated "ns_startcontent" by "ns_headers"

M	tests/encoding.test

commit abb11d6a464823698941538bd07bdc3d41395b46
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-24

    - add listen constraint

M	tests/adp.test

commit 3aa186414801f363f60aed393c118c5af2694ff9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-24

    - add support for "-binary" flag in test http client

M	tests/modules/testhttps.tcl

commit 5c88dbc3051456086805292a29a2b56bf99b27dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-24

    - Don'd use bool in socket options

M	nsd/sockfile.c

commit 902a58036d1a3a5672400000269fa5d6cda83bde
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-23

    - obtain hex string from function pointer in a c99 compliant manner

M	nsthread/thread.c

commit a442a602dc8270428be9f147194e2f88e72603de
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-19

    - prefer lowercase unsigned suffix

M	nsd/form.c

commit e797012b4ca1d9cb0bb38ac9b86d37dc2bd58cb5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-16

    Added tag naviserver-4.99.10 for changeset 22c89823961c

M	.hgtags

commit 9426b65a92890a2493effdcdb10ff35b8ffb55ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-16

    - updated NEWS file

M	NEWS

commit c92a28632843dc85d61dd216fa9679a746c06f5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-16

    - bump version number to 4.99.10

M	configure.ac

commit 25d7c6fef119283c712791f9eb321dc6e989872e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-14

    - add a section of deprecated commands

M	doc/src/naviserver/commandlist.man

commit 3db1a1e77e97069fc9c81d6b1cc08c721393f756
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-14

    - log when deprecated function ns_startcontent is called

M	nsd/tclresp.c

commit c36a87e05d9121fb0784e5cb416deb040eba01fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-13

    - remove .cvsignore files

D	.cvsignore
D	include/.cvsignore
D	nsd/.cvsignore
D	tests/testserver/.cvsignore

commit b498a20611a8952c1acb80d87e4602a5e4f1d5e5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-13

    - fix spelling errors

M	doc/src/naviserver/nsv.man
M	nsd/adpeval.c
M	nsd/cls.c
M	nsthread/tls.c

commit 355f111b50a8f5f8b0cb1503678fdf3b2b3d4cbb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-12

    - use SCNd64 instead of PRId64 for scanning values

M	include/nsthread.h
M	nsd/config.c

commit ddf7ab2b5ebb4820c6c823ef2d8a9c5e2a0aba9b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-11

    - further cleanup of the compatibility layer of the PRI*PTR macros

M	include/nsthread.h

commit 426409730dbdd0527255b5de02fddc1c6cbc0af2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-07

    - add parallel checks and inconclusive results to cppcheck options

M	Makefile

commit ea366c830bf7bea164ae5841612324e8ccacba07
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-07

    - don't shadow type from zlib.h

M	nsd/fastpath.c

commit b59222ac93d20e1f44cabbc9cb3ecb421fa860bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-07

    - skip constant part

M	nsd/server.c

commit bd84506635b41e7b68598acada95810b97f2f1ae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-07

    - remove double assignment

M	nsd/connchan.c

commit 8908857b5304a5fceb8ce7d7fd4be274e9f86459
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-05

    - add parens

M	nsdb/dbinit.c

commit 8519e5b73bd4eb0952a5981a461652b7d84dcbee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-04

    - fix cut&paste problem

M	include/nsthread.h

commit 3fd66f073379c9b20e7659eea517d2e2c22f19cf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-03

    - added nonnull annotations

M	nsdb/dbinit.c
M	nsdb/nsdb.h

commit a34d1dc5e3fe7377d6bee00151dcf35808e85019
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-03

    - improve macros for supporting bool und visual studio

M	include/ns.h

commit 8dc0c8637510c6a5901926be0d960614dc9f66d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-03

    - improve print macros for _WIN64

M	include/nsthread.h

commit 42d362ad50fd5176337574e176e14e064cb0eb65
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-02

    - Don't pass NULL after the last typed argument to a variadic function

M	nslog/nslog.c

commit 4b6f9c05dd57c55882520303cd9477c5375e3221
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-01

    - add check whether obtaining DH parameters from pem file fails

M	nsssl.c

commit a8a852469a25daaffeed645a4271a8b3a4693496
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-02-01

    - remove cppcheck target, since it is already "inherited" from Makefile.modules

M	Makefile

commit 4969b9c7ae4aa11cf29f3b2217139f4fd28ec024
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-27

    - add hint to documentation

M	doc/src/naviserver/returnstatus-cmds.man

commit ac5ee2de9366c480b6365a853d8374bed9b5a71e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-27

    - refine "bool" definition for C++ compilers

M	include/ns.h

commit 5e041924ce463f8d3e4aa3d9e7200b6015be3d60
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-22

    - minor cleanup

M	nsd/driver.c
M	nsd/nswin32.c
M	nsd/tclhttp.c

commit 439ac42e7415cfe9072d4483f62ca1fdeb3491ca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-18

    - add const declarations

M	nsd/connchan.c

commit 7ec0b4ea99346cc95b05e9adad5d02667029e18f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-18

    - no need to use address operator, when array (name) is passed to a function

M	nsd/log.c
M	nsd/urlencode.c

commit 5e102974653e429119a3a3073b85d668afbe22f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-18

    - don't do a '#if SOMEVAR > ..." on a potentially undefined preprocessor variable

M	include/ns.h

commit 2d9ab3d945fcc7d1bd82eb4defab0d9dec1958b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-17

    - use ns_strdup() instead of ns_strcopy() when it is clear that argument is nonnull
    - minor cleanup

M	nsd/set.c

commit d1ab5325750c8355f40df928baecd2e5affb3128
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-17

    - don't set members of the configuration Ns_Set() from multiple threads, since these sets are not secured via a mutex. Move reading of config variable "connsperthread" into main startup thread

M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c

commit 178e6c4495e8e36f517b853883a3749291ea7f82
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-15

    - add target for testing under lldb

M	Makefile

commit 811b6563f7db076494d65bba49c18d2d8f52caec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-11

    Added tag naviserver-4.99.9 for changeset 67ee59f56e70

M	.hgtags

commit eb8d1c72e5695dcd12fe7eecef2318d19d556762
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-11

    - update README, NEWS

M	README

commit e020e88cba73f4da5aff84122f4beb9abd1b92d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-11

    - update version number

M	configure.ac

commit 26e7ecf0bc98832a76366cb0160614586f51caf8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-11

    - add target "cppcheck" (for all modules)

M	include/Makefile.module.in

commit 2271aea96ed6a81ed8e450fc99035f09203811d4
Merge: 140398eb d64d5af8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-10

    - merged heads

commit 140398ebfd1fb9358eed156c75dd9e7d746eed63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-10

    - updated ChangeLog

M	ChangeLog

commit e06487daa68f266742621f313b341cff291493f2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-10

    - added optionional SSLINCLUDE to Makefile to point to openssl include files

M	README.md

commit 965cdff65f057292c89ecdd66fec41edfe203288
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-10

    - don't use NULL in sentinel

M	nsssl.c

commit 5adfec5d306bf0c8a273c822a176cb77a25bdc4a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-10

    - include target cppcheck

M	Makefile

commit fa71beeb19e2dbb15cb53bbee91b1b9c1d1b026e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-10

    - prefer lowercase U-suffix over uppercase.

M	nsd/server.c

commit bbccf89595d75f2ec5028b5e9fc4113e7d694d38
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-10

    - remove side-effect

M	nsd/tclcache.c

commit c3c7c5df36184982a226b9569753f495704be8b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-10

    - reduce variable scopes

M	nsd/cache.c
M	nsd/form.c
M	nsd/tclhttp.c

commit 46400c077ddc336584de02871c397aafb2cd6156
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-10

    - change result of  Ns_Cancel(), Ns_Pause(), Ns_Resume() form "int" to "bool"

M	include/ns.h
M	nsd/sched.c

commit 8547e02ada93dea25f2de5f0014ba94d76f9884d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-06

    - TCP_FASTOPEN: macOS 10.11 seems to support TCP_FASTOPEN, but does not allow the qvalue 5, which is recommended for Linux

M	nsd/sock.c

commit d16576a84f7a68ac797b4a64faf94a10584f0931
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2016-01-03

    - improve comment density above threshold

M	nsd/binder.c

commit 5bbfa49bbf6f8e6ac1cabef16b8556c25e6b5b74
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-31

    - align member elements

M	include/ns.h
M	nsd/driver.c

commit c2565b47a6c6705a9d9c8b5c460b812b2d8c1ee9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-31

    - add "const" declarations

M	include/ns.h
M	nsd/info.c
M	nsd/nsd.h

commit 1a43102d7836275ba6322b969504e2bc465b7565
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-31

    - add "const" to cast
    - prefer "u" over "U" suffix

M	nsd/adpparse.c

commit 0218f297ec05cce7edd1cec8c81ccb025741ed81
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-31

    - remove extra comma

M	nsperm/nsperm.c

commit 3608a844b9d3e1df6b78d406b62e4ab4c8c33ad6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-29

    - fix typos
    - white space changes

M	nsd/index.c

commit fb7c3d35026af66e442a667157ea2dfdfa8b06c2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-29

    - make asserts more precise

M	nsproxy/nsproxylib.c

commit 0096a85d4e7235f2cb802c93092d5172af5c5b8e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-29

    - initialize variable to ease life of static checkers

M	nsd/exec.c

commit 8e2887a0476e2781ac41b595252185f1abbc5fbe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-28

    - fix filename

M	nsd/connio.c
M	nsd/nswin32.c

commit d23c08ac3e5cd5fcab0a9e3ab33502e86fea51fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-26

    - improve compatibility of ns_eval with Tcl's eval. In particular,
      one can now define a proc containing a comment via ns_eval.
      The following forms works now:
    
        set cmd [list proc ::foo {} {
            # some comment
            ns_return 200 text/plain ok
        }]
        eval $cmd
        ns_eval $cmd
        ns_eval {*}$cmd

M	nsd/init.tcl
M	tests/tclresp.test

commit 94f741c7749be2234ab6db47ad187af6369b2fdc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-22

    - updated list of status codes

M	nsd/return.c

commit 0f816eab2316ca34a802e5d9d945632aaea062ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-20

    - return correct type for getpid() under windows

M	include/nsthread.h

commit 3708d6c43ca7a9154a09313fb0ab98aff5991acb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-20

    - use warning instead of error when dns-lookup fails (potentially expected result)

M	nsd/dns.c

commit ab9a3dbe5b952fda7d18d2ac4868307ba09d6222
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-19

    - use real boolean type in C99 (helps as well for c++)

M	include/ns.h
M	nsd/connchan.c
M	nsd/tclsock.c

commit 64edc76d953c912ab2b0e8b4a104d09ab9f58259
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-17

    - provde c++ compatibility

M	include/ns.h
M	nsd/nswin32.c

commit a9a111dc3743ef1085660ea4155ff1c30c2188a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-12

    - fix obsolete documentation for ns_register_proc

M	doc/src/naviserver/ns_register.man

commit 02289ae80838986f534d50e74dcc86c651959174
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-10

    - remove strange code

M	nsdb/dbtcl.c

commit 7516129c28f7118c28b632bb510c6219b26570f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-07

    - add parens around expressions

M	include/nsthread.h

commit 2c28f2196cbd8444a012740b531e4e6506d2fba2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-07

    - fix nesting in switch statement

M	nsd/urlspace.c

commit 082312c329cc4e8ea5fb1aa57d6b8a809898a2da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-12-07

    - fix typo

M	nsproxy/nsproxylib.c

commit 52d1e99b85b8e7ef428206576c1152f5ba2feb6a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-29

    - reduce implicit signed/unsigend conversions
    - prefer 0u over 0U

M	nsd/conn.c
M	nsd/driver.c
M	nsd/urlspace.c

commit 9110d5e55ba27d48b5eed8949ab10120c900c282
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-28

    - New macro NS_NONNULL_ASSERT():
      Background: The unreleased gcc6 with "-pedantic"
      complaints since recently about asserts, in which nonnull
      conditions are explicitly tested, and spits out warnings like
          ... warning: nonnull argument ... compared to NULL ...
      The new macro NS_NONNULL_ASSERT  turns off these tests
      when gcc6 is used.

M	include/nscheck.h
M	nscgi/nscgi.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/cache.c
M	nsd/callbacks.c
M	nsd/cls.c
M	nsd/compress.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/crypt.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/encoding.c
M	nsd/event.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/index.c
M	nsd/limits.c
M	nsd/lisp.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/proc.c
M	nsd/queue.c
M	nsd/quotehtml.c
M	nsd/range.c
M	nsd/request.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/server.c
M	nsd/set.c
M	nsd/sls.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/str.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclcmds.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/unix.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsd/uuencode.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/dbutil.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nssock/nssock.c
M	nsthread/cslock.c
M	nsthread/memory.c
M	nsthread/mutex.c
M	nsthread/pthread.c
M	nsthread/reentrant.c
M	nsthread/rwlock.c
M	nsthread/sema.c
M	nsthread/signal.c
M	nsthread/thread.c
M	nsthread/time.c
M	nsthread/tls.c
M	tests/ns_proxy.test

commit c4518d56bc7bdc2d24bd0158de15f3c0944869bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-28

    - add more const declarations

M	nsd/conn.c
M	nsd/connchan.c
M	nsd/driver.c
M	nsd/info.c
M	nsd/log.c
M	nsd/sls.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclset.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/urlspace.c
M	nsdb/dbtcl.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c

commit cc216b6380e07249adacae41513193210619b795
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-28

    - add missing assert()

M	nsd/cache.c

commit 27ac4da638058fa5a5b95db0d2f046f433f82918
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-28

    - don't get in conflict with c90 identifier
    - align prototype
    - add "default" to switch statements
    - remove unaccessed variable

M	nsd/urlspace.c

commit 7e08949af19690c3ce8a5f62b6c11893a3ff6322
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-28

    - remove extra comma

M	nsd/nsd.h

commit aa76edcfa20b805d31f7ff16e3eed5d984209696
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-23

    - fix urlspace deletion bug (previously noted in regression test)
    - extend regression test

M	nsd/urlspace.c
M	tests/ns_urlspace.test

commit 6f97fa127938e41f13924e0aea617fae16a22700
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-22

    - don't use unsigned format on signed variable

M	nsd/fd.c
M	nsd/queue.c
M	nsdb/dbinit.c

commit b74b9b1c5d8bfeb8f3185488c90730acc0ca7ab4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-22

    - fix test on wrong variable

M	nsperm/nsperm.c

commit 18c6bb16df147f9eac3342b735965cdc5fa17072
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-22

    - add more test cases to regression test

M	tests/ns_urlspace.test

commit f12f8e79f9bc21e4458070038601b8c19f0b69fa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-19

    - add regression test cases for ns_urlspace

A	tests/ns_urlspace.test

commit 9da534d885d92002c20917a1bb8f1aacc068d2ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-19

    - reduce variable scope

M	nsd/urlspace.c

commit f87831cb814633f6f7b573c674f418df0cee3ad0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-19

    - fix typos

M	doc/src/naviserver/ns_urlspace.man
M	doc/src/naviserver/nsv.man

commit d5cef6a642fc6ca57e92dafc4fa133a0862ed9d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-19

    - new man page for ns_urlspace
    - minor fixes for related man pages

M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_connchan.man
A	doc/src/naviserver/ns_urlspace.man
M	doc/src/naviserver/nsv.man

commit 06ab545679676deb1a58b8bea5ddae7d1022e6cb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-19

    - cleanup

M	nsd/urlspace.c

commit ca9f24c7136c9940131d2c6cc9b36d7664c6f086
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-18

    - The new command "ns_urlspace" that allows one to attach data to URLs in
      a hierarchical manner form the Tcl level. The command allows e.g. to
      write ns-perm like access control in Tcl without much hassle.
    
       ns_urlspace set ?-id i? ?-key k? ?-noinherit? /url/ string
       ns_urlspace get ?-exact? ?-id i? ?-key k? ?-noinherit? /url/
       ns_urlspace list
       ns_urlspace new
       ns_urlspace unset ?-id i? ?-key k? ?-noinherit? ?-recurse? /url/
    
    - Ns_UrlSpecificGetFast() was (and is) broken, but it is nowhere
      used. It is marked now as deprecated, requests are redirected to
      Ns_UrlSpecificGet().
    
    - The optimization of __URLSPACE_OPTIMIZE__ imposes no changes, all
      tests work functionally equivalent. However, at least in my
      test-cases there is no performance improvement when using it.
    
    - ns_urlspace can be used in the regression test for testing the
      functionality provided by in urlspace.c systematically. The
      regression tests will be added later (like man pages).

M	include/ns.h
M	nsd/limits.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/queue.c
M	nsd/tclcmds.c
M	nsd/tclfile.c
M	nsd/url2file.c
M	nsd/urlspace.c

commit 025699d0a674a038c34379b0066906754e8ba1e5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-18

    - use single return

M	nsd/tclvar.c

commit a67bd8c94e72632977957fd34256ffe51e9015ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-18

    - use single return

M	nsd/tclcache.c

commit 24b0ef0fd0ea416aa58b209036b83bf2571ebcd5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-10

    - reduce implicit signed/unsigned conversions

M	nsd/exec.c

commit 712a0d36ced24eec423438ddb8fb91b30345b3a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-10

    - include logo via css to ease debian packaging

M	doc/src/header.inc
M	doc/src/man.css

commit fd49a3010c6734c712bff58355be22642c28295e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-10

    - don't compare unsigned type with less than 0

M	nsd/urlspace.c

commit 4db425d6e4111a00b58fa73a58a0e154269a37f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-10

    - there seems to be a compliter bug on recent versions of clang. Let's try whether this variant can cause the same problem

M	nsd/set.c

commit 627538605745943cfcaa6a721aa50cba308b0a65
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-09

    - reduce signed/unsigned conversions

M	include/ns.h
M	nsd/index.c

commit 7a739524c02908e20afdd7133e61818601ac55c6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-09

    - don't cast away const

M	nsdb/dbinit.c

commit a51ddf5bbfac260b10f2a22949f310fa0c3487e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-09

    - don't ignore result of Tcl_ObjSetVar2()

M	nsd/tclcache.c
M	nsd/tclvar.c

commit c96281f0e45494e6827ebb7ec6737daab677f177
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-09

    - prefer "for" loop over "while"

M	nsthread/thread.c

commit 21e10e4c4758c0524212090549fe7ebf1586c321
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-09

    - don't use "Ns" prefix for static functions

M	nsd/queue.c

commit 6c3a507aca251a52a1cd50403038946d9b9724d9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-09

    - improve debugging output

M	nsd/callbacks.c

commit a889d54163f1618874bdbb5714544b564e70877a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-04

    - reduce implicit type conversions

M	nsd/connio.c
M	nsd/crypt.c
M	nsd/fastpath.c
M	nsd/index.c
M	nsd/set.c
M	nsd/urlspace.c

commit 89295dcf9b9600c8f0ca729f20e67f6bb00de064
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-04

    - added ability to optionally minify css and js files on the fly when gzipped content is requested. This is an extension of the gzip_static/gzip_refresh feature.

M	doc/src/naviserver/ns_return.man
M	openacs-config.tcl
M	sample-config.tcl.in
M	tcl/fastpath.tcl

commit b4aa256db935abb0bace4d38609e948ba8530c74
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-11-03

    - fix typos

M	nsthread/mutex.c
M	nsthread/nsthreadtest.c

commit 235074adc7515e03640079396f31afbf33d557a1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-31

    - add const declarations

M	nsdb/db.h
M	nsdb/dbinit.c
M	nsdb/nsdb.h

commit 3d057ac488993c01ae12f7c11f6b30a65417abb9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-31

    - reduce implicit conversions

M	nsd/urlspace.c

commit 2ed9383884b6cf83d7ee732452dafd76cf6fe759
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-31

    - remove debug output

M	nsdb/dbtcl.c

commit 78740363ed775df26c9e4bafb05cea52a3999b7c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-31

    - reduce implicit conversions

M	nsd/log.c

commit 734d2dffd07a28023737726c664741fdafee9f85
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-31

    - fix typo

M	doc/src/naviserver/ns_return.man

commit c49fa7c986e548d34f3f79d93e0d6b391bff4f90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-26

    Extend nsdb and document configuration options:
    - added logMinDuration: when sql logging is turned on, include only
      queries that take longer than the specified duration in the
      error.log (similar to log_min_duration_statement in PostgreSQL)
    - logMinDuration can be specified in the config file for every pool
    - logMinDuration can be altered dyamically via "ns_db logminduration ..."
    - document nsdb configuration options in ns_db man page

M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/doc/mann/ns_db.man
M	nsdb/nsdb.h
M	openacs-config.tcl

commit 21bfb2336195a5be74d29e79bedce03c32f44890
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-25

    - Ns_GetTimeFromString: provide API callable from config file to
     convert strings to ns_time (supporting "sec:usec" and "sec.fraction"
     formats)
    - fix "floating-point" format for Ns_ObjvTime(): 1.05 was interpreted like 1.5

M	include/ns.h
M	nsd/config.c
M	nsd/tcltime.c

commit c939faa8fe77ea3ded88400fca43d7f238c57db9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-21

    - add aggregated sql times, suitable for delta monitoring

M	nsdb/dbinit.c

commit f8ccb7726d9989433c3c72497e924b845d4f4770
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-21

    - reduce implicit conversions

M	nsd/index.c

commit f0d9b7548282fc9c595d664332e21d5a669571f9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-21

    - adapt regression test to new command line options

M	nsd/log.c
M	tests/ns_log.test

commit 17e9a20200349f685e227554c6342054bf3b6663
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-21

    - when logcolorize is true, provide a potentially different color for
      the timestamp prefix based on ANSI color codes
      (parameters logprefixcolor and logprefixintensity)

M	doc/src/naviserver/ns_log.man
M	nsd/log.c
M	openacs-config.tcl

commit 3f2bc9b54e8a92bfe0981e8e8a424230d35fe9d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-21

    - silence checker

M	nsd/fastpath.c

commit 71ecaa73913988d15b3462c912e9e878d7765ba1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-18

    - initialize extra severities with enabled=false

M	nsd/log.c

commit e731b3cae64a41e282eb830ee9c62452eb4046a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-17

    New feature: optional colorization of error.log
    - all severities (system- or user-defined) have now "color" and
      "intensity" specified, which can be controlled via
    
        ns_logctl severity severity-level ?-color color? ?-intensity intensity? ?bool?
    
    - reasonable default values for the color mapping are provided.
    - to enable colorization, set "logcolorize" in section "ns/parameters" to true
    - when viewing error.log file via less, use "less -r"

M	doc/src/naviserver/ns_log.man
M	nsd/log.c

commit b58a98701188bfd61eef8b38f938219615439780
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-17

    - indent #ifdefs more consistently

M	include/nsthread.h

commit 03db36694bc66c39d686f4a4c6acaaf43e38dab9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-17

    - fix man entry

M	nsproxy/doc/mann/ns_proxy.man

commit b4f36d5c08b9f38ad926c4d4e275ead4c87c22e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-17

    - colorize log per default

M	openacs-config.tcl

commit 374c2faa10bbc4b556bf23636dfb2bd09d48713a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-16

    - reduce implicit conversions
    - add more parenthesis

M	include/ns.h
M	nsd/index.c
M	nsd/sockfile.c

commit 87d23b6a704c6553d7592c5f86da2966c0bb3dd3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-16

    - access structure after assert

M	nsd/conn.c

commit 478ea41f90ffec9c32d668c643fd20036ac10267
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-16

    - fix test on invalid result

M	nsd/sock.c

commit f313033d69e4be55bbe76959bf4f62ac8cfae48e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-16

    - remove unneeded comparison

M	nsd/set.c

commit 5b766c16cf3c7cc1433b0062872ef97baf806a4f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-10-01

    - move usage of pointers after assert() to reduce messages of static checkers
    - reduce implicit conversions

M	nsd/cache.c
M	nsd/conn.c
M	nsd/fd.c
M	nsdb/dbinit.c

commit 3de842eaddb8b772a3ba431bf02c36d02ee067c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-29

    - move operations with potential null pointers after asserts
    - improve cleanness of print formatters

M	nsd/connchan.c
M	nsd/connio.c
M	nsd/dns.c
M	nsd/fd.c
M	nsd/queue.c

commit a18db8c01bc385b1b0a4dbe6fbafe4ef65bf0a22
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-29

    - move variable initializations after assert statements to silence static checker (sonarsrv)

M	nscgi/nscgi.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/cache.c

commit 1c96d1ad96fedb81ef8be9fd457a6fc1438ae33f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-27

    - improve cppcheck issues
    - add unlikely() for error cases
    - make ignoring of results more explicit
    - pass (char *)0 instead of NULL to varargs interface

M	nsd/adpeval.c
M	nsd/driver.c
M	nsd/queue.c
M	nsd/tclvar.c

commit 7db1536199a934fc1263a4f2b25d1b9594e8cefd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-26

    - reduce implicit conversions

M	nsd/driver.c

commit c5987e283082ccddb6e230712059de6f930b0b68
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-26

    - add const

M	nsd/tclinit.c

commit 15fda432a97c53ff2dcaf90f26b7ad38e7d3b92f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-25

    - replaced obsolete function 'asctime' by strftime

M	nsthread/reentrant.c

commit e8947b0c5965f5c52561c0dc169b1ec598120383
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-25

    - allow NULL value in last argument of Ns_SetUpdate() and Ns_SetIUpdate
    - prefer bool over int for boolean values

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/dns.c
M	nsd/set.c

commit 87951ba8e8b0e4c8f86cbf1cfe7199d9619a896b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-23

    - use consistently Ns_ObjvTime for all "-timeout" parameters
    - add missing documentation for parameter "-timeout" of "ns_job configure"

M	doc/src/naviserver/ns_job.man
M	nsd/tcljob.c
M	nsd/tclsock.c

commit ec62649da60d5c6dfd8f77f06d77308bc3846a0f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-22

    - don't compare integers with pointers

M	nsd/fd.c

commit 776a2dd1915027672a483c56aa98d5b0446b7e8d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-19

    - add const declarations

M	nsd/urlspace.c

commit e8365a9abd8ab1ee7491bcd0efa8390363e7be1a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-19

    - align function name with prototype

M	nsd/fastpath.c

commit ed01bfc82f4766209a76d00eb3a545027cb09b44
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-19

    - use standard function memchr() instead of home-brew strnchr

M	nsd/driver.c

commit db18b03c6b80bc5cb61291165624d4a38becfbb1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-19

    - add const declaration
    - silence static checker

M	nsdb/db.h
M	nsdb/dbinit.c

commit 44d1fdac722589f0087dfd5414bf69af3df03f16
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-19

    -  reduce flagged items from sonarsrv: _get_osfhandle(fd) returns since 2011 intptr_t; http://sonarsrv.spazioit.com:9000/component_issues?id=my%3Anaviserver#createdAfter=2015-09-07|createdBefore=2015-09-13|resolved=false;

M	nsd/fd.c

commit d64d5af86e8270a6b42f9ffb55be45b272a548a1
Author: gustafn <neumann@wu-wien.ac.at>
Date:   2015-09-18

    README.md edited online with Bitbucket

M	README.md

commit 424fd76cafaed65284634cad3f4a18d3b6a907b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-15

    - update documentation

M	nsdb/doc/mann/ns_db.man

commit 949ebd607048e994c8beb6afd15aa4d7f4c25ddd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-15

    - use 127.0.0.1 instead of "localhost" for temporary web server during regression test

M	tests/test.nscfg

commit 6e46366be12217a479582575035eef016e6762a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-15

    - include number of get-handle operations in [ns_db stats] to improve transparency on potential bottlenecks

M	nsdb/dbinit.c

commit 74c997d8fb308a93df4f03562c752e4dd5e46445
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2015-09-14

    nsproxy/nsproxylib.c: fixed glitch in [ns_proxy config]
    tests/all.tcl: explicitly state Tcl8.5 package
    tests/ns_proxy.test: tests checking config options now know "-env"

M	nsproxy/nsproxylib.c
M	tests/all.tcl
M	tests/ns_proxy.test

commit 5b0784ddf0b7b4d373b3bfda536696cab3062581
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-13

    - include content-encoding, when determining  binary content in http client requests
    - update to same level as in naviserver http client requests
    - add regression tests

M	nsssl.c
M	tests/config.tcl
M	tests/nsssl.test

commit 35929660e9a848230d7e0400f76ce2efce270477
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-13

    - include content-encoding, when determining  binary content in http client requests

M	nsd/tclhttp.c

commit fd51bbd97267dcca3150e0a3e799b84060bc8bf3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-13

    - fix bug in interaction between chunked encoding and gzip: when gzip
      is enabled, then it is necessary to write content even with 0 bytes
      (last chunk) to make sure the gzip stream is flushed

M	include/ns.h
M	nsd/compress.c
M	nsd/connio.c
M	tests/ns_adp_compress.test

commit 7c2661fa6d2fdd7bd33ba98a6463102e26c2edab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-12

    - include aggregated wait times for handles per pool in "ns_db stats" output

M	nsdb/dbinit.c
M	nsdb/doc/mann/ns_db.man

commit bec1fe1b602b395f09e1f35cec6e280163cf2da1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-12

    - Improved debug output for SQL: include runtime in log statements
    - added "nsdb stats":
    - fixed typos in comments and docmentation
    - bring ns_db subcommands in man page consistently into alphabetical order
    - prefer bool over int
    - add missing const declarations

M	nsdb/db.h
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/doc/mann/ns_db.man
M	nsdb/nsdb.h

commit 2aaedfa676b9278302062b9a7cf9deb7c498ce75
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-11

    - reduce scope of variable

M	nsd/tclinit.c

commit 4c434a20fd93f79a474da5fd0ad3d270e1c0c70a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-11

    - more updates to documentation

M	doc/src/manual/main-features.man

commit efa065c13359544c6483d8f5f8ae31c04b060d44
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-11

    - fix example in documentation

M	doc/src/naviserver/ns_normalizepath.man

commit e26d91dcdea6fbadd3814b6b8a0f698a878745d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-11

    - make per-handle log statement dependent on "verbose" member

M	nsdb/dbinit.c

commit eaa9be313393476b7682280775c21c9fa133c2ba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-09-11

    - improve sample config file (add ns_logctl, more comments)

M	openacs-config.tcl

commit aec042488949c6958fee3028bd5a023696e9aa7a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2015-09-09

    Changed RDF repository hint from CVSRepository to HgRepository.

M	naviserver.rdf.in

commit 596d87ab1e5cf18a4fb3a2cae23fc2025e96540d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2015-09-07

    nsproxy/nsproxylib.c: added passing env to slave from an NsSet

M	nsproxy/doc/mann/ns_proxy.man
M	nsproxy/nsproxylib.c

commit b1ef37f2e28f35d8e333d695c2af08a837b8bfd0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2015-09-07

    nsd/fd.c: added Ns_(No)CloseOnExec implementation for Win32.
    nsd/tclinit.c: Tcl_CreateHashEntry needs valid "changed" arg.

M	nsd/fd.c
M	nsd/tclinit.c

commit bf55aa907f61896288e2d101a192a4a22f803755
Merge: 94a98266 7b8c4811
Author: gustafn <neumann@wu-wien.ac.at>
Date:   2015-08-03

    Merged in davidqc/naviserver (pull request #8)
    
    String length fix

commit 94a982669ee56e45ae3f1c93756bc6e2246ee2c8
Merge: 0111f2a1 523626c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-08-03

    merge

commit 0111f2a1e6a39204ece6b825eac95cc3a19a955e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-08-03

    improve robustness of ns_http with post data:
    - determine binary transmission based on NsTclObjIsByteArray() (old) and
      mime-type (new) to provide a more robust solution when shimmering of
      tcl_objs happens.
    - provide API to determine whether a content type requires binary transmission
    - adding test cases for POST requests vis ns_http
    - provide configure parameter "listenurl" for testserver to ease
      portability between ns_http and ns_ssl tests

M	include/ns.h
M	nsd/mimetypes.c
M	nsd/set.c
M	nsd/tclhttp.c
M	tests/http.test
M	tests/test.nscfg

commit 7b8c48111c1ac4bf452c63e9b0990ee3a1bb82a1
Author: David Osborne <david@qcode.co.uk>
Date:   2015-08-03

    String length fix

M	nslog/nslog.c

commit 4b1199b192facd9551fd6810fc07eec1c70ca301
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-08-02

    - match operations in register and unregister commands

M	tests/http.test

commit 41ea4b322190ab3f67976098474f7263aa3c23ce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-08-02

    - distingusih tip version number from released one

M	configure.ac

commit 816d1c142c36cd667dae95eb6b020a3dc3848436
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-31

    - address size issue as flagged by sonarsrv

M	nsd/event.c

commit 523626c5dad953396bf9bd84db78c673e650d2e0
Merge: 4856e7c5 63035082
Author: gustafn <neumann@wu-wien.ac.at>
Date:   2015-07-30

    Merged in davidqc/naviserver (pull request #7)
    
    Default directoryproc to _ns_dirlist regardless of directorylisting value

commit 4856e7c531d7c0177819fe2e4cd22493c6fc9b98
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-30

    - fix logical error

M	nslog/nslog.c

commit 630350828c11c65852d2c934dbc6aba487252aab
Author: David Osborne <david@qcode.co.uk>
Date:   2015-07-30

    directorylist doc update

M	doc/src/naviserver/ns_return.man

commit 2c28c68f33690b80b3197ba5150f6adaab1a8495
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-29

    - Add The fallback for definition of L_tmpnam, since the fallback from Tcl  was removed on 2015-07-15

M	nsd/tclfile.c

commit b7b9d0b080a47012a1d8d0444579b2c5adcff891
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-29

    - handle binary data when "-body" is specified in ns_http command

M	nsd/tclhttp.c

commit 3632d68154567639c2f3dfd0f8e44229ee4d565f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-29

    - handle binary data when "-body" is specified in nsssl command

M	nsssl.c

commit b766d515a4e25df82b33a01cc69bed0d7418e2f5
Author: David Osborne <david@qcode.co.uk>
Date:   2015-07-21

    directoryproc defaults to _ns_dirlist regardless of directorylisting

M	nsd/fastpath.c
M	tcl/fastpath.tcl

commit 6647c174af779df9c7589bd0d94e2602a3a5ef10
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-14

    - add apache-style escaping in access log as well for other double-quoted fields depending on external input

M	nslog/nslog.c

commit 03c285cfe197aee84cebd823570d0c45ee35e4bd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-14

    - escape special characters in query field of access log in apache style

M	nslog/nslog.c

commit 2bbb55718e609b7c2764cfd395fa37afb2c0e141
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-14

    - fix typo in comment

M	nsthread/signal.c

commit 1d7958e70361f0f12c1f1aa4c1174265064e2bc2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-09

    - fix definition order of NS_finalshutdown

M	nsthread/signal.c

commit baf92721da75c1802d4ea9455a09ab7f154c17e2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-09

     - use always macro INT2PTR to convert integer to pointer

M	nsssl.c

commit 96e913648c6aa095d4109ae21543b0a25c068cc4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-09

    - use always macro INT2PTR to convert integer to pointer

M	nsd/tclhttp.c

commit 82f7b18a5d1854315aef73caea8bf64b5397d21e
Merge: 2fdf8fdd d9930811
Author: gustafn <neumann@wu-wien.ac.at>
Date:   2015-07-09

    Merged in davidqc/naviserver (pull request #6)
    
    Header processing updates

commit 2fdf8fdda2f759fb0ba549d246414a53389cef2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-09

    - change member name drvPtr->options to drvPtr->opts

M	nsd/sockfile.c

commit bb345fbd316c8ea0f9c2d702639ec5987b579870
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-09

    - Don't use TCP_CORK on UDP sockets

M	include/ns.h
M	nsd/sockfile.c

commit 5eda14e9d74efb95e0e820234e5c8c379f9d1e5b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-07-02

    - improve socket shutdown behavior for udp-based drivers

M	nsd/driver.c

commit 5b42ea01ffe89865a6ed12199ebc08eeaedd0e1c
Author: David Osborne <david@qcode.co.uk>
Date:   2015-07-01

    Check for host header when keep_host_header is specified. Move check to before strdup.

M	nsssl.c

commit d99308112515e630529a520c127c366d4aa64d81
Author: David Osborne <david@qcode.co.uk>
Date:   2015-07-01

    Test for expected host header when keep_host_header is specified

M	nsd/tclhttp.c

commit a97008d6781f3189b4b176f4dd15e56f323ddcb6
Author: David Osborne <david@qcode.co.uk>
Date:   2015-06-30

    Possibly should check for cases where Host header is expected by isnt given

M	nsssl.c

commit 5e8d31e56e91aef50fb26834ab1f7b2bc9c3f9c2
Author: David Osborne <david@qcode.co.uk>
Date:   2015-06-30

    Readme update

M	README.md

commit 0b81dd6f7b99421f3ca9cd06581079efc123fde4
Author: David Osborne <david@qcode.co.uk>
Date:   2015-06-30

    Documentation update

M	doc/src/naviserver/ns_http.man

commit 6d4e052fc6c535041e3918e9f34e6cccb0ecaf54
Author: David Osborne <david@qcode.co.uk>
Date:   2015-06-30

    Use bool rather than int.

M	nsssl.c

commit c006b47c0fd598a2d3eb64983c8c30a7bfa7bca8
Author: David Osborne <david@qcode.co.uk>
Date:   2015-06-30

    Move non-null assertion. Use bool rather than int.

M	nsd/tclhttp.c

commit c9867a522c3aa55878d93e22ad799154c49bcfea
Author: David Osborne <david@qcode.co.uk>
Date:   2015-06-26

    keep_host_header argument for HttpConnect

M	nsd/tclhttp.c

commit fe7f8225fe2bc7f64b0f5f117f65cee9e2df0f1a
Author: David Osborne <david@qcode.co.uk>
Date:   2015-06-25

    Ns_SetIUpdate prototype

M	include/ns.h

commit 5237f33eb96a8c95a72bb94d3dfe7768f8781ba5
Author: David Osborne <david@qcode.co.uk>
Date:   2015-06-24

    - Ns_ConnUpdateHeaders to use case insensitive Update

M	nsd/return.c
M	nsd/set.c

commit 181018d74066a1b8b333a56cdb5eea95d3b459ea
Author: David Osborne <david@qcode.co.uk>
Date:   2015-06-23

    optionally keep Host header intact

M	nsssl.c

commit 4a8c0cdec2284d7c9192b0c19cf9f150f2ae530c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-06-22

    - add function prototype for Ns_ModuleInit()

M	nscgi/nscgi.c

commit a87a02a9c545e75947206461e6e370bfe8d25b64
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-06-17

    - improve README file (add more about installs from the repository, mention *-modules-tar file)

M	README

commit bbfc81ac46ee456effbfbfd56589c26e65433d05
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-06-17

    - add missing "NS_" prefix before EXTERN (many thants to William Scott Jordan for pointing this out)

M	include/nsthread.h
M	nsd/nsd.h

commit 33d1e31a249af014206a5163277db6b628f2b7fb
Merge: eb3a25c3 8ec13bbe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-06-11

    merge

commit eb3a25c3566002d2c11a513b65a5f5d28377188f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-06-11

    - remove potential xss attack (mostly false positives) on error
      messages that are directly generated from user strings by naviserver
    - prefer lowercase html elements and attributes
    - quote html attributes (recommended by HTML 4.*)

M	nsd/return.c
M	nsd/returnresp.c

commit 8ec13bbee1ae73670a82c4434003bf4b06d8f878
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2015-06-02

    ensure list nature of errorCode is preserved in proxy calls
    
    errorCode was being treated as a list element by passing it to
    Tcl_SetErrorCode; as a result the value would have an additional
    level of list quoting.  Passing a Tcl_Obj to Tcl_SetObjErrorCode
    preserves its value as a list.

M	nsproxy/nsproxylib.c
M	tests/ns_proxy.test

commit 63281da07ce5096bf3494f83d28f5a092759e008
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-05-05

    - make sure that size of ns_set is always less than maxSize, since  set->fields[size] is used

M	nsd/set.c

commit 0f37f566f3982a6e92c985d6f532127c14838ea0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-05-05

    - don't return directly from switch statement

M	nsd/info.c

commit dfcb3ca93dc6078190a327be8610f9790e2cb0f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-05-05

    - don't write block in a single line

M	nsd/form.c

commit 48ab9ca069b8ee14a51f68f615d81aaac9bb4a9a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-05-01

    - don't cast away const

M	nsd/tclmisc.c

commit 94bad2fc15125016777b5c20989d68cb29cfeb12
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-05-01

    - use FALLTHROUGH as pseudo comment, since "lint -fallthrough" did not work with pc-lint

M	nsd/tclthread.c

commit 413ecd36010ba2c572225f8290aa5bf6925f55a0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-05-01

    - remove implicit conversion

M	nsd/tcltime.c

commit a63820ab94776c4a676012b69b556c46ae221698
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-05-01

    - remove assignment operation from boolean expression

M	nsd/config.c
M	nsd/dstring.c
M	nsd/pathname.c
M	nsd/tclcallbacks.c

commit f0c15e5cf4aec57d9fccca2aa67281ca6e8944b7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-27

    - don't cast away const

M	nsd/tclobj.c

commit 619a1f59f7b4f2295b5d578693a5ba2ebf36f274
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-24

    - remove debug output

M	tests/ns_server.test

commit 8ce534fe3a61748b72bc7b1a4e904846c096263a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-24

    - reduce implicit conversions
    - add const declarations

M	nsd/crypt.c
M	nsd/queue.c
M	nsd/tcltime.c
M	nsd/urlencode.c

commit 18a08c98aa1093f7ee5a5d8764b3654f5d851f75
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-24

    - white space change

M	nsd/nsd.h

commit 4900d1d8b6a5bd9a9216b91fde72782547bcfc87
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-24

    - improve variable names (use inputSize instead of bufSize, which
      might refer to the output buffer size)
    - white space changes

M	include/ns.h
M	nsd/uuencode.c

commit 17fa08df085e540646045f19ceda40eab3431cd9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-24

    - removed Ns_ParseOptions() with defined types, use instead
      Ns_ParseObjv()
    - adapted regression test

M	include/ns.h
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/tclobjv.c
M	nsd/urlencode.c
M	tests/cookies.test
M	tests/ns_writer.test

commit 7f3706da8238e4578f275a4219b49f1af5bd1f68
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-24

    - clean compilation for clang 3.7

M	nsd/tclobj.c

commit 1ffac16858b818f4e30915e8f4e36f9205b0ccc9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-23

    - switched argument parsing for command "ns_server" to the standard
      Naviserver argv parsing (since this was fixed a few releases ago)
    - added converter (Ns_ObjvProc) Ns_ObjvServer
    - extended regression test

M	include/ns.h
M	nsd/queue.c
M	nsd/tclobjv.c
M	tests/ns_server.test

commit 7577511f86273d239934d5e56590fbf0ac1298ee
Merge: 526ba440 19ccf7f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-23

    - merge

commit 526ba44022ea3f7f4a3c9e3a2bfb98ceec758c8f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-23

    - stop tracking a debug file

D	tcl/nstrace.tcl-head

commit 57edfa9f83558b25e30e765ff62ee07e5d5a3963
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-23

    - add test case for "ns_server"

M	tests/ns_server.test

commit 345c6afc3faffd9ef4a435037832dbf11dcef1ce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-23

    - improve "signal lost" handling (timeout happens, but connPtr is provided). On some sites the previous approach was leading to a state stuck in a while in the error state.

M	nsd/queue.c

commit 19ccf7f15b4b431f192a8fd06e7a2c13dd821df6
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2015-04-22

    fix off-by-one error in ns_server
    
    NsTclServerObjCmd was incorrectly checking argc after parsing options.
    As a result, "ns_server -pool {}" (pool given, no subommand) would
    segfault.

M	nsd/queue.c

commit 0decdc4299b8a9181de824573e9dbf7de76137bd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-17

    - allow the synatx of the result of "ns_time format" to be used on input at every place, where ns_times are accepted

M	doc/src/naviserver/ns_sleep.man
M	doc/src/naviserver/ns_time.man
M	nsd/tcltime.c

commit 20752b201352154b8d53210728e314b761f50fbb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-16

    - added const declaration

M	nsd/return.c

commit 81dfd62ce764d6c329a1a8ae9f2cae53d17cd944
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-16

    - added const declarations

M	nsdbtest/nsdbtest.c

commit 8849eff3986236686a94b3895d006fe13af18c05
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-16

    - fix typo in WIN code

M	nsd/exec.c

commit 8f1fa6044d6f37910377cb0f6c954f18eb905d0a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-13

    Added tag naviserver-4.99.7 for changeset 380de4a12557

M	.hgtags

commit ed72d364c5e23f4b2953fcc73b5ba15388989ee2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-13

    Added tag naviserver-4.99.8 for changeset 5664e7d0813a

M	.hgtags

commit 36badc9229f9f2c1ff82532da943c37f1ded6660
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-13

    Added tag naviserver-4.99.7 for changeset 20ece8458972

M	.hgtags

commit 427b76bff0503d448b9ff3424608b3e0df42dd97
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-13

    - added release date to NEWS file

M	NEWS

commit 1fd12c0452c5c61262cb414567f2696bcdf28ca5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-13

    Added tag naviserver-4.99.8 for changeset 7350d17dc8f8

M	.hgtags

commit 26cf6c2e811f477f5bf258dea65e0c5524189d66
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-13

    - updated NEWS

M	NEWS

commit 03701af4604d3b1d67fa4bf5dc25182130b2edb0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-13

    - update version numbers to 4.99.8

M	README
M	configure.ac

commit b798725f4980258779f5e5ec50446e55a0e96ea8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-13

    - avoid potential access of string past null character

M	nsd/tclmisc.c

commit 40b8b97a710d8ce16544e962f636fdf7f92e3d10
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-10

    - added 24 testcases for image handling (we have now more than 1000
      test case in total)
    - modernize Tcl in documentation pages for image handling, uses
      see_also for pointing to other pages.

M	doc/src/naviserver/ns_gifsize.man
M	doc/src/naviserver/ns_imgmime.man
M	doc/src/naviserver/ns_imgsize.man
M	doc/src/naviserver/ns_imgtype.man
M	doc/src/naviserver/ns_jpegsize.man
M	doc/src/naviserver/ns_pngsize.man
A	tests/ns_image.test
M	tests/ns_md5.test

commit 2b9b608462d9f944ea4969628420e028cf7d62d4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-10

    - move "compresspreinit" to the server configuriation, same place as ompressenable, compresslevel, and compressminsize.

M	nsd/nsd.h
M	nsd/server.c

commit 7433becba7508b50606a6b473544f5a1c98f40df
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-10

    - ns_imgsize returned an error where it should return success and widht and heith returned as 0 (according to documentation)

M	nsd/tclimg.c

commit 167892cf7eda650210a6bd7daf1cc92995bfbe13
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-10

    - added global variable NS_finalshutdown to avoid freeing of thread
      local storage on final shutdown, since this seems to be the major
      source for crashes during shutdown.

M	include/nsthread.h
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/unix.c
M	nsthread/signal.c
M	nsthread/tls.c

commit 3983b1edcad30ca25024799cec6cf1568765e0b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-10

    - cosmetics (spacing, preferring NS_TRUE, moving parameter descripting
      to the right section

M	nsd/server.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit fba5d2e4c55312d40cfcd737f81d40d9b95321c6
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2015-04-09

    add compresspreinit config parameter
    
    Setting this parameter (default is false) will cause the compression
    stream buffers to be allocated and initialized at server startup.
    Without it, they will be allocated and initialied as needed.
    This drops the memory footprint of a server with a default config
    from ~40M to ~5M

M	nsd/server.c
M	sample-config.tcl.in

commit bc8af09caba527e28ea4743eb2a71c2581ff8e81
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-09

    - added ability to debug configuration via "ns_logctl severity Debug(cgi) on"
    - improved documentation
    - added nonnull declarations
    - replaced SetUpdate() by Ns_SetUpdate(), since no values are passed as NULL (tested via assertion)

M	nscgi/doc/mann/nscgi.man
M	nscgi/nscgi.c

commit 2aa5054e390d7ebe42810d37b8889b53d56ed4d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-07

    - add missing man page for ns_md5
    - add cross-refs for crypto functions
    - update NEWS

M	NEWS
M	doc/src/naviserver/ns_crypt.man
A	doc/src/naviserver/ns_md5.man
M	doc/src/naviserver/ns_sha1.man

commit fdb2db6b1837a726fdf7fcf64dfe925185fd9c60
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-06

    - updated version number, README and NEWS for release candidate

M	NEWS
M	README
M	configure.ac

commit 4c414763fb71e10fbdd61fbcb2752ee0fb72589f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-06

    - updated README and version number

M	README.md
M	nsssl.c

commit a6fb1afc7944e4e18e73267f865cb6d52c311537
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-06

    - Improved rpath handling in configure.ac for Linux distros,
      where TCL_CC_SEARCH_FLAGS and TCL_LD_SEARCH_FLAGS are set
      empty, like e.g.Debian (Many thanks to David Osborne for the recommendation)

M	configure.ac

commit bcf67447012612593585ae6da3f668dc8889fad8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-06

    - add assertion for dynamic array indexing

M	nsd/adpeval.c

commit 2d013d680f73a9d50f6f83d211dca203cc4f4853
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-01

    - improve robustness of tests

M	tests/ns_parseargs.test

commit f5262c9739ef9273e4b58a9d039cf546b61d2ae0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-01

    - ns_sha: removed (and commented) a seemingly unneeded memset()

M	nsd/tclmisc.c

commit 3511a5bfcae47651498a707dd44301a0b2526e98
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-01

    - add binary support to ns_sha1 to be feature compatible to ns_md5
    - add test cases for check-summing on binary files
    - reduce verbosity

M	nsd/tclmisc.c
M	tests/ns_md5.test
M	tests/ns_sha1.test
A	tests/testserver/pages/ns_poweredby.png

commit 9dde35db5eea274b13738520a07e689ec870b4db
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-01

    - improve wording in comment

M	nsd/queue.c

commit dfc654a3cc1fc460883b105642a58c5571d79561
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-01

    - revert +1 change, was not necessary

M	nsd/event.c

commit 93ece8655e1abe6b9d90acbce32d3692ff9c9586
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-01

    - ns_md5 added support for binary data
    - extended regression test

M	nsd/tclmisc.c
M	nsd/tclresp.c
M	tests/ns_md5.test

commit dc675774a9b8d0f8834b8c99d7a9b36e4513b66f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-01

    - fix long existing but so far undetected bug in ns_md5:
      confusion about uint32_t vs. uint8_t
    - cross checked results with other md5 implementations
    - added regression test set for md5

M	nsd/tclmisc.c
A	tests/ns_md5.test

commit 1116315bc374ba9fb193f121eb360853c1fc0095
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-04-01

    - improve startup message about FD_SETSIZE and hard/soft limits on number of files
    - improve indentation in nsthread.h

M	include/nsthread.h
M	nsd/nsmain.c

commit 4eaf233a38e96fe367465ead9cd46214a9b6796b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-29

    - prefer single return of function
    - protect against potential buffer overruns

M	nsd/log.c

commit 3910727ccdd529196d7d240642b5b284ddd803bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-29

    - no need to pass empty argument vector

M	nsd/fastpath.c
M	nsd/tcljob.c

commit 47776db9f646d9f7e173f28fdf4a0d373d0e9112
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-28

    - switch from db-specific flag fVerbose to Ns_LogSqlDebug to generalize notification handling (as already done in nsdbpg)

M	nsdb/dbinit.c

commit c186a43a01d823b46d41ffd362523127fb4ce520
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-28

    - fix off-by-one error on array size

M	nsd/event.c

commit d4bcd3cae80e4904dc91bd766163f8df5ab1f74c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-27

    - address possible reac condition

M	nsd/queue.c

commit a6c7c4f46c952c92554727019a669c4ff91a2e3a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-27

    - reduce warning during regression test

M	nsd/driver.c

commit b3ca9d9b5d477ba83e4f0c5003e9a30dc58b5850
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-25

    - add hack to address mysterical problem with static checker PC Lint, leading previously to an internal error

M	nscp/nscp.c

commit 596f47042f698f8439be9352c8986d729f8abe13
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-25

    - add suffix to avoid implicit conversion

M	nsd/conn.c

commit 96ec999f7f5bbb71000a232cca93bf7b8e0587d9
Author: Victor Guerra <vguerra@gmail.com>
Date:   2015-03-23

    parameter type was renamed to mimeType

M	nsd/return.c

commit e3d28371f00ebceb31fc212ecd888f1bfab4370e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-16

    - prefer variable name "mimeType" over "type" for mime types.

M	include/ns.h
M	nsd/return.c
M	nsd/tclresp.c

commit e661380ccf64121a64ae76353f4df20006fbaca0
Author: gustafn <neumann@wu-wien.ac.at>
Date:   2015-03-15

    README.md edited online with Bitbucket

M	README.md

commit 90c717c46679bca0315517f6c39e05756f2688d1
Author: gustafn <neumann@wu-wien.ac.at>
Date:   2015-03-15

    README.md edited online with Bitbucket

M	README.md

commit 0f0abd4eae54f240b47ec3ab351121e759ece9d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - use .md as extension for README to provide a nicer start page on Bitbucket

R100	README	README.md

commit dbdfde37519b521afece269199108686f5fc3e22
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - avoid c90 identifiers starting with str[a-z]

M	nsd/urlencode.c

commit 04c2dc5aa091a5415cf78c7a0449ddf5ed987e90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - align prototype with function definition

M	nsd/tclvar.c

commit 23816815dcdebc1e12143724f25f012353998418
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - avoid "bool" as variable name
    - don't write if-statements as a single line

M	nsd/tclobjv.c

commit e0de220fa9d5b9be7fdf1c4db2df0acb4f57f177
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - use char datatype when assiging to a char variable

M	nsd/tclmisc.c

commit 6e5143e58439a321326fef45b83f4df60155e327
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - don't use for loops without a braced body

M	nsd/request.c

commit 22c56aa162f558310f965e74ae83eb93ee402d74
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - reduce implicit signed/unsigned conversions

M	nsd/nsconf.c

commit 38c5bfadb46d9ef96ff1b94726eb32dfdb96af0d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - provide more hints for error diagnosis when DriverDebug is activated

M	nsd/driver.c

commit 942584cfb7fc66a8392306dc6e98b29b292c67bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - reduced implicit signed/unsigned conversions

M	nsd/crypt.c

commit ce121afd882b380ad9299cb9dea9d5cab50ccc0a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - don't use for loops without a braced body

M	nscgi/nscgi.c
M	nsd/auth.c

commit 1967eebb5efd199c4496d75b0f457bae71c477ef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - align prototype names and function names

M	include/ns.h

commit e35683b3d931dbc3a73d4e945e7eca8fb3717ad9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - make test more robust

M	tests/http.test

commit 1052e7789bb818bd1ebc25be50f8a3bf0baa6d2e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-15

    - added test cases for nsssl
    - new command nstest::https to provide support for running regression test over ssl

M	Makefile
M	nsssl.c
A	tests/all.tcl
A	tests/config.tcl
A	tests/etc/openssl.cnf
A	tests/modules/testhttps.tcl
A	tests/nsssl.test

commit 6b93e11d9cb880e550245fc9083fe5684197e4ef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-13

    - update README

M	README

commit 412bdfd53356b24742ef6780d030d81a50332bfa
Merge: 7dd0e2b1 9a79ba24
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-13

    - merge

commit 7dd0e2b1a185f53b29e74b6725569c8e0d401835
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-13

    - fix off by 1 bug leading to incorrect urls when https client was used with url path
    - align logic more closer with tclhhtp.c
    - bump version number to identify fixed versions

M	nsssl.c

commit 9a79ba2419511d5ca2a912e2780393601962aae3
Author: gustafn <neumann@wu-wien.ac.at>
Date:   2015-03-12

    README edited online with Bitbucket

M	README

commit 92b985693c9118de4d44771c52d682d715db442b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-12

    - update sample nsssl configuration

M	openacs-config.tcl

commit 8dd0cf17643768a14a0bc9233245b2f25e71cddc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-11

    - prefer bool and NS_TRUE/NS_FALSE over int and 1/0

M	nsssl.c

commit 6affb4ab9f8edd2f9a47745fc7f3d131121f896c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-11

    - prefer boolean and NS_TRUE/NS_FALSE over int and 0/1

M	include/ns.h
M	nsd/sockfile.c
M	nssock/nssock.c

commit 80a194a65ed7a77791392341daed89c2228a058e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-11

    - fix initialization (many thanks to David Osborn for the catch)

M	nsd/sockfile.c

commit a5e0dce3f89a52029469e497efa73138475e296a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-04

    - remove redundancy from CFLAGS, come closer to what's probably intended by tcl.m4

M	include/Makefile.global.in

commit ee68ff532c716ce74f3b9b6174e925b9f722f4d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-03-04

    - Fixed bug, where one thread frees a nsv-array, but an internal
      representation of a Tcl_Obj for this array in another thread
      contains still a pointer to the freed array. The bug was introduced
      in Nov 2014, when fixing the memory leak of unset nsv-array
      structures. After the change we use now a less aggressive caching by
      just storing the bucket pointer in the internal representation of
      the Tcl_Obj.
    - Prefer boolean and NS_TRUE/NS_FALSE over int and 1/0
    - Use lowercase unsigned suffix

M	nsd/tclvar.c

commit c18f8d19fbda5e704d5fca4124d40966b7dbe177
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-25

    - fix bug reported by Wolfgang Winkler, when " ns_urldecode --" is called.
    - switched ot regular argv parser, since reasons for using alternate one is fixed for a while (using caching of internal rep only for non-shared tcl-objs)
    - extended regression test

M	nsd/urlencode.c
M	tests/ns_urlencode.test

commit ae30c65a61062a9666d47815cef3571194de058e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-25

    - don't crash on [ns_conn content] when there is no content
    - extend regression test

M	nsd/conn.c
M	tests/ns_conn.test

commit e324c087dc2be1df53f9c90a0af91b8f6f0950b8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-23

    Added tag naviserver-4.99.7 for changeset 380de4a12557

M	.hgtags

commit ebc6a47198ee7444df001a4042b012e73d73cf1c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-23

    - fixed typos and polished text

M	NEWS

commit ddba5cefdbad864864339447be4deae2b673a292
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-23

    - update NEWS file

M	NEWS

commit bc072b4aa2f9d3b222132d38af804775c7fd8971
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-23

    - add uncommitted file

A	doc/src/naviserver/ns_connchan.man

commit 9be8db60a800ab6cef97abb10dbf9e00daa46274
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-23

    - bumped version numbers

M	README
M	configure.ac

commit c1dd3eaf024aac754ad5d2dccbfe1f5dceb5792f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-23

    - make path const (since it is returned usually as const)

M	include/ns.h

commit 12e41a4dafa0f37edb04f2fca4b57aa05dffffdc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-23

    - update recommended ciphers to exclude RC4

M	README

commit 454b76b72b35842a99aad8e5852917bb1d49086e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-21

    - define path as const

M	nsssl.c

commit ddb48d23982fb95a1d126bb700c8d8966a2ec19a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-21

    - relax constraint that 2nd argument of Ns_TlsSet() has to be non-null

M	include/nsthread.h
M	nsthread/tls.c

commit 38829979ccb3f756d26efeaad8da417dbddf8293
Merge: f0a0984a 5ca3d48e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-21

    - merge

commit f0a0984a28ac09fc52eb81c33c1a5cd1c3f5a205
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-21

    - improve security options in README file

M	README

commit 86254ef90cc1238f12c23888decd9bee7985226c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-21

    - use documented MODOBJS instead of older-style OBJS in Makefiles

M	Makefile

commit 5ca3d48eed65cd219bb62e2d12cd70980856c754
Merge: e6e92b4f 0771940e
Author: gustafn <neumann@wu-wien.ac.at>
Date:   2015-02-20

    Merged in apiskors/nsssl (pull request #1)
    
    add Windows nmake support

commit 27c77f8891597040ab55a2698280520881ed9049
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-19

    - whatspace change

M	nsdb/Makefile

commit 5e4c3f168445585edce78516fe00fea718cb7670
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-19

    - sue ccourier forn when displaying results of [const ...] in documentation

M	doc/src/man.css

commit 4b30c46ed2de7442074ed5290a99cff464ea995f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-19

    - improve docuemntation

M	doc/src/manual/tcl-lib-file.man
M	nscgi/doc/mann/nscgi.man

commit 43996e9fb54c4ca3b5432a06bebf2d35709218d2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-15

    - fix typesetting
    - remove obsolete content (e.g. concerning CVS)
    - use examples from existing code basis

M	doc/src/manual/main-standards.man

commit 32bae2b9a005c28c904580ec8f57ca3cab0e8276
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-15

    - use documented MODOBJS instead of older-style OBJS in Makefiles

M	nscgi/Makefile
M	nscp/Makefile
M	nsdb/Makefile
M	nsdbtest/Makefile
M	nslog/Makefile
M	nsperm/Makefile
M	nssock/Makefile

commit bcd6545698d13af7a2ea4f6d0de48411ee746120
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-10

    - added compatibility macro PRIuz in symmetry to PRIdz. the former is  for size_t, the latter for sssize_t
    - added length fields for *scanf* operations to avoid possible  internal buffer overflows in certain versions of libc
    - added --verbose flag for cppcheck

M	Makefile
M	include/nsthread.h
M	nsd/config.c
M	nsd/driver.c
M	nsd/return.c
M	nsd/tclobj.c
M	nsd/unix.c

commit 28cea9fa38d2415919b12fc5e60cbbf3ca85303d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-10

    - reduce variable scope

M	nsd/tclthread.c

commit a00a4bb669b08d719b58864fa8eda41b4373f22d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-10

    - make sure to initialize array "chars"

M	nsd/uuencode.c

commit 9c9a395b8c79dd0bc61e225c6b06602f54c1939e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-08

    - fixing potentially undefined behavior
    - adding const

M	nsd/compress.c
M	nsd/httptime.c
M	nsd/lisp.c
M	nsd/tclxkeylist.c

commit 911e5fb7fe908af20b0cd0c05c5d01aa00c0f93c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-08

    - remove obsolete undefine operation

M	nsd/watchdog.c

commit 2ac6c5d382d9cb11502a25153f74ad869a43306f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-08

    - improve documentation

M	doc/src/manual/tcl-libraries.man

commit 5b838341a4a080a5dbcc45ab80652b124db15013
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-01

    - use unsigned type for bit operations

M	nsd/log.c

commit 5a33167dc64596032d6ae8431c0fa449646ca1f2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-02-01

    - fix duplicate semicolon

M	nsd/conn.c

commit e3c54c2a8ebda4ff02f6d5a4c179594e393f9b9e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-31

    - improve comment density

M	nsd/adpparse.c

commit 3b5ddeb1916e44dd226701d985f662a4f1980deb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-31

    - improve comment density

M	nsd/connchan.c

commit 674aacb2cd55bca6249a993215d235f462bab4d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-31

    - improve comment density

M	nsd/tcltime.c

commit bae6bd7cb41adc02303b0bee8b07366ab1cbb844
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-31

    - mark ns_geturl as deprecated in favor of ns_http
    - improve comment density

M	doc/src/naviserver/ns_geturl.man
M	nsd/urlopen.c

commit cf8e73ddff4986cec90c7e1014d6c35a881f71b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-30

    - add additional test cases for http encodings (including curl-based testcase, when curl is available)
    - finish the default charset of utf-8 (adjust encoding testcases)

M	tests/encoding.test
M	tests/http.test
M	tests/test.nscfg

commit 0424292969c337ed8db2e947e6b7eb096ca7dc4e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-30

    - bugfix and compatibility with aolserver: return for "ns_conn content" per default result in the charset of the connection
    - add for "ns_conn content" the flag "-binary" to return the raw byte array

M	doc/src/naviserver/ns_conn.man
M	nsd/conn.c

commit 6fd6c6d7b3cba3983fffb6a9b766cc27b4f27253
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-29

    - remove unneeded operations in driver loop, add likely/unlikely

M	nsd/driver.c

commit 5825e4508b9712a6c9291a94d117828e916a95d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-29

    - add tests for encoding in "ns_conn content"

M	tests/http.test
M	tests/test.nscfg

commit b3c474a40e7e6160c95916e45d754951b10d838f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-29

    - fix typo

M	tests/ns_adp_compress.test

commit fcb290fd8f4f315941af3fe02d2d53b8ce18ab38
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-29

    - reduce verbosity

M	nsd/dns.c

commit 74a18dd415912d9a9ab1a00144ce2ed699d3193f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-21

    - use INT2PTR macro for integer to pointer conversion

M	nsd/cls.c

commit 15b438ad401187f1b5e2ae4f5c4b2907177d0414
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-16

    - win32: use GetCurrentProcessId() instead of _getpid() to return DWORD instead of int

M	include/nsthread.h

commit 4c599fb7ee145c0ff0e3b1b4ba1404d569fe1b8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-16

    - don't apply plain #if on undefined preprocessor variable

M	nsd/nsmain.c
M	nsd/random.c

commit 6c1bb06d57fdf619f392ae0930338606cee5a77b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-13

    - reduce implicit conversions
    - improve variable names
    - improve comment
    - prefer lowercase type suffix

M	nsd/return.c

commit ef5dcef6d50c44e3789d745158e8c2eca2b46362
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-12

    - improve comments

M	nssock/nssock.c

commit 0ede7c7e53115421d56241ec53ec7309ca713295
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-12

    - fix extra headings handling

M	nsd/driver.c

commit 94dd4a4afd2b5abdb59f7304a895b70540f8a442
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-12

    - reduce implicit conversions

M	include/nsthread.h
M	nsd/adpcmds.c
M	nsd/crypt.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/nsd.h
M	nsd/request.c
M	nsd/return.c
M	nsd/tclhttp.c
M	nsd/urlopen.c

commit 0fadeae678a5ce8177c7130d3ce49588055f9e2b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-12

    - align name to posix

M	nsthread/winthread.c

commit 66e6751b0e9e417a541246453f23fecc1ab09f8b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-10

    - the macro HAVE64 was never initialized.
    - rename HAVE64 to HAVE_64BIT to follow naming conventions more closely

M	include/ns.h
M	include/nsthread.h
M	nsd/tclmisc.c

commit 2e41dc76e6c54a15f0172ccc30bf66659ec60a3e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-10

    - recast result of <<
    - adding const properties

M	nsd/crypt.c
M	nsd/nswin32.c
M	nsd/urlencode.c

commit 1d03addc568281c11dcf436bc248eb4393dd103d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-10

    - recast result of <<
    - adding non-null assertions
    - adding const properties

M	nsd/tclimg.c

commit 0c76c140a95acdd2420c49baa2614e251ac88d54
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-10

    - improve locality
    - don't declare variables after assert()

M	nsd/tclmisc.c

commit df7babd9f979f0f1b9d93a40a2447226100457d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-10

    - recast result of << operation

M	nsd/uuencode.c

commit 2263d0e44b8721fe6357a246cc1969b0f4c6083c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-10

    - added test for "ns_thread handle"

M	tests/ns_thread.test

commit ff6fe079da0770ca6d0ced71720c935c809ba4ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-09

    - adding non-null assertions
    - removing unneeded casts
    - adding const properties
    - adhere to function naming conventions
    - put macro values into parenthesis

M	include/ns.h
M	nsd/tclmisc.c

commit e6e92b4f7f664513008ae6ff13d3a4e627f81023
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-07

    - fix freshly introduced bug while eliminating write operations to const strings

M	nsssl.c

commit 0470b5ba96955abbac83bd4447f7149a3653a3d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-07

    - fix freshly introduced bug while eliminating write operations to const strings

M	nsd/tclhttp.c

commit 814f8fea1ae66a909be36c38bd13ef0fce3ea9f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-07

    - add trailing dash

M	nsd/queue.c

commit e4e1e925f4e3a58c16ed668e504347d098b97ac5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-07

    - try to silence pc-lint the fseudo comment
    - add missing comma

M	nsd/tclthread.c

commit a35fca004713a7b9e6048193f8b9c693941ff9b7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - improve markdown

M	README

commit 10eec6c087f4a53ef197f366cc2e86843e6e5069
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - improve markdown

M	README

commit 50be371fd41226120a541139f186aa316e0de86e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - improve markdown

M	README

commit 87e4bc7840e4d1957724a3b7c740733d9e422e47
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - improve markdown

M	README

commit 90476715eb0997c4426097f84f2cbc99e0c6baff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - improve markdown

M	README

commit 55854221fa892480827e087d9b78f58f2d3f035b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - improve markdown

M	README

commit 64fa881d1e362b547a605e8c6bc97ae59c2f6146
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - improve markup on Bitbucket via markdown

M	README

commit 21057d8e86e8f89502e0a8cea91c1e4c08405bc4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - reduce modifications of const strings

M	nsssl.c

commit d07191d15465ae4a2f2095cfd29b024f71dbea99
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - improve markup and wording

M	doc/src/naviserver/ns_thread.man

commit 871e4d966d60aab11b908818c6e6ce5c9f34e9cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - added an option "-name" to "ns_thread begin" and "ns_thread begindetached"
    - marked redundant names of subcommands in ns_thread as deprecated
          ns_thread begin -> ns_thread create
          ns_thread getid -> ns_thread id
          ns_thread join -> ns_thread wait
          ns_thread get -> ns_thread handle
    - updated documentation

M	doc/src/naviserver/ns_thread.man
M	nsd/tclthread.c
M	tcl/nstrace.tcl
M	tests/ns_cache.test
M	tests/ns_thread.test

commit 062754fd1a9a1e4d88664cdb9001ea0c210629d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - prefer bool over int (make management of keep-alive status more explicit)

M	include/ns.h
M	nsd/conn.c
M	nsd/connchan.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nssock/nssock.c

commit 0643ca8a034428dc91ed28901ef247839c6bcd99
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-05

    - recast after "<<" operation (MISRA 10.5)

M	nsd/uuencode.c

commit f6022495a3add81625cb44320c4decd4342e9e86
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-04

    - use consistently uintptr_t for nextids

M	nsd/nsd.h
M	nsd/queue.c
M	nsd/tcljob.c
M	nsthread/cslock.c
M	nsthread/mutex.c
M	nsthread/rwlock.c
M	nsthread/sema.c
M	nsthread/thread.h

commit 7ca823de1aadaf61c93f0e77da0be3c7012c8724
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-04

    - add const declarations

M	nsproxy/nsproxy.h
M	nsproxy/nsproxylib.c

commit dd5c6c7f5f43141ee794dc6b3b4308e65d14343a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-04

    - prefer boolean expression

M	nsperm/nsperm.c

commit d8da7ed27972be972f5ee99f0f1c2d4c5f7c7765
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-04

    - improve documentation

M	doc/src/manual/tcl-libraries.man

commit cdb86259679401c1ee855a179a9c5c0cf519f9b2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-03

    - documentation fix for ancient parameter passing to functions registered via ns_register_proc

M	doc/src/naviserver/ns_geturl.man

commit 7fd0b29aa9e4aa4b293758a93e70fe2f90e6b69d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-03

    - various more documentation fixes for ancient parameter passing to functions registered via ns_register_proc

M	doc/src/manual/tcl-overview.man

commit 11d5e2831dbaa959821e152ab880600482eb55c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-03

    - documentation fix for ancient parameter passing to functions registered via ns_register_proc

M	doc/src/manual/tcl-libraries.man

commit 558bad45c98ce1b174a295fbe79741a0cdd8d3e6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-03

    - improve documentation

M	doc/src/manual/tcl-libraries.man

commit fa38e57c546a2412b91651fd254d030495f87721
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-03

    - there is no evident need for using "eval"

M	nsd/init.tcl

commit 6028c2bf62460f5c5a420470507e7d28e4703b3b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-02

    - reduce implicit conversions
    - add const property
    - reduce variable scope
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	include/ns.h
M	nsd/connchan.c
M	nsd/cookies.c
M	nsd/fastpath.c
M	nsd/nswin32.c
M	nsd/sockcallback.c
M	nsd/tclresp.c
M	nsthread/thread.c

commit f44bcd7b055b0b22304b7ff07451d895417acb26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2015-01-01

    - make TclThread more robust
      * fix crash when a thread was created with "ns_thread  begindetached", but
         an error occurred during startup)
      * fix memory management for TclThread by moving TclThreadArg into
        thread local storage
      * provide the new call NsThreadShutdownStarted()
        to handle race conditions in tls cleanup during thread shutown
    - prefer bool over int for boolean variables
    - use unsigned variables/values for flags

M	include/nsthread.h
M	nsd/tclthread.c
M	nsthread/pthread.c
M	nsthread/thread.c
M	nsthread/thread.h
M	nsthread/tls.c
M	nsthread/winthread.c

commit aff3474972227cba0f94e14da0edbe496e5bbf9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-31

    - add missing file

A	nsd/connchan.c

commit fd0d249e5f73acac618191bed76ddb89b43c51c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-31

    - first implementation of ns_connchan

M	doc/src/naviserver/ns_chan.man
M	doc/src/naviserver/ns_sockcallback.man
M	include/ns.h
M	nsd/Makefile
M	nsd/nsd.h
M	nsd/request.c
M	nsd/tclcmds.c
M	nsd/tclinit.c
M	nsd/tclresp.c
M	nsdb/doc/mann/ns_db.man
M	nssock/doc/mann/nssock.man
M	tests/ns_conn.test

commit b8aa3b7a03616f542dd2bfeaf28f01a51fa92ed9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-23

    - make sure to have diff always initialized

M	nsd/sockcallback.c

commit 84bdaf33251b47bbf0abc0fb088747bcd08a75da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-23

    - reduce variable scope

M	nsd/tclsock.c

commit 9412d7f7425c8392be6b8d0e7d508df4f12e02f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-23

    - add const declarations for (Ns_Time *)

M	nsd/sockcallback.c
M	nsdb/dbinit.c
M	nsdb/nsdb.h

commit 83a711ad71391a1dbae46bd7d18a9b47a58b07d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-23

    - improve robustness of code

M	nsd/return.c

commit 2587293a2e6a448ad4ddb48d2eafc568d6c41822
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-23

    - remove useless variable

M	nsd/sockcallback.c

commit 704c279af49362a5a413cdb0cabdc99c6dbc6ded
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-23

    - reduce variable scopes

M	nsd/cookies.c

commit 1c33f71cbd7e4b130ff1dd6c2c447916b455ba92
Merge: 0211948b f2e16a78
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-20

    - merge

commit 0211948bc7de4383f77a6c1b4cef1f0c75654a76
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-20

    - remove hard-coded sizes of ip-addresses and replace it by  NS_IPADDR_SIZE
    - fix incorrect result of   "ns_conn protocol" (returned empty"
    - extend regression test
    - provide new function NsTclAllocateInterp(NsServer *) in addition to
      Ns_TclAllocateInterp(char *server) to reduce string base server lookups
    - use Ns_Time for timeouts instead of int/long
    - let Ns_SockCallbackEx(), Ns_SockCancelCallbackEx() return optionally the name of the associated thread
    - use bool instead of int as last argument of ns_sock_set_blocking()

M	doc/src/naviserver/ns_sockcallback.man
M	include/ns.h
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/nswin32.c
M	nsd/queue.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclsock.c
M	nsd/unix.c
M	tests/ns_conn.test

commit 3be79c770a312eaec350f606e44f3613b0505e2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-20

    - use Tcl_DStringResult instead of AppendResult

M	nsd/driver.c
M	nslog/nslog.c
M	nsperm/nsperm.c

commit 827a7f49f7d0ffa577a878cf66d0179c17b8e34f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-20

    - reduce implicit signed/unsigned conversions

M	nsd/crypt.c

commit ea6338ee65395b5f2b5102aae9752c0611411d9b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-20

    - add nonnull assertions

M	nsd/tcltime.c

commit 35abd78073438d4eb10c06d9f01452095d67adf2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-20

    - fix typo

M	nsdb/dbtcl.c

commit 7c580f172db56bc9876e4f4ed7676a5a8fc5e4b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-20

    - add nonnull assertions

M	nssock/nssock.c

commit 18adf02e5c73560ac37ef2278b139d761cc88e18
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-20

    - add editor hints

M	nssock/nssock.c

commit a9e707ad1373aee1f4046849ee0c46cc75d995f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-20

    - allow time interval of timeout for "ns_db gethandle" to be specified with second factions (usual ns_time format)

M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/doc/mann/ns_db.man
M	nsdb/nsdb.h

commit 7342caf75a4ce5f7e2167b1dae2658597ce2039a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-20

    - document "ns_time format"

M	doc/src/naviserver/ns_time.man

commit e63565f724c60fa376e552d1418126c242529526
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-20

    - make threadpool timeout an Ns_Time (as it is the case for most other timeout values)

M	nsd/tcljob.c

commit f2e16a78bbc41c8ae66a8d3aec5878924847bd77
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2014-12-18

    fix setting of private/shared in ns_module

M	nsd/init.tcl

commit d82e5571084292de833d6bf63d0005014e99881f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-18

    - move network module filtering to the front to avoid double loading of Tcl modules (many thanks to William Scott Jordan for the fix)

M	nsd/init.tcl

commit b3ba725337501a67e7bb5198666a96b5fc4d2eb2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-13

    - don't nest the malloc in memcpy()

M	nsthread/memory.c

commit 813c6b8bffe29f29d69b6ba1cb4d92f5b99f9664
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-13

    - move assignments out of if-conditions

M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/cookies.c
M	nsd/dns.c
M	nsd/fastpath.c
M	nsd/pathname.c
M	nsd/range.c

commit b11b504bc2bd86ed3f7c9ae93d0204ff575ef6c1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-13

    - don't cast complex expressions

M	nsd/cookies.c
M	nsd/nsmain.c

commit 43576a3ca9a823db1dd36379f16636c4139c001a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-13

    - don't cast complex expression

M	nsd/httptime.c

commit 72117e4e22f31ace2db0562df7973ca32b4579e2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-13

    - reduce signed/unsigned conversions

M	nsd/crypt.c

commit 9b40b1b680dce36677ec724001542e37630ad821
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-13

    - remove dead assignment

M	nsd/config.c

commit 5d6786e8080c592108bb9e2df6efe5831b607595
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-13

    - simplify macros

M	nsd/limits.c

commit 1fbbdf328dbcbcb2a1c489983853213645b2d033
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-13

    - don't use old-style prototypes

M	nsd/log.c

commit be41fdbc8e28619d496e20f0a1001fb722802a00
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-11

    - reduce probibited operations with plain chars
    - reduce implicit conversions

M	nsd/cache.c
M	nsd/crypt.c

commit 2fc1fdde9c828d54864cc0441b2554d68d769700
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-11

    - white space change: remove trailing spaces, replace tabs by spaces, prefer suffix "u" over "U"

M	nsd/driver.c

commit 7deaae877255e561ae4927660b148da50d333658
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-11

    - deleted unneeded code
    - fix spelling in comments

M	nsd/queue.c

commit daa094d22346d424ca12fd1ca9cdf7783f699402
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-10

    - reduce implicit signed/unsigned conversions

M	nsd/nswin32.c
M	nsd/queue.c
M	nsd/sock.c
M	nsd/tcltime.c
M	nslog/nslog.c

commit b78bf0d54ba17180bb7d3bea08f5033a3c88cd03
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-10

    - removed declaration of not used symbols NsCloseAllFiles(), NsStopSockCallbacks(), NsStopScheduledProcs(), NsGetBuf(), NsUrlSpecificWalk()
    - complete adding of nonnull constrains in nsd.h

M	include/ns.h
M	nsd/cls.c
M	nsd/config.c
M	nsd/encoding.c
M	nsd/listen.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/sls.c
M	nsd/tclcmds.c
M	nsd/unix.c
M	nsd/urlspace.c

commit d7b6d3389f9f038dd41951bab3010533718b2b20
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-10

    - silence checker about possible initialized value in error branches
    - fix indentation

M	nsd/log.c

commit 034c48318f0d593f48bf81ffb807314dba9c6711
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-10

    - add nonnull constraints to binder.c, config.c, limits.c
    - add more const declarations

M	include/ns.h
M	nsd/binder.c
M	nsd/config.c
M	nsd/info.c
M	nsd/limits.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/queue.c
M	nsd/server.c
M	nsd/tclinit.c
M	nsd/tclthread.c

commit ea89a5997b464b71f237350639ac7ef136a428b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-09

    - add nonnull constraints

M	nsd/driver.c
M	nsd/filter.c
M	nsd/mimetypes.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/pathname.c
M	nsd/request.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/url2file.c

commit 66f90987d7e1faa53d65475a80ea134d34696be3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-09

    - reduce implicit signed/unsigned conversions

M	include/ns.h
M	nsd/adprequest.c
M	nsd/cls.c
M	nsd/connio.c
M	nsd/crypt.c
M	nsd/httptime.c
M	nsd/set.c
M	nsd/sls.c
M	nsd/tclobjv.c
M	nsd/tclsock.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/urlopen.c
M	nsd/urlspace.c

commit 455013f868fc94d8d4c0e5b5d20d83c1a618f9bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-09

    - add const declarations

M	nsd/queue.c

commit 23127e4832d17038947055db01b22504a72afd8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-09

    - leave switch statement via break, and not via return

M	nsd/log.c

commit cce6cce9c01f44e2292f00abdd8cfc086603891d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-09

    - prefer bool and NS_TRUE/NS_FAIL over int and 0/1

M	nsd/driver.c

commit 1c978919401da0a83b65821617572252bf175c74
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-09

    - relax nonnull constraints for Ns_SockListenUdp
    - improve documentation

M	include/ns.h
M	nsd/binder.c

commit e91462c9ea2afef298ddbd3c0274dd5609c35c49
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-08

    - add const declaration which become possible due to last changes

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/exec.c
M	nsd/nswin32.c
M	nsd/queue.c

commit 7e93e400ff691c41ce9565fd1034abe123c131d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-08

    - don't cast away const

M	nsd/conn.c

commit 418e90544d0b508b2fd6f6715a8134aed8a797c1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-08

    - ajust comment style

M	nsd/binder.c

commit e500bf778d1420452015815eea59ffa1a35155ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-08

    - make enumeration in case statement complete

M	nsd/tclinit.c

commit 5d315c7068cbf04f0f1a63117bcc0e7ecead5899
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-08

    - align with prototype names

M	nscp/nscp.c

commit ce96401592b71c9f081a321f4833360d7a0bcec1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-08

    - add nonnull assertions (finishing all prototypes from ns.h)

M	include/ns.h
M	nsd/binder.c
M	nsd/fd.c
M	nsd/listen.c
M	nsd/proc.c
M	nsd/quotehtml.c
M	nsd/return.c
M	nsd/sched.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nsd/tclcallbacks.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/unix.c

commit b62317de0a829364a88d8cea9f785d02734f5f5a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-07

    - add nonnull assertions in lisp.c, listen.c, pathname.c and tcltime.c

M	include/ns.h
M	nsd/lisp.c
M	nsd/listen.c
M	nsd/pathname.c
M	nsd/tcltime.c

commit d0024cdba31d2209c0089408005a5de07d2c752f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-07

    - add nonnull assertions in dstring.c and index.c

M	include/ns.h
M	nsd/dstring.c
M	nsd/index.c

commit 731d356db90c5224b4771f5217e2921245b826ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-07

    - fix condition in tclsock
    - no need to iterate over callbacks when ns_poll() returns 0
    - prefer bool and NS_TRUE/NS_FAIL over int and 0/1

M	nsd/sockcallback.c
M	nsd/tclsock.c

commit a0364430519642871f3e4529a2eccbb08b7228ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-07

    - fix random calculation based on arc4random()

M	nsd/random.c

commit 0f6b3d279302c3f45e7385ebdf84e652aef0d1db
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-07

    - fix wrong command name
    - improve linkage between related commands

M	doc/src/naviserver/ns_base64decode.man
M	doc/src/naviserver/ns_base64encode.man
M	doc/src/naviserver/ns_uuencode.man

commit 180e3377fa17b2dc533963d6461e9f0671d5d464
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-06

    - update documentation for ns_logtcl

M	doc/src/naviserver/ns_log.man

commit fe9474631423437a713052c6f8444c431640f583
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-06

    - minor cleanup

M	nsd/conn.c
M	nsd/dns.c
M	nsthread/mutex.c

commit 420780cd9811068f0c2b57f3ae30728622ee78d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-06

    - add nonnull assertions to crypt.c, dns.c, event.c, exec.c, uuencode.c
    - add const declarations in crypt.c, dns.c, event.c, exec.c, uuencode.c

M	include/ns.h
M	nsd/crypt.c
M	nsd/dns.c
M	nsd/event.c
M	nsd/exec.c
M	nsd/uuencode.c

commit e618cda9b7644cc21d12e8d720087b6a2b86142c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-06

    - add nonnull assertions to cookies.c
    - add const declarations in cookies.c

M	include/ns.h
M	nsd/cookies.c

commit 3450c504f2a742d9005d2ea0f376173b0a77a17e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-06

    - add nonnull assertions to conn.c
    - fix wrong placement of function names in ns.h
    - add const declarations in conn.c
    - prefer bool and NS_TRUE/NS_FAIL over int and 0/1
    - reduce implicit signed/unsigned conversions
    - reduce assignments in conditional expressions
    - fix api documentation bug

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/adpcmds.c
M	nsd/compress.c
M	nsd/conn.c
M	nsd/crypt.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/log.c
M	nsd/nsconf.c
M	nsd/nswin32.c
M	nsd/request.c
M	nsd/tclenv.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/tclxkeylist.c
M	nsd/uuencode.c
M	tests/ns_log.test

commit f9f15863fbd1306a3fbbd981efa28bd69163782b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - fix freeing of dstring: Tcl_DStringResult() clears the dstring automatically

M	nsd/info.c

commit aece434c25c90a86be8dd5d8082b7970614d41a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - added experimental log statistics

M	nsd/log.c

commit fd1ded4cba18491a2fc5d97c04db9cc404ebe42b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - add nonnull assertions

M	include/ns.h
M	nsd/log.c

commit c5a1a67771f74c893b443d4a436921dab7b47023
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - use boolean datatype for log severity enabled

M	include/ns.h
M	nsd/log.c

commit 0ac225c98797525950dc6c6643761aa110749915
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - fix potentially uninitialized variable

M	nsd/listen.c

commit 6b14833fbe6aa0f38027e11861db2340a3cf1dd7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - make ignoring of arguments explicit
    - reduce implicit signed/unsigned conversions

M	nscgi/nscgi.c
M	nsd/sockfile.c
M	nsdb/dbutil.c

commit fad0c1e751ae0e952d9ed1500ada1fd6390281bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - use same datatype for timeout (long) as in time structure
    - use boolean for shutdown and wakeup flags

M	nsd/limits.c
M	nsd/listen.c
M	nsd/nsd.h
M	nsd/queue.c

commit 8be5eacb69908a7faa08331fe4b859456b90bcf5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - handle results of Ns_SockProc

M	nsd/listen.c
M	nsd/sockcallback.c

commit daf77e65fc8a0ce3752ddc6b74e5f7d3d54bece8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - document cases, where result of Ns_SockProc are ignored
    - use NS_TRUE/NS_FALSE instead of numeric values when checking results of Ns_SockProc

M	nsd/sockcallback.c

commit 27a526d117b3e60e8552fe457ac9da820d2fead9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - Ns_SockProc returns NS_TRUE/NS_FAIL; therefore, return type should bool

M	include/ns.h
M	nscp/nscp.c
M	nsd/listen.c
M	nsd/returnresp.c
M	nsd/sock.c
M	nsd/tclsock.c

commit 41966621c384a2482d8580e5dac01c8eff3cc970
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - make sure to use NS_SOCKET and NS_INVALID_SOCKET instead of int/-1

M	nsd/binder.c
M	nsd/request.c

commit 1681c9193b6a14073466ba6fd0893cc03d7f9940
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - prefer bool and NS_TRUE/NS_FAIL over int and 0/1

M	nsd/form.c

commit b05a1791613f3f85188e42227da3acce9fa0ed04
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-05

    - get rid of undefined behavior
    - prefer boolean expressions
    - add cons property

M	nsd/request.c

commit 5ccd713c13d6e763774119dc147d3aa92888f8ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-04

    - make Ns_Encrypt threadsafe under Linux

M	nsd/crypt.c

commit 89486c4f813f637398bba71ebbcec059e336ba3b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-04

    - make sure the Tcl_Obj-cached array ptr has already a bucketPtr (result of linux testing)

M	nsd/tclvar.c

commit 5e3e299b20b1ff267a900d119249118c974a7413
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-04

    - silence -pedantic compilation with -stc=c99 under linux

M	nsd/return.c

commit 5efcbfe6f504362502013f3cead397b53fff8c1e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-04

    - check for existence of crypt_r
    - reduce implicit conversions

M	configure.ac
M	include/nsconfig.h.in
M	m4/misc.m4
M	nsd/crypt.c

commit 20db72f32f3b8f127c51c5aa3be5a54c01ffcf62
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-04

    - allow one to set logging of SQL statements via "ns_logctl severity Debug(sql) on"
      at runtime
    - reduce implicit conversions

M	include/ns.h
M	nsd/conn.c
M	nsd/log.c
M	nsd/rollfile.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/nsdb.c
M	nsdb/nsdb.h

commit 1c8a5e301546c5288063c3ed01bd4db5911a6734
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-03

    - add C-API function Ns_LogSeveritySetEnabled() to let modules change
      enabled states
    - ns_http:
        * fix invalid request strings, when url http://google.com/ (with trailing  slash) is used
        * fix possible race condition when time gap between "ns_http queue"
           and "ns_http wait" is larger
    - prefer memcpy over strncpy, since it has in most cases the appropriate semantics
      and it is faster
    - avoid multiple strlen() operations
    - provide better handling of overlong strings
    - add nonnull assertions

M	include/ns.h
M	nsd/adprequest.c
M	nsd/binder.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/log.c
M	nsd/nsconf.c
M	nsd/queue.c
M	nsd/task.c
M	nsd/tclenv.c
M	nsd/tclhttp.c
M	nsd/tclxkeylist.c
M	nsthread/memory.c
M	nsthread/mutex.c

commit 47bbbcdb38e562cfcf37ce02f7a2c7e06817b9bd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-02

    - use memory bounded functions instead of potentially buffer overflowing functions
    - reduce scope of variables
    - dereference values after assertions

M	nsd/cache.c
M	nsd/crypt.c
M	nsd/form.c
M	nsd/task.c

commit 5b4222579f0d09846c1e00ff48de2372277c5a06
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-02

    - reduce number of false positives for cppcheck

M	Makefile

commit 9f1310f373d900ca5942e77eeb63dded18813695
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-02

    - use memory bounded functions instead of potentially buffer overflowing functions
    - warn, when results of ns_malloc, ns_calloc or ns_strdup is not used
    - replace macro ckstrdup by function in tclxkeylist.c
    - add const declarations
    - prefer "const" over "CONST" unless in Tcl interface

M	include/nsthread.h
M	nsd/rollfile.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclobjv.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tclxkeylist.c
M	nsdb/dbutil.c
M	nsproxy/nsproxylib.c
M	nsthread/memory.c
M	nsthread/thread.c

commit eea1882d26f6df45ca9b28ec13b75560cd981f18
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-02

    - add nonnull assertions to mimetimes.c and rollfile.c
    - ignore less function results
    - reduce variable scopes
    - reduce implicit signed/unsigned conversions
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	nsd/config.c
M	nsd/crypt.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/mimetypes.c
M	nsd/nsd.h
M	nsd/return.c
M	nsd/rollfile.c
M	nsd/sock.c
M	nsd/str.c
M	nsdb/nsdb.c

commit e33218d7e731a27dfe91a777eabaab39f2e986c9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-01

    - reduce implicit conversions

M	nsd/crypt.c

commit 10f66004bc673c0a54882de27f7eb882f6903b2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-01

    - cleanup type under windows

M	nscp/nscp.c

commit 4c99e21d8c5c4f4fff02a2ef4b5ef5a1a8709f3a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-01

    - remove seemingly useless statements, which can lead to a crash under windows

M	nsd/log.c

commit 666733e446a2ae377f143074cb121f6d575e1772
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-01

    - make ignoring of function results explicit

M	nsd/config.c
M	nsd/fd.c
M	nsd/log.c
M	nsd/nswin32.c
M	nsd/pidfile.c
M	nsd/queue.c
M	nsd/range.c
M	nsd/sockfile.c
M	nsd/url2file.c

commit 7f154fd9647097dbcf879d1c81f6147aa97b94aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-01

    - use safer strncpy() insteady of strcpy()
    - add nonnull assertions to tclobj.c
    - prefer bool and NS_TRUE/NS_FAIL over int and 0/1
    - add const declarations
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	include/nsconfig.h.in
M	include/nsthread.h
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/form.c
M	nsd/log.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/tclenv.c
M	nsd/tclobj.c
M	nsd/tclrequest.c
M	nsd/url.c
M	nsthread/memory.c

commit 0bb62d0e459cdbd4b1f047ba4a9719160c9dc8cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-01

    - use arc4random() if available

M	configure.ac
A	m4/misc.m4
M	nsd/random.c

commit 9fb0388957877c71b3da8849d0010314ef255036
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-12-01

    - add nonnull assertion to fastpath.c
    - prefer "const" over "CONST" unless in Tcl interface
    - prefer bool and NS_TRUE/NS_FAIL over int and 0/1

M	include/ns.h
M	nsd/fastpath.c
M	nsd/nsd.h

commit 263f19a6305290aa4830a371e3e9cbf982103144
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-30

    - there is no need to compress empty io-vecs (where the compressed content is longer due to footer etc.).
      we have to ajust the regression test, since it contains such empty compress blocks
    - revert over-eager changes
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	nsd/compress.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/sock.c
M	tests/ns_adp_compress.test
M	tests/tclresp.test

commit 7a471e84ee4839a190c7db04dc40b7c0380bfae2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-30

    - make nonnull assumptions clear

M	nsdb/dbtcl.c

commit f44d4495690bc47c455f449aceb08371d9f990f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-30

    - eliminate dead code

M	nsd/driver.c
M	nsd/url.c

commit 332e2bf52620e42ff3a6a24da267a8c7622bf95e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-30

    - fix potentially uninitialized variables

M	nsd/tclhttp.c
M	nsd/tclxkeylist.c

commit 6458a67add11de8835ea90388781cab5a89f0b71
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-30

    - make compilation clean for clang 3.6
    - remove redundant operations due to nonnnull declarations
    - align NS_GNUC_NONNULL with asserts on more occasions
    - add const declarations
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	nsd/config.c
M	nsd/connio.c
M	nsd/exec.c
M	nsd/modload.c
M	nsd/request.c
M	nsd/return.c
M	nsd/rollfile.c
M	nsd/set.c
M	nsd/str.c
M	nsd/tclinit.c
M	nsd/tclset.c
M	nsd/tclthread.c
M	nsd/url.c
M	nsdb/dbinit.c
M	nsthread/mutex.c

commit d91401301ce16c44851d9e7613b4d4fe3fb90544
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-30

    - fix a bug in cgi interface leading to a reported port with a starting ":"
    - fix sample configuration for cgi
    - remove some documentation bugs for cgi

M	nscgi/doc/mann/nscgi.man
M	nscgi/nscgi.c
M	nsd-config.tcl

commit c5500302d94a68a2983ab012e0c5e0e46838ef5c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-29

    - add const declarations
    - prefer "const" over "CONST" unless in Tcl interface
    - reduce implicit conversions

M	include/ns.h
M	include/nsthread.h
M	nsd/info.c
M	nsd/task.c
M	nsd/tclinit.c
M	nslog/nslog.c

commit 86fea13cdaded285c247db511cb20a8a60fea3bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-28

    - reduce implicit conversions

M	nscp/nscp.c
M	nsd/sched.c

commit 1a1d98f80dc94279b842f5fe7aba75dba3c2ea22
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-28

    - handle return results of functions or ignore these explicitly

M	include/ns.h
M	nscp/nscp.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/log.c
M	nsd/sched.c
M	nsd/tclimg.c

commit d91331a8c964f85543101b617303f4d23bec7a3c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-28

    - improve documentation (document port 0 behavior)
    - improve linkage between documentation pages

M	doc/src/naviserver/ns_http.man
M	nssock/doc/mann/nssock.man

commit 37387a3c9d734e3ed71b1a57207a5631fd8e8120
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-28

    - fix wrong modifications

M	nscgi/nscgi.c

commit 518fdc039f714c8be323f5c7888a506c7dd6de5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-26

    - make ignoring of results explicit

M	nscgi/nscgi.c
M	nsd/adpparse.c
M	nsd/config.c
M	nsd/tclhttp.c

commit 60e49ecfe1cf6aa41deee2b8c9aaa966071a91a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-26

    - added nonnull assertions to pthread.c, reentrant.c, sema.c, thread.c

M	include/nsthread.h
M	nsthread/pthread.c
M	nsthread/reentrant.c
M	nsthread/sema.c
M	nsthread/thread.c

commit 6deefa3300e614da0e2ad2113861f444d40a833b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-25

    - use Ns_LogTaskDebug to be able to turn debugging selectively on/off (via ns_logctl)

M	nsssl.c

commit ed4609665a2d1b88f9f378cf34c83afb925e3bdb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-25

    - make Ns_LogTaskDebug a global symbol such it can be used from nsssl as well

M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/task.c
M	nsd/tclhttp.c

commit 74fc70b6f2796933ec123e3730d8e2ad2f0f01a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-25

    - add debugging severity for tasks

M	nsd/task.c
M	nsd/tclhttp.c

commit 1d0a8f5c79e09a6ab3af5059e5bc3acc55b3e97d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-25

    - make compilation clean under gcc5

M	nsd/driver.c
M	nsd/nsd.h

commit d0726aba48189f0aeaef6ccc5ec02be0d6f71234
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-25

    - make compilation clean under clang

M	nslog/nslog.c

commit 538f3a23c244a0d0b8fddefdffc890b7aad9ec87
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-25

    - adjust to new prototypes

M	nsssl.c

commit a15d82aa1e2c4f1ada897df8f1a22d0e71e2697b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-25

    - change order in array, add comment

M	nsd/driver.c
M	nsd/nsd.h

commit 131617c8f1478b7d0762c138d6b5b2998baab37d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-25

    - add mapping from spooler states to sock states (for error reporting)

M	nsd/driver.c
M	nsd/nsd.h

commit 9b4a420486c6d063a95dbff818ab91cc83d6f843
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-25

    - added nonnull assertions to task.c
    - add const declarations
    - reduce implicit conversions

M	include/ns.h
M	include/nsthread.h
M	nscp/nscp.c
M	nsd/adprequest.c
M	nsd/cache.c
M	nsd/dstring.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/proc.c
M	nsd/queue.c
M	nsd/sock.c
M	nsd/task.c
M	nsd/tclcallbacks.c
M	nsd/tclinit.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/url2file.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/nsdb.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c
M	nsthread/winthread.c

commit bc915fe90a143e11bff4a36beb6c660c5a01fcc7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-25

    - added nonnull assertions to cslock.c, rwlock.c, pthread.c, thread.c, tls.c
    - add const declarations

M	include/ns.h
M	include/nsthread.h
M	nsd/nsthread.c
M	nsd/queue.c
M	nsthread/cslock.c
M	nsthread/pthread.c
M	nsthread/rwlock.c
M	nsthread/thread.c
M	nsthread/thread.h
M	nsthread/tls.c
M	nsthread/winthread.c

commit 2d32f99c2934f7ff91c2963cd68254ffd95edec0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-24

    - align parameter names of ns_strtok to unix man pages
    - white space change

M	nsthread/reentrant.c

commit c384ecd851d8fdb123ee4cac0117f77426cf90e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-24

    - there is not need to introduce Ns_GetTimeFromTcl() since one can use
      Tcl_GetTime() directly
    - there is not need to introduce Ns_GetTimeFromWindowsFileTime() since
      this call would be only usable under windows.
    - keep assertions and fix of typo

M	include/nsthread.h
M	nsthread/time.c

commit f4eff1c84aaa88fdaa0eeaaecc9e58064fad2d72
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-24

    - guard Tcl namespace ensemble usage by checking the version number of Tcl

M	tcl/nstrace.tcl

commit eff6331f3ed9a1ed35ee33d80541b5bde998c0d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-24

    - revert to previous version: the intention is that the message is the last statement in the old log. In case there is a bug in windows, it should be properly fixed, not just getting rid of the symptoms.

M	nsd/log.c

commit a5d6d765f220eb03e1a5982d2ff0a82e72b8d1bb
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-11-24

    Adjust include/Makefile.global.in (for Unix) to work correctly with my
    2014-11-02 rev 557970029135 fix (for Windows) to nsd/Makefile.

M	include/Makefile.global.in

commit a3b22d561f3c0d408fe84d652cc307fc676546b4
Merge: 144205b5 7d88e7a4
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-11-24

    Merge in all upstream changes.  No conflicts.

commit 144205b5839ecaa378770c7c70cd91891286ca05
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-11-24

    Re-apply my 8d3c79974f08 fix which got lost during merge:  Fix ns_logroll crash on Windows.

M	nsd/log.c

commit 7d88e7a4560b825ea60d6d62af1f355d88df3f97
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-24

    - parenthesize macro body

M	include/nsthread.h

commit 2e45bf498a0bbe5acf030b6df72fb00c84dea620
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-24

    - implement ns_recv() and ns_send() as functions under windows

M	include/nsthread.h
M	nsd/nswin32.c

commit ea0b498660b99e22c40c9be9b6cdce1f5f079a32
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-24

    - added nonnull assertions to auth.c, callbacks.c, httptime.c,
    - limits.c, range.c and mutex.c
    - changed conn->id from int to uintptr_t (like for sls ids.
    - added NsConnIdStr()
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	include/ns.h
M	include/nsthread.h
M	nsd/adpeval.c
M	nsd/auth.c
M	nsd/callbacks.c
M	nsd/conn.c
M	nsd/httptime.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/range.c
M	nsthread/mutex.c
M	nsthread/thread.h

commit 4cce4430c21c30fbbf58ae503fac765a247bf333
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-24

    - align prototype names and function names
    - reduce implicit conversions
    - avoid c90 identifiers starting with str[a-z], to[a-z], E[A-Z]
    - add const declarations

M	include/ns.h
M	m4/usermgt.m4
M	nsd/adprequest.c
M	nsd/index.c
M	nsd/queue.c
M	nsd/return.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tclxkeylist.c
M	nsd/urlopen.c
M	nsd/uuencode.c
M	nsdb/dbdrv.c
M	nsdb/nsdb.h
M	nsdbtest/nsdbtest.c

commit f86c0c1d00aad478f018a0b28a75ed4874689b38
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-23

    - fix a potential race condiditon in writer threads: fill in queue structure before a writer job is added to the queue (and is potentially picked up by a writer thread).

M	nsd/driver.c

commit aca47f749b068b5f66d45245935e05dea8aa11a1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-22

    - add nonnull assertions to form.c
    - reduce implicit conversions
    - add const declarations

M	include/ns.h
M	nsd/dstring.c
M	nsd/form.c
M	nsd/random.c
M	nsd/tclresp.c
M	nsd/tclxkeylist.c

commit ef57befe8101c3785665e03216f03965559ec3f7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-22

    - avoid c90 identifiers starting with str[a-z] and to[a-z]
    - use modern-style argument parsing for NsTclKillObjCmd() and NsTclSymlinkObjCmd()
    - make ignoring of function results explicit
    - reduce implicit conversions
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	nsd/adprequest.c
M	nsd/tclfile.c
M	nsd/tclsock.c
M	nsd/tclxkeylist.c
M	nsd/urlopen.c

commit 96146c20bb119094f7005c7a4314d052784d5ffd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-22

    - avoid c90 reverved identifier "signal"

M	nsd/nsmain.c
M	nsd/tclfile.c

commit 619c74064dea514de0d665430a79909ee39be553
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-22

    - avoid usage of c90 reserved identifier "free"

M	nsd/log.c

commit 19b03fce69504443a865755fec651767ae1018c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-22

    - eliminate c90 reserved identifier starting with E[A-Z]

M	nsd/encoding.c

commit 38d1976c98efa73f376edd89eca8f60ca17bcadc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-22

    - add nonnull assertions to cache.c
    - avoid c90 reserved identifier starting with to[a-z]
    - add const declarations
    - prefer bool and NS_TRUE/NS_FAIL over int and 0/1
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	nsd/cache.c
M	nsd/fastpath.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclhttp.c

commit 9ec98593fe200b7689bc6a620106666ddd991e35
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-22

    - avoid potential confusion by plural of http and the https protocol
    - avoid reserved c90 identifier "remove"

M	nsd/nsd.h
M	nsd/tclhttp.c
M	nsd/tclinit.c

commit 79abf42e9ea0a270698c28856386783a487767fa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-22

    - add const declarations

M	nsdb/db.h
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/nsdb.h

commit 22aa805d48d1841b48038121a70b1af1eca6cac9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-22

    - move assignments out of conditions in "while" or "if" statements
    - avoid c90 reserved identifier "signal"
    - prefer bool and NS_TRUE/NS_FAIL over int and 0/1
    - add "const" constraints
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/binder.c
M	nsd/conn.c
M	nsd/fastpath.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/server.c
M	nsd/sls.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclconf.c
M	nsd/tclenv.c
M	nsd/tclinit.c
M	nsd/url2file.c
M	nsdb/db.h
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/dbutil.c
M	nsdb/nsdb.h
M	nslog/nslog.c

commit c8c972d39e9c8a1447f9e36f8404934ed6680f7d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-22

    - reduce implicit conversions
    - prefer boolean and NS_TRUE/NS_FAIL over int and 0/1
    - add nonnull constraints
    - add "const" constraints
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	nsd/compress.c
M	nsd/filter.c
M	nsd/sockfile.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclobjv.c
M	nsd/urlopen.c

commit 51c883cbf873231d4a7c604f75dc1c973be17c54
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-21

    - reduce implicit conversions

M	nsd/driver.c
M	nsd/nsd.h

commit 98bd9bc018439c7afa801db7f95b85ba669a2993
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-21

    - prefer for loops over while loops

M	nsd/sockcallback.c

commit e85cce2ea9bf898c877ee3b68ad506cf21e401a2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-21

    - reduce scope of variables

M	nsd/unix.c

commit f16bfa42ee73244f995bcb6d0f01fb44b8201f37
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-21

    - prefer boolean and NS_TRUE/NS_FAIL over int and 0/1
    - reduce implicit conversions

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/sock.c

commit d798c4ab607d78eca75dc5bbcd9f5669e6ba64a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-21

    - add "const" constraints to driver

M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h

commit ab5ce8e4315bc69d0710c57e3f1337c529a435ae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-21

    - reduce implicit conversions

M	nsd/driver.c

commit e6cc12acbcf1ab37ea5f37e0ada6b2ce9fd60900
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-20

    - avoid c90 identifiers starting with str[a-z]
    - add "const" constraints

M	include/ns.h
M	nsd/adpcmds.c
M	nsd/adpparse.c
M	nsd/httptime.c
M	nsd/nsd.h

commit 2ab4b258e46eef6aac3eb852ff893894f89ead81
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-20

    - reduce implicit type conversions

M	nsd/driver.c

commit 2bd2d9806c66e6ecc027522c8e8bd49c5fff198c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-20

    - avoid usage of c90 reverved identifiers "time" and "tm"

M	nsd/httptime.c

commit 882a41135e0110bd187489f84aea0910cf0ab361
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-20

    - fix stupid bug in socket close callback (introduced by me)

M	nsd/tclinit.c

commit 8bf831d046570bbcb1984c29be3f4e3484ae6c62
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-20

    - move bool definition from nsd.h to ns.h

M	nsd/nsd.h

commit 5fefba89308107ec2fb2534c61db6440016ebbe4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-20

    - use getpwnam_r, getpwuid_r, getgrnam_r, and getgrgid_r instead of
      their thread-unsafe counterparts. This change allow these functions
      to run without locking

M	configure.ac
M	include/ns.h
M	include/nsconfig.h.in
A	m4/usermgt.m4
M	nsd/unix.c

commit 040bf5851c1770fd8ef92d14588a8ae92e75955e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-20

    - reduce variable scopes

M	nsd/tclset.c

commit df8283da90ec3bbae23d8ae8607e0a9185a02036
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-20

    - editing error

M	openacs-config.tcl

commit c33db130eb077bcf70814031abf81ad13ad58f99
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-11-19

    I somehow lost some upstream changes when merging, apply them.

M	include/Makefile.win32
M	nsd/log.c
M	nsd/queue.c

commit 6250f7bd34fafbbeac6378fcd30a7c6da7cd0056
Merge: 398263a1 7e4d01a0
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-11-19

    Merge in all upstream changes.

commit 7e4d01a0108b67bb20ffa05ed62d1700fbf698ae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-19

    - move assignments out of conditions in "while" or "if" statements
    - prefer boolean and NS_TRUE/NS_FAIL over int and 0/1
    - reduce implicit conversions

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/task.c

commit 8cca0f091f49a1e3a1c3af305ad1b10dff3e9ee4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-19

    - use NS_INVALID_FD instead of -1

M	nscgi/nscgi.c
M	nsd/driver.c
M	nsd/log.c
M	nsd/nswin32.c
M	nsd/return.c
M	nsd/sockfile.c
M	nsd/tclhttp.c
M	nsd/unix.c
M	nslog/nslog.c

commit 6f8a83b6bf636fdc6939747ac100446d3fd805c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-19

    - handle non-started drivers on more places
    - simplify loop logic over drivers

M	nsd/driver.c

commit ea1aac744ccdaa6ddd959b785b1813de557871ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-19

    - define NS_INVALID_FD similar to NS_INVALID_SOCKET and NS_INVALID_PID

M	include/nsthread.h

commit f0750773341f5111d31e2a9a2c3b1f2bc2b8ae68
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-19

    - allow one to load driver module (and register commands), but do not start driver, when port is set to 0

M	nsd/driver.c

commit ef0442d12693035e0355a74b6fe1937e1ead8587
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-18

    - switch argument of Ns_SockProc back to "unsigned int" since there is
       a single place in the code, where Ns_SockProc might be called with
       a combination of Ns_SockState flags.
    - use parens around macro arguments
    - reduce implicit conversions
    - prefer boolean and NS_TRUE/NS_FAIL over int and 0/1
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	include/nsthread.h
M	include/nsversion.h.in
M	nscp/nscp.c
M	nsd/binder.c
M	nsd/config.c
M	nsd/driver.c
M	nsd/listen.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclresp.c
M	nsd/tclsock.c
M	nsd/url2file.c

commit bc2babee98b24f9e8ce8295ee4a9771db269dd24
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-18

    - avoid c90 identifier starting with str[a-z]
    - ignore less function results
    - reduce implicit conversions
    - move assignments out of conditions in "while" or "if" statements
    - avoid shadowing of variable names
    - prefer "const" over "CONST" unless in Tcl interface
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	include/ns.h
M	include/nsthread.h
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/config.c
M	nsd/driver.c
M	nsd/form.c
M	nsd/index.c
M	nsd/info.c
M	nsd/nsd.h
M	nsd/nswin32.c
M	nsd/pathname.c
M	nsd/progress.c
M	nsd/quotehtml.c
M	nsd/tclcache.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/tclxkeylist.c
M	nsd/url2file.c
M	nsdb/dbinit.c
M	nsdb/dbutil.c
M	nsdb/nsdb.h
M	nslog/nslog.c

commit c52a7fb6cbc2adb0ad8ac02f2ba3f546f835e2e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-18

    - use modern style argument passing for ns_sock
    - ignore less runction results

M	nsd/tclsock.c

commit 6177c3dc721015f6720f92bcaec80553a3f7c611
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - avoid c90 identifier starting with "E" or str[a-z]
    - reduce implicit conversions
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	nsd/dns.c
M	nsd/event.c
M	nsd/log.c
M	nsd/queue.c
M	nsd/sock.c
M	nsd/tclinit.c
M	nsd/tclobj.c

commit c366cc3c5b9e59cc02eaca1655d73f69c70ea4b3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - add missing definition for ns_lseeks under unix

M	include/nsthread.h
M	nsd/driver.c

commit 2869263d4a735f887faeb086e5071e1ac3f299ee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - add extension to be ignored for windows compilation intermediaries and results

M	.hgignore

commit d8db3ab7a9625081b06a8755df786d9fb1616b57
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - use ssize_t for results of write() operations

M	nsd/driver.c

commit 940179edefc0753cfd57a77ac9cf4745cb685160
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - use ns_open consistently with 3 arguments

M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/nswin32.c
M	nsd/unix.c
M	nsproxy/nsproxylib.c

commit 18bc86eb11186d0857eecab7cd035462753c1889
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - set windows runtime library option from /MT(d) tp /MD(d). This was probably the true cause of the access log problem

M	include/Makefile.win32

commit 1ba15bb90a6973c518172d00b60aa22c9aaf9eed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - use ns_* as well in log entries and messages

M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/log.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclinit.c
M	nsd/unix.c
M	nslog/nslog.c

commit b87962f6e9685124d6784f7d9622189444f58c5c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - added ns_lseek, ns_dup, ns_dup2
    - use ns_open, ns_close, ns_lseek, ns_dup, ns_dup2, ns_write and ns_read consistently

M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/binder.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/log.c
M	nsd/nswin32.c
M	nsd/return.c
M	nsd/sock.c
M	nsd/tclhttp.c
M	nsproxy/nsproxylib.c
M	nsthread/winthread.c

commit eaf50f01fd8bcb9c4b97491cdf189a21cd9154ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - reduce type conversions

M	nsd/nsd.h
M	nsd/nswin32.c
M	nsd/unix.c

commit 8bba1c09e11a652aae6dc47c3888d06073ef1a47
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - reduce reuse of reserved c90 identifier str[a-z].*

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c

commit b96cd3124c0f83a30401b94b3a36f24d12012272
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - reduce re-use of C90 identifier time and is[a-z].*

M	nsd/tcltime.c

commit 4ba966e68977b99aab9c0d1f624893e8e8519642
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - make switch cases explicit
    - ignore less return issues

M	nsd/adpeval.c

commit 216bf1bddb9d459118375bc027248109d0e3c1e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - add comment for symmetry with other blocks

M	nsd/binder.c

commit 9c615d93da7127e5ba6c51280272648d7e3be225
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - make enum to int conversion explicit

M	nsd/sockcallback.c

commit 14e994c899cc167597e22f490ff232880f113cc7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - reduce implicit conversions

M	nscp/nscp.c

commit addcb9cdf137c99d75a99cc3a56ef3363ef08c71
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - fix format string

M	nsthread/nsthreadtest.c

commit e541cd62691d55407ead99d927042729461fbc92
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - revert escaped change

M	include/Makefile.build

commit 6afe3c826307a5d3dd54a121f3488f6becb7c087
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-17

    - don't provide a return value for a void function

M	nsd/exec.c

commit db992744d746f8975bbe64113226723d428b5fae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-16

    - reduce implicit type conversions

M	include/Makefile.build
M	nsd/fastpath.c

commit 1076ffa9c1489474338e85cbda3e6fe3d1e75203
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-16

    - reduce implicit type conversions

M	nscgi/nscgi.c
M	nsd/nswin32.c
M	nsd/tclhttp.c
M	nsd/tclxkeylist.c

commit 2351f481d8ff41864d30bc12c547dcd3b084cd54
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-16

    - implement interface routines ns_open, ns_close, ns_write, ns_read as small C functions to address weird problem with access.log (it seems that the windows dlls for nslog and the main libnsd are linked agains 2 different instances of the runtime system)

M	include/nsthread.h
M	nsd/nswin32.c
M	nslog/nslog.c

commit 4fd5f30837063cd76e274d27a5fe8de67f0a888a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-16

    - fix compilation and reduce warning under windows

M	include/Makefile.win32
M	nsd/nswin32.c
M	nsd/tclxkeylist.c
M	nsthread/nsthreadtest.c

commit 4799ce23c5c553b6e63e6d2851540eac4e945d44
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-16

    - improve comment density

M	nsd/binder.c
M	nsd/connio.c

commit 3baf58c6ec7ff6c644f0a054a73a2d98629b4227
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-16

    - avoid c90 identifier starting with "_" or str[a-z].*

M	include/ns.h
M	nsd/compress.c
M	nsd/connio.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/server.c
M	nsd/tclcallbacks.c

commit 75f10e696165f8e96226fc95178950e04af7f3dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-16

    - reduce unhandled function results
    - reduce implicit conversions
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	include/ns.h
M	nsd/adprequest.c
M	nsd/cache.c
M	nsd/callbacks.c
M	nsd/conn.c
M	nsd/exec.c
M	nsd/fd.c
M	nsd/httptime.c
M	nsd/lisp.c
M	nsd/nsconf.c
M	nsd/random.c
M	nsd/return.c
M	nsd/server.c
M	nsd/sls.c
M	nsd/sockfile.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclset.c
M	nsd/url.c
M	nsd/urlopen.c
M	nsdb/dbdrv.c

commit 855e79cbcce23bd951c82e6e5b7ac6ff9328fcfb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-16

    - document handling of Ns_ModuleVersion in module loader
    - move constants needed potentially for flags back to the public interface

M	include/ns.h
M	nsd/cookies.c
M	nsd/modload.c
M	nsd/nsd.h

commit 5f60c6d3f5aebc65ff7d3eb994006ac659dd00b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-16

    - handle Ns_SockState masks with explicit casts (to unsigned int) for
      bit operations
    - more adjustments to new enums
    - reduce implicit conversions
    - name handled enum values explicitly in switch statements
    - avoid returns in switch statements
    - prefer return type bool with (NS_TRUE/NS_FALSE) over return type int (with  0 / 1)
    - add more comments to sockcallback.c

M	include/ns.h
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/cache.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/nsd.h
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/tclobj.c
M	nsd/tclresp.c
M	nsd/tclsock.c

commit 88b74ba1bebbdd5f7bd65ce51a293902cd62eccc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-16

    - turn macro DupSharedKeyListChild into a function

M	nsd/tclxkeylist.c

commit e57127b583ebb2ff74a2cb263b9eb6834fc613c6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-15

    - move defines into file when not needed in ns.h or nsd.h
    - move more platform dependencies from nsd.h into nsthread.h
    - eliminate unneeded define NS_FATAL, group naviserver return code together
    - define enum AdpResult for adp results
    - get rid of pedantic warning for empty translation units
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	include/ns.h
M	include/nsthread.h
M	nsd/cookies.c
M	nsd/event.c
M	nsd/listen.c
M	nsd/mimetypes.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/pathname.c
M	nsd/proc.c
M	nsd/sock.c
M	nsd/tclmisc.c
M	nsd/tclsock.c
M	nsthread/winthread.c

commit 58a0d51da10516b855362c5ecbc665fc693486aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-15

    - cleanup after define->enum conversion
    - avoid c90 identifier starting with "_"
    - reduce implicit conversions
    - make ignoring of function results explicit

M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/filter.c
M	nsd/nsmain.c
M	nsd/return.c
M	nsd/sls.c
M	nsd/str.c
M	nsd/task.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclinit.c
M	nsd/tclrequest.c
M	nsd/tclset.c
M	nsd/tclxkeylist.c
M	nsdb/dbtcl.c

commit 816709bf2a9dbd068d8849c5119c8f3075d4fe99
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-14

    - reduce implicit conversions

M	nsd/nswin32.c

commit 58493d04e4561aa8e12bd7b6d28df083870a1231
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-14

    - convert NS_FILTER_* defines into enum Ns_FilterType
    - add nonnull constraints (filter.c)

M	include/ns.h
M	nsd/filter.c
M	nsd/nsd.h
M	nsd/tclrequest.c
M	nsd/tclset.c

commit 6def97e3c542f2f0317dde2032b58d03f38cfd0f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-14

    - handle NS_SOCK_EXCEPTION state explicitly

M	nsd/tclhttp.c

commit d0b0fb08767d81855d000f0f1364661e500cf901
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-14

    - use Ns_SockState
    - handle NS_SOCK_EXCEPTION
    - adjust variable size for ssl options

M	nsssl.c

commit 3d87b24ae3de4231e66287693cb270e57e78f520
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-14

    - add "default" labels to switch statements
    - reduce scope of loop variables
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	nsd/info.c
M	nsd/tclset.c
M	nsdb/dbtcl.c

commit a583ef870f9829e166face00f7f9f1584ba8c124
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-14

    - driver.c: demangle NaviServer return-codes (NS_OK/NS_ERROR) and socket/driver
      return states by using enums (SockState, DriverState)
    - provide different error messages for read and write timeouts
    - introduce enum Ns_SockState for socket states
    - add nonnull constraints (tclinit.c, urlspace.c)
    - don't hardcode sizes of arrays
    - reduce scope of variables
    - avoid reuse of C90 identifier pattern (str[a-z]+)
    - prefer boolean expressions in if/while/... over expressions of other types
    - prefer "const" over "CONST" unless in Tcl interface
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	include/ns.h
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/event.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/range.c
M	nsd/return.c
M	nsd/sockcallback.c
M	nsd/str.c
M	nsd/task.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/urlspace.c

commit 1d03c40347743bff22ac868a5fff270863b40656
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-13

    - add nonnull constraints
    - prefer "const" over "CONST" unless in Tcl interface
    - reduce implicit conversions

M	include/ns.h
M	nsd/encoding.c

commit b38bfad62ec7a62bd5f89314a75b0d6065913618
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-13

    - move assignments out of conditional expressions
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	nsd/connio.c

commit c65ae6126b2cb41531e9562973245ccb2facceed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-13

    - avoid c90 reserved identifiers to[a-z]*

M	nsd/pidfile.c
M	nsd/urlopen.c

commit 80228b6e245cf84d8b4adcf758b84f02d58d1a6b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-13

    - avoid c90 reserved identifier is[a-z]*

M	nsd/tclconf.c

commit c417d6ab2c240eecdbf5f3c0451bd28b34b21a55
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-13

    - avoid c90 reserved identifier to[a-z]*

M	nsd/sockfile.c

commit 3a55053879d9da7ea0c13b497160c82cf95f0049
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-13

    - avoid c90 reserved identifier "log"

M	nsd/log.c

commit fcca084c9678dc5968d8f83e933a545dcd3b2249
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-13

    - replace TclX-specific assert by regular assert
    - add default labels to switch statements
    - add nonnull constraints in ulrspace.c
    - add const constrains (mostly tclxkeylist)
    - prefer "const" over "CONST" unless in Tcl interface
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	include/ns.h
M	nsd/adpeval.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/tclobjv.c
M	nsd/tclxkeylist.c
M	nsd/urlspace.c

commit f6f499189ff8422c1a5ad0f18273f6ec6fc67f59
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-13

    - turn tcl trace types from ifdefs into enums
    - add default labels to switch statements
    - reduce implicit conversions
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	include/ns.h
M	nsd/dstring.c
M	nsd/exec.c
M	nsd/tclinit.c
M	nsd/tclthread.c

commit b42eadc7e299cc941c0d762f9ae7fd5b12e47323
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-13

    - add default labels to switch statements
    - reduce implicit conversions
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	nscgi/nscgi.c
M	nsd/adpparse.c
M	nsd/binder.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/httptime.c
M	nsd/log.c
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/sls.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tcljob.c
M	nsd/tclrequest.c
M	nsd/tclset.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/urlopen.c

commit 04afdf44d9f350ddaab426321babbc179fc91820
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-12

    - add nonnull constraints in adp* interface
    - add default labels to switch statements
    - avoid reuse of C90 identifier pattern (str[a-z]+)
    - prefer "const" over "CONST" unless in Tcl interface
    - reduce implicit conversions
    - prefer boolean expressions in if/while/... over expressions of other types
    - add editor hints to keep formatting conventions, prefer spaces over tabs

M	include/ns.h
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/set.c
M	nsdb/dbdrv.c

commit 5c4631813bf25908445826953421b7e9c93e132f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-11

    - use Tcl_NewBooleanObj() for returning boolean values (not Tcl_NewIntObj)

M	nsd/tclcache.c
M	nsd/tclvar.c

commit 103a56b0ec13efff0c3bc69a78b9906943944996
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-11

    - size array correctly

M	nsd/cookies.c

commit 7d234bd9d96c6e339ad9ff339fb58db72c80ead7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-11

    - don't assign value to ignored variable

M	nsd/task.c

commit 08c96a9cfa5896de73235eb574172bcb4b51ba0b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-11

    - remove unneeded variable

M	nsd/tclobjv.c

commit 8399757dd74f7775c219d0baee0ed356e15d03ba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-11

    - nscp: report error when "user" config entry is invalid and ignored
    - don't change strings in ns_set values
    - reduce implicit conversions

M	nscp/nscp.c

commit c5fc788fa29a228abdb74ae5ce19870e0fcbc393
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-11

    - fix a bug with where NsGetFilters() failed to return the right
      filter type when NS_FILTER_FIRST flag was set.
    - extend regression test

M	nsd/filter.c
M	tests/ns_register_filter.test

commit 5cd8d76631cef0f400f847c7f5c9d4b3db9a006a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-10

    - add macros ns_write() and ns_read() rather than write() and read()
      for os-abstraction to avoid potential conflict with variable name
      "write" or "read". This is analogous to many more ns_* definitions
      for OS abstraction
    - use parens for macro arguments
    - add editor hints to keep formatting conventions, prefer spaces
      over tabs
    - prefer boolean expressions in if/while/... over expressions of other types

M	include/nscheck.h
M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/config.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/filter.c
M	nsd/info.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclxkeylist.c
M	nsdbtest/nsdbtest.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c

commit ec745ddcc65cc8dac21b0b98457e32b035e0d84c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-09

    - reduce implicit signed/unsigned conversions
    - move assignments out of conditions in "if" statement

M	nsd/driver.c
M	nssock/nssock.c

commit 5c77e4c990bd494da28aae4e4a7c5f680b82f508
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-09

    - don't compare unsigned type with negative number

M	nsd/request.c

commit 9a3e50b6f5b74a70d7b4fd4183a76f0ce471770a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-09

    - fix second argument of Ns_ThreadArgProc

M	include/nsthread.h
M	nsd/info.c

commit 36bdef3bf7c084fa31306ff403779b12a79dacc0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-09

    - reduce conversions of function pointer to object pointer type

M	nsthread/thread.c

commit ca29935605a2615843525a08d0808f1b3a2408c7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-09

    - make ignoring of function results explicit or handle it.
    - move assignments out of conditions in "while" or "if" statements
    - reduce implicit signed/unsigned conversions

M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/range.c
M	nsd/tclvar.c

commit 2bbca756636a0e7f7e666b87ebada84b18b7ef5f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-08

    - revert escaped changes

M	include/Makefile.build
M	include/Makefile.win32

commit 17b925d06b246091ab6b19d72afda35da9c123b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-08

    - move more windows dependencies from ns.h into nsthread.h
    - close sockets with ns_sockclose() instead of close()
    - define ns_recv() and ns_send() to handle windows/unix differences better
    - reduce implicit conversions

M	include/Makefile.build
M	include/Makefile.win32
M	include/ns.h
M	include/nsthread.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/config.c
M	nsd/driver.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/request.c
M	nsd/set.c
M	nsd/sock.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tclset.c
M	nsd/tclxkeylist.c

commit 92ba6162d9fc94f13314f9ee338d0b31cb2a8d82
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-08

    - don't merge NS_DRIVER_ACCEPT_STATUS and sock status codes in one variable
    - reduce implicit signed/unsigned conversions

M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/tclvar.c
M	nslog/nslog.c

commit f8899308ec99559d8a5916d317e64cc66e355585
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-08

    - reduce implicit signed/unsigned conversions

M	nsd/adpeval.c
M	nsd/driver.c
M	nsd/range.c
M	nsd/tclxkeylist.c
M	nsd/urlencode.c

commit 9334ccfc1a11c00cd60ad5e97e5b99fbddeeec6b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-08

    - provide for errors logged in error.log a context information by
      using Ns_TclLogErrorInfo() instead of Ns_TclLogError(). Mark the
      latter as deprecated.
    - move assignments out of conditions in "while" or "if" statements

M	include/ns.h
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/tclcallbacks.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclrequest.c
M	nsd/tclsock.c

commit d7670aee2bb834ffaf9f8d12dc3843a507be2912
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-08

    - fix indentation

M	nsd/task.c
M	nsd/tclinit.c

commit 398263a12d5ed2a9a7a89b79662fc14c35e140f0
Merge: 001c3351 3958d68a
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-11-07

    Merge in all upstream changes.  No conflicts.

commit 3958d68a79a6137af9ecb387b59ea64aaf192dc5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-07

    - make compilation clean for linux version of compilers (gcc 4.8.3, clang 3.4)

M	include/ns.h
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/queue.c
M	nsd/tclobjv.c
M	nsd/urlencode.c

commit 9a8b40b6141520594d906689520ef871a32023f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - let type-checker make sure, enum values are within range. use
      assertions to make sure, enough print-strings are available.
    - prefer "const" over "CONST" unless in Tcl interface

M	nsd/tcljob.c

commit d70e22a13818b67903b84fee2b2ddf079724f9ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - prefer boolean expressions over expressions of other types

M	nsd/binder.c
M	nsd/config.c
M	nsd/connio.c
M	nsd/filter.c
M	nsd/pathname.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/tclcache.c
M	nsd/tclimg.c
M	nsd/tclinit.c

commit fde49c054e00bffeeeecaa1438097c06adf3a150
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - linux/freebsd/oracle define pollfd.events and pollfd.revents as
      short. Make sure, we use always the same type.

M	include/nsthread.h
M	nsd/driver.c
M	nsd/event.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsproxy/nsproxylib.c

commit 0bc9b9691bb899fcaff21e8dc466b7705b55d99b
Merge: 361d5b02 a42dc888
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - move assignment out of expression
    - make ignoring of result explicit

commit 361d5b02c9fa53d7cd6af32d7b5d4f8a29347d0b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - make Ns_LogSeverity signed (reduce implicit conversions)

M	include/ns.h

commit 46bc5c687303b3805657842301f1ae1e23fc2a56
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - make singned conversion explicit

M	nsd/cookies.c

commit a42dc8889b8baf27d76bfab2622983d99c8dff24
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - temporary fix for Windows writing to access.log. Even though the write operation nslog.c and driver.c is performed with seemingly the same arguments, the operation in driver.c behaves weird. Although it reports that the right number of characters was written, they do not show up in the access.log. A tell(fd) before and after the write operation shows, that nothing is written....

M	nslog/nslog.c

commit 00f2b84ad94707e18f80d10213d84d0355d6b583
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - avoid reuse of C90 identifier pattern (str[a-z]+)
    - add nonnull assertions

M	nsd/str.c

commit ce60c19a4f8a86f173f9cdf44fd04de13a990657
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - don't extend value-range of enum programmatically. Therefore, change
      enum type Ns_LogSeverity to integer to be able to use it for passing
      native enum types and used-defined log levels

M	include/ns.h
M	nsd/log.c

commit d5d84e3f7f321aed3d38bf9ea2d6ec321564838a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - reduce variable scopes

M	nsd/server.c
M	nsd/tcljob.c

commit 523c4bafde2b18c190f2096a4fef85c24508f4bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - improve compilation with "--std=c99 -pedantic"

M	nsd/adpeval.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nswin32.c
M	nsd/proc.c
M	nsd/queue.c
M	nsd/tclhttp.c
M	nsthread/thread.c

commit 0d03dec3b2ed2f7618f4622a2683b878e77eaeac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-06

    - fix typo

M	nsd/exec.c

commit f58e29ed1f2b7ede03a2589bc9ce8499c1fb255d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-05

    - reduce implicit conversions of enums to int

M	nsd/tclvar.c

commit 3b6967f85fa195abb08ab65702c7ae618fa29d43
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-05

    - handle write errors

M	nsd/conn.c
M	nsd/driver.c
M	nsd/exec.c

commit 505f53ddb98b58571496234e67c828fee5a8c0e7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-05

    - add missing const flag

M	nsd/sockfile.c

commit 1cbd3bec7c0c63306d1386738f770267c5a0b0b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-05

    - fix flag coding bug (stupid me!)

M	nsd/nsd.h

commit 6c5c2b43afd1983940c84b65fe0d506363cdf085
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-05

    - make sure ns_set sizes are accessed via size_t
    - prefer size_t over Tcl_WideInt for sizes
    - use boolean expressions in conditions with flags
    - reduce implicit signed/unsigned conversions

M	include/ns.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/binder.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/exec.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/index.c
M	nsd/limits.c
M	nsd/mimetypes.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/queue.c
M	nsd/range.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/server.c
M	nsd/set.c
M	nsd/sock.c
M	nsd/tclcache.c
M	nsd/tclenv.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclobjv.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c

commit 1aa038054d4fcf161707c925bcbdf5c84c2e7363
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-04

    - use Tcl_GetStringFromObj() instead of Tcl_GetString() when string
      length is needed (avoid additional strlen() operations)
    - use Tcl_GetCharLength() instead of Tcl_GetStringFromObj and ignoring
      return value

M	nsd/driver.c
M	nsd/encoding.c
M	nsd/mimetypes.c
M	nsd/tclfile.c
M	nsd/tclmisc.c
M	nsd/tclxkeylist.c
M	nsdb/dbtcl.c

commit 12de350de262fc068a83d8a37bc619710a016c90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-04

    - avoid buffer overflows
    - don't hardcode sizes for string arrays

M	nsd/conn.c
M	nsd/nsconf.c
M	nsd/nsd.h

commit 1646921958217e4096ee0c5983a76853f93b3648
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-04

    - make ignoring of function results explicit

M	nsd/set.c

commit 5f65b0e3e4743707acd99c5fd0049c1223c68da4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-04

    - use unsigned type for bit operations

M	nsd/urlencode.c

commit f8b3972cc2bf9547d820faa1f6a69341270e80bb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-04

    - no need to include <stdio.h>

M	nsd/sockfile.c

commit 6ed88de4cbfefe459e835de34f1988be0e3d7d96
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-04

    - remove unneeded (void)

M	nsd/auth.c

commit 87d7b26e9ebb196834b11be2958317c309dbdba2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-04

    - fix parens around likely()

M	nsd/conn.c

commit fbd8bee8ffaad9e8ddbb2ea56551af6e01b04f2d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-04

    - remove debug statements

M	nsd/url2file.c

commit d1c75674450717fbcf4a49eba023f9bc92bc8668
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-04

    - use const on more occasions (e.g. result of Ns_ConfigGetPath)
    - reduce implicit signed/unsigned conversions
    - use boolean expressions in conditions with flags
    - adding nonnull assertions (connio)
    - avoid reuse of C90 identifier pattern (str[a-z]+)

M	nscp/nscp.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/limits.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/rollfile.c
M	nsd/server.c
M	nsd/tclcallbacks.c
M	nsd/tclhttp.c
M	nsd/tclmisc.c
M	nsd/tclobj.c
M	nsd/tclset.c
M	nsd/urlopen.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c

commit bb0559e0f10e2abf1a1e48cd27b6af1f9841538a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-04

    - adding nonnull assertions

M	include/ns.h
M	nsd/set.c

commit da140c9e673def831bf996f2e90065c0b51451ae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-03

    - use const on more occasions

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/tclvar.c

commit 616f88c3934313f7aab6bb3544bddc5df93227fa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-03

    - don't assume, enum type is the same as int

M	nsd/tcljob.c

commit b79eeb1c63dcd8fd61ea5d26882addac71d07226
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-03

    - don't calculate with signed characters

M	nsd/httptime.c

commit 7bbc80ee81c5ee66f5f365574ed535f9a204e51b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-03

    - use int instead of char for status information

M	nsd/random.c

commit 48b11afde1225673ff4fcd6cce8214a2f0b9e61f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-03

    - simplifying NsTclNsvUnsetObjCmd()

M	nsd/tclvar.c

commit fc404be36372af7e1a6f2f3996f8b4a588d363e6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-03

    - use CHARTYPE macro consistently (digit, alpha)
    - use boolean expressions in conditions with flags
    - avoid reuse of C90 identifier pattern (str[a-z]+)
    - use const on more occasions

M	include/ns.h
M	nsd/adpcmds.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/callbacks.c
M	nsd/conn.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/httptime.c
M	nsd/pathname.c
M	nsd/range.c
M	nsd/server.c
M	nsd/sls.c
M	nsd/tclconf.c
M	nsd/tclmisc.c
M	nsd/tclxkeylist.c
M	nsd/urlspace.c
M	nsdb/dbdrv.c
M	nslog/nslog.c

commit efd1050567c72d060e250ff4122aeb712a2b4dd4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-03

    - use modern-style Ns_ParseObjv() instead of manual argv parsing for
      ns_job interface, at least, when optional arguments are involved.

M	nsd/tcljob.c

commit 001c33513f613b7af0e8bac2bd1335ce037cd182
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-11-03

    Fix ns_logroll crash on Windows.

M	nsd/log.c

commit 8f7842cd224289c8c2c1dbefe6e7e1074192bb62
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-11-02

    Rename nsd.{lib,dll} to libnsd.{lib,dll} to avoid smashing over their
    PDB debug file with the one for nsd.exe.

M	include/Makefile.win32
M	nsd/Makefile

commit ba18514275e0686fb4c0bd38494dd487fe51f512
Merge: 93a7b57f c4393294
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-11-02

    Merge in all upstream changes.  No conflicts.

commit c43932943a366236e85cef8ac5ece523f6fbc697
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - use char type in comparison

M	nsd/form.c

commit 6effd0ac4bb1b320caf17922e2350849c297ab14
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - do not use non-ANSI escape sequences

M	nscp/nscp.c

commit a1b0efa5e0f12696738880d8d5b5b166d6adf325
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - use size_t for length of data in Ns_ConnSendChannel(),
    - Ns_ConnSendFd(), Ns_ConnSendFp() like in other functions.
    - make ignoring of results explicit
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	nsd/connio.c
M	nsd/return.c

commit c4401d4c8603d86368c11e829fe9c2514fba78ba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - use boolean expressions in conditions of conditional expressions

M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/compress.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/progress.c
M	nsd/queue.c
M	nsd/return.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclobjv.c
M	nsd/tclthread.c
M	nsd/urlopen.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdbtest/nsdbtest.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nssock/nssock.c
M	nsthread/rwlock.c

commit 2d8c8b39e02afb298453c66f148deb7e26900258
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - use short types for events/revents to avoid truncations
    - use boolean expressions in conditions of conditional expressions

M	nsd/compress.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/limits.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/set.c
M	nsd/str.c
M	nsd/tclset.c
M	nssock/nssock.c
M	nsthread/winthread.c

commit dbf517a982e5ef94a4062eeaf9eb16d2e193c9a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - when ignoring return values of functions, use standard C means

M	nsd/config.c
M	nsd/driver.c
M	nsd/exec.c

commit 4f6ea1c5cd408e362d9f227b6f92b651d5e5f874
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - use boolean expressions in conditions of conditional expressions

M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/cache.c
M	nsd/compress.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/index.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/proc.c
M	nsd/queue.c
M	nsd/sched.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclconf.c
M	nsd/tclenv.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclset.c
M	nsd/watchdog.c
M	nsdb/dbinit.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nsthread/memory.c
M	nsthread/mutex.c
M	nsthread/nsthreadtest.c
M	nsthread/winthread.c

commit 102911eb7f55f9bba330066fad0febb837d693ce
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - add NS_COOKIE_EXPIRENOW for handling former negative value for time_t

M	include/ns.h
M	nsd/cookies.c

commit edcef8a9203a633eae78409b5fb20639b54e3587
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - reduce implicit signed/unsigned conversions
    - make ignoring of result of Ns_SetPut() explicit

M	nsd/adpeval.c
M	nsd/auth.c
M	nsd/tclvar.c
M	nsd/urlencode.c

commit f49d3175ed16f1ceaa8d4ffd6411e8c9c727f49a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - don't ignore result of Tcl_Close()
    - reduce implicit conversions

M	nsd/tclimg.c
M	nsd/tclvar.c

commit 70d53d6de384ae2c6a52e97f6927d185fcc6d45d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - don't pass nagative value to time_t, align implementation ot documentation
    - reduce implicit signed/unsigned conversions

M	include/ns.h
M	nsd/cookies.c

commit f969f39619354a2f50e7991b4b9211044e3985e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - reduce scope of variable

M	nsd/tclvar.c

commit 5740b048f355b389edb07a0ed84aa74f19b52bca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - use distinct bit-patterns for signal detection under windows.

M	nsd/nswin32.c

commit 9cfec991cc55b630c5cd97a756d611040f75d13e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - initialize static variables

M	nsd/callbacks.c

commit bfb678769ed90cccb78c4b16a7278c79f410e9ee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-02

    - avoid reuse of C90 identifier pattern (str[a-z]+)

M	include/ns.h
M	nsd/urlencode.c

commit 474ecb9ea80b013a9e6cb411c5a7e0ef6b9d9caf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-01

    - remove  casts
    - prefer "const" over "CONST" unless in Tcl interface
    - prefer boolean expressions over expressions of other types
    - ignore result of ReleaseQueue() explicitly
    - reduce implicit signed/unsigned conversions

M	include/nsthread.h
M	nscp/nscp.c
M	nsd/encoding.c
M	nsd/nsd.h
M	nsd/nswin32.c
M	nsd/tcljob.c
M	nsd/unix.c
M	nsd/uuencode.c

commit 5b7b761b5ee9dd2ad149b43f974d7ed2479f79c2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-11-01

    - adjust to current tip

M	nsssl.c

commit 4d1bd42fbaf242dad6fb347edb90b8cbc2fb4309
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-31

    - use const on more occasions

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/pidfile.c
M	nsdb/db.h
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/nsdb.h
M	nsproxy/nsproxylib.c

commit 8fa18bcfc8c0ce7006d712eda2a4c0fa76d950f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-31

    - remove several casts
    - use "char buf" + UCHAR when needed as on other places

M	nscp/nscp.c

commit 7c0f68fd6fa15d9cd7fc2efc3706e50824787864
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-31

    - prefer boolean expressions over expressions of other types
    - adding nonnull assertions
    - reduce implicit signed/unsigned conversions
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/callbacks.c
M	nsd/cls.c
M	nsd/compress.c
M	nsd/config.c
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/crypt.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/form.c
M	nsd/init.c
M	nsd/limits.c
M	nsd/lisp.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/progress.c
M	nsd/queue.c
M	nsd/random.c
M	nsd/request.c
M	nsd/return.c
M	nsd/sched.c
M	nsd/server.c
M	nsd/set.c
M	nsd/sls.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/sockfile.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclconf.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/unix.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsd/watchdog.c
M	nsdb/dbtcl.c
M	nsdb/dbutil.c
M	nsdb/nsdb.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c
M	nssock/nssock.c
M	nsthread/master.c
M	nsthread/memory.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	nsthread/reentrant.c
M	nsthread/thread.c
M	nsthread/winthread.c

commit 93a7b57f3c6c953a93ee8c297e01b66b40416b89
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-30

    My ActiveTcl install location is now:  C:\P\Tcl-64

M	Makefile.win32

commit 8506981dfa558c91fe589633c043efcb679c963c
Merge: f678ab4a fc4abbd6
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-30

    Merge in all upstream changes.  No conflicts.

commit fc4abbd69bd303cc54ebbebb33849dc3a1eb255c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-30

    - fix array unset bug reported by Andrew Piskorski
    - extend regression test

M	nsd/tclvar.c
M	tests/ns_nsv.test

commit f678ab4a6a6a6c3bb982986e458895dc1371ff65
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-29

    Fix test ns_nsv-3.5 to actually check that the array no longer exists.

M	tests/ns_nsv.test

commit 726a0a166cd42c51df8ffbf9799b5a94160ffb4e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-29

    - use boolean expressions in asserts

M	nsd/queue.c
M	nsproxy/nsproxylib.c

commit cc4c880d737336955e674c821ba03c44c5b243bd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-29

    - don't ignore return value of Ns_SockCallback() and Ns_SockSetNonBlocking()
    - reduce implicit signed/unsigned conversions

M	nsd/form.c
M	nsd/listen.c
M	nsd/nsconf.c

commit 52cda56cbbd59902b94ad8851ae5ceeeadd5ff5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-29

    - make several fields of Ns_Request "const char *"

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/queue.c
M	nsd/request.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nslog/nslog.c

commit fc9488f940696477e0ced2289a7976029810b561
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-29

    - ducoment function in usual style

M	nsd/sched.c

commit a0bf89b87ed87c43f7146b7481e3e7ae100b24b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-29

    - mino cleanup in function produced from former macro

M	nsd/sched.c

commit 0ab1f24b96ae7038d876f999697acdc4a9e4c47c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-29

    - make nextSlsId uintptr_d

M	nsd/nsd.h
M	nsd/sls.c

commit 8391c72b7a1f8054c707f651ead564b294d2f255
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-29

    - reduce implicit signed/unsigned conversions
    - prefer "const" over "CONST" unless in Tcl interface
    - document urlv construction

M	include/ns.h
M	nsd/request.c

commit 34e33d1d0d2acfdaaf88a521f48145c34b0fc4b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-29

    - use socklen_t for accept

M	nsssl.c

commit e2df50d4a36e9cc10507fb834f4619a21c8f3534
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-29

    - Use Tcl_Free() instead of ckfree() to free result from Tcl_SplitList() as described in the manual
    - use socklen_t consistently (was used sometimes)
    - remove unneeded casts
    - use const on more occasions

M	include/ns.h
M	nscp/nscp.c
M	nsd/adpparse.c
M	nsd/cache.c
M	nsd/driver.c
M	nsd/info.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/sock.c
M	nsd/task.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nssock/nssock.c
M	nsthread/nsthreadtest.c

commit 21743c4b70c49bdf6dc2333a0714437355c970a3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-28

    - use const on more occasions

M	include/nsthread.h
M	nsthread/time.c

commit f4f691e12c730c569232a93a10420618a2b5864e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-28

    - use consistently macro CHARCONV generally for conversions and macro
      CHARTYPE for testing character properties
    - rename misspelled function NsParseAcceptEnconding() to NsParseAcceptEncoding()
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/config.c
M	nsd/connio.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/mimetypes.c
M	nsd/nsd.h
M	nsd/pathname.c
M	nsd/request.c
M	nsd/str.c
M	nsd/tclmisc.c
M	nsdb/dbtcl.c
M	nsdb/dbutil.c
M	nslog/nslog.c

commit 0ae1594dbb3012d7b772f2fef0057bd16091ba1c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-28

    - remove unneeded casts

M	nsd/adpeval.c

commit 1d4a768108d8ad8a1826a7bccf75126d2a11a482
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-28

    - new macro CHARCONV to avoid implicit conversions changing
      signedness and making int-to-char conversion (losing precision)
      explicit

M	include/ns.h
M	nsd/request.c

commit f2caf0ff8444e29a032eec4f30ca93740250e63d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-27

    - use CHARTYPE macro for testing character properties
    - reduce implicit signed/unsigned conversions
    - use const on more occasions

M	include/ns.h
M	nsd/connio.c
M	nsd/request.c
M	nsd/sched.c
M	nsd/sock.c

commit eadf77a2daca24dbb921e877f240081288c4ab04
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-27

    - Don't ignore result of GzipFile()
    - reduce implicit signed/unsigned conversions
    - use const on more occasions

M	include/ns.h
M	nsd/adpcmds.c
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/info.c
M	nsd/queue.c
M	nsd/sched.c
M	nsd/tclimg.c
M	nsd/urlencode.c

commit 2a508bb1e9fb043dc5d5b32ce0ead9fab8e856fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-27

    - use const on more occasions
    - prefer "const" over "CONST" unless in Tcl interface
    - reduce implicit signed/unsigned conversions

M	include/ns.h
M	nsd/binder.c
M	nsd/connio.c
M	nsd/nsd.h
M	nsd/nswin32.c
M	nsd/sockfile.c
M	nsd/tclobj.c
M	nsd/tclsock.c
M	nsd/tclxkeylist.c
M	nsd/unix.c

commit 72921f471192198d4da7aab66959635287250620
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-27

    - replace unsafe atof() by strtod()

M	nsd/request.c

commit f598d00f1c757b694aff04abb56ad206736374c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-27

    - prefer boolean expressions over expressions of other types (regularizing "isNew" checks)

M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/binder.c
M	nsd/cache.c
M	nsd/config.c
M	nsd/dns.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/limits.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/op.c
M	nsd/proc.c
M	nsd/progress.c
M	nsd/returnresp.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/tclcache.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclset.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c

commit 42f4ebf169b2adb022b46cee0ede657d307c966e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-27

    - Don't ignore result of Ns_TclRegisterTrace()
    - reduce implicit signed/unsigned conversions

M	nsd/adpparse.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/tclinit.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxymod.c

commit 7f3f5344d9a266b1a4f1ce8a4ef5ce441c215a4e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-26

    - replace unsafe atoi() by strtol()

M	nscgi/nscgi.c
M	nsd/binder.c
M	nsd/request.c
M	nsd/returnresp.c
M	nsd/tclsock.c
M	nsthread/nsthreadtest.c

commit 8f31cae705c18ad7b2c5cf220e8f6c0db4297bb7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-26

    - use new macro CHARTYPE to avoid implicit conversions changing signedness

M	include/ns.h
M	nsd/request.c

commit 9fed38a343e594869def62ee26a0f4befa24e1ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-26

    - use Tcl_DStringResult when appropriate
    - use Tcl_SetObjResult() instead of Tcl_SetResult(..., TCL_VOLATILE);
    - prefer boolean expressions over expressions of other types

M	include/ns.h
M	nsd/adpcmds.c
M	nsd/encoding.c
M	nsd/exec.c
M	nsd/info.c
M	nsd/log.c
M	nsd/sockfile.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/urlopen.c
M	nsdb/dbtcl.c
M	nsproxy/nsproxylib.c

commit 7d596a00eac651bc59b1f755add355dfa657d3e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-26

    - revert escaped change

M	include/Makefile.build

commit b24df8c0759bbfedfec4d7a488b05a7ab0a81387
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-25

    - simplify logic (no need for separate tests)
    - reactivating thread name settings for other service modes

M	Makefile.win32
M	include/Makefile.build
M	nsd/nsmain.c

commit 59404db4a98bd82c3994f26f2882108637383e53
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-25

    Windows improvements:
    - provide error messages with messages strings
    - provide more detailed messages when registering services fails
    - set thread name correctly in service mode

M	nsd/nsmain.c
M	nsd/nswin32.c

commit 2d9563e27c7f6e65b543e939334ade8b15d1d8e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-25

    - reduce number of implicit char/int or unsigned char/char conversions

M	nsd/adpparse.c
M	nsd/driver.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/range.c
M	nsd/server.c
M	nsd/tclimg.c
M	nsd/tclsched.c
M	nsd/urlencode.c

commit a986d80eea499ee416602803fd545d64d58133d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-25

    - modernize arg parsing of NsTclFTruncateObjCmd() and  NsTclTruncateObjCmd()

M	nsd/tclfile.c

commit 881803a63bf9de1de2e8ef279ddf9d0f652638b9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-24

    - remove several casts, dropping "const" property
    - declare more argumemts/results as const

M	include/ns.h
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/config.c
M	nsd/form.c
M	nsd/info.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/queue.c
M	nsd/tclcache.c

commit 75372b3f059a7bf42b9066e04f57b53260f21794
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-24

    - declared more arguments const

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/binder.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/server.c
M	nsd/sockfile.c
M	nsd/tclobjv.c
M	nsd/tcltime.c

commit 1730c9545f5d6a6eeca1e9336c191b83186d6d20
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-24

    - reduce signed/unsigned conversions with potential loss of precision

M	nsd/connio.c
M	nsd/driver.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/sls.c
M	nsd/sockfile.c

commit 5022a44425a49a389ed6fc13af0c804c092fafb0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-24

    - use const on more places

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/binder.c
M	nsd/cache.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/exec.c
M	nsd/form.c
M	nsd/log.c
M	nsd/main.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/set.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/tclxkeylist.c
M	nsdb/db.h
M	nsdb/dbdrv.c
M	nsdb/dbutil.c
M	nsdb/nsdb.h
M	nsdbtest/nsdbtest.c

commit 8571d93054381f7df4070be1e0eb8a8ac5cda4b8
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-23

    Allow empty string thread name in CreateConnThread().

M	nsd/queue.c

commit 7fed6ccd9498c5bc45ade413fe6c2c1a8b33d9af
Merge: bf5ad4c7 f7938d3d
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-23

    Merge in all upstream changes.  No conflicts.

commit f7938d3d4d41cc815b7578c104b3fe1108630388
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-23

    - use '\0' instead of 0 for null byte
    - prefer boolean operations over expression of other types in tests

M	nsd/adpparse.c
M	nsd/config.c
M	nsd/crypt.c
M	nsd/dns.c
M	nsd/encoding.c
M	nsd/form.c
M	nsd/log.c
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/server.c
M	nsd/tclmisc.c
M	nsd/tclsock.c
M	nsd/tclxkeylist.c

commit d2ac3867cf69a2321cca03a3e3041abc7c9ba1e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-23

    - use UCHAR macro consistently for islower(), isupper(), tolower(), toupper(), isdigit(), and isspace()

M	nsd/tclmisc.c
M	nslog/nslog.c

commit 80cc0776e3052b57dc7ecc40ae3ba5e50898fbd6
Merge: b84d925a 2734a499
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-23

    - merge

commit b84d925a4f6b2221943ac5e8fe6e95afda2f78c6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-23

    - use UCHAR macro consistently for islower(), isupper(), tolower(), toupper() isdigit()

M	nsd/pathname.c
M	nsd/request.c
M	nsd/tclimg.c

commit 2734a499e6c0a2bc4388f6b74b8baafc5c9b7c5a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-23

    ä- adjust prototypes, when zlib is not available

M	nsd/compress.c

commit beb76e4bb394234b700e55e471fb19ed454e448c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-23

    - add "-service-" to allowed thread names in development mode

M	nsd/queue.c

commit 4a821f725fc22c6f63229aab4c08cdd3b3cadb0c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-23

    - make first argument of Ns_DiffTime const

M	include/nsthread.h
M	nsthread/time.c
M	nsthread/winthread.c

commit c13dc10398f4978110bd962d75307f64f407f0d9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-22

    - make semantics of cascaded "if" more explicit

M	nsd/urlspace.c

commit c047d960f2de870eb1ef08b3e1113793716e2967
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-22

    - remove bug with "ns_adp_ctl stream on"
    - make intended semantics of AppendBlock more clear

M	nsd/adpparse.c

commit 448acae17351c102cf53d4da1878fd37fabdad40
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-22

    - use ptrdiff_t for difference of pointers
    - AppendBlock() make clear, that arg 3 == NULL is implemented as a noop. Probably a bug.

M	nsd/adpparse.c

commit 4dc7f853aa8821b56ae43156b81c4d5addef3e74
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-22

    - reduce signed/unsigned conversions
    - use const on more occasions

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/cache.c
M	nsd/cookies.c
M	nsd/event.c
M	nsd/filter.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/progress.c
M	nsd/server.c
M	nsd/sls.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tclthread.c
M	nsd/urlspace.c
M	nsdbtest/nsdbtest.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsthread/mutex.c
M	nsthread/reentrant.c
M	nsthread/rwlock.c
M	nsthread/thread.c
M	nsthread/winthread.c

commit 1883522046f7320e289c2618b0ad2378168df7b7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-22

    - arithmetic operations on void* are undefined (gcc extension). Avoid these by uase char **.

M	nsd/index.c

commit 30ef1210e4f033b0fc4ce006773ff92da3d5d1e4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-22

    - use boolean expressions

M	nsd/conn.c
M	nsd/tclvar.c

commit ca29ff4c4439df280aac87615252909397f39627
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-22

    - sample config file for openacs: don't use directory path traversal for determining whether libthread is available, since this seems to cause problems under FreeBSD

M	openacs-config.tcl

commit 235c1d746086ea1bdcabcec222acbb73f6b47e0d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-22

    - reduce signed/unsigend conversions

M	nsd/tclimg.c
M	nsd/tcljob.c

commit c5c51443d4e20764cd0cff8b48f036a3327df879
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-22

    - reduce int to pointer conversins
    - use INT2PTR and PTR2INT more consistently

M	nsd/adpparse.c
M	nsd/sched.c
M	nsd/sockfile.c
M	nsd/tclthread.c
M	nsd/tcltime.c

commit 17d78b837e201f57118051a71a6b53651f571ed2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-22

    - relax NONNNULL constraints on NsInitServer: 2nd argument can be NULL (when called via ServiceMain() under windows)

M	nsd/nsd.h
M	nsd/server.c

commit dc6a0c17e8add732d6f29fc0ffb857f184cbd0b4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-22

    - add const for send operation

M	nsssl.c

commit bf5ad4c762dff34452530a8ada9820ceec344f81
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-21

    In Ns_Main, when the server is missing, log more info about the
    servers that ARE present in the config file.

M	nsd/nsmain.c

commit 45651a1b7c35686e8a2ebf70c6cab52f626d48cd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-20

    - use const on more occasions

M	include/ns.h
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/cache.c
M	nsd/callbacks.c
M	nsd/cls.c
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/filter.c
M	nsd/index.c
M	nsd/limits.c
M	nsd/lisp.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/sched.c
M	nsd/set.c
M	nsd/sls.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/sockfile.c
M	nsd/task.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsdb/dbinit.c
M	nsdb/nsdb.h
M	nssock/nssock.c

commit cbe246be83b12af2513d341b3a23f24b46d2fa42
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-20

    - fix argument numbering in NS_GNUC_NONNULL

M	nsd/tclobjv.c

commit e403dad05b3d100bb6fa1f411a5ea420a594f52c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-20

    - reduce signed/unsigend conversions
    - avoid reserved word "time" as identifier

M	include/nscheck.h
M	nsd/adpeval.c
M	nsd/binder.c
M	nsd/compress.c
M	nsd/cookies.c
M	nsd/dns.c
M	nsd/event.c
M	nsd/op.c
M	nsd/tclinit.c
M	nsd/tclresp.c

commit 70d25a90ffc7999182021f2d35f9d4d8caef4798
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-20

    - use const on more occasions
    - reduce signed/unsigend conversions
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	include/nsthread.h
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/config.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/main.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/pathname.c
M	nsd/request.c
M	nsd/return.c
M	nsd/rollfile.c
M	nsd/set.c
M	nsd/sock.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlspace.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nsthread/memory.c
M	nsthread/pthread.c

commit eac8d542fcc4b7f1ae5cbe99fae12fca91433f93
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-19

    - use const for strings in Ns_ObjvTable and Ns_Driver
    - align types sendwait and recvwait in Ns_Driver with type for
       Ns_Time.seconds (long)
    - reduce signed/unsigend conversions

M	include/ns.h
M	nsd/driver.c
M	nsd/tclobj.c

commit ac222d962a0a582bac0bd7b2ff1553ec0ab233be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-19

    - openacs sample config file: add parameter hostname to section "ns/server/${server}/module/nsssl"

M	openacs-config.tcl

commit ef6e957ae140cd03e25dc7b31aebd8ed42971489
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-19

    Add in more of Gustaf's time changes that got lost during an earlier merge.

M	nsthread/time.c

commit 2adbc6b4bba0c423797431bdd73ef1c83f4bbeff
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-19

    Change _MSC_VER version of Ns_GetTime() to use Ns_GetTimeFromWindowsFileTime(),
    per Gustaf's newer preference.

M	nsthread/time.c

commit f4c8885f4387be6f66927e9ebdeeddd91627e5db
Merge: 38c2c867 e6907391
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-19

    Merge in all upstream changes.

commit e690739121d132816f95c5ef6d0a26a2ed853807
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-19

    - use const on more occasions
    - adding nonnull assertions
    - prefer "const" over "CONST" unless in Tcl interface

M	include/ns.h
M	include/nsthread.h
M	nscp/nscp.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/cache.c
M	nsd/callbacks.c
M	nsd/cls.c
M	nsd/config.c
M	nsd/crypt.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/event.c
M	nsd/exec.c
M	nsd/info.c
M	nsd/listen.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/quotehtml.c
M	nsd/range.c
M	nsd/request.c
M	nsd/return.c
M	nsd/sched.c
M	nsd/set.c
M	nsd/sls.c
M	nsd/sockfile.c
M	nsd/task.c
M	nsd/tclenv.c
M	nsd/tcljob.c
M	nsd/tclset.c
M	nsd/tclthread.c
M	nsd/urlopen.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/nsdb.h
M	nssock/nssock.c

commit 135e49ab1f2a00c798e2709dc5d0072a85764582
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-19

    - use NS_INVALID_SOCKET instead of INVALID_SOCKET

M	nsssl.c

commit bb9c852921f57ae0967f787bcd856823901ef1ae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-19

    - add nonnull assertions

M	nsd/tclobjv.c

commit 7129a0020d5a07ec8a363895b8b8ed8230a60749
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-19

    - align function prototypes with function definitions

M	include/ns.h
M	nsd/compress.c
M	nsd/index.c
M	nsd/pathname.c
M	nsd/sched.c
M	nsd/tclobjv.c
M	nsdb/nsdb.h

commit 64bd9525d85df0a7457c468ddd156951bcbf07a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-19

    - don't hardcode .so

M	Makefile

commit 2092d0e1a6b402deff87afb5baa6a553e0c2e646
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-18

    - use const on more occasions
    - adding nonnull assertions

M	include/ns.h
M	nsd/index.c
M	nsd/tclobjv.c

commit 29d465557eff9228ddace997ca07ee63d177151e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-18

    - fix man page for "ns_cond wait"

M	doc/src/naviserver/ns_cond.man

commit 27ed645cbff487e331e039aec4f94657d412aa46
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-18

    - fix bug in ns_cond reported by Andrew Piskorski; tcl command argument parsing was incorrect

M	nsd/tclthread.c

commit b0cf29cc6d50c712419236b0a1f8dd3a15d22d6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-18

    - add missing pages for test adp test cases

A	tests/testserver/pages/adp1.adp
A	tests/testserver/pages/adp2.adp

commit eaeb41a8d53b5826a58f36fe474b305281584fde
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-18

    - fix streaming flag

M	nsd/connio.c
M	nsd/driver.c
M	nsd/tclresp.c

commit 2b10ca3bc84f852e25b180e2e1ddf8f1d00b7255
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-18

    - Ns_ConnSetLengthHeader(): make handling of HTML-streaming explicit
    - use const on more occasions
    - adding nonnull assertions
    - reduce signed/unsigend conversions

M	include/ns.h
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/httptime.c
M	nsd/range.c
M	nsd/return.c
M	nsd/tclresp.c

commit 38c2c8675993ff75b6e4cfbf8e586459ec52af59
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-18

    Add a real-world test of ns_cond wait and broadcast.

A	tests/ns_cond.test
A	tests/testserver/modules/ns_cond.tcl

commit af34516b0f3437eccb33dea2b371273a520f0efc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - use const on more occasions
    - prefer const over CONST unless in Tcl interface
    - reduce signed/unsigend conversions

M	include/ns.h
M	nsd/return.c

commit c0379229cab97405822b0accf9c8e200499f508d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - reduce signed/unsigend conversions

M	nsd/driver.c

commit 822aabc9a9467c1f2b24e8316ae8c6d9173ba29c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - user INT2PTR for integer to pointer conversions

M	nsd/return.c

commit 32bd95ed400359406b0cfb88a74f35cf1bbed84a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - align function prototypes with function definitions

M	include/ns.h
M	nsd/compress.c
M	nsd/log.c
M	nsdb/dbtcl.c

commit 2b76f7950f97a68e6a36b37d239b1482e440862d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - adding nonnull assertions
    - reduce signed/unsigend conversions
    - use const on more occasions

M	nsd/url2file.c
M	nsdb/dbinit.c

commit ca894007ee1c32c3eff874de4649e586b2905342
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - use "const" on more occasions
    - reduce signed/unsigend conversions

M	include/ns.h
M	nsd/compress.c
M	nsd/tclhttp.c

commit 712bfbf81e08076f9c69b3bc9bea295958127485
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - prefer Boolean values
    - reduce number of reserved word conflicts by using camel case

M	nsd/driver.c

commit 0b51dc3f1c23d55e18c7f3617bfd594810e279dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - use "const" on more arguments

M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h

commit dc820b12eec0cc38d97860b6366da440f9ecdb39
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - reduce signed/unsigned conflicts

M	nsd/return.c
M	nsd/sock.c
M	nsd/task.c

commit 899e33a55fc02742d8a6a3214d28ff3ddce74cd0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - fix indentation

M	nscp/nscp.c

commit 58d4f6327221a38a24843374b652b0512eb2fd5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - use Ns_ParseObjv for NsTclGetAddrObjCmd() and NsTclGetAddrObjCmd()
      instead of ad-hoc parsing.
    - document option "-all" of function "ns_addrbyhost"

M	doc/src/naviserver/ns_addrbyhost.man
M	nsd/tclsock.c

commit f33ba8372c23381d8cf4a55aed517d570042a2ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - more cleanup in mutex.c:
      * make mutex timings configurable (e.g. via defines during compilation)
      * document NS_NO_MUTEX_TIMING
      * don't leave undefined variables when NS_NO_MUTEX_TIMING is turned on

M	nsthread/mutex.c

commit fe86c0ab0197e5a200e9a432dd4afaa5f5977ec0
Merge: d6e34066 7a651ef4
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-16

    Merge in all upstream changes.
    Resolve nsthread/time.c conflicts in favor of my local changes, as
    they are cleaner and more general.

commit d6e34066d1f489047222215147e43bf56f71cca5
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-16

    Prevent the missing 'namespace ensemble' command from breaking Tcl 8.4.

M	tcl/nstrace.tcl

commit 7fb8e45dc07ce7cf0a34dc0a2012fd01b545ba1a
Merge: 6456668c f48f8bb4
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-15

    Merge in all upstream changes. No conflicts.

commit 0771940e716b5fd87dbefff96a6ca14486baaedc
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-12

    Add 32-bit build support.

M	Makefile.win32

commit 3823178968226f87d146f603ad8299324f77a092
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-11

    Add new Windows-only nmake file.

A	Makefile.win32

commit 68f7c6a290bc270d6f3894417b343f3800648cfb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - adjust types

M	nsssl.c

commit 0028182a50d9f6cecee7f742df93b8d39e7f21bc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-23

    - make flags "unsigned int"

M	nsssl.c

commit c145a3273516dec91befed795731401b60926d41
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-07-02

    - change advertised version number

M	README

commit bf1dcba5625720dcb5da71ee2cd4b16930886dda
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-02

     Make sure to initialize all members of Ns_DriverInitData to zero

M	nsssl.c

commit d384449bd57dddb973fecfcd218226e7f65ac80a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-12

    - update documentation with HSTS (HTTP Strict Transport Security)

M	README

commit 1307ab8ac020be07d2f76c1c03198500ec297906
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-12

    - remove debug line

M	nsssl.c

commit b323c12fdc9077959d410df544a2ed68aee39e4f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-10

    - fix typos in README

M	README

commit 52ceee2a471f703c084c00bfa4257b68e159d9f1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-10

    - added support for Eliptic Curve Cryptograpy (such as Elliptic Curve Diffie-Hellman (ECDH))
    - provide compiled-in defaults for DH parameters
    - add flags for handling several SSL and TLS bugs.
    - deactivate SSLv2
    - bumped version number to 0.5

M	Makefile
M	README
A	dhparams.h
M	nsssl.c

commit c7332d972db9b0cff902a858d13bc06241d18f66
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-05

    - Added OpenSSL version number to startup message

M	nsssl.c

commit 14f1e2182e95a97e8cf89cbea4e809125e9c8ba8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-03-31

    - mention adding of diffie hellman parameters to server.pem in README file

M	README

commit 9d3cb56ec2f26518dd20ce8e14f358dc1dab4e80
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-02-14

    - added additional parameter "-decompress" for "ns_ssl wait" to compress
      the result on the fly (incrementally) in case it is content encoding
      is "gzip"

M	README
M	nsssl.c

commit e1677a5a128603d083243ac2b0cbbd0bf90c97f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-27

    bump version number to 0.4

M	README
M	nsssl.c

commit aaddea9822efa5ffb61daf2d9f8d9bb98768b9f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-27

    - added support for perfect forward secrecy (PFS) to nsssl

M	README
M	nsssl.c

commit 215a3a872f6a2b4d63f5ff8656fa19a4c2002110
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-08-22

    - return headers + status also, when no spoolsize is specified

M	nsssl.c

commit e6edcee2391f1337dc5e8b219a23de9182dd83d4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-18

    - updated ChangeLog, README

M	ChangeLog
M	README

commit d60e5badb56f7b6e8db453ad461fbf1f9a6670bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-18

    - Made ns_ssl working with asynchronous  I/O.
    - Refactored code to improve reuse from ns_http.
    - Added flags
         -file /varName/
      and
         -spoolsize /int/
      to "ns_ssl wait".  If the content of the obtained
      file is larger or equal than spoolsize, it is spooled to
      temp file, and the name of the temp file is
      returned in the variable provided by "-file". These
      options make it possible to retrieve also large
      content (e.g. video files) via ns_http without
      bloating memory.

M	nsssl.c

commit ef38e288a4a94a1a7a624968620d0360bd7a0611
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-25

    Added tag naviserver-4.99.5 for changeset 2a01f010f2b7

M	.hgtags

commit 560473090ad96025405ff20742bd3da2a58ca1cb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-25

    - updated README file, added ChangeLog

A	ChangeLog
M	README

commit a7bec381039cd725446f41f80dfcc8813ec262d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-25

    Added tag naviserver-4.99.5 for changeset 60b45c18e323

M	.hgtags

commit 146ac6eb66bdb0247620cb535a245df6de374ce0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-18

    enable partial write operations on a per-connection basis (value in CTX does not seem to propergate)

M	nsssl.c

commit b043851b42f6b9cd1fd1b7e6d6ba7855a5c3c31c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-18

    fix 1 byte reads

M	nsssl.c

commit bfe8f298c808368f1411ab134cde7c4db03d1233
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-13

    Pass accept timeout to Ns_SockSetDeferAccept()

M	nsssl.c

commit ff9605f54a1b8e412fd9737a4692fabac8cad01a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-13

    Use refactored function Ns_SockSetDeferAccept() instead of private implementation

M	nsssl.c

commit 306f0d0f47b774ad3fa2e28d98114f0111bb03fc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-09

    pass structure to SockCork, not fd.

M	nsssl.c

commit b8a31431764847a64745d86ca73966ddd7b89bd2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-09

    Using TCP_CORK for optimizing TCP tracffc. Avoid send attempts on
    zero-byte buffers.

M	nsssl.c

commit 55322707ffd74514727c4bfdf5a6e01a93b0bded
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-07

    SSL_read frequently returns just 1 byte in a read operation. Perform in such cases a second attempt (which will return significantly more data)

M	nsssl.c

commit 522962ff3da93eabd9fdebe253197c6c7d021f15
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-07

    added SO_ACCEPTFILTER for machines having no TCP_DEFER_ACCEPT

M	nsssl.c

commit ad1ce50337731241f9f7ef2362da9c080b9fdd5f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-06

    update recommended cipher configuration (old one exposes vulnerabilities)

M	README

commit 1c6a3de02bd89401a6f9ec683b59a5ead271fe9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-05

    Prefer server ciphers to secure against BEAST attack.
    Disable compression to avoid CRIME attack.
    Prevent client-initiated renegotiation which is an attack point for DoS.

M	nsssl.c

commit 924f50c87f0b012ba9181dc78cf7d316402a697d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-03

    Define driver properly as NS_DRIVER_ASYNC; don't enter eventloop via
    Ns_SockTimedWait() since this might interact badly with the top-level
    event loop in driver.c. Various small cleanups. Tagged old version as
    0.1 and incremented version number to 0.2. Tested on Linux and macOS.

M	README
M	nsssl.c

commit f07db4c0d4e108a70e7bf4e993f6f8230ca9a347
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-03

    Added tag nsssl-0.1 for changeset 07e8df5c88e7

A	.hgtags

commit a5b1f33d831dfec38e68e4e08f99fe0ee686cc4d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-26

    add Darwin fix, allow deferaccept

M	nsssl.c

commit 4ad4e332ddd931e5f29703b03bc0ba7896669a11
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2010-09-14

    Fixed wrong args bug

M	nsssl.c

commit 9be770a0b37619d22d51c4c2d80af9059999927a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-11-07

    Don't implement driver SendFile callback as this is handled automatically

M	nsssl.c

commit 480b6f2caae7c8e72ae3e9efd3d2bc45ce30bea6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-22

    Check the return value of SSL_new() in Accept()

M	nsssl.c

commit 138643b166f2475849584a4f3e9d80ea6b9c752c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-22

    Drop the Ns_DriverRequestProc; validate client cert in Recv

M	nsssl.c

commit 3b7afea211e7b7ac42f8df7f5fb245864ea355c3
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-22

    Implement new driver callback interface

M	nsssl.c

commit 0a932674d8889ae64059b952c9a6a2f7ba924eb8
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-05-05

    No longer use NS_DRIVER_QUEUE_ON_ACCEPT flag, should be automatic; reindent

M	nsssl.c

commit 41534fb58e204ad5fb7cbc1203a48dd697995e5e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-04-25

    Implement https client requests, mimicking ns_http command

M	README
M	nsssl.c

commit 4b7d0e2ba1680e920dce251692f884fe6b9882a8
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-04-05

    Fix the example of loading the module

M	README

commit 84f0d53a80d02bf01b661ddd4477d4153bd3fce5
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-01-02

    Add stub ns_ssl command

M	nsssl.c

commit b99815318584d808847033088b9e0cc9465b789b
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-28

    Add random seed to ssl init module

M	nsssl.c

commit 1a47e3223e55ab49b360eff76157c9bd22cac80f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-28

    Initial revision

A	LICENSE
A	Makefile
A	README
A	nsssl.c

commit be2dae101b7f96589a7d53f948031b73018d05ef
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2006-03-28

    (Ns_LogRoll): fix logrolling on Win32 (bug # 994224)
    
    Uses a simplified version of Dossy's bug-994224-v409a-patch-20040928.txt
    patch.
    (transplanted from 40cdd73ec6a44782929eaad8af3e37b07af7ba99)

M	nsd/log.c

commit 6456668cc5391269d87a375a1099617e0818fb45
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2006-03-28

    (Ns_LogRoll): fix logrolling on Win32 (bug # 994224)
    
    Uses a simplified version of Dossy's bug-994224-v409a-patch-20040928.txt
    patch.
    (transplanted from 40cdd73ec6a44782929eaad8af3e37b07af7ba99)

M	nsd/log.c

commit 08a4734a652c18144d20c4cf84bd56de0b35ba2b
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2006-03-28

    Fix Ns_NormalizePath() for //foo/bar paths on Win32 (bug #1162890)
    (transplanted from b0fe3532af28b729dead9f9c3637e1ac97611a13)

M	nsd/pathname.c

commit 88897c21c1bf9182909f08ca8e1a260e8110aa60
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - use same objv definition as in Tcl

M	nsd/tclsock.c

commit 5c9608b78fbc758dcb504ac13a080d47c4f7fd9d
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-13

    Fix broken 2005-02-16 rev 1097:3d984c89b332, which bogusly smashed
    over the Ns_GetAllAddrByHost() [ns_addrbyhost -all] support added
    2004-12-06 in rev 1092:89882a8e77bc.

M	nsd/tclsock.c

commit ac77a288541fcc937a6c2851c9665740824e0f01
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-13

    Remove trailing whitespace, only.

M	tcl/sendmail.tcl

commit fb16e63ab0291f0edf1f2163407b985fc76bd85e
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-12

    Better control of whether to append to or smash over LIB and INCLUDE.

M	Makefile.win32

commit b13ad5f41a3a68aca771dd437d8e5e48356e0748
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - fix merge conflict

M	Makefile.win32

commit 25fa6d69781d17572b9f5695efbc63c7c99d63e3
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-11

    Add the nsssl module.

M	Makefile.win32

commit a70e7e7a2307091ba389e8a17b81ac2d204aa121
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-11

    Do not explicitly INCLUDE to child nmakes.  Doing so was breaking the
    nsssl build, although I don't entirely understand why.

M	Makefile.win32

commit dd4fd02b34b43be38c00ff69509620f21e88810c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - fix merge conflict

M	Makefile.win32

commit c735bb72ea6fdfb93ad2588a2ca71ec1f4f18f6b
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-11

    Add support for building add-on modules.

M	Makefile.win32

commit 07f81b91ba6874569fc0c5b7b7a148ce961c5782
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-08

    Make it easier to toggle mutex timings on/off.

M	nsthread/mutex.c

commit 0ff9443b7c23490b4ec299a122db7ad161e7bdcc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - use "const" on more occasions
    - avoid reserved word "time" as identifier
    - reduce signed/unsigend conversions

M	include/ns.h
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclcmds.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c

commit 1636a1936340525698a4c938f31a35250a35b4df
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-17

    - ignore function result

M	nsd/tclcmds.c

commit d2e04ae8b86cd9b961a89e2e2974c6942a415266
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-16

    - reduce singed/unsigend conversions
    - use const on more occasions
    - align var names in prototypes with var names in function definitions
    - follow posix naming for send() and recv() arguments

M	include/ns.h
M	nsd/sock.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c

commit c0279a7048429c01d93704ff9da30674badcf285
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-16

    - remove hard-coded MIME-Version from headers

M	nsd/return.c

commit 7a651ef46588a42d37194af81683f11e9f810105
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-16

    - fix for bug in nsthreadtest when compiled with Tcl 8.5 or newer

M	nsthread/nsthreadtest.c

commit 1051465501687539b4bec35c2e936cda5f2c9721
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-16

    - undo part of removal of seemingly unused variables since these have consequences for the actual db drivers

M	nsdb/dbinit.c

commit 201772704145a3fd848f4bd43ef053e80b14868a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - use const for more arguments

M	include/ns.h
M	nsd/set.c
M	nsd/tclset.c

commit 65091c74b248b6b200ec5a71c5bc1d4fb22e9441
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - declare more arguments as "const"

M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/nsd.h

commit fe8d9389af7a7282831a0c5033a26b5559c75492
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - used boolean expressions in asserts
    - make constants unsigned

M	nsd/driver.c

commit 8af9e6d1a21be9bdbff75e4690de82decbda9417
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - add const to definition

M	nsd/tclxkeylist.c

commit 81523695423f3769697c0b9ba36108baeeaf1226
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - avoid shadowing of variable names

M	nsd/nswin32.c

commit 5ca217221aa12f461e6184d1def89a9b3a5ba322
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - reduce singed/unsigned operations

M	nsd/tclobjv.c

commit f67d1cd9fa418640905524dfff7b6f9a5e29a251
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - avoid adding or shifting by 0

M	nsd/crypt.c

commit 9a1b22304025701b1623da7e1a4ff8de5bf80013
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - add nonnull assertions

M	nsdb/dbutil.c
M	nsdb/nsdb.h

commit 00127ed98a0f4a6a9991b97dd764bc0d2053f136
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - reduce signed/unsigned conversions

M	nscp/nscp.c
M	nsd/tcljob.c

commit 38d10bc5cf0239d5b4077b2309c47aa89554259e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - use const for proc descriptions

M	include/ns.h
M	nsd/proc.c

commit 3ff99cec7d2ee48b1d768010007758ed9c3c14a3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - donÄt ignore noinherit (seemingly old bug)

M	nsperm/nsperm.c

commit 972b267003a93aca650c3164b88af80044ee974a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - undo change of using & in front for function pointers due to
      seemingly contradictory warnings from lint:
      "Suspicious use of &: Since names of functions by themselves are
      promoted to address, the use of the & is redundant" vs.
      "function identifier used without „&‟ or parenthesized parameter list"

M	nsd/proc.c

commit bd3cac2d6f2a4b5869e3fcee4bec9d03018f76ca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - initialize variable

M	nsd/adprequest.c

commit c6d01957916c1a9623c18e0ad01c43dac68922c9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - further cleanup of Ns_GetTime()
    - added nonnull assertions

M	include/nsthread.h
M	nsthread/time.c

commit f48f8bb4c7c1725e5f9c6552ca2006894786c882
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-15

    - use INT2PTR consistently for Ns_ObjvBool

M	nsd/adpcmds.c
M	nsd/adprequest.c
M	nsd/fastpath.c
M	nsd/index.c
M	nsd/limits.c
M	nsd/nsmain.c
M	nsd/tclcache.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclvar.c
M	nsperm/nsperm.c

commit 3a2a322210bbc5bc43cbd83a497d378d39dd636e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - use macro INT2PTR for integer to pointer conversions

M	nsd/tclsched.c

commit 6a06fb15a1a2d906166dd162fd092f57ec728ebc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - use expicit cats for into to size_t conversions

M	nsd/urlspace.c

commit da264bc840981287f7b380a8906e7741c8a927db
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - use unsigned int for flags

M	nsd/tclset.c

commit 65fd0e564f1cb4c57158218d7470b1dd8bc8f095
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - reduce signed / unsigned conversions

M	nsd/return.c

commit dbc954f9051c311f358b17377d880cf6ee7d5b5f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - remove unneeded struct

M	nscgi/nscgi.c

commit 20b66ba623a682768ce91a9b680f068436d5586c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - use ssize_t for recv()
    - reduce impliced unsigned/signed conversions
    - use const for more arguments

M	include/ns.h
M	nsd/info.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/sock.c
M	nsd/tclinit.c

commit 9f3f42963f7bb00f40f4a980dd669a3a7789a27a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - remove redundant definition

M	nsd/nsd.h

commit 13ca55bc0470834c5598a857f206bf0d757fec6e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - specify function pointers with &-operator

M	nsd/proc.c

commit 43af6d835adf59d5d8c2b19417e57f14b660e3d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - remove cast

M	nsd/nsconf.c

commit 7093d16baab7478ab523ea4d698c9a97a93b506c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - use const on more occasions

M	nsd/sockfile.c
M	nsd/tclxkeylist.c

commit a289e751a1f33ca6654ab98157945710b965e984
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - use INT2PTR more frequently

M	nsd/log.c

commit 271d78bce71c1154d65f647f1e7827f153b19082
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - make sure, local variables are always initialized

M	nsd/adpeval.c
M	nsd/config.c
M	nsd/exec.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclset.c

commit 91dfe870a86a346ca80aada3c32ebeb18f6e8eb7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - reduce signed/unsigned conversions

M	nsd/driver.c
M	nsd/rollfile.c
M	nsd/tclimg.c
M	nsd/tcljob.c
M	nsd/tclmisc.c

commit a75e0e60e56f8a35e23045266e572511e66f85da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - fix flag handling, use INT2PTR macro

M	nsd/tclrequest.c
M	nsd/url2file.c

commit a78089166e1e2c042f2277111409ddcaf48f274f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - brace body of for-loop

M	nsd/tclxkeylist.c

commit df567821977da1aece7b8dfde71069977c6a89a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-14

    - reduce unused assignments

M	nscp/nscp.c
M	nsd/connio.c
M	nsd/httptime.c
M	nsd/lisp.c
M	nsd/modload.c
M	nsd/nsmain.c
M	nsd/queue.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/uuencode.c
M	nsdb/dbdrv.c

commit 6a51193d2b2f14868699cd23a1cd55d6f001a655
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - use character type for character value

M	nsd/urlencode.c

commit 1ffa077910c0294a8523ca02ca5f67589fe908ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - remove redundant defines

M	nsd/fd.c

commit da86d3408ddc1cdfa7da2783e7146e69c90780a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - name parameters in prototype

M	nsd/set.c
M	nsd/tclvar.c

commit b8e84c58bad7754fa69b62f89063070ef6f8a0d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - initialize static variables

M	nsd/nsmain.c
M	nsd/random.c

commit fe65222d5f66a855fa583d729cd1af46701f6092
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - remove unneeded external references

M	nsd/info.c
M	nsd/tclhttp.c

commit 256c73e19cc9adacfff58bfb7892ff2b599e44db
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - remove unused symbols and structure members

M	nscgi/nscgi.c
M	nsd/binder.c
M	nsd/cache.c
M	nsd/driver.c
M	nsd/exec.c
M	nsd/info.c
M	nsd/nswin32.c
M	nsdb/dbinit.c

commit 3bd107f1612549d7064cf1c3a4952c3bc78d36c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - reduce singed unsigned conversions

M	include/ns.h
M	nsd/adprequest.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/request.c
M	nsd/task.c
M	nsd/tclimg.c

commit 80ee602f06b376053d3d5de1e79b4a5387c08d4f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - use const for more strings and structures

M	nsd/adpparse.c

commit a1148500ca684434e36ee90e7bdb92193154a8bf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - make flag value unsigned, use hex notation

M	nslog/nslog.c

commit e1e3272aa861ba663d259e6f492d5ed7b65f75dd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - improve comment density

M	nscgi/nscgi.c

commit 15a1973f1d3aca3968d8d9447a23847cf119a8dd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - fix newly introduced bug

M	nsd/tclset.c

commit 7d60886331d49ea25595a8101a832f68d8b84032
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - remove shadowing of variables

M	nsd/driver.c
M	nsd/log.c
M	nsd/tcljob.c

commit 0d79f3dee33b954610bd389e6916ba77a351bca3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - fix consequences of removal of useless ns_set option purge

M	tests/ns_set.test

commit a535623c45b8f9a65e14f6231d63844c83a74315
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - remove unused preprocessor defines

M	nsd/adpparse.c
M	nsd/binder.c
M	nsd/compress.c
M	nsd/driver.c
M	nsd/tclmisc.c

commit 69611e207967e998963a8bd82b28638c5297cf76
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - remove old-style function prototypes

M	nsd/nsd.h

commit c8557bc9f596c221961893dbba6cb3170226d1d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - UNUSED polishing

M	nsd/encoding.c
M	nsd/log.c
M	nsd/sockcallback.c
M	nsd/tclcache.c
M	nsd/tclfile.c
M	nsd/tclobjv.c
M	nsd/tclresp.c
M	nsd/tclsock.c

commit 7ed73fa48be894a5e7df997f75a3df3c363bacf8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-13

    - remove unneeded symbols
    - align names in prototypes and function definitions

M	include/ns.h
M	nscp/nscp.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/callbacks.c
M	nsd/cls.c
M	nsd/compress.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/exec.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/index.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/range.c
M	nsd/return.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/server.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nsd/str.c
M	nsd/task.c
M	nsd/tcljob.c
M	nsd/tclobjv.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/uuencode.c
M	nsdb/db.h
M	nsdb/dbtcl.c
M	nsdb/nsdb.h

commit d5236aadeb06eec5a17ba9cc77d77b5dfa4c6ae3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - use "const" for more strings

M	include/ns.h
M	nsd/auth.c
M	nsd/crypt.c
M	nsd/dns.c
M	nsd/httptime.c
M	nsperm/nsperm.c

commit f56696e4518876e0b14918c6411438921addb08e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - use size_t for sizes

M	nscgi/nscgi.c

commit 46d2e7021c2505457d717cafb86f5182e904b84e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - use size_t for  maxsize and bufsize in DrvWriter and Driver

M	nsd/driver.c
M	nsd/nsd.h

commit c0b2bfa0d00f03ce6cfce5b756350efb2c6a97b8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - fix indentation

M	nscp/nscp.c

commit 6c24b8d8094d6dcb0f81dbbd16eaa7377c4e1f2b
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2006-03-28

    Fix Ns_NormalizePath() for //foo/bar paths on Win32 (bug #1162890)
    (transplanted from b0fe3532af28b729dead9f9c3637e1ac97611a13)

M	nsd/pathname.c

commit b2392ac5664c398097138e7656e47a43af65b1b5
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-15

    Declare Tcl_GetMemoryInfo() with NS_IMPORT.

M	nsthread/nsthreadtest.c

commit 814775ae32ba9ee37e28d5a312651b702fc8e52a
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-13

    Fix broken 2005-02-16 rev 1097:3d984c89b332, which bogusly smashed
    over the Ns_GetAllAddrByHost() [ns_addrbyhost -all] support added
    2004-12-06 in rev 1092:89882a8e77bc.

M	nsd/tclsock.c

commit d9f2cbbd076d014314ff4e9613c5d4d3df251522
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-13

    Remove trailing whitespace, only.

M	tcl/sendmail.tcl

commit dda965b5c3bf64600bdd72ac920a1685aaf12a0a
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-12

    Better control of whether to append to or smash over LIB and INCLUDE.

M	Makefile.win32

commit 8259d720c897e523d62b4ca3d28937d1dd0f1a71
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-12

    Tweak, when timing is off we do not need the end, diff, startTime variables.

M	nsthread/mutex.c

commit 9aa45fc1d0f534e841070567498746f70b24c972
Merge: 6c489a61 a1e614fc
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-12

    Merge in all upstream changes.  No conflicts.

commit 6c489a61740d36d28dc5b4aff3aeda3e0b6192cf
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-12

    Add 32-bit build support.

M	Makefile.win32
M	include/Makefile.win32

commit a1e614fcc08a21da90d0f7a49445deaa938e70df
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - remove unreferenced enumeration value

M	nsd/tclset.c

commit bb0f6cda6af93774e1de6d698c7627ceca828729
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - remove unreachable code

M	nsdb/dbutil.c

commit ee0e6fea008e59b2b2252aa4aa6f41663d7da4a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - initialize variable explicitlely

M	nsd/log.c

commit 7f6a9d03de23223a8fdce135e407f49f9ac56fda
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - brace body of if statements

M	nscp/nscp.c
M	nsd/lisp.c
M	nsd/tclmisc.c
M	nsdb/dbdrv.c

commit eb29e7e7e6184764216c58bcef488d70cf43ce86
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - brace for loops

M	nsd/crypt.c

commit 64c44da276f4ee1b10dffea3236f221cdb9cd41f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - adding missing "static" declarations

M	nsd/limits.c
M	nsd/nsmain.c
M	nsd/tclvar.c
M	nsd/urlspace.c

commit 87b9a2904464c83631e4f8d08aa2ebd0e229d302
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - adding missing "static"

M	nsd/urlspace.c

commit ac7a99f17c65e87c6884713e79b7ade2adf1988b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - use INT2PTR and PTR2INT more consistently
    - reduce signed/unsigend operations
    - used unsigned types for bitwise operations

M	include/ns.h
M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/adpparse.c
M	nsd/config.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/proc.c
M	nsd/quotehtml.c
M	nsd/task.c
M	nsd/tclconf.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclsched.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlopen.c

commit 9aeda5f7d256900e958d000094ade170e70dedb3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - make char* pool const
    - use PTR2INT and INT2PTR for int/pointr conversions

M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/nsdb.h

commit 8e67db90e94432150713d1f1e36c5c9620af8de1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-12

    - make Ns_ModuleVersion constant

M	nsdb/nsdb.c
M	nsdbtest/nsdbtest.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxymod.c
M	nssock/nssock.c

commit 8fd9b138fd65ea8019b268027267bc5ba347efd0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - align variable names

M	include/ns.h
M	include/nsthread.h
M	nsd/connio.c
M	nsd/driver.c
M	nsd/pathname.c
M	nsd/sock.c

commit 17bd85b7b382c9248269a2680a9cdc442b511f72
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - reduce number of sign conversions

M	nsd/tclmisc.c

commit a310ffa3d4bb2feeeb485dfed693212824abb8c7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - prefer boolean expressions

M	nsd/urlspace.c

commit d9cd87fcfa816d967f52d6f3f3e3e56ec5dc3ec4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - remove unused variable from unix-part

M	nsd/nsmain.c

commit 6abc13d52d3865330d257832baad47b9a49a444c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - remove octal constants

M	nsd/crypt.c

commit e9aea2f30d7a2fb28ddf0d7f3d7df5c21139dc33
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - use hex rather than octal constants

M	nsd/uuencode.c

commit f41b6a0c9471a1978ec61e7c3c6beea2a933d87d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - switch to the notation of Tcl_ObjCmdProc and Tcl_CmdProc as defined in tcl.h in Tcl 8.5.*

M	include/ns.h
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/conn.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/info.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/progress.c
M	nsd/queue.c
M	nsd/quotehtml.c
M	nsd/random.c
M	nsd/sls.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclconf.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsdb/dbtcl.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c

commit c8195846d6a7f94f3e4a7fd261527d15058b4156
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - assert on locally used variables

M	nsd/adprequest.c

commit 6354b422a049b4ab4799e26908fdbb5898c45817
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - reduce implicit signed/unsigned conversions

M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/event.c
M	nsd/form.c
M	nsd/nsd.h
M	nsd/pathname.c
M	nsd/random.c
M	nsd/task.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tclrequest.c
M	nsd/tclsched.c
M	nsd/tclvar.c
M	nsd/url2file.c
M	nsd/uuencode.c
M	nslog/nslog.c

commit 556f8d170716398136e0b42ba5526ffafc5f5147
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-11

    Add the nsssl module.

M	Makefile.win32

commit fdc7e8f310c98749974c2885253f0a4d6af7fe99
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-11

    Do not explicitly INCLUDE to child nmakes.  Doing so was breaking the
    nsssl build, although I don't entirely understand why.

M	Makefile.win32

commit 3e1e47fd6a9cf2582248dd0b074ab8d5605d51f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - add missing function prototypes

M	include/ns.h
M	nsd/adpparse.c
M	nsd/cookies.c
M	nsd/crypt.c
M	nsd/fastpath.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nsd/tclcmds.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclobjv.c
M	nsd/tcltime.c
M	nsdb/dbdrv.c
M	nsdb/dbtcl.c

commit a1eca9d13625a4203f1bf324c3c067118c0d964e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - bsearch is available in newer versions of MSVC.
    - add missing function prototypes

M	nsd/index.c

commit c1d78d704d534d0ec004deb99c51a28965e5a0d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - remove old-style function declaration
    - remove unneeded variable

M	include/ns.h
M	nsd/driver.c

commit 453034c105d50fc438ed52b296d7532c0220e328
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - remove unnecessary function (not included in any .h file)
    - made functions not defined in any .h file static and define function prototypes

M	nsd/tclxkeylist.c

commit e794c511cb2d50a1467d687f9e69176597e78e5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - rename NS_TclCreateInterp to NsTclCreateInterp to follow naming conventions and move function to internal usage (nsd.h)

M	include/ns.h
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/tclinit.c

commit d8b6096c5eed669a5bd8cc54a00aeba344f8304b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - remove unneeded static function

M	nsd/tclfile.c

commit 5b6c05f578d3d9b1e36d600c165d7afa0e199b2f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - flag all unused parameters in function heads
    - use macro UNUSED as uniform mechanism (instead of naming parameters "dummy" or "ignored", ...)
    - add more nonnull assertions

M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/conn.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/main.c
M	nsd/mimetypes.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/pathname.c
M	nsd/pidfile.c
M	nsd/progress.c
M	nsd/quotehtml.c
M	nsd/random.c
M	nsd/return.c
M	nsd/sched.c
M	nsd/sls.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclconf.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclsock.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/urlencode.c
M	nsd/urlspace.c
M	nsdb/dbtcl.c
M	nsdbtest/nsdbtest.c

commit 6a7604d8c396fee35c0241baeca9688ff07a2f1d
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-11

    Remove /e option to nmake, it is not necessary for core Naviserver,
    and interferes with appending to INCLUDE in add-on module makefiles.

M	Makefile.win32

commit 6df9e6ebbb60b629379e60f94d2ccc4230151aa2
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-11

    Add support for building add-on modules.

M	Makefile.win32

commit 6566644204a6b0bc2c10d3de73296ea2b4555a84
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-11

    - addressing signed/unsigned divides and relational operators

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/adpparse.c
M	nsd/connio.c
M	nsd/log.c
M	nsd/nswin32.c
M	nsd/tclvar.c

commit 425ff244205afe436758dbf53b680feaa02b5a96
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - remove flag /D "NO_CONST=1" and /D _CRT_NONSTDC_NO_DEPRECATE from flags from windows build

M	include/Makefile.win32

commit ca84dbb926d5ac6301698daa8a618cbe59e0d12b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - change CONST -> const

M	nsd/encoding.c

commit 6593a9c3f5baea52abf84651047641d5ca8653be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - change from usage of INVALID_SOCKET (windows predefined constant) to NS_INVALID_SOCKET due to confusion under MinGW

M	include/nsthread.h
M	nscp/nscp.c
M	nsd/binder.c
M	nsd/conn.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/index.c
M	nsd/listen.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/sock.c
M	nsd/tclhttp.c
M	nsd/tclsock.c
M	nsd/urlopen.c
M	nssock/nssock.c

commit eb7737e2c2b97cc7447259394410c866f13cf2e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - name parameters in declarations

M	include/ns.h
M	include/nsthread.h
M	nsd/index.c
M	nsd/set.c
M	nsd/tclcallbacks.c
M	nsd/tclresp.c
M	nsd/tclthread.c
M	nsd/urlspace.c
M	nsdb/db.h
M	nsdb/dbdrv.c
M	nsdb/dbinit.c

commit 76419645c980b908fbcc547c287159ae236370a2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - const-ify more variables
    - use "const" rather than "CONST" when not required from Tcl interface

M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/binder.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/event.c
M	nsd/httptime.c
M	nsd/info.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/queue.c
M	nsd/return.c
M	nsd/sls.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclcmds.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclset.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/urlencode.c
M	nsd/uuencode.c
M	nsdb/dbtcl.c
M	nslog/nslog.c

commit a75ee103ecaecccb0ad2b5d34845afb95e2edd15
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - define variables as const

M	nsd/tclimg.c

commit 8cb91bd414b47486dd48ce59d6f71e4a05a36805
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - initializae value, fix order

M	nsd/tclimg.c

commit 7621881336aedab6d8f68bc8242fb65c7f7b570e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - use unsigned types for flags

M	nsd/conn.c
M	nsd/dstring.c
M	nsd/nsd.h
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclsock.c

commit 3b50c46ab748cab86e70bd5a143c26493f581428
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - use unsigned type fir flags

M	include/ns.h
M	nsd/tclrequest.c

commit f5c097bb48b3f21faa4391ed20e7b55fdb0adf04
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - add nonnull assertions
    - use unsigned type for flags

M	nsd/adprequest.c

commit fbca87dc26b5685706bb15008b3cb4b6d93f4fcb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - GetLastError() returns a DWORD, not int

M	include/ns.h
M	nsd/nswin32.c

commit 57c0d51c25f3f4dac93ab8191f48512cf44304f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - reduce number of unsigned -> signed conversions

M	nsd/nswin32.c
M	nsd/tclimg.c

commit 6b0d593698c13f759c4497de3ee7afeef279e8ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - use dup() instead of ns_sockdup() on non-socket file descriptors

M	include/nsthread.h
M	nsd/driver.c
M	nsd/nsd.h

commit 3fb27c8d6d2b7adc165c653614e2ec7b044c997d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-10

    - use unsigned type for bit operations

M	nsd/task.c

commit 4e4cdab57749ff6b3a5d8f818faaf1b364200189
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-09

    - rename variables to camel-case

M	nsd/connio.c

commit e45ebd2fba65dc067f3e9585487555f77c52cc4e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-09

    - make flags unsigned

M	nsd/nsd.h

commit 5a7df9efe1b6fd920ea60a1b5d745c8338bbd7f2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-09

    - windows returns sometimes an INVALID socket but keeps errno 0. Don't complain in such cases in the error.log

M	nsd/sock.c

commit c9e9af5850c9c6490914b0ff4380b8973a92b538
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-09

    - adding nonnull assertions

M	include/nsthread.h
M	nsd/unix.c
M	nsthread/signal.c

commit 31c2caf4cbb200baceaba6c6747d04db63c04002
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-09

    - reduced potential signed/unsignedess problems in arithmetic
      operations and comparisons
    - adding nonnull assertions
    - improve variable namings

M	include/ns.h
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/range.c
M	nsd/request.c
M	nsd/sockfile.c
M	nsd/tclhttp.c
M	nsd/tclresp.c
M	nsd/tclvar.c
M	nsd/urlspace.c
M	nssock/nssock.c
M	nsthread/mutex.c

commit 00393fc8bd3575ab8bdf19a06255f14004885c43
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-08

    Switch to using Ns_GetTimeFromTcl() for the _MSC_VER case too.

M	nsthread/time.c

commit 09c2c01805a098cb2d9cc94f8f8b2b92185438df
Merge: b25125a2 89ea3849
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-08

    Merged in all upstream changes.  Resolved conflict in nsthread/time.c
    largely by adopting my newer code, but included the cast to long.

commit b25125a26a1e560aa9195d13bcdc3130b741c89f
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-08

    Backout b1180ffe3f1d, make Ns_Time.sec a long again.

M	include/nsthread.h
M	nsd/sched.c
M	nsd/tcltime.c
M	nsthread/time.c

commit 86b025208747eac9e5aca447c4f6af152a59c8eb
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-08

    Make it easier to toggle mutex timings on/off.

M	nsthread/mutex.c

commit 712730f0bd3ef86e5ceb0dfde3bd0e6a49ef5edb
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-08

    Backout eb2066caeb8a, turn Windows mutex timings OFF again.

M	nsthread/mutex.c

commit 89ea38495d1064fae3ab6fa23efe8b7c0c474557
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-08

    - add function prototypes
    - add nonnull assertions

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/tclcache.c
M	nsd/tclmisc.c

commit bb821eb0237dac2fc9207f2d1e78a68300b34586
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-08

    Move code into Ns_GetTimeFromWindowsFileTime() and Ns_GetTimeFromGetTimeOfDay(),
    making Ns_GetTime() much simpler.

M	nsthread/time.c

commit da60da131fdaa144e12835b4061fed9f8754f3ef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-08

    - fix argument passing in case sizes of time_t and long differ (fix for bug n windows reported by andrew)

M	nsd/log.c
M	nslog/nslog.c

commit b515b8bfa6b60b53de73418696e4ed67863c3a26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-08

    - improve shift operation in case offset is a 32bit quantity

M	nsd/sockfile.c

commit 098afc3ce53759d046a8c5a836d3e2bdabe817b2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-08

    - provide error messages in case gmtime_s or ctime_s fails

M	nsthread/reentrant.c

commit 6ed6eb44087b77a3c1c779bd00aa70a36d354ec7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-08

    - deactivate msvc platform version by default

M	nsthread/time.c

commit fe6bc8e753496b6b4a98ca22442a518b1d73b2e2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-08

    - add missing definition, sort order of definitions

M	include/ns.h

commit fc805f364c022f0dbbe864a1c548af6af7a00130
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-08

    - fix function definition

M	nsd/sockfile.c

commit 1d002faa0c5368122108fabdba04cf230f252606
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-08

    - add nonnull assertions

M	nsd/tclresp.c

commit 01c70176d0904bf76398cc822e3898e5a284a58e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-08

    - address potential problem in windows code

M	nsd/sockfile.c

commit 7271a5dbbd84f43fd76eb9225cf53675aeea39e4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-08

    - fix syntax

M	nsthread/reentrant.c

commit 5a547e82e4cfa916159e0789aa2b4ccc5f25bd73
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-08

    - fix function names in comment

M	nsd/tclenv.c

commit 876b4c384285a9c02b00c2fd8e00896fabcdc7c2
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-08

    Remove ATP_LLD_MSC_HACK_YES for ns_localtime(), we now have a better fix.

M	nsthread/reentrant.c

commit 0a65d2f0e31184080740150d1813c7e742603a8a
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-08

    Turn mutex timings back on for Windows, they were not the problem.

M	nsthread/mutex.c

commit 74928ad6d9380b918aaf42a460990e8c1d2a3018
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-08

    Change Ns_Time.sec from long to time_t, fixing big problems on Windows!

M	include/nsthread.h
M	nsd/sched.c
M	nsd/tcltime.c
M	nsthread/time.c

commit b8a0474eebefe2e685f27f97d6fbe7eaf32a78bf
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-07

    Add ATP_LLD_MSC_HACK_YES version of ns_localtime() which does NOT trigger EINVAL from localtime_s().

M	nsthread/reentrant.c

commit ffeeb8703dc90e70963875c5824898d0f5a19e20
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-07

    Move code into Ns_GetTimeFromTcl().

M	include/nsthread.h
M	nsthread/time.c

commit 7d59cc97b988b5b1ce979e1de2acdcb93dabfc74
Merge: c5b63219 bab456d4
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-07

    Merge in all upstream changes, including Gustaf removing my rpath hack.

commit c5b632194c7566d77df119147ecc9bd6c11df125
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-07

    Clarify necessary LIB and INCLUDE settings and where they come from.

M	Makefile.win32

commit 087cba8667f8fe158e6831a86546ebc13c417c21
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-07

    Increase warning level to /W3.  Add /EHsc flag (C does not throw C++ exceptions).

M	include/Makefile.win32

commit bab456d447ccf1b063108df331a4f3dd4eea7b38
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-07

    - provide casts for thread exit code handling

M	nsthread/winthread.c

commit eb2a023872d1e34cbf1358abab5f2ecc1bfc87d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-07

    - move block of underscore definition into native windows block

M	include/nsthread.h

commit f5fb73be63ed54f1551e9cb7b4cdd99fb069dca4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-07

    - correct "#elseif"

M	nsthread/time.c

commit d3abfb7c4212f3636ac214943ffe8aa546ce95d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-07

    - provide better distinction between MSVC build and cygwin/mingw builds. _WIN32 is set for both. Native windows build should check for _MSC_VER.

M	include/nsthread.h
M	nsthread/mutex.c
M	nsthread/reentrant.c
M	nsthread/time.c

commit 9123463b9d90ca780a3fb78a233f6a11285fb5a8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-07

    - fix types, when zlib is not defined

M	nsd/compress.c

commit f0184674d2009b5b5261cf146ce35adcb9a45631
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-07

    - remove rpath struggles, which have sneaked in

M	include/Makefile.global.in

commit ec74e912210abaf7ff13711249220f27124058fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-06

    - deactivate mutex timings for the time being under windows

M	nsthread/mutex.c

commit 5ba9e8c0632e335366cafa19513511d3c387e8be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-06

    - remove unneeded code

M	nsd/nsd.h
M	nsd/nswin32.c

commit d32ddc811013c13ccd922b83d03dc815f4d08e7a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-06

    - use "ns" as default root directory name like on other platforms

M	include/Makefile.win32

commit c7631a8b50fef668fd2caa33737ad2237167b5c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-06

    - remove deactivated debug statements
    - keep code more local

M	nssock/nssock.c

commit 5f2817d14c5d6ebb66919f8a8f39df7c3548101c
Merge: 5c3b0cad cf07ed99
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-06

    Merged in apiskors/naviserver/clean (pull request #3)

commit 5c3b0cad4debcab60edf3e948d5dc3cf7a67597e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-06

    - add a fallback for NS_POLL_NFDS_TYPE (use this not only in the windows case)

M	include/nsthread.h

commit 5b72196da740eb8827c514f90ed4a011dc92e72a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-06

    - when os system functions fail, use NsThreadFatal() like in other files in the nsthread directory

M	nsthread/reentrant.c

commit 9d09242ddf3eb71f83b9628ec67c4f0d3c59bfd5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-10-05

    - include ns.h as last include file

M	nsthread/reentrant.c

commit cf07ed99043ea9fc7843b2a5e60c7a93a3155c32
Merge: 518c5733 36a07e81
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-04

    Merge in Ns_GetTime() fix from clean.  Keep rpath hack.

commit 36a07e8171d999b72557abd580e3f4816b6a32a9
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-04

    In Ns_GetTime(), add back Windows implementation removed by Zoran on
    2007-09-29 in changeset 2009:4bf1ee6ebf84.
    
    --HG--
    branch : clean

M	nsthread/time.c

commit dbad13c1897b7b6fc6bb8ee56afd78207fe63ee3
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-03

    Oops, revert accidental commit that turned on Makefile.win32 by default.
    
    --HG--
    branch : clean

M	include/Makefile.build

commit 71498ae796cb7c7e5b7846196a2c800fe75a3f0e
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-03

    Back out rpath hack.
    
    --HG--
    branch : clean

M	include/Makefile.global.in

commit 28ea609c3a166f1b964a37e721ba39b413f8628e
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-03

    New branch, clean sources suitable for pushing upstream.
    
    --HG--
    branch : clean

M	include/Makefile.build

commit 518c5733d7468122a09f4f3b7188a8f1cbf6df6a
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-02

    Remove the "/EXPORT:Ns_ModuleInit" link flag, it is unnecessary and
    causes LNK4197 "export specified multiple times" warnings.

M	include/Makefile.win32

commit 8cffd24c239747a0f423ede4c2421a341b9d4d82
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-02

    On Windows strip the .so from module names so the file will be named
    e.g., "nscgi.dll" not "nscgi.so.dll".

M	include/Makefile.win32

commit 4c08705cdbe56c34ac693ca3106656c56c087b9b
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-01

    The recently added Ns_Log() in the Windows version of ns_asctime()
    causes an unresolved external link error, so comment it out.

M	nsthread/reentrant.c

commit f0c08fb2cd185d8da66c39c89de64e62825d3e2e
Merge: eb7ff9fe ba3a8030
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-10-01

    Merge in all upstream changes through 2014-09-29.  This completely
    replaces my local (in fork) changes to nsd/driver.c and nsd/queue.c.

commit ba3a80308c6e6e58aafb4ae711b2e31a9e6a08b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - signedness cleanup

M	include/ns.h
M	nsd/tclmisc.c

commit ba662233fb4dae1d263bd35117e08ae931f9db72
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - simplify code

M	nsd/tcljob.c

commit bb810064dd4b017181d7be67e5d6fee05aa397c6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - make usage of buffer clear

M	nsd/queue.c

commit b3e2f5e6d5b0be3b5282c42c18a4cf3cf30d24fd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - initialize buffer

M	nsd/driver.c

commit 10628fd3f4340f183540e133f0a1629fe76f847c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - ioctlsocket has a long argument

M	nsd/nswin32.c

commit abffc49b96b8cd0954ecb6626e7383e89fd24597
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - don't call function repeatedly as argument of a macro

M	nsd/tclenv.c

commit b1d6e4a516c8a75423108832dbf433aeaa6d1f24
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - improve safety of macros

M	include/ns.h
M	nsd/index.c
M	nsd/queue.c
M	nsd/tclmisc.c
M	nsd/tclxkeylist.c

commit ee88707a3ff58d7238b593942ded087a6c5d57d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - sort out some more potential signed/unsigned conflicts

M	nsd/log.c
M	nsd/tclcache.c

commit 47d97d5ffbdb21724a057aa5de8a7b648ae9a9e4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - remove further potential signedness conflicts

M	include/ns.h
M	nsd/connio.c

commit fe2048432c8169f4006b1ba47aa2fcbeeaeb840f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - move typedefs for *Cmd() to nsd.h to guaratee type checking argument lists.
    - fix bug: TclX_KeylgetObjCmd where classified as Tcl_CmdProc instead of Tcl_ObjCmdProc

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclxkeylist.c

commit 542340d5536f9660e41cea6155a932407f28a081
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - sort out more potential signed/unsigned conflicts

M	include/nsthread.h
M	nsd/driver.c

commit 4107cdaa23961b2e0c9fdf35a5a780cc403322b6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - added a new macros PTR2NSSOCK and NSSOCK2PTR in analogy to PTR2INT
      and INT2PTR to mask more win incompatibilities
    - use PTR2INT and INT2PTR on more occasions
    - change more dataytypes with bitwise operations to unsigned

M	include/ns.h
M	include/nsthread.h
M	nscp/nscp.c
M	nsd/binder.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/event.c
M	nsd/filter.c
M	nsd/listen.c
M	nsd/nsd.h
M	nsd/pathname.c
M	nsd/proc.c
M	nsd/returnresp.c
M	nsd/sched.c
M	nsd/sls.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclobjv.c
M	nsd/tclsock.c

commit 9368b80aa618e2f5745d3677aaa88264cc1d955b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - adding nonnull assertions

M	include/ns.h
M	nsd/dns.c
M	nsd/driver.c
M	nsd/urlencode.c

commit b527231dea2653e4c6ed1d4b515e4f0bcbaed2e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-29

    - remove unused functions, duplicating other behavior, without prototypes and entries in ns*.h

M	nsd/fd.c

commit 1ff48ac105c10fc9af51d4cf1235d2e50c57e8c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-28

    - add more function name mappings for windows
    - remove signed/unsigned comparison

M	include/nsthread.h
M	nsd/adpcmds.c
M	nsd/tclfile.c

commit 175ed5dfdeb4dfff3349113d53baf2c3feafaa33
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-28

    - define ns_mkstemp() as a first approximation for a replacement of mkstemp() under windows

M	include/ns.h
M	include/nsthread.h
M	nsd/nswin32.c
M	nsd/tclhttp.c

commit 86933d150ef4caf88d6888d8cece7b48804983e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-28

    - use unsigned constants and types for bitwise operations

M	include/ns.h
M	nsd/driver.c
M	nsd/nswin32.c
M	nsd/sock.c
M	nsd/task.c
M	nsd/tclmisc.c

commit 076a492cdc995879fe91eb98aafee9efb33329d6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-28

    - use ns_sock_set_blocking instead of other implementations

M	nsd/sock.c

commit 9758985674b55ac49776d1732abd3854124bc49f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-28

    - add nonnull assertion

M	nsd/connio.c

commit 1fa12d053098b5fdf4f33d0ba630bef443a12050
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-28

    - add nonnull assertions and CONST to const buffers

M	include/ns.h
M	nsd/compress.c
M	nsd/proc.c
M	nsd/tclhttp.c

commit 24100683051ce50964c869b14f5053549368c032
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-27

    - setting WINVERSION to Vista to allow usage of InetNtop()
    - make code more robust against previous defines
    - use the right pid_t type for win
    - add shutdown flags
    - use *_s function in win-specific reentrant code

M	include/nsthread.h
M	nsd/exec.c
M	nsthread/reentrant.c

commit 270b7bfd167687b3799ef96baf1ec80705836941
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-27

    - respect USE_FIONBIO if in use

M	nsd/unix.c

commit ad6f31dd075838c0dae4b1079b3113a7a21315bc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-27

    - introduce new functions ns_sock_set_blocking() to better separate platform concerns

M	include/ns.h
M	nsd/driver.c
M	nsd/nswin32.c
M	nsd/unix.c

commit f0ea83b5922a281adb8a089875eec9df6e05154e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-27

    - use non-NULL sentinel arguments

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/log.c
M	nsd/pathname.c
M	nsd/pidfile.c
M	nsd/server.c
M	nsd/tclcallbacks.c
M	nsd/tclinit.c
M	nsd/tclrequest.c
M	nsd/tclsched.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nssock/nssock.c

commit b9849f357a95a332174c149c30b5ee4db9e438fd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-27

    - adding nonnull assertions

M	nsd/nsd.h
M	nsd/server.c
M	nsd/tclinit.c

commit c01be0ee1dde945e8271acb86141cda552f66737
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-27

    - add nonnull assertions

M	include/ns.h
M	nsd/request.c
M	nsd/tclcmds.c

commit 010b7a6778f62e58a440da54252da9dab8e08c43
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-27

    - sort declarations

M	nsd/tclcmds.c

commit 447ad4f117242d85ba29ebd2802540e7d93f6a22
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-27

    - remove redundant definition

M	nsd/tclcmds.c

commit 176ffa01ebc2c8ea76a11bab40057d9ff3e172ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-27

    - add nonnull assertions

M	nsd/driver.c

commit b1eb6b847a2a0583f750a7eab6c02e81ddf0bd1b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-27

    - add nonnull assertions

M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c

commit 531ba42ed713163672b982e26d4697d9dc73c4a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-27

    - add nonnull assertions

M	include/nscheck.h
M	nsd/tcljob.c

commit 33dcdf93a434610467cfd3643a7bc29e71a77d0c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-26

    - move variable declaration to the begin of the block

M	nsd/queue.c

commit c4e73e1afc055e4d73b3872500dd72d444e60967
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-26

    - return as well pid_t from Ns_InfoPid

M	include/ns.h
M	nsd/info.c

commit b0ac13c6da3e16fcc67af68bd131947ba1c70ea5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-26

    - use angle brackets for include file

M	include/nsthread.h

commit c7ce59a5b8caa653ca05f7d1804225811a2af024
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-26

    - remove unsigned suffix for making windows happy again

M	include/nsthread.h

commit f6866e6cddb5a10613ee480cb9f85453c59c7328
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-26

    - adding nonnull constraints

M	include/ns.h
M	nsd/connio.c
M	nsd/set.c
M	nsd/tclset.c

commit 4a7e4e62feac344c79f249a2e9127080849b5dd9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-26

    - remove unneeded structure

M	nsthread/reentrant.c

commit eb7ff9feaef1770690e8ac4a2a015322712cfe45
Merge: 81539f41 e9577168
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    Merged in latest naviserver/naviserver head (default branck) changes from Gustaf.

commit 81539f41ba61cb17d1071bf26489f6d8d512deeb
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    Set DLL from MOD when that makes sense.

M	include/Makefile.win32

commit 9e39d7afbd57b9418b936155506441799c563f84
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    Move DWORD n1 declaration to where the Microsoft compiler allows it.

M	nssock/nssock.c

commit d09cc7a2f3bb31a9f382420b16a9d8ff16540415
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    Add fake mkstemp() stub so I can continue Windows build debugging.

M	nsd/nswin32.c

commit 0fa4303dcd46f314c9297d855c281c02814f0210
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    Oops, left in bogus temporary comment when committing the LIBOBJS fix.

M	nsd/Makefile

commit 7021f49566a6f399901e8c5c917cc593c58090fc
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    Hack in rpath support.

M	include/Makefile.global.in

commit 986d0eac0612b8263bc19d2a46432d1c483e34bc
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    Set LIBOBJS directly to fix 'cycle in macro definition' error for OBJS
    on Windows.

M	include/Makefile.win32
M	nsd/Makefile

commit 2de36927f6dc45dffb77a368e96c6088595676eb
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    Rename makefile LIB variable to LIBNM.  This fixes conflicts with the
    Windows linker LIB environment variable.

M	include/Makefile.global.in
M	include/Makefile.module.in
M	nsd/Makefile
M	nsdb/Makefile
M	nsproxy/Makefile
M	nsthread/Makefile

commit 57b3c42202a6914ecc8167e37a862b9ee26ef772
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    The nsd does not export Ns_ModuleInit either.

M	include/Makefile.win32

commit fca2c8455be8fb597b51278330e89c8f42b69bd1
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    Default DEBUG to 1.

M	Makefile.win32

commit e3645c53b5b503943669c14ae02ba9d4e684578a
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    Use nmake macro string substitution to reduce boilerplate and let us
    build individual modules at a time.

M	Makefile.win32

commit 265eef1837759d8b56baa5ed4325d1623b0a8c99
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-25

    Show where we do the manual switch between Makefile.module and Makefile.win32.

M	include/Makefile.build

commit e9577168e9a8bccd6cfe1a1f53a32f91256aaa97
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-25

    - remove usage of anonymous union
    - reducing the conversion between function pointer and non-function-pointer

M	include/ns.h
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/driver.c
M	nsd/filter.c
M	nsd/info.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/proc.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/tclcallbacks.c
M	nsd/tclinit.c
M	nsd/tclrequest.c
M	nsd/url2file.c
M	nsdb/nsdb.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c
M	nsthread/thread.c

commit 32873b27c531dccca74669414f0da35bb29c2e1a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-25

    - added nonnull assertions

M	include/ns.h
M	nsd/adprequest.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/listen.c
M	nsd/nsd.h
M	nsd/progress.c
M	nsd/queue.c
M	nsd/returnresp.c
M	nsd/sched.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nsd/tclfile.c

commit 7445e93cf105301601d5cf6f5b14defc063bf12b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-25

    - remove unneeded casts

M	nsdb/dbinit.c
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c

commit a0b486855aaa38ecb47f7ab7cf8bb7a53d8b8094
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-25

    - reduce variable scope

M	nsd/tclmisc.c

commit 590fffc8a5992ad9b6806838c9ab312b4ad86d8d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-25

    - handle potential loss of sign in multipurpose adpCtlOpts.flag ny avoiding negative values

M	nsd/adpcmds.c
M	nsd/nsd.h

commit fab8ebf836bc577abc6de58a2571b53c39aeaefe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-25

    - adding nonnull assertions

M	include/nsthread.h
M	nsd/tclhttp.c

commit 3e85c5671ba18fb25817bd7f3551bbecf2bcac95
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - use unsigned value to ioctl

M	nsd/sock.c

commit 65f9fbb439e22757faefef78ebcd95e52a1e0910
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - remove unneeded variables

M	nsd/urlspace.c

commit ed84df37395240b8f84c8e0e98a62f4d541e2087
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - use constantly PTR2INT and INT2PTR macros to convert integers from and to pointers

M	nsd/log.c

commit cd7ff3e6fb318e2e2e83b601084f79050cb03c01
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - remove superfluous "adp" argument (most probably cruft from the past)

M	nsd/tclrequest.c

commit 0f2e7e64e02313232e68b11594e3ab437566515f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - don't define unused symbols under windows

M	nsd/binder.c

commit 162f71384a6212be038228efeac0831324e66e9a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - add include for search for nfds_t
    - changed one more occurrence to NS_POLL_NFDS_TYPE

M	configure.ac
M	nsd/unix.c

commit f52dffbcf638722b906d5298ec34807d39eb681e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - use nfds_t when available (re-run of autogen.sh is necessary)

M	configure.ac
M	include/ns.h
M	include/nsconfig.h.in
M	include/nsthread.h
M	nsd/driver.c
M	nsd/nswin32.c
M	nsd/unix.c

commit 545643958b2726b6522d5302bbcd431110b30ddb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - brace body of if-expressions

M	nsd/crypt.c
M	nsd/form.c
M	nsd/queue.c
M	nsd/set.c

commit 4ee5466302bbf5b49be09de25208cde70bc1cea9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - brace body of non-trivial if-expressions
    - whitespace changes

M	nsd/tclxkeylist.c

commit c30b43dd674bfb44862c983832dc4a0b287e141c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - make hex constants (mostly for flags) unsigned

M	include/ns.h
M	include/nsthread.h
M	nsd/adpparse.c
M	nsd/compress.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/task.c
M	nsd/tclmisc.c

commit 4c7f043cf81184d0cf95da702b6226e92fb31013
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - fix variable names (serv, servPtr for flags is strange)
    - use unsigned for flags

M	nsd/adpparse.c

commit fc9f4a17008b723f0676c6954d7f9023929a4d4c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - fix indentation
    - remove extraneous commas

M	nsd/adpcmds.c
M	nsd/adpparse.c
M	nsd/exec.c
M	nsd/info.c
M	nsd/queue.c

commit 6b5df0a72c04e12709fd08cfcf5ed0df5bf0679b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    - use unsigned type for flags

M	nsd/adpcmds.c

commit 860c28f264b41bc90e7905fe11120e50f9054a70
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-24

    windows:
    - replace call to deprecated function asctime() by a call to asctime_s()

M	nsthread/reentrant.c

commit aca2f0c86c60f24d7fde18fa12feebc861dca5de
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-23

    Fix bogus inline declaration of wrPtr.

M	nsd/queue.c

commit afaab1c9016f4cd6af0aed3999c435b722448752
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-23

    Define SHUT_WR on Windows.

M	nsd/nsd.h

commit bd65911406fa26f60f57d304e38646cb9921d241
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-23

    Add links to examples of ioctlsocket() vs. fcntl().

M	nsd/driver.c

commit dd7d21482da7010c7ff13217bb17d02d17e51e7b
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-23

    On Windows use ioctlsocket() and FIONBIO rather than fcntl() and O_NONBLOCK.

M	nsd/driver.c

commit 16315cdde1b4e3c94a44b5ae6e7961519a0857d9
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-23

    Use the DTPLITE environment variable if one is set.

M	Makefile

commit e1b4ef0e6935ac1b434586b660c09dbbfacb2021
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-23

    Add Emacs modeline to makefiles that need it.

M	Makefile.win32
M	include/Makefile.build
M	include/Makefile.global.in
M	include/Makefile.module.in
M	include/Makefile.win32

commit 05c69a0673c6fc35e6cfa1518ae01134e4ee5a30
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-23

    Always set NSTHREAD_EXPORTS, not just for the __GNUC__ and __MINGW32__ cases.

M	include/nsthread.h

commit 938d137d2a9486e646e50b9698f487384225b56d
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-23

    Various misc. Windows build fixes:  Append to rather than overwrite LIB
    and INCLUDE environment variables.  Ns_ModuleInit check for nsthread.
    Remove NOWIN98 option, it no longer exists and breaks the build.
    Backslashes.

M	Makefile.win32
M	include/Makefile.win32

commit e6b5553274eaa023a10843139381f9eb583fa85e
Author: Andrew Piskorski <atp@piskorski.com>
Date:   2014-09-23

    Add Windows-specific makefiles, exactly as received from Ibrahim
    Tannir <itannir@archiware.com> on 2014-08-26.

A	Makefile.win32
A	include/Makefile.win32

commit 28c6a95b926a4ee30291aab8552f9f1d98a6d2be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-23

    - reduce variable scopes
    - use nunnull constraints

M	Makefile
M	nsd/tclcallbacks.c
M	nsdb/dbinit.c

commit c5539b5dfbc129172ad2d7bd8180513f268fb351
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-23

    - using CONST for channel IDs, reduce casts
    - ease life of static checkers by providing more asserts()
    - reduce variable scopes

M	include/ns.h
M	include/nscheck.h
M	nsd/config.c
M	nsd/driver.c
M	nsd/sockcallback.c
M	nsd/tclcache.c
M	nsd/tclfile.c
M	nsd/tclmisc.c
M	nsd/tclsock.c

commit d169c5e2d5ce0ec94d169f4bc62d06db6dfed7ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-23

    - make clear that buffer is initialized

M	nsd/connio.c

commit 8c8050a45d5c2da03b3bfc6f599bbea53abeb102
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-23

    - make flags everywhere "unsigned int"

M	include/ns.h
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/config.c
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/sched.c
M	nsd/sock.c
M	nsd/sockfile.c
M	nsd/tclset.c
M	nsd/url2file.c
M	nsd/urlspace.c
M	nssock/nssock.c

commit 91987e84d35fc104a4ab0e2af66650bfd6c354dd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-23

    - add nunnull declarations and assertions

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c

commit f2ed510b362b5ed1782dd3e42c0d7f6f14d1bfbf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-23

    - remove unreachable code

M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcltime.c
M	nsdb/dbdrv.c
M	nsdb/dbtcl.c

commit b555a924430941305a331bfd18f82d4d8bbcd7a2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-23

    - remove constant boolean expression
    - remove two more cases, where invalid sockets are assumed to be -1

M	include/ns.h
M	nsd/nswin32.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsd/urlspace.c

commit 6ae4f229bfcfaa306186b0c8f1dd30af2b4c01f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-22

    - use just constants for aggregate initializers

M	nsd/tclcache.c

commit 89420669da3bac1234f5953aef9e04f79920d930
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-22

    - use STREQ() macro more frequently

M	nscp/nscp.c
M	nsd/binder.c
M	nsd/mimetypes.c
M	nsdb/dbtcl.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c

commit c102ab20d319d524b8c4d794e58d23bdfcd88bf0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-22

    - use UNUSED macro, which has chances to work on window as well

M	include/nscheck.h
M	nsd/driver.c
M	nsd/exec.c

commit 4288b75b0e8bf806eba50267463b61f5f7907020
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-22

    - add explicit initializer for static variables

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/callbacks.c
M	nsd/fd.c
M	nsd/limits.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/queue.c
M	nsd/sched.c
M	nsd/tclmisc.c
M	nsd/unix.c
M	nsdb/nsdb.c
M	nsthread/nsthreadtest.c

commit 97fc2c03d73c6864f86a6c0b7a4ca55a17550132
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-22

    - add same visiual separator for end of win + unix blocks

M	include/nsthread.h

commit 689e35fb9e208f1ac2a9a301b69731786e615be1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-21

    - remove unneeded address operators

M	nsd/tclobjv.c
M	nsd/tclrequest.c

commit 64db9d55b195b33672cc45e363dd983a39f18dbc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-21

    - undo earlier change

M	nsd/modload.c

commit e7d4aaef3e90cd20b2dd63d1768d0ea3172cd336
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-21

    - remove unneeded casts

M	nscp/nscp.c
M	nsd/modload.c
M	nsd/url2file.c
M	nslog/nslog.c

commit c9abcae9ee967da8fc8cf8b5809d6b96a97a8c3f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-21

    - make is easier to visually separate windows and unix block

M	include/nsthread.h

commit ecdd1bff177fa959af412408a1082822fc3352d3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-21

    - add comments

M	win/cgitest/main.c
M	win32/cgitest/main.c

commit fc01a3eb94a0e0a94286f570b5acd51353ce486b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-21

    - standardize type definitions of objv to the variant recommended on the Tcl man pages (e.g. http://www.tcl.tk/man/tcl8.5/TclLib/CrtObjCmd.htm)

M	nsd/adpcmds.c
M	nsd/adpparse.c
M	nsd/conn.c
M	nsd/tclmisc.c
M	nsd/tclresp.c

commit abd204878a3a10a31a49634ede9ce990940c4f97
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-21

    - standardize type definitions of argv in Tcl_CmdProc to the variant recommended on the Tcl man pages (e.g. http://www.tcl.tk/man/tcl8.5/TclLib/CrtCommand.htm)

M	include/ns.h
M	nsd/adpeval.c
M	nsd/info.c
M	nsd/quotehtml.c
M	nsd/request.c
M	nsd/tclfile.c
M	nsd/tclmisc.c
M	nsd/tclset.c

commit a76d6388c337c34288f498feecff9c1227fd8e15
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-20

    - address potential signedness issues

M	nsd/adpeval.c
M	nsd/driver.c
M	nsd/urlspace.c

commit 65cf92b13e73179915102875e49add92cec30a83
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-20

    - fix indentation

M	nsd/urlencode.c

commit 65b8a0826fa0887a2eda1e235dff4a2738329f6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-20

    - use just constants for aggregate initializers

M	nsd/tclcache.c

commit f4061688ca16f748d1434452244f7b36508b82ec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-20

    - remove unneeded casts

M	nsd/op.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/tclinit.c
M	nsd/tclobj.c
M	nsdb/nsdb.c

commit c18dc52d137eca818d527dcec3bea512c07d952d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-20

    - standardize type definitions of objv to the variant recommended on the Tcl man pages (e.g. http://www.tcl.tk/man/tcl8.5/TclLib/CrtObjCmd.htm)

M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/conn.c
M	nsd/form.c
M	nsd/info.c
M	nsd/limits.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/queue.c
M	nsd/sls.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclset.c
M	nsd/tcltime.c
M	nsd/tclvar.c

commit ef4de3fa2e83133b51c916141b01c2137a5a2b9b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - one place more, where  NS_SOCKET should be used for sockets

M	nsd/binder.c

commit 0837a66cd60521a6c951eeed637d125ac344531b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - handle potential null-pointer dereferencing

M	nsd/tclobjv.c

commit 576eee339a01eb5cf7ad9880454f0c6065eaad7f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - trying to silence static checker

M	nscp/nscp.c

commit aefca9840680bd2177353b235c175bf616df95a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - handle potential signedness conflicts

M	include/ns.h
M	nsd/connio.c
M	nsd/encoding.c

commit 17d9f87b819e8535dd440e21cf12fb48083d20c7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - don't use negative numbers for size_t

M	nsd/log.c

commit 8cba77b04f50a2ee8444268ae4949523e61ef1ae
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - use INVALID_SOCKET instead of -1 for datatype NS_SOCKET

M	nsd/driver.c

commit 6e487c57c6d823d64225ca79afa2063d4ef1ec3a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - fix indentation and array boundary

M	nsd/tclmisc.c
M	nsd/urlencode.c
M	nsd/urlspace.c

commit 0127fb66711ca0aa445f8e49b16c5c82196925e5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - use just constants for aggregate initializers

M	nsd/sock.c
M	nsd/tclcache.c

commit 46a28002cef85fa40f08a9bfa50b0468b3c84558
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - adding CONST for use with string constants

M	nsd/tclcmds.c

commit 0a768122562a7c9539d8a8ab7b4659f1e459efaa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - remove unneeded casts

M	nsd/callbacks.c
M	nsd/filter.c
M	nsd/proc.c
M	nsd/tclcallbacks.c
M	nsd/tclrequest.c
M	nsd/tcltime.c

commit 0ae8c01c8a65c56fc12e1b3e088a6df66b97a8eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - use constantly INVALID_SOCKET instead of hardcoded -1 to improve portability

M	nsd/binder.c
M	nsd/conn.c
M	nsd/nswin32.c
M	nsd/sock.c
M	nssock/nssock.c

commit f25a983ed3401de4cbfe24252685db1619074943
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - reduce variable scopes

M	nsd/nswin32.c

commit d76e0f30ffe89d86b9134d610abb9af253122dee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - introduce NS_INVALID_PID to handle invalid pids on windows (-1 is not allowed there)

M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/exec.c
M	nsd/watchdog.c
M	nsproxy/nsproxylib.c

commit dce1174d57b4564f1ab948b203623da7d0644e91
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - remove unneeded assignment for windows

M	nsd/driver.c

commit db29828e6f61b35de22e6b06c819f773d2fbdcaa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - simplify lvalue expression

M	nscp/nscp.c

commit 2c0274136da245e67e6a6ea35baa7d67e3047ea0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - remove unneeded cast

M	nsd/tclxkeylist.c

commit 32e70fd4f33223fc9cf237d4c90c8d6ea7304402
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - use parenthesis in macro to improve safety

M	nsd/tclmisc.c

commit 8e86668480c552c066f20fea9873e43e60d804d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-19

    - replace array indexing by pointer arithmetic

M	nsdb/dbtcl.c

commit 6dec5d47f7f574b81061ebe7fe3ca21b0a06ddf3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-18

    - use pid_t for pids instead of int
    - add type pid_t for WIN builds

M	include/ns.h
M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/binder.c
M	nsd/exec.c
M	nsd/nsd.h
M	nsproxy/nsproxylib.c
M	nsthread/fork.c
M	nsthread/winthread.c

commit 76c5fa4056c7004398e98bc56ea03db111aa126f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-08

    - return gzipped size for content-encoding gzip

M	nsd/fastpath.c

commit 794054fab5d4e08ab3c810e092c4a4b194fd809d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-08

    - first fix for HEAD requests. we should add some regression tests and look closer to boundary cases

M	nsd/fastpath.c
M	nsd/return.c

commit f9b5987ae63314b1e779d2b8b36ea72274f39475
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-08

    - documentation update: add nsv* to commandlist

M	doc/src/naviserver/commandlist.man

commit 6a095d8a49a48a2ff868c699c9197a5e79dfb1d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-09-01

    - pass ZLIB_INCLUDES to CLFAGS of modules build, since the includes are required by ns.h

M	include/Makefile.global.in

commit a99c36dec251c9324296cae7cfa092e2ab532f75
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-08-30

    - set environment variables from config file

M	openacs-config.tcl

commit f249eb2e95079ed4b611040d6625cc7ac97e37a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-08-30

    - adjusted logging levels

M	nsd/tclhttp.c

commit c2cc620ccee72092550cbb7af4a610d274d294f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-08-06

    - openacs config file: increase default number of kept error logs

M	openacs-config.tcl

commit 04ae20019d7a848a40492cd40595b63defee44c9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-08-06

    - ns_http: when spoolsize is specified, but http server does not return content-size, use size of actual returned data to determine whether server should spool to file or not

M	nsd/tclhttp.c

commit d1710e00832be9955b7c928324e6db60fbf51915
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-07-23

    - update doc READM

M	doc/README

commit ef5f7ad68802a61cdf1fdbd3e714de0c19ac06e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-07-23

    - adding module description to get rid of empty string in first line of manual entries
    - minor updates

M	doc/src/manual/admin-db.man
M	doc/src/manual/admin-install.man
M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/admin-tuning.man
M	doc/src/manual/adp-overview.man
M	doc/src/manual/c-driverdb.man
M	doc/src/manual/c-urlspace.man
M	doc/src/manual/main-faq.man
M	doc/src/manual/main-features.man
M	doc/src/manual/main-history.man
M	doc/src/manual/main-standards.man
M	doc/src/manual/tcl-lib-file.man
M	doc/src/manual/tcl-lib-nstrace.man
M	doc/src/manual/tcl-libraries.man
M	doc/src/manual/tcl-overview.man
M	nscp/doc/mann/nscp.man

commit 8cb78d6fe3b911242792f7b64adbc2610ac975e6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-07-10

    - add test to show that byte range is ignored on adp requests

M	tests/http_byteranges.test

commit 4eb293beca4d2e507ef559a7af564a617afe59cf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-07-10

    - fix index in loop (many thanks to jeff rogers to point this out)

M	nsd/return.c

commit 9b6c75d338e48ae9382b2558218dbdad40f7b821
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-07-02

    - ns_setcookie, ns_getcookie: if ignore the domain, if provided empty. Otherwise IE ignores the directive completely.

M	doc/src/naviserver/ns_cookie.man
M	nsd/cookies.c
M	tests/cookies.test

commit 2fbd5a5d9996adb04d5efbe64b0d083b6895dc36
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-06-29

    - minor documentation updates

M	NEWS
M	README

commit 0fc8bdf84b9e65aa7519fbe530028a5c5f05a4c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-06-29

    Added tag naviserver-4.99.6 for changeset 5a843ad8cfc4

M	.hgtags

commit d48db43a7797b0d811c4464ab998dc8e26403b26
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-06-29

    - updated news file

M	NEWS

commit 18aed9909519b4d1a5ac33a1b46bd5bf7843aee2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-06-29

    - bump version number

M	configure.ac

commit 475225f1f6f64a7a961bc459e9aec0289b98bd8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-06-19

    - reduce variable scopes
    - add target "cppcheck" to Makefile

M	Makefile
M	nscgi/nscgi.c
M	nsd/connio.c
M	nsd/encoding.c
M	nsd/exec.c
M	nsd/form.c
M	nsd/log.c
M	nsd/returnresp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c

commit ed52f375d871db8814bacfe14ad18036218283fb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-06-18

    - further cleanup of ns_adp_parse
    - improved man page
    - added regression tests

M	doc/src/naviserver/ns_adp_parse.man
M	nsd/adpcmds.c
M	tests/adp.test

commit 93efa621204c841ac9ffaaf4197b67bb96c5c4a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-06-18

    - fix flag setting

M	nsd/adpcmds.c

commit a81f4210e320391c594500371ea7d3064cc0e25f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-06-18

    - resolve flag confusion between ADP_TCLFILE and ADP_ADPFILE

M	nsd/adpcmds.c

commit c422e903a2e7ab6d5621bad9408a207b85d94d66
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-06-18

    - improve documentation

M	doc/src/naviserver/ns_adp_parse.man

commit 1447076a802d45b85336ea49c76f9269a3be1e8b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-06-18

    - bump revision number

M	configure.ac

commit 86c414ff5b232ce1779964125b4d826e444e4d20
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-06-02

    - make sure to output error messages, when mkstemp() failed

M	nsd/driver.c
M	nsd/tclhttp.c

commit 35887a5fe7048988984aba748ea429290f7e2741
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-29

    - add a diffstat line

M	NEWS

commit 3375b14f0dfbfc9de980dd23c5fd68615a0ac2a2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-29

    - add first version of template for news entries

A	NEWS.template

commit 3517ad49cfee8c199ee4045916386c7b2e6157a4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-29

    - first draft of change summary

M	NEWS

commit effc47c287f51f19d09f182ec77aa0ba27d3e64e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-29

    - make sure to avoid inclusion of ._ files (on mac os x)

M	Makefile

commit 0616c1045a9a15f577c670ef42119dbbfe578651
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-29

    - use version number for pre-release

M	configure.ac

commit e207ec734592fdb1a6c1c86e04d753117bafc3f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-29

    - execute "ns_ictl addmodule" for every kind of module

M	nsd/init.tcl

commit 9f65fd9a519b98699c02d61a2b52141fe1f42196
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-29

    - get rid of warning in recent gcc

M	nsd/tclmisc.c

commit 72bbd28ddcbdffc3633bfe7ac45159f6ee436fe9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-29

    - improve wording

M	doc/src/naviserver/ns_return.man

commit 8d30a495b5d75058a7ffc6cec1f597e9d20562ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-29

    - avoid potential NULL derefernce and make assumptions explicit

M	nsd/adprequest.c

commit 7213caa93ccfae355e5e703a9e4e56abc7b326a1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-25

    - fix log statement

M	nsproxy/nsproxylib.c

commit 2a059057686fe18d60fff964fbdde229843aaec3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-25

    - use consistently pid_t instead of int

M	nsproxy/nsproxylib.c

commit c0dde9ded6fe8bc7b0a0049626265a29125ced59
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-25

    - provide compatibility with OpenSolaris (OmniOS, SunOS 5.11)

M	include/Makefile.global.in
M	include/nsthread.h
M	nsd/binder.c
M	nsd/compress.c
M	nsd/driver.c
M	nsd/tclfile.c
M	nsd/tclobj.c
M	nsd/tcltime.c
M	nsproxy/nsproxylib.c

commit b90127ffc3f21911360a57a88577fa4b2cbda94c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-02

    - Remove CVS variable $Header$

M	doc/src/man.css
M	include/Makefile.build
M	include/Makefile.module.in
M	include/ns.h
M	include/nsversion.h.in
M	license.terms
M	m4/cmmsg.m4
M	m4/dns.m4
M	nscgi/Makefile
M	nscp/Makefile
M	nsd/Makefile
M	nsdb/Makefile
M	nsdb/nsdb.h
M	nsdb/util.tcl
M	nsdbtest/Makefile
M	nslog/Makefile
M	nsperm/Makefile
M	nsperm/compat.tcl
M	nsperm/htaccess.tcl
M	nsperm/init.tcl
M	nsproxy/Makefile
M	nsproxy/nsproxy.h
M	nsproxy/test-nsproxy.sh
M	nssock/Makefile
M	nsthread/Makefile
M	nsthread/thread.h
M	tcl/config.tcl
M	tcl/limits.tcl

commit 119e8228ac3086114b73919562a2bfab228765c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-02

    - Make sure to initialize all members of Ns_DriverInitData to zero

M	nssock/nssock.c

commit 4c493b8593fa94e15a0cfd5381ecd628c68736a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-05-01

    - make test for bytearray safe for changes introduced in tcl 8.6 and
       backported to Tcl 8.5  (see e.g. http://core.tcl.tk/tcl/info/91be696bf3)

M	nsd/tclobj.c

commit d1681b78061f1418dea37682cafce2378d562864
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-30

    - use recommended autoconf constants quoting
    - deactivate AM_* macros (get rid of warnings), since these are not used by autogen.sh

M	configure.ac
M	include/nsconfig.h.in
M	m4/dns.m4
M	m4/gettid.m4
M	m4/zlib.m4

commit c8bc107af0afeb3da7cd2818e9c386949c81f72e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-12

    - add parameter "extraheaders" to drivers (e.g. nssock, nsssl). This
      feature allows an admin to specify extra reply headers sent back
      to on every request. By using this feature, one can activate
      for example HTTP Strict Transport Security for nsssl.

M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/return.c
M	nssock/doc/mann/nssock.man

commit 82dd0c2117108bf97a07b4ff5f19d8d5a5c9fb3e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-06

    - use recent version of install-sh from tclconfig repository

M	install-sh

commit 37fb9331336dca210aaf66f7df52538d4a010d20
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-06

    - update generated file

M	include/nsconfig.h.in

commit 00eca9d255225d6811e27178b7995c7ef81fa267
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-06

    - replace obsolete macro AC_TRY_RUN

M	m4/dns.m4

commit 8937a9f1942d20bfcf86a8aa6a7aff6e63833bcd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-06

    - replace obsolete macro AC_TRY_LINK

M	configure.ac

commit 57874acea35f6656c81c6889940ffa7547c0c051
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-06

    - update to recent version of tcl.m4

M	m4/tcl.m4

commit 7c9c88fc7668cd2794326c280e350a2ff284f15c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-06

    - minor cleanup: reduce variable scopes, remove obsolete tests, ease code reading

M	nsd/driver.c
M	nsd/form.c
M	nsproxy/nsproxylib.c

commit c7ea02eceb86aee8d689ea3e34fd967af77de6a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-04-02

    - change the setting in the sample config file "nsd-config.tcl" from "serverlog nsd.log" to "serverlog error.log" since novices seem to expect this.

M	nsd-config.tcl

commit d3a0deeb40a31830f04ed2d42332f16c7e9aabca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-03-26

    - defined new macro NS_GNUC_DEPRECATED_FOR() to be able to provide
       replacement hint
    - used NS_GNUC_DEPRECATED_FOR where appropriate
    - remove undefined and decprecared Ns_ConnInit() declaration
    - updated documentation of deprecated commands in the source

M	include/ns.h
M	include/nscheck.h
M	nsd/dstring.c
M	nsd/tclinit.c

commit 928f33bedd4b8d105ae3fb660e99ddc09b9d7add
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-03-26

    - fix typos

M	nsd/conn.c
M	nsd/tclobjv.c

commit 0a1bbb46277686df27148b9207fa44f6d07cba6c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-03-26

    - mark ns_tmpnam as deprecated since it uses a desprecated C-library function
       (use ns_mktemp instead)
    - allow "ns_mktemp" to be called without template (makes migration simpler)
    - update man page for ns_tmpnam
    - fixed man page for ns_getform
    - update .tcl-code to use ns_mktemp

M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/ns_getform.man
M	doc/src/naviserver/ns_mktemp.man
M	nsd/tclfile.c
M	tcl/form.tcl

commit ba50efaf6ac4ce83de42a34aded0968da8fe7f25
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-03-15

    - new static function GetOptIndex()  used in Ns_ParseObjv():
    
      Background: Tcl_GetIndexFromObj() validates internal reps
      based on the pointer of the base string table, which works
      only reliably with static string tables. Since NaviServer
      can't use static string tables, these are allocated on the
      stack. This can lead to mix-ups for shared objects with the
      consequence the resulting indices might be incorrect,
      leading to potential crashes. In order to allow caching, it
      should be possible to validate the entries based on other
      means, but this requires a different interface.

M	nsd/tclobjv.c

commit a421ee4278707d9dca69f1b29d96b54870855485
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-03-05

    Make Ns_CacheUnsetValue() more robust against code, where the freeProc calls an ns_cache operation (such as e.g. nsdbipg). Before that modification, double free operations were possible when the cache was pruned.

M	nsd/cache.c

commit f715102bc31bf51682fb2b2a7014a1821261f1a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-03-01

    ns_set.man:
    - mention default value for "ns_set get" and "ns_set iget"
    - remove "-persist" flags from the documentation, since this was
      removed from the implementation years ago (ns_set copy,
      ns_set create, ns_set split)
    - remove "-shared" flags from the documentation, since this was
      removed from the implementation years ago (ns_set list)
    - improve formatting of entries

M	doc/src/naviserver/ns_set.man

commit 7bcaaa46cf181830914bd0e7cd6227f97cf7ea8e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-03-01

    - improve error message

M	nsd/tclset.c

commit d00a52cc0bdb054c36eeaaabdf885d06eeaf7102
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-03-01

    - add empty stub for next release

M	NEWS

commit 2b41adca785ba6c3c17e5c47bcefb83a4dd041be
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-02-14

    - change back to previous version, until the fixed version of nsf is in wider distribution

M	tcl/aolserver-openacs.tcl

commit d0bd6774a548d75101fa2cbb5d5b44cf9319aa80
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-02-14

    - added additional parameter "-decompress" for "ns_http wait" to compress
      the result on the fly (incrementally) in case it is content encoding
      is "gzip"

M	doc/src/naviserver/ns_http.man
M	include/ns.h
M	nsd/compress.c
M	nsd/tclhttp.c

commit 7e421dc42282ec24f1e29bb3c7fcb6f2ec087025
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-02-14

    - use uplevel method instead of uplevel tcl cmd (to skip mixins layers)

M	tcl/aolserver-openacs.tcl

commit b11cb45775e14d9bda7f5bff634a21ae3749a7d6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-02-14

    - provide a default value

M	nsthread/thread.c

commit 58238aefd34fd3da3ce236cfc212abe3ca688a75
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-02-04

    - make place explicit, where loading magic is required (this fixes as well startup problems with some configs)

M	nsd/init.tcl

commit 9d74366ef17168732a96342b7ae3a5f8f97ccabd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-02-01

    remove debug info

M	nsd/init.tcl

commit eb54e7df3619c4a8d80c02cd706164226d20d04b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-02-01

    - load network modules after other ones to allow command from a global module used in the blueprint (was not possible so far due to the loading order)

M	nsd/init.tcl

commit 617597a92bf58df559bbd028cbf8cb5030aaa36a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-23

    - add hint about creation of admin user

M	Makefile

commit 5feb73959dab74c19a57fdda58922408751b516b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-23

    - improve man page

M	doc/src/naviserver/ns_memoize.man

commit 24b12a24dc1be5ba449b4f02943939c0273f6edc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-23

    - use optimize flags in CFLAGS

M	include/Makefile.global.in

commit c391972374bb7c1d6a0580531e691d0d94c47514
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-23

    - use contemporal version numbers

M	README

commit 8da88d85c2058885acd828ea50f78071c51feb99
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-13

    - get rid of ns_share in introductory examples
    - improve formatting

M	doc/src/manual/adp-overview.man
M	doc/src/manual/tcl-overview.man

commit e8a9b7a842298eca79bcbf8fa42c8f9c72c39bd8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-10

    - undo last change: don't require dptlite to be in ns directory, pass "dtplite=..." from installer scripts into makefile to force usage of a particular version

M	Makefile

commit f13278dac1408183ba1bbba506ed733f0b983cfc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-07

    - build directory modues/tcl during install, since default configs point to it

M	Makefile

commit 975ff81fe17dd3149c336bbeee3340a5e6f1e4e5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-07

    - fix tar options and output handling to work under Linux and macOS

M	bitbucket-install.tcl

commit bf7554c127b218ef52092178614ac93f5336ca44
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-07

    - remove deprecated warnings

M	index.adp

commit 3ba0f3135971dd7bd5b2de3e9e881d8a63bdb0fe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-07

    - let script run relative to binary

M	nsd-config.tcl

commit 4dcf83ee1d1d14409d2d4d6f72cdde4913a6dc30
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-04

    - fix various documentation issues

M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_fmttime.man
M	doc/src/naviserver/ns_gmtime.man
M	doc/src/naviserver/ns_httptime.man
M	doc/src/naviserver/ns_localtime.man
M	doc/src/naviserver/ns_parsehttptime.man
M	doc/src/naviserver/ns_parsetime.man

commit a05339986a81944427964e57e6ec6682d5b86210
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-04

    ns_time:
    - add option "ns_time format" to print a time in the sec:usec format
      in secs in a decimal dot notation
    - fix and extend man page for ns_time

M	doc/src/naviserver/ns_time.man
M	nsd/tcltime.c

commit d7d21f9a363eb45d2081b587ac00572b613d39ca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-04

    - use dtplite from $(NAVISERVER)/bin to avoid confusion with other tcl installations on the same machine

M	Makefile

commit de8caeea72677d3c560e3e92fd7fb35c019d4885
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-04

    ns_adp_parse:
    - add dummy option "-string" for backwards compatibility

M	doc/src/naviserver/ns_adp_parse.man
M	nsd/adpcmds.c

commit 34a8e1afaa5a7b1184b5b604e143e2e21558e6c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2014-01-04

    ns_adp_parse:
    - bring documentation in sync with implementation
    - remove flags that were undocumented and did nothing
    - make sure that in string-mode the file-flag is cleared, otherwise
      string mode behaves like file mode

M	doc/src/naviserver/ns_adp_parse.man
M	nsd/adpcmds.c

commit d99d225c3671bce44add1c2eff1188f7e816e209
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-12-26

    - add name of pool to entry in log file

M	nsd/server.c

commit 99c18a621a4a3734b483d2b48befb4e9d15b3100
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-12-26

    - make script more robust and general

M	bitbucket-install.tcl

commit f500c7a0325e654159189ce25a02ae3e405cab8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-12-06

    - ns_setcookie, ns_deletecookie: added flag "-replace" to replace
       already issued cookie requests in output headers;  the same option is
      used in OpenACS.
    - updated documentation
    - extended regression test

M	doc/src/naviserver/ns_cookie.man
M	include/ns.h
M	nsd/cookies.c
M	tests/cookies.test

commit eda9978f6f73add99bcd8d9e12ce8f2dc5fa752b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-12-05

    - nstest::http: added flag "-getmultiheaders" to return all headerfields (multiset) with the specified name

M	tests/testserver/modules/testhttp.tcl

commit 2d31ec718305346f531311d68b9f55e9e461d551
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-12-02

    - ns_getcookie: added option ?-include_set_cookies bool? to search
      cookies being set as well (from output headers); the same option is
      used in OpenACS.
    - added option converter Ns_OptionBoolean()

M	doc/src/naviserver/ns_cookie.man
M	include/ns.h
M	nsd/cookies.c
M	nsd/tclobjv.c

commit 4e8b1bfa369ed142ce348364ebf69ce3a9c53838
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-12-02

    - ns_cookie: added option "-discard" as specified in RFC 2965

M	doc/src/naviserver/ns_adp_bind_args.man
M	doc/src/naviserver/ns_cookie.man
M	include/ns.h
M	nsd/cookies.c
M	tcl/charsets.tcl
M	tests/cookies.test

commit a42c9a7f233e70126c1b3a7b6710950d7f132e79
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-11-10

    - use explicit pointer initializations to make newset gcc happy

M	nsd/adpcmds.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/queue.c
M	nsd/tclresp.c
M	nsd/url2file.c

commit 70fe8b54407870d9fd6d64ac23aeeb5eb850abca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-15

    - improve documentation: fix and complete descripting of command line arguments of NaviServer

M	doc/src/manual/admin-install.man
M	doc/src/manual/admin-maintenance.man

commit 2f65385cd9661f75e2b456c15c34b213725af836
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-15

    - improve documentation

M	openacs-config.tcl

commit ff3a9b08c20adaa5b752fdf3f5d5598360f0303f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-10

    - don't abbreviate info subcommands

M	nsd/init.tcl

commit 1108f1e8476ebcd44173b9148d6a40eb4192672d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-10

    - don't abbreviate info subcommands

M	tcl/aolserver-openacs.tcl

commit cd2dd96f6b6b890c618706675b9ac5e910b045b3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-10

    - don't abbreviate info subcommands

M	tcl/nstrace.tcl

commit 7fe9a3209fe1024ce365491e069837869d8c00ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-10

    - use more clear string comparison operators

M	tcl/form.tcl
M	tcl/http.tcl

commit 1ead7e4fb9dde47350af2f0ed6c8a5f48c9b5c2e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-10

    - make ns_driversection more robust in case it is called without connection

M	nsd/init.tcl

commit 027511be87a68a49a91790821388978cf43244ec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-10

    - make it easier to spot a misconfiguration in case an empty filename is passed

M	nsd/modload.c

commit 0a7bf5a6d47822e87853cc5cea87247e54ba9b2a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-10

    - improve debugging output

M	nssock/nssock.c

commit 9b3ffdfcf71d0e4dfe46362782651973b092ade8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-10

    - mark ns_connsendfp as deprecated as documented (is superseded by ns_writefp)

M	nsd/tclresp.c

commit 8723edc4c7c76f474c2a12980430f331028f75f2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-09

    - use braced expressions
    - use string comparisons when appropriate

M	tcl/form.tcl
M	tcl/http.tcl
M	tcl/sendmail.tcl

commit f921f6edea5a6129ef01cc8e3e1ed14eb7b9b6ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-09

    - fix size of reallocation unit (many thanks to Wolfgang Winkler for pointing this out)

M	nsd/sockcallback.c

commit f255c7ba4a45a07f475215c19ebbb32153f33db6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-03

    - add missing prototype

M	include/nsthread.h

commit 3076b2b51e689164f5a394503c9d918712d8f8ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-03

    - improve documentation

M	nsdb/doc/mann/ns_dbquotevalue.man

commit 54aaf489326b5dca4e509c83b2a73fe06fe9ed10
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-10-03

    - fix inorrect type (sha context instead of md5 context)

M	nsd/tclmisc.c

commit c80c5f78790cbba18f2af8d50513d2d76d93c470
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-09-27

    - save aliases in blueprint

M	tcl/nstrace.tcl

commit a67a13b2c74b74cdef9b798813b12f215eeb8b1c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-09-21

    - reduce variable scopes

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsdb/dbinit.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsthread/nsthreadtest.c
M	nsthread/tls.c

commit 0bb73c8a2de7be3ebec7e04960b20d1196851901
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-09-21

    - remove last gcc warning

M	nsd/pathname.c

commit af6cd4323993458e40c0adc7ac803eeadcb14074
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-09-21

    - reduce variable scopes

M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/cache.c
M	nsd/callbacks.c
M	nsd/cls.c
M	nsd/conn.c
M	nsd/event.c
M	nsd/form.c
M	nsd/index.c
M	nsd/limits.c
M	nsd/log.c
M	nsd/pathname.c
M	nsd/returnresp.c
M	nsd/sched.c
M	nsd/server.c
M	nsd/set.c
M	nsd/sls.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/sockfile.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclconf.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclobjv.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/urlencode.c
M	nsd/urlspace.c
M	nsd/watchdog.c

commit c89f3219a8200e92b40b1056e93e7b16b135e1da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-09-21

    - just clear NS_CONN_ZIPACCEPTED flag on start of request

M	nsd/driver.c

commit 9ba90a0077e7d34b79d0fd8b22ccddac33c13e2d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-09-21

    - silence compiler warnings

M	nsd/driver.c
M	nsd/exec.c

commit 3ac0f4124bdf68c382bd99e89231d2cbd1d307c1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-09-21

    - clear flags of reused connect connections before processing a new request

M	nsd/driver.c

commit 1faf57a9f0f792a622ca0ea166b9343123bed272
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-09-17

    - prevent potential HTTP response splitting attack

M	nsd/return.c

commit 3ee13993fc568d6855deed0295e8cee3ec8b90d6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-09-01

    - improve documentation for ns_http, add larger example

M	doc/src/naviserver/ns_http.man

commit 68b3dc01cabac31fdcc3a40f2eddf15288fa69af
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-08-30

    - added parameter for ReverseProxyMode (used by OpenACS 5.8.0)
    - set minthreads to 2

M	openacs-config.tcl

commit d0a79564a80bf2825ef9d111b2f0c30f920413ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-08-22

    - return headers + status also, when no spoolsize is specified

M	nsd/tclhttp.c

commit 80962fa83f57220a683f3e66d682e689137b9f83
Merge: 2f41fb0d f45be09c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-08-16

    - merge

commit 2f41fb0d52feb7c36f007ad08a21a557c1d6e736
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-08-16

    - don't omit the ::tcl namespace in the blueprint, jeffs commit of the ensemble-serializer changed the picture

M	tcl/nstrace.tcl

commit f45be09c65f3a0fe98a919f9efc926575208032b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-08-16

    - make sure to inclide openacs-config.tcl in tar file and in the stalled path

M	Makefile

commit 14a8ab75a6f677c0aeb054e2f0cc319d2b6ad83f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-08-16

    - make sure to omit the "system forks" (hidden files) when creating tar distribution file under macOS

M	Makefile

commit 24856db592b785e5f7a90603c36be73475f61ab1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-08-11

    - dtplite from tcllib 1.15 does not allow spaces in "titles" of manpages. Fix all manpages, such that build-doc works again.

M	doc/src/manual/admin-db.man
M	doc/src/manual/admin-install.man
M	doc/src/manual/admin-maintenance.man
M	doc/src/manual/admin-tuning.man
M	doc/src/manual/adp-overview.man
M	doc/src/manual/c-driverdb.man
M	doc/src/manual/c-urlspace.man
M	doc/src/manual/main-faq.man
M	doc/src/manual/main-features.man
M	doc/src/manual/main-history.man
M	doc/src/manual/main-standards.man
M	doc/src/manual/tcl-lib-file.man
M	doc/src/manual/tcl-lib-nstrace.man
M	doc/src/manual/tcl-libraries.man
M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/keyl.man
M	doc/src/naviserver/ns_adp.man
M	nscgi/doc/mann/nscgi.man
M	nscp/doc/mann/nscp.man
M	nsperm/doc/mann/nsperm.man

commit 0fbd7bfd821929723f2b8dcd59425cdabac02886
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-08-06

    - handle result of write()

M	nsd/driver.c
M	nsd/tclhttp.c

commit 293e08d76d3d01f6e7699f8b5984fc279ed28d70
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-08-06

    - fix directoryfile entries in sample config file

M	openacs-config.tcl

commit 2748164fc96cd42312e962a703abf38c800082dc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-08-05

    - don't assume that Tcl's global variables ::errorInfo and ::errorCode are always set

M	tcl/nstrace.tcl

commit 6be524657b7e54dac915731930035766d0e14d76
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-07-17

    - removed blacklisted ::clock proc since this is apparently not needed in David's clock-scenario (see naviserver-devel discussion) when ":localtime" is used as documented instead of ":Tcl/Localtime"

M	tcl/nstrace.tcl

commit 7ce51035f5697509116c863c9f7d011cc2aebb0e
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2013-07-08

    Copied ensemble serialization from aolserver

M	tcl/nstrace.tcl

commit 268e9e0dad5cc3a8f491261d81f09b782aecd4b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-07-05

    - exclude ::clock from blueprint

M	tcl/nstrace.tcl

commit 1cf156b68763083551bac950cd5501c732c1b5e9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-07-05

    - mark proc Paren as deprecated (who uses this?)

M	tcl/util.tcl

commit 202bb5aa3736671f9e3d180e127030e78cbbd042
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-07-04

    - fix bug http://sourceforge.net/mailarchive/forum.php?thread_name=CAKmpXCd-4%2Bvq9ugMpYhz7gxf%2B8os2p90bvGiuqTS0Wi3zpNxQw%40mail.gmail.com&forum_name=naviserver-devel
      Don't save ::tcl namespace in blueprint

M	tcl/nstrace.tcl

commit d946c95579883036c3afd420d72cc4f00202b06c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-07-04

    - never return gzip-ed content unless the client indicates that it  accepts it
    - change compressenable in the test config file to true
    - updated regression tests
    - document that "ns_conn compress 0" can deactivate compression
    - add test case for "ns_conn compress 0"
    - added option "gzip_refresh" for "ns/fastpath" (default false)
    - add Tcl proc  ::ns_gzipfile to allow easy redefinition of the gzip
       command (as suggested by Jeff)
    - use Tcl proc ::ns_gzipfile instead of exec tcl command
    - set vary header in cases, where encoding might potentially
       change
    - update man pages and sample config files

M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_return.man
M	nsd/connio.c
M	nsd/driver.c
M	nsd/fastpath.c
M	openacs-config.tcl
M	sample-config.tcl.in
M	tcl/fastpath.tcl
M	tests/ns_adp_compress.test
M	tests/test.nscfg

commit 55cda96f1accee80d25ebb8c6c81049aaced9a40
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-07-04

    - add ns_set as keyword to allow for cross reference from top-level naviserver docs

M	doc/src/naviserver/ns_set.man

commit 29eec0405a68751d549ba1281cd0172daa8330f9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-07-04

    - improve spelling

M	doc/src/manual/tcl-overview.man

commit 30ab8dcaeb10124225517b711b0209f1d383f986
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-22

    - fixed typos in the documentation

M	doc/src/naviserver/ns_return.man

commit c59ff45f5a479c075f5a0bb025c2e594b0d68d94
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-22

    - Don't allow gzipped results on range requests

M	nsd/driver.c

commit e8bfb5a075a8f094688f77897f12d8cd58d6978b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-22

    - improved documentation

M	nssock/doc/mann/nssock.man

commit ae040b0e2b591665bee39f9f3be51c4a39cc6ac8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-22

    - improved documentation

M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_guesstype.man
M	doc/src/naviserver/ns_limits.man
M	doc/src/naviserver/ns_log.man
M	doc/src/naviserver/ns_sendmail.man
M	doc/src/naviserver/ns_sockaccept.man
M	doc/src/naviserver/ns_sockblocking.man
M	doc/src/naviserver/ns_sockcallback.man
M	doc/src/naviserver/ns_sockcheck.man
M	doc/src/naviserver/ns_socketpair.man
M	doc/src/naviserver/ns_socklisten.man
M	doc/src/naviserver/ns_socklistencallback.man
M	doc/src/naviserver/ns_socknonblocking.man
M	doc/src/naviserver/ns_socknread.man
M	doc/src/naviserver/ns_sockopen.man
M	doc/src/naviserver/ns_sockselect.man
M	doc/src/naviserver/ns_upload_stats.man
M	doc/src/naviserver/ns_write.man
M	doc/src/naviserver/ns_writer.man
M	doc/src/naviserver/returnstatus-cmds.man

commit 589bb4855d3c74da7849d2431ab94a4a4af42f59
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-22

    - improve message

M	nsd/mimetypes.c

commit 917ff5a20c4114d4fde10a652ecd5135b240f411
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-22

    Delivery of gzipped content via fastpath:
    
    - added option "gzip_static" for "ns/fastpath" (default false)
    
      Send the gzipped version of the file if available and the client
      accepts gzipped content. When a file path/foo.ext is requested, and
      there exists a file path/foo.ext.gz, and the timestamp of
      the gzipped file is equal or newer than the source file, use the
      gzipped file for delivery.
    
    - added option "gzip_cmd" for "ns/fastpath" (default "")
    
      Command for zipping files in case the (static) gzipped version of
      the file is older than the source. The command is just used for
      re-gzipping outdated files, it does not actively compress files,
      which were previously not compressed (this would be wasteful for
      e.g. large temporary files, there is not cleanup, etc.). If this parameter
      is not defined, outdated gzipped files are ignored, and a warning is
      written to the error.log. Example setting: "/usr/bin/gzip -9".
    
    - added section for fastpath configuration to ns_return describing the
      new and old configuration options (description of fastpath
      parameters was completely missing)
    
    - updated sample config files

M	doc/src/naviserver/ns_return.man
M	nsd/fastpath.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit 65f48ddb5b8af86a9c7b5d4675f031a34bc46ffb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-22

    - reduce variable scopes

M	nsd/connio.c

commit 3fe774479335ac5f7c5fe8920d8f8edfe4bc61eb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-19

    - initialize DSTring before usage (must be quite an old bug)

M	nsd/driver.c

commit 23467326042562d37d4a0e52096503ffa274ba31
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-19

    - don't overwrite config ns_set, when value was taken already from the ns_set

M	nsd/driver.c

commit 8095a8cd668f0054115974f221acfc85b813e314
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-19

    - updated documentation

M	doc/README
M	doc/src/naviserver/ns_conn.man

commit 0f90b3f06c57fef4138a157381ba53364370e52a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-19

    - initial attempt of a documentation guideline

A	doc/README

commit edc1cff4e53b337eb8cad9d05a9f62c9b2e3fa9d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-19

    - improve documentation

M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_return.man

commit dd4fe402ccce286fd329747f6a1edf88546a5ad7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-19

    - add initial version of a documentation of nssock parameters

M	Makefile
A	nssock/doc/mann/nssock.man

commit 542b811973561482caedea58b04ac6ff9e65ea71
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-19

    - improve comment

M	openacs-config.tcl

commit 8ff838e436d79010a44743a8083fb9c06ad7a67e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-19

    - use module name as driver name. This makes it possible to distinguish in introspection and filtering between different driver instances, when the same driver module is loaded twice with different names (e.g. to listen on e.g. 2 different nssock ports)

M	nsd/driver.c

commit 18120f998a10f6df41a06b5fef0fd7bbbcdcca57
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-18

    - improve man page

M	doc/src/naviserver/ns_cache.man

commit eefad27176a6c62bcfd7c07badbed28f8520acbd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-18

    - complete list of mimetypes from RFCs, W3C and IANA
    - fix incorrect mimetypes
    - produce warnings for overwriting predefined mimetype definitions via ns/mimetypes
    - produce warnings for useless definitions via ns/mimetypes

M	nsd/mimetypes.c

commit 016a2c40e1faa83778131192799a482e365f17e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-18

    - bumped version number to 4.99.6

M	configure.ac

commit 7a7e0aa7617e4aaa1307cf9e3ab6c2c5c4cc94fe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-18

    - Added flags
         -file /varName/
      and
         -spoolsize /int/
      to "ns_http wait".  If the content of the obtained
      file is larger or equal than spoolsize, it is spooled to
      temp file, and the name of the temp file is
      returned in the variable provided by "-file". These
      options make it possible to retrieve also large
      content (e.g. video files) via ns_http without
      bloating memory
    
    - refactored ns_http and ns_ssl to align naming and
      to factor our common code (Ns_HttpCheckHeader(),
      Ns_HttpCheckSpool(), Ns_SetNamedVar())
    
    - same changes applied to ns_http's close friend
      ns_ssl in the nsssl module.

M	doc/src/naviserver/ns_http.man
M	include/ns.h
M	nsd/tclhttp.c
M	nsd/tclmisc.c

commit e10be4ed47748ef0bbc66be3655f3c63e8c30124
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-18

    - added option "-set" to ns_config to set the parameter to the default
      value in case it was no earlier provided. This makes the actual value
      query-able later.

M	doc/src/naviserver/ns_config.man
M	nsd/init.tcl
M	nsd/tclconf.c
M	nsdb/util.tcl
M	nsperm/htaccess.tcl
M	tcl/cache.tcl
M	tcl/charsets.tcl
M	tcl/config.tcl
M	tcl/fastpath.tcl
M	tcl/file.tcl
M	tcl/http.tcl
M	tcl/limits.tcl
M	tcl/sendmail.tcl
M	tests/ns_config.test

commit f11d727964132d7f0e371a0bc496f69d3c231615
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-18

    - reduce variable scopes

M	nsd/driver.c

commit b1a688d6953e6ed5f0af17abd770318793c49498
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-18

    - allow Ns_SockTimedWait to wait for different kind of events at the same time (i.e. wait for NS_SOCK_READ|NS_SOCK_WRITE)

M	nsd/sock.c

commit 14ee2b62d59463c78745667de58c89ec89a6b88a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-18

    - create section if it does not exist

M	nsd/config.c

commit 481e8a29918e6573439fa842dbd119dd3cf1a0f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-17

    - provide determined hostname and address back to configuration nsset

M	nsd/driver.c

commit d4f40e99fda819b147f9210fab349f6c171a14ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-16

    - make code more robust to invalid data

M	nsd/driver.c

commit 2349c9b5b0f557f6c083212902f0cddfd1820e9b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-16

    - improve querying of ns_config values (e.g. in nsstats)
    - update config variables of filenames or directories to absolute  values
    - keep defaults (if provided) of tcl_level ns_config calls

M	nsd/log.c
M	nsd/nsconf.c
M	nsd/pidfile.c
M	nsd/tclconf.c
M	nsd/tclinit.c

commit e88d5abece46bcbf182a15f549d6559c7bdd2dbd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-16

    - added ns_param tmpdir honoring environment variable TMPDIR
    - use ns_param tmpdir as default for drivers uploadpath

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/nsmain.c

commit 9e880d441dfc9b6c90c99fd3bb47cd9d3a281743
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-16

    - improve indentation

M	tcl/config.tcl

commit 3136e131719e877dbf942363b171675330b0122f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-16

    - add missing sentence to man entry

M	doc/src/naviserver/ns_return.man

commit e107798ea7544245101c5b8c3e21f746cc1b18d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-16

    - add space to notice in error.log to improve readability

M	tcl/file.tcl

commit 3e4f94aea397e950534eb4053c6f2611290c17aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-15

    - quick fix for objv-parser bug; we should use Ns_ParseOptions()

M	nsd/tclhttp.c

commit 7625529720a489794d2a935cf08501a7b8989ad7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-08

    Added tag naviserver-4.99.5 for changeset b7633f34a21a

M	.hgtags

commit 1af4a1200bfc7258393c0fa6bd11da78ccad95c6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-08

    updated NEWS

M	NEWS

commit 2cb733d62087a30c6d7a90b7362bd133952f8408
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-08

    - provide feedback about used socketoptions when nodelay or defereaccept are activated

M	nsd/sock.c
M	nssock/nssock.c

commit 72588bcd1a40ca9a6a6604b737963dc1f299d6f0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-06-04

    - copy module name to avoid problems with shutdown order

M	nsd/driver.c

commit ce0bb597b53a53faccaabab332192481b9ae2708
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-31

    - nsv_get: added optional argument ?varName? to nsv_get to obtain
       compatibility with tsv::get in the Tcl thread library. This option
       allows an atomic test + get operation, avoiding unsafe nsv_exists
       following by nsv_get.
       Syntax:    nsv_get /array/ /key/ ?/varName/?
    
    - ns_cache_get: new command to obtain a value from the cache.
       similar to nsv_get.
       Syntax:    ns_cache_get /cache/ /key/ ?/varName/?
    
    - extended regression test and documentation
    
    - nsd/set.c: optimized Ns_SetFindCmp() by taking
       invariant out the loop.

M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_thread.man
M	doc/src/naviserver/nsv.man
M	nsd/fastpath.c
M	nsd/set.c
M	nsd/tclcache.c
M	nsd/tclcmds.c
M	nsd/tclvar.c
M	tcl/aolserver-openacs.tcl
M	tests/ns_cache.test
M	tests/ns_nsv.test

commit 6a6bad0a9cf06b0d135202da23550c15007f30e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-25

    Added tag naviserver-4.99.5 for changeset 723d67081aed

M	.hgtags

commit 689519f7a7e47c4e9dcf8d5b52e0589f6c408aa4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-25

    - updated NEWS

M	NEWS

commit c7714f3af8d109ff46f9447e173f0f185e8f2518
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-25

    Added tag naviserver-4.99.5 for changeset 283dbf8cd8dc

M	.hgtags

commit fd028fac4956f9a0e260c0ef8875dcf0d37feeee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-25

    - updated filename

M	Makefile

commit 53ccdca5bdadbdf8894e247f2b873c33b726f9f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-25

    - added generated file version_include.man

M	.hgignore

commit 76371b73a995bbd10ad508a3ee1364cd98024115
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-25

    - updated version numbers

M	README
M	doc/src/manual/admin-maintenance.man
M	doc/src/template.man

commit fc38e3941d3960d2467a5cb7906858c0d0081f34
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-25

    - remove CVS variables

M	contrib/start-scripts/naviserver.SuSE
M	doc/src/README.txt
M	naviserver.rdf.in
M	nscp/doc/mann/nscp.man

commit c40131e0200ea665b3c08446f66142feeeaeb946
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-25

    - remove CVS variables

M	nsd/tclmisc.c

commit 048f91c4c52359a948377b8e33c6dc0de716b614
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-22

    - no need to open file after mkstemp() call

M	nsd/driver.c

commit 24ccae3f25f5af80691264987f4ac4226c7ba179
Merge: 40f71a61 12b0f3a1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-22

    - merged versions

commit 40f71a6135369a550dd8c6bfafa7d388af52d106
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-22

    - further c-code cleanup (make assumption explicit, avoid potential NULL derefs, use more safe system calls)

M	include/ns.h
M	nsd/adpeval.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/lisp.c
M	nsd/queue.c
M	nsd/tcljob.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsdb/dbtcl.c
M	nsdb/dbutil.c
M	nsproxy/nsproxylib.c
M	nsthread/mutex.c

commit 12b0f3a1fc4014cbeda0ca83710ec1a52e28d80d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-21

    - reduced variable scopes to improve source locality

M	include/ns.h
M	nscp/nscp.c
M	nsd/connio.c
M	nsd/dns.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/index.c
M	nsd/listen.c
M	nsd/nsmain.c
M	nsd/pidfile.c
M	nsd/progress.c
M	nsd/return.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/sls.c
M	nsd/sockcallback.c
M	nsd/tclcache.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/url2file.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/dbutil.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsthread/mutex.c
M	nsthread/winthread.c

commit b611fc80dc38a0677a4e9eff3e4b84a13eadfb0c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-15

    - fix syntax in doc file

M	doc/src/naviserver/ns_return.man

commit 1ea80e551a815072944d6630bf91fa1af88b028d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-14

    - remove scripted setting of encoding system, since this is handled already in C

M	nsd/init.tcl

commit e591ab8534c064eb0fb8af7ad16ecad161a20566
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-13

    Further work on avoiding parallel create interp operations:
    - New function Ns_TclCreateInterp() to wrap Tcl_CreateInterp()
      in a mutex
    - Ns_ModuleLoad():
        * pass optionally interp to avoid Tcl_InterpCreate()
           operations in case we have a interp available
        * use NS_TclCreateInterp() instead of Tcl_CreateInterp()
    - Made messages in error log more orthogonal
    - Factored out NsStopSpoolers() and removed dependency of
      spooler shutdown from DriverThread()

M	include/ns.h
M	nsd/driver.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/queue.c
M	nsdb/dbdrv.c
M	tests/all.tcl

commit 7a37f7789544cc1a3201bfc37f6f2a073717575a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-13

    - correct spelling in comment

M	nsd/tclinit.c

commit b3776873bf2570f2d010a8d660acc81b753091b2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-12

    - more cleanup in sample config file

M	openacs-config.tcl

commit 5540bb9bce698d7e88116e127f7d253796669302
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-12

    - remove unused parameters

M	tcl/fastpath.tcl

commit 7e2cf1c2c181ebfabda1e00daf26155d35bfc6cc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-12

    - moved "ns_info pool" to "ns_conn pool", since we have as well "ns_conn server"

M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_info.man
M	nsd/conn.c
M	nsd/info.c
M	tests/ns_conn.test

commit fe67f9a36797e4d9dbbf611a480f4d01507603e5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-12

    - added "ns_info pool", which returns the current connection pool from the current server.

M	doc/src/naviserver/ns_info.man
M	nsd/info.c

commit 1d702cdc5fdab366934b80d2287992118842d285
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-11

    - replace nsopenssl definition with nsssl
    - normalize indenting

M	openacs-config.tcl

commit 303c7d4263ecc14cc94e4c4ec5ea451dda932955
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-11

    - apply config changes as suggested by martin matuska

M	README
M	autogen.sh
M	m4/tcl.m4

commit 7a29a1ad50dff403780c447640f7e8e71a198609
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-11

    - provide a a better name to the mutex lock for the ns_job thread pool

M	nsd/tcljob.c

commit bfa887417407e4d6d288bdd7c8a95ba19b4805a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-10

    - use newer style tcl expressions

M	tests/testserver/modules/testhttp.tcl
M	tests/testserver/modules/vhost.tcl

commit fd2f3232875dc8096e01b0abcf02516e24514cda
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-10

    - comment parameter "tclinitlock" for ns/params in config files

M	nsd-config.tcl
M	openacs-config.tcl

commit ccd7b13aba79b2bb712167dd47c5d7d9aaeb855b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-10

    - more paranoia checks for potential race conditions

M	nsd/queue.c

commit 053470560db7053fe6290e0e024eb454379c3b9b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-09

    - paranoia check: fix several dirty reads

M	nsd/queue.c

commit b3ab3bb21662f56a97af10de1e02b0d2f0fd37af
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-09

    - make staticstics collection less racy. In the worst case, one could have gotten just wrong statistics, but the cleanup eases at least debugging

M	nsthread/mutex.c

commit f637c76093ac6d3aa1810084bf52aefff7ca5eba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-09

    - change system encoding just once

M	nsd/tclinit.c

commit 1b9272d2b933c54556ec0095a0811e6a1ff9bf7b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-08

    - protect against a potential race condition in Tcl_CreateInterp()

M	nsd/tclinit.c

commit 043d24872d99936e1d71be61d8b62d6ea481cbe4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-05

    - updated NEWS file (based on the version prepared from Bernhard van Woerden)

M	NEWS

commit 2348197b1bcaedd9bf5b83e323be0310944356ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-05

    - remove obsolete RCS variables

M	nsd/init.tcl
M	tcl/cache.tcl
M	tcl/charsets.tcl
M	tcl/compat.tcl
M	tcl/fastpath.tcl
M	tcl/file.tcl
M	tcl/form.tcl
M	tcl/http.tcl
M	tcl/init.tcl
M	tcl/nstrace.tcl
M	tcl/sendmail.tcl
M	tcl/util.tcl

commit 44770f84a0397a3f9c3f6831f14295a556966128
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-05

    - removed unneeded macro variable

M	Makefile

commit c1cb60eed294ee6a942c4e40203070d12dcc6904
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-05

    - remove nstclsh (not needed, since we have "nsd -c")

M	Makefile
D	nstclsh/Makefile
D	nstclsh/nstclsh.c

commit 732584637b930c83dd617b3efc88c86599c30bc5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-03

    - change sock-read-error message from a warning to a driver-debug message, since this happens quite often

M	nsd/driver.c

commit e1e550a45150f0a6ded841e38b0aa86a4e7fad93
Merge: df8d4785 a3f02d25
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-01

    - merge

commit df8d4785a391ddb8ea31108402431af77cb8af41
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-05-01

    - Enforce utf-8 as system encoding
       Without this change the regression test fails when e.g. the
       system environment uses LANG=C.
    
       Background: On today's systems, the LANG variable is set to
       e.g. "en_US.UTF-8". This setting results in a "encoding system" in
       Tcl of utf-8. However, when the system setting is "LANG=C",
       we see the following behavior in Tcl:
    
        alice:~% tclsh
        % set tcl_patchLevel
        8.5.13
        % encoding system
        iso8859-1
        % set a "äüö"
        äüö
        % string length $a
        6
        % string bytelength $a
        12
    
      The three characters "äüö" are reported with a string length of 6
      and a byte length of 12. The same information is used in NaviServer
      for e.g. the contentlength. Also in NaviServer, the default encoding
      is utf-8. So setting the system encoding should result in less
      surprises, different output encodings can be defined anyhow.

M	nsd/tclinit.c

commit a3f02d25e7538bf70339997ca21af700a429f236
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-30

    - nslog.c: make logfile printing more robust (in respect of external modules)

M	nslog/nslog.c

commit d87ed6577c14f3692f8bc7a9178ea141a1d64fa1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-30

    - fix comment in config file

M	openacs-config.tcl

commit 58fdc9193bc9e2753c8d0d6342440fe0a9c4cb90
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-30

    - document "-binary" flag for ns_return

M	doc/src/naviserver/ns_return.man

commit 12b9032667ecc8219c0192d04b98a5c56e4a0674
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-29

    - provide compatibility with nx 2.0b5 (unreleased)

M	tcl/aolserver-openacs.tcl

commit 206e420c832c089ddf56645b4a27b0ae3d133351
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-29

    - recommend in sample config script to enable writers by default

M	openacs-config.tcl

commit 48c26dcee787af710e730e90967e96ea932f142b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-29

    - beautify documentation

M	nslog/doc/mann/ns_accesslog.man

commit ff93cd25b9150d9b0a9f1873655d5f8f63694d1e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-29

    - fix indentation

M	nsdb/dbtcl.c

commit 65246dd3bb476da82f4aacff6ee9c4b993b18aa2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-13

    - Do not save variables of the top-level namespace into the blueprint. OpenACS had with this a problem, since the database handles are managed via global variables, which is solved by this modification.

M	tcl/nstrace.tcl

commit 7bec417dad9cbc632657e52dca4974264b76dcc5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-12

    - changed server lock to pool lock in most cases
    - fixed typos

M	include/ns.h
M	nsd/callbacks.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/range.c
M	nsd/server.c

commit 4da222b46101c9302c2d4a47c7de6760a98e53ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-07

    - extend ns_setexpires such one can include cache-response-directives (see section 14.9 of rfc2616)

M	doc/src/naviserver/ns_setexpires.man
M	tcl/util.tcl

commit 8612448c061e07612d6efa6ccb00414351be146d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-03

    - pass seconds explicitly to ns_setexpires

M	tcl/util.tcl

commit d6de6672f6eecff07678b79c7c782a3d712ad86f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-03

    - remove obsolete argument '$conn' from documentation

M	doc/src/manual/adp-overview.man
M	doc/src/manual/tcl-libraries.man
M	doc/src/manual/tcl-overview.man

commit 09687fbfa37b107e4467f997fdb739aea8801d75
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-04-03

    - move directory listing options to fastpath section, where the code expects it

M	openacs-config.tcl

commit ecd53be51d08f9e2b6ec2f9037a9cdfa0696e98e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-03-18

    - updated documentation (ns_http and friends)
    - marked ns_httpget, ns_httppost and ns_httpopen as deprecated (use ns_http instead)

M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_httpget.man
M	doc/src/naviserver/ns_httpopen.man
M	doc/src/naviserver/ns_httppost.man
M	tcl/http.tcl

commit 383a1df10838d9649e08408f5d36f75c0f8658ac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-03-14

    - fix syntax in print statement

M	nsd/driver.c

commit d1f450c4df8f4692f5682744f8eabf670cceb493
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-03-14

    change due to extended autoconf

M	include/nsconfig.h.in

commit 1befd46177a43ad69e603e605ffc7782e752b27b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-03-14

    Report spoolerthreads and writerthreds in log file even when they are 0. When drivers are defined globally and/or locally, make sure to avoid potential confusions.

M	nsd/driver.c

commit 4e5db308f1ea2b7272c8eb4e6fc327fb9c23c690
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-03-14

    New function "ns_driversection" do determine the configsection for
    driver in the config file.
    Usage: ns_driversection ?-driver drv? ?-server s?

M	nsd/init.tcl

commit 591a9a64b7b523ba1c63fd2c8da394d6cfd88f9f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-03-11

    - fix documentation syntax

M	doc/src/naviserver/ns_writer.man

commit a3fa8ad2796b9dffba99180c7f68f278ecc7a92e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-20

    - ns_writer: added -server option to "ns_writer list" to list only
       requests from a particular (virtual) server
    - extended regression test, updated documentation
    - added Ns_OptionConverter: Ns_OptionServer to convert string to
       existing server.
    - extended option parser to allow options at the end of a command

M	doc/src/naviserver/ns_writer.man
M	include/ns.h
M	nsd/driver.c
M	nsd/queue.c
M	nsd/tclobjv.c
A	tests/ns_writer.test

commit 6c46e16400a4ffc200b69d6edbb015aabcb5ebc7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-18

    - reduce (at least initial) memory consumption by lazy initializing zlib

M	nsd/compress.c

commit 13f121204ed773035c72cf519dad3a74781adaa7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-18

    - adjust notDarwin constraint true for versions before macOS 10.8

M	tests/ns_hostbyaddr.test

commit 5941d164f0fc6b0501654880703b6f391fb44535
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-16

    - ns_writer: made "ns_writer submitfile" more robust and foolproof,
    - ns_writer: fixed "size" confusion (filesize vs. nr-bytes to be transmitted)
    - added more regression tests
    - updated documentation

M	doc/src/naviserver/ns_writer.man
M	nsd/driver.c
M	tests/http_byteranges.test

commit e8fbe91281f394f82ae26c749286a5f8038b0d47
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-14

    - improve wording in status message of test

M	tests/ns_log.test

commit 1cec814e57fe22d712c2dee62da9ac1b9ada1710
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-14

    - remove deprecated ns_info subcommands from test

M	tests/ns_info.test

commit cd2574a939a265020dd73ff06c1de137e6b14a5e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-14

    - removed "-constraints {notDarwin}" in tests, since apparently not needed anymore

M	tests/ns_hostbyaddr.test

commit ad73f547176856e5b7c1920b30743a22246bfc2c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-14

    - Change "ns_eval -synch ..." back into "ns_eval -sync ..." to follow usual terminology and to improve compatibility with aolserver

M	nsd/init.tcl
M	tests/tclresp.test

commit fa020ccb1caf7cc82504ab100e294d65b71be5c4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-11

    fix typo

M	nsd/tclmisc.c

commit af19465c12004bef64dd896a27089836c44c3c76
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-08

    - silence compiler warnings about format specifiers under 32bit compiles

M	nsd/driver.c
M	nsd/progress.c
M	nsd/tclthread.c

commit f294fe0d457b17682970e6cf8df964c52b0a95d6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-07

    - Writer: fix leftover offset handling for partial writes
    - WriterSock: rename member "nread" to "toread" and move it into "file" struct

M	nsd/driver.c
M	nsd/nsd.h

commit e8e90dba7f64b6d747db657c1c13154baebb35d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-07

    - improve documentation

M	doc/src/naviserver/ns_server.man

commit 35a9917f889aa4cb907b7a9ebb3fad68aead206b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-07

    - ns_server: mark passing of optional second arg as pool as deprecated.

M	nsd/queue.c

commit e491910218ff6aa08e5c75e9ee5e58eaebb81e66
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-04

    make timing statistics independent from nslog: refactor Ns_ConnTimeStats() into Ns_ConnTimeSpans() and Ns_ConnTimeStats()

M	include/ns.h
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/queue.c
M	nslog/nslog.c

commit 64d53460124f510cff5e5ee16653a8499795d0db
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-04

    make order of ns_server subcommands alphabetical

M	doc/src/naviserver/ns_server.man

commit 060188def48b0c68ce0f47ac862929669037802d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-04

    revive ns_register* man page

A	doc/src/naviserver/ns_register.man

commit 32d5ba3403fc3f75b71b0a21a172978f6b235218
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-01

    * added "ns_server ?-server s? serverdir" to return the base directory
      of the virtual server
    * extended regression test, updated documentation

M	doc/src/naviserver/ns_server.man
M	nsd/queue.c
M	tests/ns_server.test

commit 2346ac24356a506b161b65bb8796e9cd3e80b3e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-02-01

    marked "ns_info platform" as deprecated; use $::tcl_platform(platform) instead.

M	doc/src/naviserver/ns_info.man
M	nsd/info.c

commit 2bb70ca98a5a6c1a3d83632b0d416fae703e8c54
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-26

    * Fixed all known range request bugs from regression test.
    * Handle most range requests via writer (all memory based range
      requests up to 32 ranges, 0 or 1 range fd-requests).
    * Extended WriterQueue to send most requests via a single
      corked unit (don't call Ns_ConnWriteVData() from WriterQueue() )
    * Extended regression test.

M	include/ns.h
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/return.c
M	nssock/nssock.c
M	tests/http_byteranges.test

commit 491f9504bd4404ed1c24d42f619272b8f96ba1c6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-24

    - Allow delivery of mmaped files via writer without the need of copying contet.
       Before, mmaped files were delivered via connection threads.
       (still todo: range reguests; could be extended to use mmap as well for other cases;
       other todo: find better way to run tests with multiple config files)

M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/return.c
M	tests/http_byteranges.test
M	tests/test.nscfg

commit 90a089a11e8a16e816b6978e101320722bae85d8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-24

    - reduce verbosity

M	nsd/nsmain.c

commit c445becc7c445028b52bb95f626caf611a646f82
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-23

    - marked ns_register_adptag (use instead ns_adp_registerscript) and
       ns_adp_registertag (use instead ns_adp_registeradp) as deprecated.
    - updated and streamlined documentation
    - removed obsolete doc files doc/src/naviserver/ns_adp_registertag.man
       and doc/src/naviserver/ns_register.man

M	doc/src/manual/adp-overview.man
M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_adp_register.man
D	doc/src/naviserver/ns_adp_registertag.man
D	doc/src/naviserver/ns_register.man
M	nsd/adpparse.c
M	nsd/tclcmds.c
M	nsd/tclmisc.c

commit f1fbc076c1b56d781380c53da4dd5ff1ffe26d87
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-20

    - reduce verbosity

M	nsd/nsmain.c

commit 58c69e74aa3472683c3b5015d7be1b88e2461f97
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-20

    * Allowing to call "nsd -c" without config file.  One can specify the
      environment variable NAVISERVER to point to the naviserver home
      director (for e.g. log file directories), otherwise it is determined
      by the location of the nsd binary.
    
         nsd  -c
         NAVISERVER=/usr/local/ns/ ./nsd/nsd  -c
    
    * Standardize printing of timings (get rid of stupid $sec.$microsecs,
      where 1.2 means 1.000002 secs).
    
    * Moved statistics structure from NsServer to ConnPool to track
      per-pool usage. Added member poolPtr to Conn for easy association.
    
    * Defined new C function Ns_LogDeprecated() for handling deprecated
      messages for tcl-level defined commands.
    
    * Marked the following commands as deprecated:
    
        ns_info filters
        ns_info pagedir
        ns_info pageroot
        ns_info requestprocs
        ns_info tcllib
        ns_info traces
        ns_info url2file
    
      and defined the following commands instead:
    
        ns_server ?-server server? filters
        ns_server ?-server server? pagedir
        ns_server ?-server server? requestprocs
        ns_server ?-server server? tcllib
        ns_server ?-server server? traces
        ns_server ?-server server? url2file
    
    * Marked the following commands as deprecated:
    
       ns_server keepalive    (use "ns_conn keepalive" instead)
       ns_info winnt             (use $::tcl_platform(platform))
    
    * Updated documentation.
    * Updated regression test (new test set ns_server.test).

M	doc/src/naviserver/ns_info.man
M	doc/src/naviserver/ns_server.man
M	include/ns.h
M	nsd/adprequest.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/filter.c
M	nsd/info.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/op.c
M	nsd/queue.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nslog/nslog.c
M	nsthread/mutex.c
M	nsthread/nsthreadtest.c
M	tests/ns_info.test
A	tests/ns_server.test
M	tests/test.nscfg

commit 46c3c67a29c1ef2078f4ffd6d35f1fcc365ff249
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-19

    fix typo

M	nsd/return.c

commit 1f0f543f53b3de208e02ef8747d2f72ae6858bdd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-19

    reducing variable scopes

M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/binder.c
M	nsd/callbacks.c
M	nsd/compress.c
M	nsd/config.c
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/limits.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/queue.c
M	nsd/request.c
M	nsd/returnresp.c
M	nsd/rollfile.c
M	nsd/server.c
M	nsd/sockfile.c
M	nsd/tclcallbacks.c
M	nsd/tclmisc.c
M	nsd/tclobjv.c
M	nsd/tclset.c

commit e4072b968cd602db0237f618495cccab8918be97
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-18

    Reduce number of (used) API calls by favoring iovec interface

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/adprequest.c
M	nsd/compress.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/return.c
M	nsd/returnresp.c

commit baf16e9e7c648fac031df34efa3d62fd6fea5efb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-18

    check in linux version

M	nsd/sockfile.c

commit 73c05f036515ea8c4df039b68f662a9f726c3523
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-18

    Partial write-reform:
    
    Previously, NsDriverSend() never performed partial writes although
    some client functions handled it (not always correctly). The reason
    for this was that nssock.sendProc used Ns_SockSendBufs() as
    implementation, and Ns_SockSendBufs() uses its own timeouts and event
    handling to deliver all content also on nonblocking sockets.
    
    The consequence was, that every write request in the writer thread
    waited until the full completion, which causes essentially a single
    outgoing request per writer thread at a time. This problem was reduced
    somewhat by the fact that file-spools read always smallish junks where
    the blocking was usually not so long. The problem was especially bad
    when fastpath-mmap + writer threads were activated and/or when only
    one writer thread was defined. For file with sizes > writersize, this
    meant sequentialization of file deliveries.
    
    The complete-delivery scheme is not a problem, when the connection
    threads send the content to the client (since multiple connection
    threads can send back multiple streams and do not block each other
    directly), but this is a problem when e.g. a single writer thread
    should deliver content of multiple requests.
    
    Now, the new code handles partial low-level writes correctly by
    allowing partial writes on the driver level. This requires some
    reshuffling of the functions.
    
    - The old SockSend() is now implementation of nssock.sendProc
       and performs partial writes on nonblocking sockets.
    
    - Ns_SockSendBufs() delivers all iovec bufs like before but calls
       now NsDriverSend() instead of the direct SockSend().
    
    - Ns_ConnSend() calls Ns_SockSendBufs() instead of NsDriverSend() in
       cases, where the writer thread is not used.
    
    - Ns_SockSendBufs() calls NsDriverSend() instead of SockSend()
    
    - Ns_SockSendFileBufs() calls NsDriverSend() instead of
       Ns_SockSendBufs()
    
    Further changes:
    
    - Group fields in WriterSock to separate concern of file-spooling and
       memory based requests.
    - Factor out WriterSend() from DriverThread() to improve readability
       and locality
    
    The code was tested with nssock + nsssl on macOS and Linux.

M	include/ns.h
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sock.c
M	nsd/sockfile.c
M	nssock/nssock.c

commit 12da9bc81b7a1847a34991ea326db1f112d34d0b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-18

    simplify UIO_MAXIOV handling; add UIO_SMALLIOV if not defined

M	include/nsthread.h

commit 5daf88ad92e62225e66c361afae19df866c234c7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-16

    fix format code warnings for newest generation of gcc

M	nsd/connio.c

commit 82e0af6cc8ba9a0074186c6a667796b6586850f9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-16

    provide better compressed image

M	contrib/banners/ns_logosmall.png

commit 27d22ab4b9f3754f7f208c7120ec1e79890cf7a5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-16

    Support TCP_FASTOPEN (new feature in Linux 3.7.0, (co)developed from Google's Web Performance Group), tested with FC18

M	configure.ac
M	m4/gettid.m4
M	nsd/sock.c

commit c4b5214e09ee4f780bfbe8d3cb1d49f620080da4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-16

    simplify SockSendResponse; flag partial writes

M	nsd/driver.c

commit 42350f257b8ae377d54239f2e851646916679a53
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-16

    In newer Linux distributions (like FC 18) crypt() returns frequently NULL (for empty salt, or one-character salt)

M	nsd/crypt.c
M	tests/ns_crypt.test

commit f6a8e61589353eafe5d805cbaa805c770f1c65ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-16

    use scatter/gather interface for writer instead of the char* interface

M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/return.c

commit fcdf024ca624770d87d8c7eadc1d3349f3dd7a3d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-16

    Avoid dup (and potential close-confusion) on temporary files; minor simplification of the handling of the various inputs for WriterQueue();

M	nsd/driver.c
M	tests/test.nscfg

commit 63eb9399e0e8389e44fa27e3e9da86caf947e3ee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-16

    remove unused file

D	tests/http-test-config.tcl

commit b7644883d0a3eaaed8999638268348ea8ebef706
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-16

    cleanup

M	nsd/queue.c

commit 37e85e1eaa40c62727b81cf28f3194b1d9e3e914
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-14

    Fix output for "ns_server active|queued|all"

M	nsd/queue.c

commit e668761661bd4c324b394ce52b6fbe96f637dcb3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-14

    move Ns_ReleaseTemp() of streaming content from connection finish to driver finish

M	nsd/driver.c
M	nsd/queue.c

commit 2fe976b0effb1828332e25c330d724e2edf04a93
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-14

    reduce verbosity

M	nsthread/mutex.c

commit 94fa6697b8ba1b51e29d052a04f8375b4aeb0339
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-14

    - Added asynchronous HTML streaming via writer to reduce
       connection thread blocking time for slow delivery lines.
    - New parameter "writerstreaming" for drivers to activate/deactivate
       streaming of HTML output via writer thread
    - New commands "ns_writer size /driver/ ?value?" and
       "ns_writer streaming /driver/ ?value?" to query set configuration
       parameter of writer thread
    - Use "NS_EXTERN" instead of "extern"
    - Updated documentation

M	doc/src/naviserver/ns_writer.man
M	include/ns.h
M	include/nsthread.h
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit 7b8fa8aff741c5dbe7a9efe467e09e2ec7785f27
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-13

    track total lock time

M	nsthread/mutex.c

commit 6958c0a3c8557cb90ddfc6a35007062e20cf988b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-10

    - Added proc  "ns_deprecated" to flag deprecated commands in the log file.
    - Marked procs in compat.tcl and form.tcl as deprecated.
    - Replaced deprecated commands in the test file by the non-deprecated counterparts.
    - Improved documentation (removed non-existing cmds/options, add missing ones, ...)

M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_adp_ctl.man
M	nsd/adpcmds.c
M	nsd/adpparse.c
M	tcl/compat.tcl
M	tcl/form.tcl
M	tests/cookies.test
M	tests/encoding.test
M	tests/errordoc.test
M	tests/http.test
M	tests/http_chunked.test
M	tests/http_keep.test
M	tests/ns_conn_host.test
M	tests/ns_register_filter.test
M	tests/ns_sls.test
D	tests/servers/server1/pages/ns_adp_chunked.adp
D	tests/servers/server1/pages/ns_adp_compress.adp
M	tests/tclconnio.test
M	tests/tclresp.test
M	tests/timeout.test
M	tests/url2file.test

commit 1136276b328901225b19c9be7455d10a09b8804f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-09

    Don't send streamed content via writer trhead for the time being

M	nsd/connio.c
M	nsd/driver.c

commit 6ee489584a8a3c708204703f8f77c544952d40b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-09

    - remove wrong assertion

M	nsd/tclobjv.c

commit 4887969574fbe50ad5b3fb8b9ca8b060fff0194b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-09

    Generalized option parser from ns_server and used in ns_urlencode and ns_urldecode to get rid of the potential crash due to non-static strings in Tcl_GetIndexFromObjStruct().

M	doc/src/naviserver/ns_urlencode.man
M	include/ns.h
M	include/nsthread.h
M	nsd/queue.c
M	nsd/tclobjv.c
M	nsd/urlencode.c
M	tests/ns_urlencode.test

commit 308bd0929d78e6042c44959d7c97b2ecb2f8e77a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-08

    return in [ns_server stats] and in [ns_server connections] the connections per server, and not the total number of connections

M	nsd/nsd.h
M	nsd/queue.c

commit 2387a105601617e0646d826a90e3b5adc7c32034
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-07

    Update to TEA 3.9, rename configure.in to configure.ac as suggested by the auto-tools warning

M	autogen.sh
R098	configure.in	configure.ac
M	include/Makefile.global.in
M	include/nsconfig.h.in
M	m4/tcl.m4

commit 3f6acac6b7b05aefe32eb37ba4e63a0845cd2c9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-04

    improve documentation: add a few missing man-pages, group entries in commandlist, provide cross-references

M	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_adp_abort.man
M	doc/src/naviserver/ns_adp_break.man
A	doc/src/naviserver/ns_adp_close.man
M	doc/src/naviserver/ns_adp_ctl.man
M	doc/src/naviserver/ns_adp_dump.man
A	doc/src/naviserver/ns_adp_flush.man
M	doc/src/naviserver/ns_adp_return.man
A	doc/src/naviserver/ns_adp_stream.man
M	doc/src/naviserver/ns_conn.man

commit f33bb2aad0ad562acac2e51bb16de61ce00a6d63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-04

    don't use ns_unlink, which is deprecated

M	tcl/form.tcl

commit c486a6744504a93e63b59023a715a142a01b1cba
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-04

    fix typo

M	doc/src/naviserver/ns_adp_registertag.man

commit 21f0998051d4a7bb16a26f214ba624c2400bfa71
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-04

    provide better error message in case the subcommand of "ns_server" was not found.

M	nsd/queue.c

commit 4c21f5ce39f2e3e79af491c4e774f9c3fbdbf683
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-04

    consolidating commands registering scripts and adp pages for a URL in ns_register man page. Removing man pages for non-existing commands, and half written man pages about commands, written elsewhere, adding documentation for ns_uregister_op, simplifying keywords, etc.

M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_adp_append.man
M	doc/src/naviserver/ns_adp_argc.man
M	doc/src/naviserver/ns_adp_argv.man
M	doc/src/naviserver/ns_adp_bind_args.man
M	doc/src/naviserver/ns_adp_break.man
M	doc/src/naviserver/ns_adp_dump.man
M	doc/src/naviserver/ns_adp_eval.man
M	doc/src/naviserver/ns_adp_include.man
M	doc/src/naviserver/ns_adp_info.man
M	doc/src/naviserver/ns_adp_puts.man
D	doc/src/naviserver/ns_adp_registeradp.man
D	doc/src/naviserver/ns_adp_registerproc.man
M	doc/src/naviserver/ns_adp_registertag.man
M	doc/src/naviserver/ns_adp_return.man
M	doc/src/naviserver/ns_adp_tell.man
M	doc/src/naviserver/ns_adp_trunc.man
M	doc/src/naviserver/ns_register.man
D	doc/src/naviserver/ns_register_adp.man
D	doc/src/naviserver/ns_register_adptag.man
D	doc/src/naviserver/ns_register_fastpath.man
D	doc/src/naviserver/ns_register_filter.man
D	doc/src/naviserver/ns_register_proc.man
D	doc/src/naviserver/ns_register_proxy.man
D	doc/src/naviserver/ns_register_trace.man
D	doc/src/naviserver/ns_register_url2file.man

commit 66ce2473ad837ee3987d1594a34aabbc1e1b9774
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-03

    add lookup for server in NsTclServerObjCmd()

M	nsd/queue.c

commit 7276f11013b13735c06574f21946dd95f7c8cb18
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-03

    allow setting the size for maxthreads as well via "ns_server maxthreads value"

M	nsd/queue.c

commit aaa2313b98c345bad45fd9033e39f820d5d84caa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-03

    added experimental cmds
      ns_server ?-server s? ?-pool p? maxthreads ?value?
      ns_server ?-server s? ?-pool p? minthreads ?value?
    to query change minthreads and maxthreads at runtime

M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c

commit ac5601c8418406cdbab0ef171a103eda7872bf13
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-03

    reduce verbosity

M	nsd/driver.c

commit a80d6773ecaf4192e3675c5c408ada42cb2f0c63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-03

    improve comments

M	nsd/queue.c

commit b743725c825c0c3b4d668a19d5399de586cdd039
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-03

    make Ns_ObjvTable static where possible

M	nsd/tclinit.c
M	nsd/urlencode.c

commit a96cf895278b8ae96e45ed2321b77d76236063d5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-03

    Avoid parallel creates in case these are not allowed by the config file

M	nsd/queue.c

commit a707febf073cd23241f845f785341c6c2d751a11
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-01

    improve documentation

M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_hrefs.man
M	doc/src/naviserver/ns_register_fastpath.man

commit fba3f62b225604c09bd04aa56863edf06b7e35f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-01

    - document logpartialtimes
    - compute and aggregate partial times as well when nslog/logpartialtimes is not set

M	nslog/doc/mann/ns_accesslog.man
M	nslog/nslog.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit 56194e3f1ea843fe5746ee385b22ddfdb390ec69
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-01

    drop LogToAsyncFile and use NsAsyncWrite in LogToFile. Async log file writing can be switched on/off by configuring the async log writer.

M	nsd/log.c

commit f62aee5e982f9944db26e6db6eee3c3b2842f4f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-01

    cleanup

M	nsd/queue.c

commit c04601be2cacfb44f2875200c17d32dfca419851
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-01

    - remove debug statements

M	nsd/queue.c

commit 34eab780a6e405469454379cffcf98af97ebd53d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-01

    - remove debug statements

M	nsd/driver.c

commit a9b602ef2f733a30cc23a834d25c0c9ea317ba6c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-01

    remove unneeded argument

M	nsd/nsd.h
M	nsd/queue.c

commit 5a52a4ac115196620cd5a52a41ff8066312c9f51
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2013-01-01

    - remove cast

M	nsd/queue.c

commit f13e2016be87272c35f27389730f9a02d5ddf8c6
Merge: c787538e 2612c62c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-27

    merged version with naviserver-connthreadqueue and bumped release to 4.99.5

commit c787538e12f797f3701184cf6df3e9d08608b2e2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-27

    Added tag naviserver-4.99.4 for changeset d34fc2681cf1

M	.hgtags

commit 2612c62cb256e91210ed172f1cf8f2f423133fe5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-25

    add branch optimization for most frequently used blocks

M	include/nsthread.h
M	nsd/cache.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/filter.c
M	nsd/info.c
M	nsd/log.c
M	nsd/quotehtml.c
M	nsd/set.c
M	nsd/tclcache.c
M	nsd/tclconf.c
M	nsd/tclinit.c
M	nsd/tclobjv.c
M	nsd/tclset.c
M	nsd/tclvar.c
M	nsd/urlencode.c
M	nsthread/memory.c
M	nsthread/mutex.c
M	nsthread/pthread.c
M	nsthread/time.c

commit 639776a54b038da3d0f225f9a5a95776a191ba75
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-23

    Use GetSection() instead of Ns_ConfigCreateSection() in ConfigGet(), since this is (a) faster and (b) removes the need for the most-frequently used mutex lock in naviserver, namely "nsd:conf".

M	nsd/config.c

commit c0d47b1c8c7d281cbd71e8f903319384984420aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-23

    - recommend to set the OutputCharset in the config file in OpenACS

M	openacs-config.tcl

commit 1417178121e14110d0d407fc9e41b00f0ea804ec
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-20

    New subcommand "ns_conn clientdata" to query or set the client date of
    the current connection. The client data is provided by the application
    and is potentially passed to different threads and can be used to
    establish the context with the connection thread. For example, the
    writer thread outputs the client data when listing running connections
    (one can determine e.g. which user has initiated the delivery, etc.).
    
    Output in "ns_writer list" contain now start time of the initiating
    request, name of the thread, driver, the ip-address of the requestor,
    the file descriptor, the remaining size and the bytes already sent,
    and the client data as provided via [ns_conn clientdata].

M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_writer.man
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	tests/ns_conn.test

commit df59afc498decfd6940becaa845e4699e940f1e6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-20

    initialize static variable cache to NULL; return empty in ns_fastpath_cache_stats, if the fast_path cache is not used.

M	nsd/fastpath.c

commit a3fbeacc3497482ceb504f9d2ffb8bfae4e87ced
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-20

    make sure to initialize variable

M	nsd/urlspace.c

commit e2ff992745d2d82adf2886a8798a579f61508cef
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-19

    Document missing options of ns_conn.

M	doc/src/naviserver/ns_conn.man

commit 472ccaffbc7889d4ab6e912678f6642d6e1af15e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-19

    bring ns_conn options into alphabetical order

M	nsd/conn.c
M	tests/ns_conn.test

commit 06051f9a60bf74e498ed68ec2f9825d7ee0985ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-19

    document "ns_writer list" more precisely

M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/ns_writer.man

commit b16dd4c7bf4aa9a796945372839d6aee4570c8c3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-19

    reduce verbosity

M	nsd/queue.c

commit be41bcd528e9c2e721c3367e6cbb037028829e09
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-19

    Let Ns_ConnSend() use the writer thread to deliver adp-content
    etc. without blocking a connection thread. This improves the request
    latency and avoids (maybe unwanted) DOS attacks.
    
    Extend the interface of SockWriterRelease() to contain the
    queue. SockWriterRelease() manages now the queue entries as seen
    e.g. by "nswriter list".
    
    Fix thread safety of "nswriter list".
    
    Handle POLLHUP in writer thread explicitly.
    
    Delegate close() operations from writer thread to driver thread via
    NsSockClose().
    
    Extend interface of NsWriterQueue() to accept as well iovec & nbufs
    (as required by Ns_ConnSend()). This saves an unneeded copy of the
    send data.

M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c

commit 15f981557e62fa7b11d91abf7980cadfb6cffff4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-13

    pass timeout to Ns_SockSetDeferAccept

M	include/ns.h
M	nsd/sock.c
M	nssock/nssock.c

commit 45ab310bf589908cc2683d0631b99297df663282
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-13

    Factor out Ns_SockSetDeferAccept() from nssock and nsssl

M	include/ns.h
M	nsd/sock.c
M	nssock/nssock.c

commit 59cf7a9ad8666951847336a577332ed2b34cbc85
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-13

    Silence false positive compiler warning

M	nsd/request.c

commit 70b59023d1de3df8c00d22f975869856f935c252
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-12

    add experimental support for TCP_FASTOPEN

M	nssock/nssock.c

commit 9f3401feefa60a0b54585be97aa9f51a0bfc2884
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-11

    setting default for connsperthread to 10000; simplifying flag initialization of connections

M	nsd/queue.c
M	openacs-config.tcl
M	tests/ns_conn.test

commit d37809f053c025c96dc18e3f6fdbf91c48a7a1ff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-10

    refactoring of parsing of accept-encoding; new command 'ns_conn zipaccepted'

M	doc/src/naviserver/ns_conn.man
M	include/ns.h
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/request.c
M	tests/ns_adp_compress.test

commit 77163dcc9529bf1203c68e1069895cf3e389a46c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-09

    reduce verbosity

M	nsd/sockfile.c
M	nssock/nssock.c

commit 2d010824de569c651fd5f904c71b1faab88acbb9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-09

    Adding TCP option "nodelay" for nssock on operating systems that do not
    use this per default (Linux uses TCP_NODELAY per default). Using
    TCP_CORK for optimzing TCP_PACKAGE size on machines where this  is available.
    Extending buffer size when sending files from 4KB to 16KB.

M	include/ns.h
M	include/nsconfig.h.in
M	nsd/sockfile.c
M	nssock/nssock.c
M	openacs-config.tcl

commit 281509a3e44557594fffc355775355b72f8afc93
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-09

    remove unused flag

M	nsd/driver.c

commit 6c571ebd1e925fae513cfc2cae25ce799f0580cf
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-07

    added SO_ACCEPTFILTER for machines having no TCP_DEFER_ACCEPT

M	nssock/nssock.c

commit dc57ee2ff8e0432d3e893254cadd376c510d359d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-07

    rename the parameter "asyncwriter" to "asynclogwriter" to avoid confusion with the writer threads, which deliver content asynchronously

M	nsd/driver.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit eaeaac7bc7376f1622a308e98a572a8807903e80
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-06

    shigh. i think i need new glasses.

M	nssock/nssock.c

commit afdaee5fc447747cc55abcd573501fd4600da4ee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-06

    align nssock with the driver logic (revc 0 => SOCK_MORE)

M	nssock/nssock.c

commit 8bb85e6a71a9771d035b56403b05c3153ff450b4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-04

    Increase static buffer size to avoid stalling from SSL.
    Make sure to reset buffer size to original value on 0 byte reads or error read operations.

M	nsd/driver.c

commit 516bbb00ec952c58208f3db2532d4f3a8b3acb9e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-03

    Made asyncwriter configurable (boolean ns/parameter
    "asyncwriter"). Added shutdown handling for asyncwriter. Added
    filterTime to logpartialtimes and to values returned by "ns_server
    stats". Simplified driver logic (fixed bad interaction with nsssl,
    which used nonblocking sockets, but declared itself as a non-async
    driver). Fixed potential bug for partial reads in header parsing
    (string comparison could read past available bytes, pick up values
    from previous requests). Deleted obsolete parameter "flushcontent".

M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c
M	nslog/nslog.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit d9f30a0b9d30772389aa9f7c746ee788f2a03b6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-01

    add documentation for highwatermark and lowwatermark

M	openacs-config.tcl
M	sample-config.tcl.in

commit e885c4d73f5a99016df0a0194071dd2f9c4d654c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-12-01

    improve readability, delete parameter "spread"

M	sample-config.tcl.in

commit eaf2896a1d50123610968e7d0284510f65fa6e87
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-29

    output start time in "end of job" line as tag for easier correlating error log and access log

M	nsd/queue.c

commit 1d32444defb3f49595a359458492cd5c10769b25
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-29

    added command ns_fastpath_cache_stats to obtain usage info from the fastpath cache

M	nsd/fastpath.c
M	nsd/tclcmds.c

commit 10c6d7c12ba47a5078791798458508da82e9e9bd
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-29

    add highres start time to partial-times output in access log (to be able to repoduce the exact order of requests), minor cleanup

M	include/ns.h
M	nsd/conn.c
M	nsd/queue.c
M	nslog/nslog.c

commit da86d66965d178cc6f12eb7f0a63c529edf86123
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-28

    add aggregated accept time, queue time and run time to [ns_server stats]

M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/queue.c
M	nslog/nslog.c

commit e54e91ec3b335feb1daa1d60d73b762f2038e38f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-28

    Cleanup: comment code, reduce verbosity, eliminate dead code

M	nsd/driver.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/queue.c
M	nslog/nslog.c

commit 2ada4524af8a785d4bd9658eebb4ab47dcbd4281
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-27

    naming locks, minor cleanup

M	nsd/driver.c

commit 1860de19cf85c803e86f83451eb6f8bfaac568d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-27

    extended experimental version of async writer to error.log (after fighting a while with stderr handling, at least on macOS)

M	nsd/driver.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/queue.c
M	nslog/nslog.c

commit d66339cd700ea57d926867be73e0c8535ff6670a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-26

    added async disk writer to reduce request latencies due to filesystem latencies. Currently just used to access log, can/should be optimized, cleaned up, used for error-log etc. shutdown handling should be added

M	nsd/driver.c
M	nslog/nslog.c

commit d3490deac3683ada068db397a05498fd590dac3e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-23

    Fix bug in rolling access log when rollfmt is specified. Previously the log file was closed but not reopened, log data was lost.

M	nslog/nslog.c

commit 47b1927c9e2f768042cfa2fae9f4d525ad5457ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-22

    Changed nslog parameter logqueuetime into logpartial times that includes accept time, queue time and run time of the request

M	include/ns.h
M	nsd/conn.c
M	nslog/nslog.c

commit 0726998526664d1c765f8936d5cf423e62a3abd0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-22

    When ns_writer is used explicitly, send the content via writer thread regardless of the config value "writersize"

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/return.c

commit a1dd98f453d5fc0bac4d7e1d0b3e84e043a5c523
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-22

    setting accessTime just on positive accepts

M	nsd/driver.c

commit 4798b13854269f871ad02a2440a90fedb14cf5de
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-22

    reset sockPtr->flags when reusing a socket structure

M	nsd/driver.c

commit cb7c7f24c606888700b1aa5c40b41f1e8efd3d33
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-22

    don't try to accept more than one connection at a time on Darwin, since this fails always

M	nsd/driver.c

commit 09a0d8fad02ec49fa17a9565634c3ddc784cc4ed
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-22

    reset sockPtr->keep just in timeout case

M	nsd/driver.c

commit 6b5841f9bb48ead78acfdb25cefa6e3e1dc8205f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-22

    report error message in sock accept, if the errno is different from EAGAIN

M	nsd/sock.c

commit 7d99756bdbef8cbe3ad5eeb128aa1624304e57ec
Author: gustafn <none@none>
Date:   2012-11-21

    define gettid via systemcall

M	configure.in
M	include/nsconfig.h.in
A	m4/gettid.m4
M	nsthread/thread.c

commit 67dd5e15c344b39abcbec34fbe2e0bd9ad6e9b3d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-19

    Record for every request the acceptTime, requestQueueTime, and requestDequeueTime. Use acceptTime as startTime for a request (was requestQueueTime).

M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/queue.c
M	nslog/nslog.c

commit dab9d7df5601d9a5a2bbdcab4b9f0d1dca0847a7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-19

    measure accept time and queuing time separately

M	nsd/queue.c
M	nslog/nslog.c

commit f5df2f6383edc415d5a8a4969c26dcba2defc945
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-19

    add experimental feature to record internally the queuing time and to allow its output to access log

M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nslog/nslog.c

commit 6f837bd1ecb15853816c6a6b37662a53fa270d99
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-16

    get os-level thread id, which can be used to obtain os-info about the threads

M	configure.in
M	include/nsconfig.h.in
M	nsthread/thread.c

commit 2969ef06f5fb292e187e2cf96dfcf89aaa31ceb8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-13

    Adjusting server exit to new infrastructure; new function NsWakeupConnThreads(ConnPool *poolPtr) to wake up every idle conn thread during shutdown. Some cleanup.

M	nsd/driver.c
M	nsd/queue.c

commit 8c45e660d53e27335268e82d44928e898a423500
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-09

    reduce wakeups, improve code ducumentation.

M	nsd/driver.c
M	nsd/queue.c

commit a31fe73340f5f2256aced4723f6a5a5f25b607df
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-09

    New function NsWakeupDriver(); used in queue to signal conditions to the driver, when we might have to recreate threads.

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c

commit e714cce4ac2e57ea503c5a03a99bf6ee9660bc19
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-07

    New parameter "lowwatermark" for controlling thread creation.
    Renamed "concurrentcreatethreshold" to "highwatermark".
    Extend "ns_server stats" to return as well the number of created connection threads since startup.
    Fix a bug showing up with nsssl (a driver has no NS_DRIVER_ASYNC flag set), where pollin says that data is available, but the read returns no data. This lead to a busy loop before.

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c

commit d8d3b30b4a33e62b4202becc4f40cd7e97c227ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-04

    make reinitialized all fields of q request to zero; don't initialize request with zero after al calloc; take care of drivers without servers (during regression test).

M	nsd/driver.c

commit 4113297ce644531ae8adfa52ac84648c1f4f634d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-04

    make exit logic more clear

M	nsd/queue.c

commit ae5388b64758e753011cc670362cbd0a79a1815e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-03

    add "ns_server stats" to return number of requests, number of spools and number of requests added to the waiting queue; todo: documentation
    fix length computation in "ns_writer submitfile" when offset is specified

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c

commit 61c6a5d5da3775aaa352d0882d5eb90f815e92f6
Merge: 53785338 f07aebe6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-02

    rebased with naviserver tip

commit 53785338e136de0092453e61f78e958d83af3cda
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-02

    code cleanup

M	nsd/driver.c
M	nsd/queue.c
M	nsthread/mutex.c

commit bfc1141a43bcb20cddc225c1ea89f573153238c3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-02

    use gettimeofday() if available instead of the rount trip to tcl

M	configure.in
M	include/nsconfig.h.in
M	nsthread/time.c

commit 220406c3d013473694758a5f723c83c7d9a55722
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-02

    remove spread factor, which is not needed due to connection thread queue

M	nsd/queue.c

commit f07aebe6c064224c79d0c37778673a51e20b054f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-01

    added "ns_info pagedir", removed "ns_info pageroot" from 2 config files.

M	doc/src/naviserver/ns_info.man
M	nsd/info.c
M	openacs-config.tcl
M	tests/http-test-config.tcl
M	tests/ns_info.test

commit 8fde7c0fe2301d9ec5e1e51d312f809ac53b9181
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-01

    Introduced separate locks for waiting queue (wqueue) and thread queue
    (tqueue) per pool. In classical naviserver there is a pollslock
    (covering all pools) used. The change leads to much finer lock
    granularity in improves scalability.

M	nsd/nsd.h
M	nsd/queue.c
M	nsd/request.c
M	nsd/server.c

commit 2f4e7e64a4a5501817b3d97271d0f4f2a4e0ef64
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-01

    Initialize mutex and provide a name for it.

M	nsd/httptime.c

commit ad92e2f48de3a8b917b2d0e57f23f26fa3f6f73d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-01

    Make sure to initialize mutex and provide a name for it for monitoring.

M	nsd/driver.c

commit 4475687406473ebd274b58d57cf8e6ee6a441f56
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-01

    added ns_returnmoved
    extended regression test
    updated documentation

M	doc/src/naviserver/ns_internalredirect.man
M	doc/src/naviserver/ns_return.man
R096	doc/src/naviserver/ns_returnerror.man	doc/src/naviserver/returnstatus-cmds.man
M	include/ns.h
M	nsd/returnresp.c
M	nsd/tclcmds.c
M	nsd/tclresp.c
M	tests/ns_urlencode.test
M	tests/tclresp.test

commit af025f8c23857a1a72aa5c331fe6754883c91651
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-01

    make sure to cleanup intermediary files of previous build-doc runs

M	Makefile

commit 213683f1f649736ad09918a78ca41a1d4d71d8da
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-11-01

    make sure, variable is initialized

M	nsd/urlencode.c

commit 4873d3b9949928b3bbf917c096816cbc2ae2ee23
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-31

    various documentation updates/fixes

M	doc/src/naviserver/ns_charsets.man
M	doc/src/naviserver/ns_critsec.man
M	doc/src/naviserver/ns_crypt.man
M	doc/src/naviserver/ns_sha1.man
M	doc/src/naviserver/ns_shutdown.man
M	doc/src/naviserver/ns_urlcharset.man
M	doc/src/naviserver/ns_uudecode.man
M	doc/src/naviserver/ns_uuencode.man

commit 749c269a6e14a7bbf3e6102d15e67fbe3e4c464c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-31

    adding charset option to ns_urlencde and ns_urldecode

M	doc/src/naviserver/ns_urldecode.man
M	doc/src/naviserver/ns_urlencode.man
M	nsd/urlencode.c
M	tests/ns_urlencode.test

commit 68d714df26bc3485c9f7201295869f7b2d21c307
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-29

    slience one more version of gcc

M	nsd/sls.c

commit 8c9c5b63c3439af522e05c7e0c890e28b7816657
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-29

    First checkin of the experimental version of naviserver using connection thread queues.
    This version works fine on the naviserver regression test and playing around with OpenACS, but needs more work to reduce the contention on poll mutex,
    must likely by using less or different mutexes, and certainly more testing.

M	nsd/nsd.h
M	nsd/queue.c
M	nsd/request.c
M	nsd/server.c
M	nsd/sls.c

commit e9c90ec4110c2a9f3a298e8bbd1d46f1f1e53f16
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-28

    Don't enforce upgrade of all drivers using SOCKET instead of NS_SOCKET

M	include/nsthread.h

commit ee55254e03342d0880cf5366a0caf97e1b8096f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-28

    white space changes

M	nsd/connio.c

commit 6aa69756545b38722f5464467dce6349e9787b4f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-28

    in HTTP/1.0, allow gzip, when it is permitted,
    in HTTP/1.1, allow gzip, when it is not disallowed.

M	nsd/connio.c
M	tests/ns_adp_compress.test

commit 63760e7948a2d9a7361b1b7b05c7e4a15290848f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-27

    handle identity and * qvalue in accept-encoding;
    deactivate defauit gzip returning for http/1.1, since this would not allow explicit forbidding of gzip;
    remove known bugs from fregression test and extend it.

M	nsd/connio.c
M	tests/ns_adp_compress.test

commit c34cb99514c67ead0dc7d2a48e3522aca5f99074
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-27

    Handle qvalue in accept-encoding

M	nsd/connio.c
M	tests/ns_adp_compress.test

commit b95a04a4d4d11819f0f893b90fc73743f3741a10
Merge: ab7dae96 24100e8d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-26

    merged versions

commit ab7dae96667ff44a42f228418c5c1aea95ad160c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-26

    remove further warnings

M	nsd/sockfile.c

commit abb02e03779aaa71051e97b4477e890dde29e6d7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-26

    remove unneeded files

D	win/.DS_Store
D	win/nsd/x64/Release/CL.read.1.tlog
D	win/nsd/x64/Release/CL.write.1.tlog
D	win/nsd/x64/Release/cl.command.1.tlog
D	win/nsd/x64/Release/nsd.Build.CppClean.log
D	win/nsd/x64/Release/nsd.lastbuildstate
D	win/nsd/x64/Release/nsd.log
D	win/nsd/x64/Release/nsd.unsuccessfulbuild
D	win/nsthread/x64/Release/CL.read.1.tlog
D	win/nsthread/x64/Release/CL.write.1.tlog
D	win/nsthread/x64/Release/cl.command.1.tlog
D	win/nsthread/x64/Release/nsthread.lastbuildstate
D	win/nsthread/x64/Release/nsthread.log
D	win/nsthread/x64/Release/nsthread.unsuccessfulbuild
D	win/x64/.DS_Store

commit ea9c352da81fd24347388d3574fa2de0191b922f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-26

    ignore .DS_Store files

M	.hgignore

commit a34249f99c904802790f2671442477697f7809d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-26

    - use size_t, ssize_t, off_t wherever appropriate
    - push casts to "int" as far as possible down the code (e.g. down to Tcl_* functions accepting sizes, but defined with "int", such as Tcl_WriteChars, Tcl_NewStringObj, Tcl_NewByteArrayObj)
    - be more careful on redefining macros (MSC seems a moving target)
    - provide base definition for inttypes for MSC WIN32 and WIN64
    - use NS_SOCKET instead of SOCKET (which is defined under Windows). We should stick with macros in our own namespace whenever possible.
    - added the project files and the solution file for visual studio

M	Makefile
M	include/ns.h
M	include/nsthread.h
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/event.c
M	nsd/exec.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/index.c
M	nsd/info.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/pathname.c
M	nsd/pidfile.c
M	nsd/progress.c
M	nsd/queue.c
M	nsd/range.c
M	nsd/request.c
M	nsd/return.c
M	nsd/sched.c
M	nsd/sls.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/sockfile.c
M	nsd/str.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsd/uuencode.c
M	nssock/nssock.c
M	nsthread/memory.c
M	nsthread/mutex.c
M	nsthread/thread.c
M	nsthread/time.c
M	nsthread/winthread.c
A	win/.DS_Store
A	win/cgitest/cgitest.dsp
A	win/cgitest/main.c
A	win/group/grpall.dsp
A	win/group/grpcore.dsp
A	win/group/grpopenacs.dsp
A	win/main/main.vcxproj
A	win/main/main.vcxproj.filters
A	win/main/main.vcxproj.user
A	win/naviserver.sln
A	win/nscgi/nscgi.vcxproj
A	win/nscgi/nscgi.vcxproj.filters
A	win/nscp/.DS_Store
A	win/nscp/nscp.vcxproj
A	win/nscp/nscp.vcxproj.filters
A	win/nscp/x64/.DS_Store
A	win/nsd/.DS_Store
A	win/nsd/Release/.DS_Store
A	win/nsd/nsd.vcxproj
A	win/nsd/nsd.vcxproj.filters
A	win/nsd/nsd.vcxproj.user
A	win/nsd/x64/Release/CL.read.1.tlog
A	win/nsd/x64/Release/CL.write.1.tlog
A	win/nsd/x64/Release/cl.command.1.tlog
A	win/nsd/x64/Release/nsd.Build.CppClean.log
A	win/nsd/x64/Release/nsd.lastbuildstate
A	win/nsd/x64/Release/nsd.log
A	win/nsd/x64/Release/nsd.unsuccessfulbuild
A	win/nsdb/nsdb.dsp
A	win/nsdb/nsdb.vcproj
A	win/nsdb/nsdb.vcxproj
A	win/nsdb/nsdb.vcxproj.filters
A	win/nsdb/nsdb.vcxproj.user
A	win/nsdbpg/nsdbpg.vcxproj
A	win/nsdbpg/nsdbpg.vcxproj.filters
A	win/nslog/nslog.vcxproj
A	win/nslog/nslog.vcxproj.filters
A	win/nsoracle/Project1.vcxproj.filters
A	win/nsoracle/Project1.vcxproj.user
A	win/nsoracle/nsoracle.vcxproj
A	win/nsperm/nsperm.vcxproj
A	win/nsperm/nsperm.vcxproj.filters
A	win/nssock/nssock.vcxproj
A	win/nssock/nssock.vcxproj.filters
A	win/nsthread/Release/vc110.pdb
A	win/nsthread/nsthread.vcxproj
A	win/nsthread/nsthread.vcxproj.filters
A	win/nsthread/nsthread.vcxproj.user
A	win/nsthread/x64/Release/CL.read.1.tlog
A	win/nsthread/x64/Release/CL.write.1.tlog
A	win/nsthread/x64/Release/cl.command.1.tlog
A	win/nsthread/x64/Release/nsthread.lastbuildstate
A	win/nsthread/x64/Release/nsthread.log
A	win/nsthread/x64/Release/nsthread.unsuccessfulbuild
A	win/test/nsd.tcl
A	win/test/servers/test/pages/cgitest.bat
A	win/test/servers/test/pages/index.adp
A	win/threadtest/threadtest.dsp
A	win/x64/.DS_Store

commit 24100e8d3d4dfc2e1fbbafd236874dfe28e2f21d
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2012-10-24

    exclude tcloo namespace from interp initialization

A	tcl/tcloo.tcl

commit ac78d48285d0c637813bcf50aabf94c66bc367ce
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2012-10-24

    Disable fastpath caching for recently changed files
    
    This fixes the bug highlighted by test tclresp-5.3.  The fastpath
    cache can collide and send data that is out of date despite checking
    the modification time of the file.  This fix disallows caching when
    the inode has changed too recently.  The check is against ctime rather
    than mtime, as mtime is changeable with utimes().

M	nsd/fastpath.c

commit 7a06b20bc56e523d0eaca555d047bf8c356a2118
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-21

    use size_t more consequently; further windows cleanup

M	include/ns.h
M	include/nsthread.h
M	nsd/adpcmds.c
M	nsd/driver.c
M	nsd/nsd.h

commit 51732c56bd1c6221d5b79497935406b5ac19e6aa
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-19

    remove unused NS_NOCOMPAT

M	include/ns.h
M	win32/nsd/nsd.dsp
M	win32/nsd/nsd.vcproj

commit 9c2d7b62264f8df2ed7d67bd3e44a5e14ee6de67
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-17

    further removal of unneeded assignments

M	nsd/adprequest.c
M	nsd/fd.c
M	nsd/random.c
M	nsd/range.c
M	nsd/tclxkeylist.c
M	nsperm/nsperm.c

commit 13b90f115022967b5630092da9462384c91df9b1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-17

    remove dead assignments

M	nsd/driver.c
M	nsd/queue.c
M	nsd/range.c
M	nsd/tclsock.c
M	nsd/tclxkeylist.c
M	nsd/urlopen.c
M	nsperm/nsperm.c

commit 4aa17f071dd9ef8a6d8d121fd5bcb38ea83de396
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-17

    value of reqPtr was never used

M	nsd/driver.c

commit ed024b4ac73144282fd37214314de89e37a3d13c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-17

    Remove all warnings when compiling with clang -Wall -pedantic (mixtures between data pointers and function pointers, remove arithmetic on void*, since this is a GNU extension)

M	include/ns.h
M	nsd/callbacks.c
M	nsd/conn.c
M	nsd/pathname.c
M	nsd/proc.c
M	nsd/sched.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/tclcallbacks.c
M	nsd/tclinit.c
M	nsd/tclrequest.c
M	nsd/tclsched.c
M	nsd/url2file.c
M	nsdb/dbinit.c
M	nsdb/nsdb.c
M	nsdb/nsdb.h
M	nsdbtest/nsdbtest.c
M	nslog/nslog.c
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c

commit f7640a56b13d44eae04b6fc4002b0b2dcc333f16
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-17

    move printing macros to nsthread.h, where some more of these macros are already

M	include/nsthread.h
M	nsd/nsd.h

commit b1840936554569abebb2330d5e4237067b6c377d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-17

    adding a print macro for PRIu64 and a print macro for printing size_t

M	nsd/nsd.h
M	nsd/tclcache.c

commit 122002776cfb7f295557150a4e53b45acbfd1b45
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-17

    Define PRId64 and PRIuMAX for visual studio, as these are apparently not defined there.

M	nsd/nsd.h

commit a4a2665ebfef09070910c3da6e5aefe2bdcb9625
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-17

    avoid usage of variable names "new", "bool" and "delete"

M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/binder.c
M	nsd/cache.c
M	nsd/config.c
M	nsd/dns.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/limits.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/proc.c
M	nsd/progress.c
M	nsd/returnresp.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/tclcache.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclset.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsd/url2file.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c

commit 61a7ccc832700251b2a70d887b8037c59349b2e7
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2012-10-16

    fixed url for tcler's wiki

M	README

commit e1f708f83c0727779e0a5ab5f3fbb278ff127368
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-16

    whitespace changes

M	nsd/tclxkeylist.c

commit 7ecc5814716125f670902f53726aa67f4580bb63
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-16

    adding Maurizio's patches for removing K&R style function definitions

M	nsd/tclxkeylist.c

commit 8aee9c7633b8c4c67a7932a09e2d8d768619e310
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-16

    improve man page of ns_mutex, document "ns_mutex eval"

M	doc/src/naviserver/ns_mutex.man

commit 741f1f3e5df5e4f6df5063208e7c9a17e16ea070
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-16

    New config parameter "concurrentcreatethreshold" to control concurrent thread creation.
    Background: classical aolserver performs eager thread creation, leading to bursty thread
    creations and huge resource consumptions (e.g. a short database lock and a constant
    request stream can cause easily maxthreads to be created without helping to improve
    the situation. Furthermore, some modules have problems seem to have problem with
    parallel initializations that can lead to crashes.
    
    Naviserver can now control whether parallel connection thread creations are
    wanted or not via the degree (percentage) the request queue is full to allow
    cuncurrent connection thread createions.
    When concurrentcreatethreshold is to 0, concurrent thread creation is always allowed;
    When concurrentcreatethreshold is to 100, concurrent thread creation is not allowed;
    value inbetween allow parallel thread creations in certain stress situations.

M	nsd-config.tcl
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c
M	openacs-config.tcl

commit 0d2158ceb5355d00d08aff3daf34bb5c6584593b
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2012-10-15

    add test for fastpath cache collision
    
    The fastpath cache uses a filename as a key and verifies the freshness by
    comparing modification times.  In the rare circumstance that the contents
    of the file changes multiple times within the granularity of mtime (i.e.,
    one second) a stale version of the file can be served out of the cache.

M	tests/tclresp.test

commit 0a83ed993039e277998be0801fc57cdf26c66306
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-14

    documentation improvements

M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_ictl.man

commit 81b4bea61245f8a4dd4a35e1bc3a04e591f68817
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-13

    Add clause to continue to work on already queued requests when we might run out of requests. This clause weakens th thread exit rules determined by number of requests.
    Fix counter handling.

M	nsd/queue.c

commit 00a2c7f69f41440ffa58b43a8be49776e501d8f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-13

    correct function documentation

M	nsd/queue.c

commit 71a8188ea64e4f9812bd1b6a694a9d27b4d0e25c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-13

    protect against situations, where the driver has no server associated

M	nsd/driver.c

commit b78ad57303e7793983bb64d984bca52214dd3002
Merge: 8e668949 ceffc7b5
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2012-10-12

    merge changes

commit 8e668949d525007d6849c17ae38eacb185f7abd1
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2012-10-12

    Add NS_EXPORT to modules
    
    Recent versions of gcc include visibility attributes.  Tcl8.6
    sets the '-fvisibility=hidden' flag when building, and naviserver
    inherits this.  The effect is to keep all symbols with unspecified
    visibility hidden in shared objects.  NS modules are shared objects
    and need to export the symbols Ns_ModuleVersion and Ns_ModuleInit,
    so these declarations need to have the NS_EXPORT declaration attached
    to them.

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsdb/nsdb.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxymod.c
M	nssock/nssock.c

commit ef1c2ec8706997d7cc26632d3a56d3fa381e9e72
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2012-10-12

    Fix for parsing nested <% ... %> in adp files
    
    The previous code was counting how many levels deep the nesting of
    <% ... %> tags was, but would only count down into the first
    sequence of opening tags.  It is simpler to find the next closing tag
    after the current closing tag each time an opening tag if found before
    the current closing tag.  This handles an arbitrary nesting depth
    and non-heirarchical nesting equally.

M	nsd/adpparse.c

commit ceffc7b59da83f9bcfc1a5680341332666e132c6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-12

    add lifeliness check for bursty requests and shortlived connection threads

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c

commit 629a3810b6b94ab10f3c9ed33925868992c73e7a
Merge: b75b1d0a 35829d12
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-12

    merge

commit 35829d1215331ea261148290ff5f9ab0ed29615e
Author: ext:(%20%22Jeff%20Rogers%22) <dvrsn@diphi.com>
Date:   2012-10-11

    Add tests for nested adp parsing

M	tests/adp.test
A	tests/testserver/pages/deepnest.adp
A	tests/testserver/pages/nested.adp

commit 89f4ed5ce1d26495e2b62c7362c53b5e4f01d429
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-11

    allow parallel connection thread creation under heavy load

M	nsd/queue.c

commit b75b1d0ab7707bcbcbd0ca717752d2c49fca03a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-11

    remove some more commata from keywords

M	doc/src/naviserver/ns_adp_argc.man

commit 57e5e199d22cddaebc7833a82f6206984d40beb6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-11

    fixing keywords in documentation

M	doc/src/naviserver/ns_adp_dump.man
M	doc/src/naviserver/ns_adp_mime.man
M	doc/src/naviserver/ns_adp_mimetype.man
M	doc/src/naviserver/ns_atclose.man
M	doc/src/naviserver/ns_atsignal.man
M	doc/src/naviserver/ns_browsermatch.man
M	doc/src/naviserver/ns_crypt.man
M	doc/src/naviserver/ns_sha1.man

commit 0c538b7b78afacdc19752edcaed6e62487eaff12
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-11

    adding missing man page

A	doc/src/naviserver/ns_atshutdown.man

commit 3c5b80a85d53d8e8a45bf2216770d36945e14b52
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-11

    added missing man pages

A	doc/src/naviserver/ns_atexit.man

commit 275c1987cd51485d47e04601a43856161faac5c2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-11

    remove usage of ns_share in documentation

M	doc/src/naviserver/ns_mutex.man

commit a999ead547e72cde4d2f95e26997b01abc03f7f3
Author: jeffr <none@none>
Date:   2012-10-08

    back out accidental changes to nsconfig.h.in (?)

M	include/nsconfig.h.in

commit 46e0c5b59613e8e24a748bd95ce1ed2d971502d0
Author: jeffr <none@none>
Date:   2012-10-08

    copied nstclsh from AOLserver

M	Makefile
M	include/nsconfig.h.in
A	nstclsh/Makefile
A	nstclsh/nstclsh.c

commit 9ec985764abed90081589ef2954b752d85035ca5
Author: jeffr <none@none>
Date:   2012-10-08

    change errorLine to tcl8.6 api and add backward compatibility macro
    change definitions of NS_EXPORT for gcc >= 4 visibility attributes

M	include/nsthread.h
M	nsd/adpeval.c

commit fe257ce2167f69063957f749a505d632111d5b8c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-07

    remove some more compiler warnings when compiling under windows

M	nsd/exec.c
M	nsd/nswin32.c
M	nsd/tclcache.c
M	nsd/tclsock.c
M	nsthread/winthread.c

commit 1e7944e6c43fa4aec6566238650b1ce786733236
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-07

    use inet_pton() instead of inet_aton() if available

M	configure.in
M	include/nsconfig.h.in
M	nsperm/nsperm.c

commit 5103fcce89b5b2dae0d333ecf5f307e87191609e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-07

    use _WIN32 instead of WIN32 throughout the code

M	nsd/binder.c
M	nsd/dns.c
M	nsd/index.c
M	nsd/sockfile.c
M	nsperm/nsperm.c

commit 8573671bbd7b26ab430d9a9fa5aebf00d3c7e7d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-07

    Use ReadFile() as pread() replacement since this is atomic

M	nsd/sockfile.c

commit de0caa93df604d2e8ce3db38bca455cf59c1b114
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-06

    Fixes for compilation under windows

M	nsd/dns.c
M	nsd/index.c
M	nsd/sockfile.c
M	nslog/nslog.c
M	nsperm/nsperm.c

commit b7f688fd9c8175ef10bf09bcbca153009ca09523
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-06

    Fix spelling

M	Makefile

commit 4b7229b9211543ac35e6b1cb1d967ae2353fd9f9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-06

    Fix dummy-function when compiled without zlib support

M	nsd/compress.c

commit 5ecaee21ae6be57fc577d325b1a1bb4b8d4d6396
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-05

    Document "-concomplain" option for nsv_unset

M	doc/src/naviserver/nsv.man

commit 573bd46fa2891b8b94e00f22c08f0de2e8925cd1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-05

    Improve documentation on config files

M	nsd-config.tcl
M	openacs-config.tcl

commit 1761b49e2c4776f839be5396a395979b1ddb8a5d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-01

    revert changes that sneaked in during merge

M	nsd/tclcmds.c
M	nsd/urlencode.c

commit 9f427e3429110536bf9f4eb132a0f4e7d59b753a
Merge: fe99e0f1 f5f49b8e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-01

    merge

commit fe99e0f15b61a7072233a40f84dbde2ad74fe7f6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-01

    merged

M	nsd/tclcmds.c
M	nsd/urlencode.c

commit e11f11ca92dd07b2513f9c8b0eb9cc34a6e8ba43
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-10-01

    When the stream is already closed from the client side, don't
    kill the server via Fatal(). The stream might be already
    closed, when a huge number of requests was queued and the
    client gives up quickly.

M	include/ns.h
M	nsd/compress.c

commit f5f49b8ed3fbfc5133f4aa150bfd5bec46dd6be9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-09-17

    - update some mime types

M	nsd/mimetypes.c

commit 6aa525bd5eb7623a00232c724ba9b9d65223c52e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-07-13

    add missing file

A	include/nsconfig.h.in

commit 18463f4004405b6da41ddc7d0a883525d92f3c3d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-06-16

    Fix a memory leak when the log buffer is truncated

M	nsd/log.c

commit 9c1fc5fd359486f74bb5bf225fbc145256686185
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-06-15

    tracking locks for arrays cached in Tcl_Objs

M	nsd/tclvar.c

commit b65a1f474479f2dd52749b5adcf998e2ac1d188e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-06-12

    return in nsv_bucket additionally to each array element the lock count

M	doc/src/naviserver/nsv.man
M	nsd/tclvar.c

commit f15c9196c09470cf59f466aa6e74ab62657bb420
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-06-12

    fix macro definition logic

M	nsthread/memory.c

commit 39bb63b2a82ec666fe3ada005d90284a5f2af3c0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-06-12

    added nsv_bucket command to return names of the arrays kept in a bucket. This command is mainly useful for performance tuning, when the number of busy locks is high for a certain bucket.

M	doc/src/naviserver/nsv.man
M	nsd/tclcmds.c
M	nsd/tclvar.c

commit fe1dafee131aeacf24851a8642442c012de15201
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-06-12

    Adding missing external references

M	include/ns.h

commit b971f210224e3ff1321c3d80700b2c4319b4af54
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-06-12

    remove static RCSID strings

M	include/nscheck.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/cache.c
M	nsd/callbacks.c
M	nsd/cls.c
M	nsd/compress.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/crypt.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/encoding.c
M	nsd/event.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/filter.c
M	nsd/httptime.c
M	nsd/index.c
M	nsd/info.c
M	nsd/init.c
M	nsd/limits.c
M	nsd/lisp.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/main.c
M	nsd/mimetypes.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/nsmain.c
M	nsd/nsthread.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/pidfile.c
M	nsd/proc.c
M	nsd/progress.c
M	nsd/queue.c
M	nsd/quotehtml.c
M	nsd/random.c
M	nsd/range.c
M	nsd/request.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/server.c
M	nsd/set.c
M	nsd/sls.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/sockfile.c
M	nsd/str.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclcmds.c
M	nsd/tclconf.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/unix.c
M	nsd/url.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsd/uuencode.c
M	nsd/watchdog.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/dbutil.c
M	nsdb/nsdb.c
M	nsdbtest/nsdbtest.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxy.c
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c
M	nssock/nssock.c
M	nsthread/cslock.c
M	nsthread/error.c
M	nsthread/fork.c
M	nsthread/master.c
M	nsthread/memory.c
M	nsthread/mutex.c
M	nsthread/nsthreadtest.c
M	nsthread/reentrant.c
M	nsthread/rwlock.c
M	nsthread/sema.c
M	nsthread/signal.c
M	nsthread/thread.c
M	nsthread/time.c
M	nsthread/tls.c
M	nsthread/winthread.c

commit 55cd7e0940598b1c8079c56324d75085ec69d88b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-06-12

    Add preprocessor flag to use system malloc directly (needs as well SYSTEM_MALLOC for Tcl)

M	nsthread/memory.c

commit cee9fb4661400782be33e00809a579f6452a3c55
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-05-01

    - alter default max length of request header field from 4096 to 8192 (same value as in Apache 1.*/2.* and Tomcat 7.*)

M	nsd/driver.c
M	openacs-config.tcl
M	sample-config.tcl.in

commit 776ecaad44cd56fcb2480f4cc39cae3952cdf22a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-05-01

    - Handle error messages for too long request lines and too long header
      lines after the full request was processed. Previously client could
      experience a "broken pipe: 13" message due to the server closing the
      connection while the full request was not yet transmitted to the
      server.
    - Extended regression test

M	include/ns.h
M	nsd/driver.c
M	nsd/op.c
M	nsd/queue.c
M	nsd/returnresp.c
M	tests/http.test

commit ad219297af757076b73b23316634190cd491c35e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-05-01

    replace "vwait" by a delayed return after 2 secs, since vwait blocks sometimes

M	tests/all.tcl

commit aac8e9452e662a55d56333376899a310121db718
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-04-12

    When the stack-size is specified in the config file, try to be friendly and round the stack-size to the next multiple of the page-size (when we know how to determine it)

M	nsthread/pthread.c

commit 502b27cf4481f29a1204c8cd24dc1a4809e84a64
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-24

    fix spelling

M	nsd/form.c

commit f3f3fa30b4daf885c4c1a80a2ca338b3187d5432
Merge: a6319371 5921170e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-22

    merged versions

commit a6319371d5d7c18fe67810461f5f5a3adb96c8f4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-22

    Fix handling of escaped quotes in multi-input names (e.g. file-names
    in content disposition). Extend regression test.

M	nsd/form.c
M	tests/http.test

commit 5921170e2e7c501960c4f9f6bc4e43b6d028dd44
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-16

    Invoke the cleanup handlers (e.g. for Tls) at the end of the tests

M	tests/all.tcl

commit bb170edc70c49e3a810c9fc8e6db83d8d1a58ac6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-16

    Fix setup of environment variables for gdbtest and gdbruntest targets

M	Makefile

commit 8ea2c1706a1a85a98ba3a7551314d98e6d366cd8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-15

    Revert previous changes in tclinit.c and fix accesses to freed memory differently:
    The exact timing of the interpData depends on several factors and is
    not easy to determine. Therefore, keep the freeing if itPtr as a final
    act in this function, but make sure that DeleteInterps() does not
    stumble over freed structures. The original code missed the fact that
    GetCacheEntry() was called as well with NULL serverPtr, and was
    keeping these entries in Ns_TclDestroyInterp() in the hash table of
    existing interps, although this function deletes this interps as well
    (with its associated data). Therefore, the final cleanup could crash.

M	nsd/tclinit.c

commit 5811665574a8b6fe5c2f23a945460c86183cc8e8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-15

    prevent potential double-frees of the adp cache

M	nsd/adpeval.c

commit 019bc62bdafaf7047377db9372faa4dd45bb35c1
Merge: a642d835 1fc0be6d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-13

    merged branch

commit a642d835766008ed9658ba3e1126314fcee924f8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-13

    Avoid duplicate frees of itPtr->interp.

M	nsd/tclinit.c

commit a916057190c271f4897305e5edc02c3c52fa6267
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-13

    Fix deallocation bug. Previously, FreeInterpData() deallocated itPtr and was called before DeleteInterps(). The latter function accesses members of itPtr, reading invalid values.

M	nsd/tclinit.c

commit 1c1cd796c7f8f1b96f4b92ad718f07f21028d0d0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-13

    Further cleanup of the timeout management for writer & co. Not sure, if we do not want a finite timeout, but the current version is simply a cleanup of the version causing troubles.

M	Makefile
M	nsd/driver.c

commit 1fc0be6dc7aef755d7e99a8b4dac04594f0c2ce6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-12

    remove trailing colon in mutex name

M	nsd/server.c

commit 19d10f2b16345ac9ad54d043bc8019df0df42a4a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-12

    Simplify timeout logic for poll: the pre-existing logic could lead to negative timeouts other than -1 on the poll system call, which leads to an error (at least under mac os x 10.7.3). Since the timeout was used as a constant, make the timeout behavior explicit and set the poll timeout to -1 when intended.

M	nsd/driver.c

commit 714e1c51f55a5049566ff4f39d12c1a55ae3b45b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-12

    Provide name for metering contention rate for filter.lock; initialize mutexes for filter and pools in the server structure explicitly.

M	nsd/server.c

commit 7ff4b779ff1e1c9a47837ba7bf23e9f4477ec6fe
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-10

    finish commit for the copied variables (many thanks, Stephen!)

M	nsd/queue.c

commit 35a89f434cc8621d36884d11f35519a6bec6483b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-09

    Removed race condition on ns_log notice line

M	nsd/queue.c

commit 71b2a07e479ee8f51f2c4aa434e11897046d3716
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-09

    Fix possible race condition in filters by adding a filter specific mutex to the NsServer structure

M	nsd/filter.c
M	nsd/nsd.h

commit 5e17b69fbc1fb491474c2b4077e171b33e9f271b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-08

    remove race condition

M	nsd/queue.c

commit c5098f39329b8bb51cf7e1f2d32088fa9fb828cc
Merge: e2f96a76 2075bc29
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-08

    merge changes

commit e2f96a762f5e092b77672ddee36cb943a715c8ad
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-08

    changed memcpy() into memmove() since source and target can overlap

M	nsd/driver.c

commit 2075bc295e003f1eb367b7db9c161a0aae36cf9f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-03-06

    Fix spacing in man page

M	doc/src/naviserver/ns_thread.man

commit 73d22ad5077a30d316b998e58127c0b27c23259e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-02-17

    Fix broken man page (double escaping, weird characters, missing items)

M	doc/src/naviserver/ns_quotehtml.man

commit 742dd33b4214273b602e6c33d2de9c63a8f4f814
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-02-17

    Use "localhost" as default address to ease instructions after installing via MacPorts

M	sample-config.tcl.in

commit f0f549a083ee66fffd546187852e8d482845e4a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-16

    Completed "ns_info" man page (many subcommands were missing)

M	doc/src/naviserver/ns_info.man

commit af5c5177ec5a7ae0a3846a6d01d9b69595466b21
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-16

    Removing string "CVS" constant when referring to the built revision id

M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/nsmain.c

commit 9c14f6b8cfed2b4a107b0792f940254dc12887cc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-16

    Improve configurability of loading either XOTcl 1 or XOTcl 2 by setting the preference in aolserver-openacs.tcl; one can now load XOTcl 1 even when XOTcl 2 is configured

M	tcl/aolserver-openacs.tcl

commit 238fdfec468ca07b9efdef4b1711c6adf964cf3f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-12

    Provide value for "ns_info tag" (which was earlier from CVS) from
    either mercurial, or - for builds from a tar ball - the tar-ball
    infos. Comment configure options better, adapt regression test.

M	configure.in
M	nsd/info.c
M	tests/ns_info.test

commit 8a2c0be4ce4825f6421e97812c184db7938a66d1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-10

    Fix typo

M	tcl/nstrace.tcl

commit 497c91d7c07b6b109487a36addb721419ea87906
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-10

    Fix LD_LIBRARY_PATH for non-installed versions, make it work on macOS as well

M	Makefile

commit 3f68cb58dc4ccca80f045e53f64c87bfb6f2e755
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-09

    Deleted some more obsolete sections

M	openacs-config.tcl

commit 080699648320fb57edf4ce30b75a6fbba2a3f492
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-09

    Get rid warning about set-but-not-used variable values for modern gccs

M	nsd/event.c
M	nsd/task.c
M	nsd/tclfile.c
M	nslog/nslog.c

commit 28dab7bcec677b4ea7025873969b68da95a8a9c5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-09

    Load Tcl Thread Library if available, provide feedback via error log

M	openacs-config.tcl

commit 631c622c6aa6fb7beffc183569ee06ae08029d5e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-09

    Added DESTDIR to ease configuration with package managers (e.g. MacPorts)

M	Makefile
M	include/Makefile.module.in
M	nsd/Makefile
M	nsperm/Makefile

commit 78b84f586e3f0a4382affca19bb8110257a9b87d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-09

    Specify -lpthread for building nstrheadtest under newer Linux distributions (many thanks to Stefan Sobernig)

M	nsthread/Makefile

commit e3f3fef5a2fe5ae91b1d4f1c1577b1941b30516c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-06

    Fix quoting in sample page

M	index.adp

commit 7955ca1df9666afc799531c4ec8d63c93cad7321
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-06

    Minor markup change for default pages for sample configuration

M	bitbucket-install.tcl
M	index.adp

commit c3f7fa53f0590276ba059c612e71725dd56724ee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-06

    Changed deprecated markup by preferred one

M	doc/src/header.inc
M	doc/src/naviserver/ns_adp_registeradp.man
M	doc/src/naviserver/ns_adp_registertag.man
M	doc/src/naviserver/ns_register_adptag.man
M	doc/src/naviserver/ns_register_fastpath.man
M	doc/src/naviserver/ns_register_filter.man
M	doc/src/naviserver/ns_register_proxy.man
M	doc/src/naviserver/ns_register_url2file.man

commit dc5c6de3bba2209792c920312da66242313ec894
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-06

    Updated config files

M	openacs-config.tcl
M	sample-config.tcl.in

commit 6ceeddfd3649e1845ee430472f67fbfc25cbc033
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-06

    Initial checkin of simple installer from Bitbucket (requires wget)

A	bitbucket-install.tcl

commit e11997c97f2cbb738ca216682f89e7e771112ec3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-06

    Beautify page, add simple mechanism for adding referenced modules

M	index.adp

commit a10952dcbaddd087c20d8a4b62958d04b5ab773f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-06

    Added openacs-config.tcl to files placed into ../conf/ directory in installation; added bitbucket-install.tcl to files in distribution/installation (referenced by index.adp)

M	Makefile

commit e28c7560272e0c5e4d6538be4e9993e14d5f5c3b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-06

    Install contrib-logos in doc

M	Makefile

commit 907c18bdfdaba30624f32bdcf64387414270e0f3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-06

    Fix man page

M	doc/src/naviserver/ns_httpget.man

commit f92cd831e30d9e8ca0b49d0cf3ad775f619ba1ab
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-05

    Fixed test to use preferred getaddrinfo()/getnameinfo() for macOS instead of gethostbyaddr()/gethostbyname() when working
    under the OS release.

M	NEWS
M	m4/dns.m4

commit 47892fcd49a71affa141b0983062c64be04464d6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-05

    Make compilation clean under clang, some code cleanups

M	NEWS
M	nsd/tclmisc.c
M	nsdb/dbtcl.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c

commit 30b288e777eb1cfbb7222ef6dce43f60d91424e5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-05

    Added missing file version_include.man.in into distfiles

M	Makefile

commit 3901ebb25af46a526351e789cf0b1ffbf1699cfb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-05

    Fixed documentation rendering

M	doc/src/naviserver/ns_cache.man

commit 6030d45eea1c7029f9fb9127cb99228cc0e95a2f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-05

    Fixed typo in NEWS file

M	NEWS

commit 66358d7d277edc3ce2139528c6d40ef99004d27a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-05

    Updated description of new features

M	NEWS

commit b1c58cd87b16e1522d4dd5e14fb501f745625f36
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-05

    Bumped version number to 4.99.4
    Provided support for platforms where time_t is long (e.g. macOS 10.7)
    Don't set Ns_Time.usec to LONG_MAX, since this is outside the expected range in Ns_AdjTime()

M	README
M	configure.in
M	nsd/driver.c
M	nsproxy/nsproxylib.c

commit 9679b1ffb810b209806e29bc26490abb26b538e0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-05

    Remove non-existing flag

M	autogen.sh

commit 530b97e0cc7c91c895cc9fe8714a82f7f9cd2d7b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-05

    Added test for crash in earlier versions

M	tests/http.test

commit 5d4433ed28c4ba6c40fefa5d17cb2e33d68e229d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-04

    Added parameters "keepalivemaxuploadsize" and
    "keepalivemaxdownloadsize" for controlling keep-alives for largish
    content. Since keep-alives causes sequentialization of requests, the
    upload/download of large content delays the start of transfer of later
    content sent over the same request queue. In such cases, parallel
    requests avoid these latencies.
    
    This feature is by default turned off (both values have the default of 0).

M	nsd-config.tcl
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	openacs-config.tcl

commit 39ce7a2506f719be109ec16650f25a77310d8ab4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-04

    Preallocated (warm) threads, less eager thread creation:
    
    Background: the bookkeeping of available/running threads did not
    account for threads already being created. This lead to situations
    where on peak loads (e.g. 5 more requests in the queue, all threads
    busy an arbitrary number of new threads was scheduled to be created,
    causing a heavy burden on the server. Often, when the threads are were
    ready and running, the queue situations was already quite different
    (often empty). This situation could be as observed as bulky thread
    creations and happened e.g. on file-system latencies (e.g. ext3 has
    several potential problems in this area).
    
    The changes correct bookkeeping and avoid the overeager thread
    creation by sequentialization of thread creates. Furthermore, it
    pre-initializes threads such that only initialized threads are in the
    waiting list (important, when thread create operations are expensive,
    e.g. on large blueprints). This reduces waiting time for clients
    esp. on multiprocessor/multicore machines.  The server uses
    "minthreads" to control how many pre-initialized connection threads
    should be maintained.

M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c
M	openacs-config.tcl

commit f938415a2e5f636c3834c28e4b853daa9f32fab1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-03

    Altered the default in the annotated config file (openacs-config)

M	openacs-config.tcl

commit a233901acf0e60944c8c71583a6f316ea0bdec7d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-03

    changed default dor keepwait to 5 seconds as suggested by Stephen

M	nsd/driver.c

commit 43967fbb2710ad42ecf3deeb70297dfda9420e34
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-03

    New configure parameter "spread" (for the section server/${server} )
    to randomize thread recreation.
    
    Background: Requests are distributed to idle threads via CondSignal,
    which delivers subsequent signals to idle threads in a circular manner
    (i.e. thread t1, t2, .. tn, then t1 again) determined by the
    scheduling policy of the operating system. This round robin behavior
    has the consequences, that (a) the idle timeout will never be used on
    a sufficiently busy (server since round robin wakes it up regularly),
    and (b) the connsperthread value will be the same for every thread
    (every thread will get the same numbers of requests).  As a
    consequence, multiple threads terminate about at the same time. This
    mass termination of threads is performance-wise bad, since these
    threads will be restarte as well at about the same time. This is
    especially bad when many connections threads are configured
    (e.g. 100), since it is likely that about the same amount of threads
    will be recreated.
    
    The "spread" parameter introduces a random factor into threadtimeout
    and maxconnections to avoid these termination cycles. It adds +/-
    the specified percentage to maxconnections and threadtimeout (e.g. a
    spread of 20 means a random value between 0.80 to 1.20 of the
    specified value of maxconnections and threadtimeout for every
    connection thread).

M	nsd/queue.c
M	openacs-config.tcl

commit eb1b29c0dbf1e054a78af2d2b322916634098ef2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-03

    Update regression test for ns_cache_stats "saved"

M	tests/ns_cache.test

commit b82460554143ae21d7d509b80e4aa9ec69275e37
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-03

    Added "saved" statistics to ns_cache_stats (total saved time in secods based on computation time for the entry when it was added).
    Let "ns_cache_eval" pass TCL_CONTINUE and TCL_BREAK back to Tcl.

M	include/ns.h
M	nsd/cache.c
M	nsd/dns.c
M	nsd/tclcache.c

commit ae28644246be12d44d6d26fc15e4906174a00ba7
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-03

    Reduce default keepwait to 2 seconds (similar to what's recommended for apache with large sites)

M	nsd/driver.c

commit 3d4870e3cccc8439544e91df106e7c96a9252540
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-03

    Added a test that lead to a crash in earlier versions

M	tests/http_byteranges.test

commit 18600bafa824204b8a5b58ad835894f160191b2a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-03

    Placed nstest_http and friends into namespace ::nstest (making this ::nstest::http).
    Added "-verbose" flag to  nstest::http to trace communication

M	tests/adp.test
M	tests/cookies.test
M	tests/encoding.test
M	tests/errordoc.test
M	tests/http.test
M	tests/http_byteranges.test
M	tests/http_chunked.test
M	tests/http_keep.test
M	tests/ns_adp_compress.test
M	tests/ns_conn_host.test
M	tests/ns_pagepath.test
M	tests/ns_register_filter.test
M	tests/ns_register_proc.test
M	tests/ns_serverpath.test
M	tests/ns_sls.test
M	tests/tclconnio.test
M	tests/tclresp.test
M	tests/testserver/modules/testhttp.tcl
M	tests/testserver/modules/vhost.tcl
M	tests/timeout.test
M	tests/url2file.test

commit 501fd13eb32da3c8c3c87707e5c23c60a2ea7c9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-03

    Namepaced variable persist in blueprints. Why should this be different here?

M	tests/init.test

commit 01f44188787604f8f7c21fdf3e2db1e616bddf29
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Load NX only if not running under the testserver (otherwise we see ugly messages upon exit)

M	tcl/aolserver-openacs.tcl

commit 1898b06d16eb0d377f70e2d1d49b4efd69ef236f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Added config parameter "isTestServer" to make recognizable if one runs a script under the testserver

M	tests/test.nscfg

commit 551b49447519dc0d962a3b7894f81df3b682962b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Make ns_upload_stats compliant with the conventions from  nginx, lighttpd and by apache (mod_passenger) - and javascript files supporting this convention. This enhancement makes uploads in progress identifiable via the query parameter "X-Progress-ID". If present, use the value as key, otherwise use url + query (as before).

M	doc/src/naviserver/ns_upload_stats.man
M	nsd/progress.c

commit 69400d4669e54779f08db39b9db0dd7878e98b8f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Added nsproxy to default configuration

M	openacs-config.tcl

commit 238f6f62e8516228e11dd34438743857806534a9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Fix typos

M	NEWS
M	nsd/log.c

commit b92ddc3bc646484b71c23fa69ce8e5c5e417ea7c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Fix typo in comment

M	nsd/conn.c

commit 91ff9826cc4a4773b2a2698bcaa22ac6c7ff4de3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Added Editor hints for Tcl mode
    Removed $Header$ lines

M	tests/adp.test
M	tests/all.tcl
M	tests/compat.test
M	tests/cookies.test
M	tests/encoding.test
M	tests/errordoc.test
M	tests/http-test-config.tcl
M	tests/http_byteranges.test
M	tests/http_chunked.test
M	tests/http_keep.test
M	tests/init.test
M	tests/ns_accesslog.test
M	tests/ns_addrbyhost.test
M	tests/ns_adp_compress.test
M	tests/ns_base64encode.test
M	tests/ns_cache.test
M	tests/ns_config.test
M	tests/ns_conn.test
M	tests/ns_conn_host.test
M	tests/ns_crypt.test
M	tests/ns_env.test
M	tests/ns_gifsize.test
M	tests/ns_hashpath.test
M	tests/ns_hostbyaddr.test
M	tests/ns_hrefs.test
M	tests/ns_httptime.test
M	tests/ns_info.test
M	tests/ns_jpegsize.test
M	tests/ns_limits.test
M	tests/ns_log.test
M	tests/ns_mime.test
M	tests/ns_nsv.test
M	tests/ns_pagepath.test
M	tests/ns_parseargs.test
M	tests/ns_proxy.test
M	tests/ns_register_filter.test
M	tests/ns_register_proc.test
M	tests/ns_schedule.test
M	tests/ns_serverpath.test
M	tests/ns_set.test
M	tests/ns_sha1.test
M	tests/ns_sls.test
M	tests/ns_thread.test
M	tests/ns_urlencode.test
M	tests/ns_uuencode.test
M	tests/nsdb.test
M	tests/progress.test
M	tests/tclconnio.test
M	tests/tclresp.test
M	tests/testserver/modules/init-test.tcl
M	tests/testserver/modules/testhttp.tcl
M	tests/testserver/modules/vhost.tcl
M	tests/testserver/pages/helloworld.adp
M	tests/testserver/pages/helloworld.tcl
M	tests/timeout.test
M	tests/url2file.test

commit 7857a6c20791ee31da1ac6202682748525db2b75
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Read the whole content of requests which are too large

M	nsd/driver.c

commit 7bcb1b84680051fb9893428a5ea8831da4bfc34b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Add test substantially larger than maxinput

M	tests/http.test

commit 09505c885f4c411a6155d8cb2f3064352ce41c7e
Merge: 3687d447 4baacea9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Merged versions

commit 3687d447e483d5a60a019dfa0687fc4f2ff8bc1e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    remove debug output

M	nsthread/thread.c

commit 4baacea92657aa1406206dd03a92d32ba10e0ddc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Added *.dylib to ignored files

M	.hgignore

commit 8d5130c39ee16709ff57f6d14adfc36d707d6b9a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    Ease configuration of logfiles

M	openacs-config.tcl

commit 48506600363f7daf5be37b4c3ecbe45637936365
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-02

    When keep-alive is set and more requests are already in the request queue, don't timeout but process the requests immediately.

M	nsd/driver.c

commit 5aee2b470a8f7c0cecdfda03348f4b499d67190d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-01

    Add editor hint for Tcl mode

M	tests/test.nscfg

commit 225b513ed3ba73a220127e46a3250052ffad96c8
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-01

    Deactivate seemingly unused parameter "flushcontent"

M	nsd/server.c

commit b64d8e7d2548b9ea78ece6c01da0edf10aa33c23
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-01

    Improved comments

M	nsd/connio.c

commit 1c2aef789fb66b9e0ebc5ca3b48d28a6a517a923
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2012-01-01

    Overworked sample script for OpenACS (deleted obsolete parameters,
      added undocumented ones, commented parameters, added default
      values), esp. on sections
        * ns/server/${server}
        * ns_section ns/server/${server}/redirects
        * ns_section ns/server/${server}/adp
        * ns_section ns/server/${server}/module/nssock
        * ns_section ns/server/${server}/module/nslog

M	openacs-config.tcl

commit 368d831e50176bc012ebd2a1344476dba5973f3f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    Added test case for format used in macOS WebDav client in PUT operations with chunked encoding

M	tests/http_chunked.test

commit 0fff8431bcad7e926d2a6bb2f8a45eb1f1b0e8b3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    Added option "-omitcontentlength" to nstest_http for testing for uploads with chunked encoding

M	tests/testserver/modules/testhttp.tcl

commit 5fdc5ae28ba05785db525b4dd5a891bf61fa7682
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    Fix setting of new severity level (e.g. in all.tcl, "ns_logctl severity DriverDebug true")

M	nsd/log.c

commit cf482c57ba2b13f7c65b2bef7349976bdc3e60ea
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    Revert escaped changes

M	tests/all.tcl
M	tests/init.test
M	tests/test.nscfg

commit 9d4a9f1ef979d9d50346511f0b06f619c46ddf53
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    Make handling of XOTcl/NX more explicit

M	tcl/nstrace.tcl
M	tests/all.tcl
M	tests/init.test
M	tests/test.nscfg

commit 78fb0d59cf746bd21ffe5bb4d7c1d62c018d4296
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    Fix race condition for handling of too large requests. The original
    code handled overlarge requests directly in the driver by sending an
    413 status code directly to the client and closes then the
    connections. In this case, it might happen that the close happens
    *before the complete request was sent* to the server. Many clients
    (e.g. firefox) will show in this case an error message that the server
    has closed unexpectedly the connection while sending the request.

M	include/ns.h
M	nsd/driver.c
M	nsd/op.c
M	nsd/queue.c
M	nsd/returnresp.c
M	nsd/tclresp.c

commit 7b01af551a1ae0c64dd8b45bbac53078b5a1241c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    Make code more silent

M	nsthread/thread.c

commit a4901bf3ac226afc23e170ba8756df2686c79092
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    Fir behavior during "make test", for cases, where xotcl.tcl was not yet installed

M	tcl/aolserver-openacs.tcl

commit e8cdaae06a4501739c48d14197cbf5ef61f0e977
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    - omit test for Darwin

M	tests/ns_hostbyaddr.test

commit 54326cd5c993fdd53ffd8daa9bcb684bf65cf597
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    - fix test

M	tests/ns_thread.test

commit 114b11a7f09340a1dbe7e82fd9acdd736607613e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    In case the two arguments of NsTclParseArgsObjCmd() are shared, decouple these. otherwise the type conversions of Tcl_ListObjGetElements() and Tcl_ConvertToType() would overwrite the internal representation

M	nsd/tclobjv.c

commit 93791e1524261679e94cfc0753dc87fb429e83cc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-31

    Adding missing decoding of log severity

M	nsd/log.c

commit 1633146630a89724774330f780d9010904a79253
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    regularize spacing for function calls

M	nsd/tclmisc.c

commit d4945b86a8a6d322839232ba520a798036a72aff
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    reduce scope of variables

M	nsd/adpparse.c

commit d588fab2c524ab17d5ad21932fcbe96bdb270b9c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    avoid compiler warning for unused variables

M	nsd/binder.c

commit 002f1c5c4979a4bfb4d1198b7e32ce5476f83be3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    Avoid compiler warnings about uninitialized variables

M	nsd/tclrequest.c

commit ccdebb2b0dfbbf86d286f6ff910b1aa9c9c8281c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    avoid compiler warnings for uninitialized variables

M	nsd/tclcache.c

commit cee7011cc37e85ca63be0186ff6b912df6717c41
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    reduce scope of variable

M	nsd/unix.c

commit e93d36c37d696d82f789b8193827c4f6d3a2783c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    Avoid compiler warnings about uninitialized variables

M	nsd/url2file.c

commit 8bb21605917624f316b60b316f5417356e2bad19
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    Fix test

M	tests/ns_cache.test

commit 8a0ea4c50e441e7abb8877cbdfceb2be0e7f2e6f
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    Reduce scope of variable

M	nsd/tclimg.c

commit 0804ea169dcfd5deb74dd3149c97b31d9d0f339b
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    Fix typo in comment

M	nsd/encoding.c

commit 43cfae36669873d83c5b587168b9ce29193c123a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    Fix typo, warning about unused var

M	nsd/dns.c

commit 8eb2d4dad8e562d387bf167ef2a0444990b897d2
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-30

    Add nstrace script working for XOTcl 1.* and XOTcl 2.*/NX

M	tcl/nstrace.tcl
A	tcl/nstrace.tcl-head

commit 6c92d7265883ac49d5aaa1d385ab99562e454ca4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-29

    Added aolserver compatibility layer for OpenACS

A	tcl/aolserver-openacs.tcl

commit f026978d5e65380f64f3a2c45d83436d45250f31
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-29

    Added config file for OpenACS

A	openacs-config.tcl

commit 25b6efcdb174a26b80fbadad484ccd77f8fa01f5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-29

    Remove obsolete config parameters "urlstats" and "maxurlstats"

M	nsd-config.tcl

commit a79bb7ea99b89343aefe7b35a93a4876a3634cac
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-29

    Remove unused parameter "globalstats"

M	nsd-config.tcl

commit 1eb7baee684fb6b24d1f5a1f6ccdd4d620dbbf88
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-29

    Remove traces of unused config parameter "maxdropped"

M	doc/src/manual/admin-tuning.man
M	tests/http-test-config.tcl

commit 88f0b5a208d3ce6dbde198a24515a1f43ee5717d
Merge: 212829de 1cf2d8a6
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-29

    - merged versions

commit 212829deb71b1bb3ff82e5070367054ce0a2332a
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-12-29

    - deavtivate unused driver parameter "keepallmethods"; should be probably removed

M	nsd/driver.c

commit 1cf2d8a60827ce1d29a0989ec1b2ab63bb96d204
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-10-27

    - don't set stderr by default to linebuffered

M	nsd/log.c

commit c5ed7db3ebd9e0a9005ccd3a75cbec765b4256c6
Merge: 391def3e 375cdf91
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-10-27

    - merged versions

commit 391def3e2f9855ce606f3464acca6e02f7145d2e
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-10-27

    - added total_waiting_time and max_waiting_time to the mutex monitoring statistics

M	nsd/log.c
M	nsthread/mutex.c

commit 375cdf914edeb0801efa34c7bb83889bfe40398c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-09-13

    - revert escaped change

M	nsd/log.c

commit 54cdae5b38854808d80cb6032952a48f75a78bb5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-09-13

    - improve concurrency: get rid of long mutex locks on writes to the access log. We obseverd per day often blocking times on a single mutex call larger than several seconds due to filesystem latencies. THis change moves the write operation out of the mutex lock if possible (small enough to guarantee atomic writes)

M	nsd/log.c
M	nsd/nsd.h
M	nslog/nslog.c

commit d1256bf391c99a102a2cca91747772fb3af57603
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-08-06

    Code Cleanup:
    - changed types of file descriptors for socket from "int" to "SOCKET"
    - remove superfluous semicolons
    - moved local variables to the nearest scope
    - commented out noop-code
    - commented set but unused variables

M	include/ns.h
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/event.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/index.c
M	nsd/log.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/pidfile.c
M	nsd/queue.c
M	nsd/rollfile.c
M	nsd/set.c
M	nsd/sock.c
M	nsd/str.c
M	nsd/task.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tcljob.c
M	nsd/tclsock.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/unix.c
M	nsd/urlopen.c
M	nsd/urlspace.c

commit cd444cb29c9e632279a75794eccc5fce84d8fbc3
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-04-11

    Naviserver did loop under linux in some situations where a client connection
    was closed unexpectedly (observed under vmware under intel 64bit).
    Treating HUPs explicitly fixed this problem.

M	nsd/driver.c

commit c4a26a48e6acf2fbbb170323b131bfb70a6b3f33
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-04-11

    Use poll() as well under Darwin. Per default, poll() returns writable even when
    the socket is not. However, setting SO_SNDLOWAT fixes this (added by this patch).
    The change makes it possible to quer POLLHUP for all platforms.
    Make sure to run autogen.sh on macOS to rebuild configure etc.

M	configure.in
M	nssock/nssock.c

commit c11ba85d931219a5642b6389d2905d5f6c5a13b5
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-03-03

    Fixed another crash on POST requests, where the mmaped file
    ends exactly at a page boundary.

M	nsd/driver.c

commit 2baa95f6cb4d54f2e4f53cef364d5cd999817871
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-03-03

    - Fixed a crash when the content of a POST is mmapped and the script
       tries to access "ns_conn content" after a connection close.
       Example script:
       ======
         ns_returnunauthorized
         ns_conn content
       ======
       To access the content is probably a bug in the script, but it
       should not crash the server.

M	nsd/conn.c
M	nsd/form.c

commit ef4aa28690245f0cc1d8f6a93455ddbf0497dea9
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-03-01

    - Fix potential crash (analysis and example by Christoph Haberberger)
      The following query crashes Naviserver without this patch:
        GET /robots.txt HTTP/1.0
        Range: bytes=1-1,3-3,5-5,7-7,9-9

M	nsd/range.c

commit 311537279a8c3b093b3cfb77963c539bb2cbb172
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-02-22

    - change statistics counters from int to long

M	nsd/cache.c

commit ccb873957f4bdc09a7efac27d06424c9bb993655
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2011-01-28

    - fix a crash during concurrent nscache_evals, when the purge for one new entry
      deletes new-born (but not yet finished) entries of some other threads.
      This happens easily, when a huge entry is added, which prunes the full cache.

M	nsd/cache.c

commit cac29d13f7ec76ef38d4953f4f8753989643efcb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-12-03

    - add omitted prototype

M	include/nsthread.h

commit 5991caa8b83b87b224339f024ecb7a6c7fbc69d4
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-12-03

    - make compilation clean under non-linux platforms

M	nsthread/pthread.c

commit e954ce5092c604b46f7b72af82a0b56cb6b9e1e1
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-12-03

    - make compilation clean

M	nsthread/thread.c

commit 5e4f3fe99e03837a0afaa8265944ec224284c9bc
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-11-30

    - added [ns_thread stackinfo] to obtain size and usage information from the current thread

M	doc/src/naviserver/ns_thread.man
M	nsd/tclthread.c
M	nsthread/thread.c

commit 198c1eef26f195d6e5da9f60a0b41fc16ff5b384
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-09-10

    Quick fix to disallow terminal escape characters in the log file

M	nsd/cache.c
M	nslog/nslog.c

commit 09bc2b12efee9395bb45cbe226931d9b4738b2ca
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-06-04

    Avoid storage overwrites on 64 bit machines.
    
    GetSeverityFromObj() is based on Ns_TclSetOpaqueObj() which returns a
    pointer (on a 64-bit machine a 64bit quantity).  If
    sizeof(Ns_LogSeverity) is smaller than the pointer which is
    overwritten, passing &severity will lead to an overwrite of the
    vicinity and invalid values in severity.

M	nsd/log.c

commit b46668863772aafdb1814106d9be969687d8a64c
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-06-04

    Improve wording in comment

M	nsd/tclcache.c

commit 62402ea150efc386c168ebed305e81f062b31312
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-05-30

    add option "-exact" to ns_cache_keys to enable exact lookups also in cases where glob characters are used in keys

M	doc/src/naviserver/ns_cache.man
M	nsd/tclcache.c

commit 2ee6d139a47d7f08fa4ca96d77f9c9b174ef5077
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-05-29

    Provide constat time lookup for "ns_cache_keys cache pattern", when "pattern" contains no glob characters

M	nsd/tclcache.c

commit a3e0456cb91ab2f9a6b0aacfc253bc37ae219f22
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-04-27

    Provide names for Ns_Mutex to report meaningful output in naviserver statistics

M	nsd/limits.c
M	nsd/tclinit.c

commit 88298c425528bb345057cb2fed95f0865622bcb0
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-04-27

    fix typo in error message

M	tcl/http.tcl

commit 596f5a996be82654baaf2db43cf03e13fab4ac79
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-04-26

    Fix signedness of format statements in output messages of NsGetScheduled().
    Problem showed up on 64bit POWER6 architecture under Linux

M	nsd/sched.c

commit 526ac2c76bf5b2a159853292d6aeafbb9897ceeb
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-04-14

    Minor cleanup for unexpected client closes

M	nsd/driver.c

commit d8f518999c20810dce25ae3cf4a584a6602d9fd2
Merge: b81ec12d ba63b847
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-04-13

    Merged Zoran's changes

commit b81ec12d066926f36580af66d917c4c7b9b9c64d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-04-13

    Provide Chunked Encoding support for incoming requests
      * Shortcomings:
         a) for chunked encodings, spooling to files is turned off (since decoding happens in memory)
         b) chunked encodings still require X-Expected-Entity-Length to terminate reliably

M	nsd/driver.c
M	nsd/nsd.h

commit 988a76359f6c62f42515dc95ebda515f5922ca45
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-04-12

    Correct fix for blocking DriverAccepts when acceptsize>1 on 64-bit machines
      * undo commit 3963e46562e8
      * set argument for ioctl FIONBIO to int
      * fix for bug http://www.mail-archive.com/naviserver-devel@lists.sourceforge.net/msg02210.html

M	nsd/driver.c
M	nsd/sock.c

commit 23146f9f0a742c5f4b72e3277794a5b20deb7d28
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-04-11

    patch to let driver return nonzero content for PUT requests with chunked encoding

M	nsd/driver.c
M	nsd/nsd.h

commit 2e0343cb7a4d4082d1079f4514e4f592c905b6ee
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-04-11

    - Fix to prevent multiple DriverAccepts on the same socket. The original coded relied on the fact that later accepts
      lead to an ERROR_STATE. Under RHEL 4 (Power, 64bit) the second accept blocks.

M	nsd/driver.c

commit 1a4718c63f4ac70232241992804cd92a5445460d
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-04-11

    - change for MAC OS X (observed with 10.6.3): kern.maxfiles might return a number larger than OPEN_MAX. In this case,
      one might observer a warning like e.g. "fd: setrlimit(RLIMIT_NOFILE, 12288) failed: Invalid argument"

M	nsd/fd.c

commit ba63b8476bf52ba1989295f6d242f7147fe96a47
Merge: 1db5a1d9 510fe0b7
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2010-03-08

    Merged Gustf's changes

commit 1db5a1d9e7213b246aad613fbe685c38c74a1beb
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2010-03-08

    Implements "kill" with some basic functionality.

M	nsthread/winthread.c

commit 87ae170449abe7cb476fd46745a81a05e7706c8d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2010-03-08

    Added private version of NsBsearch and re-define the "bsearch"
    to point to it for Windows builds. We found the Windows
    implementation of bsearch to be buggy.

M	nsd/index.c

commit 20d367a0e50edc9f27365e14b949545753b88f34
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2010-03-08

    Added some includes for Windows port

M	nsd/dns.c

commit 19099dc8ec19133b9743ed274ac5cab3f8d0bdac
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2010-03-08

    Open the log file with O_LARGEFILE if defined

M	nsd/log.c

commit c0b612273f4990be210754d7ef31971bb630811a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2010-03-08

    The section/key/value et.al. may be passed as NULL
    so make sure to handle that properly when passing
    the values to Ns_Log. The Ns_Log implementation on
    some platforms cannot handle NULL arguments passed
    over varargs.

M	nsd/config.c

commit 510fe0b75d903b739c2208d8c3bd07d1c614e933
Author: Gustaf Neumann <neumann@wu-wien.ac.at>
Date:   2010-03-07

    let "nscache eval" allow one to return TCL_BREAK and TCL_CONTINUE to tell
    naviserver from tcl to omit caching of the returned result

M	nsd/tclcache.c

commit 02d8b47910c7fdbc71655d1c53a0e1cb77ab8dbc
Author: Gustaf Neumann <neumann@wuu-wien.ac.at>
Date:   2010-03-07

    - protection against path traversal attack

M	nsd/urlencode.c

commit f8c9bbcf74540e1ce7f03b2d2a2c088516c1f842
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2010-03-06

    Rewritten cancellation logic. Cancelled jobs stay in the queue and
    get run on the thread as any other jobs. The difference is only that
    we mark the cancellation state early (even before running the script)
    so the very first Tcl command in the script will be cancelled thus
    resulting in whole job cancellation. This fixes some weird races.

M	nsd/tcljob.c

commit 78477c54b47abcd50ee012f03cdc113d8c66a672
Author: vlad@video.mpower.net <vlad@video.mpower.net>
Date:   2009-07-15

    Fixed sendmsg/recvmsg in binder for x64, it requires to use standard macros for accessing structure

M	nsd/binder.c

commit 2ea9d33749625dcee318edf5e39a95e0d653475b
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-03-17

    Change ns_parseargs syntax for script into native Tcl style, before it's been something weird and never been mentioned so
    i assume nobody used it much, so now it will be in the form {[..]}, like
    ns_parseargs {-flag {[script]}} $args

M	nsd/driver.c
M	nsd/tclobjv.c
M	tests/ns_parseargs.test

commit 5443ac61eed16a5b992638d23cddb3d48a363369
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-03-16

    Updated documentation abour new repository, use common include in all docs, moved module specific docs under each module

M	Makefile

commit 096dcb9bac8a90f8a62b36488c804df4b9de6902
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-03-16

    Updated documentation abour new repository, use common include in all docs, moved module specific docs under each module

M	Makefile
M	configure.in
M	doc/src/man3/Ns_Sls.man
R099	doc/src/docs/admin-db.man	doc/src/manual/admin-db.man
R089	doc/src/docs/admin-install.man	doc/src/manual/admin-install.man
R098	doc/src/docs/admin-maintenance.man	doc/src/manual/admin-maintenance.man
R099	doc/src/docs/admin-tuning.man	doc/src/manual/admin-tuning.man
R099	doc/src/docs/adp-overview.man	doc/src/manual/adp-overview.man
R099	doc/src/docs/c-driverdb.man	doc/src/manual/c-driverdb.man
R099	doc/src/docs/c-urlspace.man	doc/src/manual/c-urlspace.man
R099	doc/src/docs/main-faq.man	doc/src/manual/main-faq.man
R099	doc/src/docs/main-features.man	doc/src/manual/main-features.man
R098	doc/src/docs/main-history.man	doc/src/manual/main-history.man
R099	doc/src/docs/main-standards.man	doc/src/manual/main-standards.man
R098	doc/src/docs/tcl-lib-file.man	doc/src/manual/tcl-lib-file.man
R099	doc/src/docs/tcl-lib-nstrace.man	doc/src/manual/tcl-lib-nstrace.man
R099	doc/src/docs/tcl-libraries.man	doc/src/manual/tcl-libraries.man
R099	doc/src/docs/tcl-overview.man	doc/src/manual/tcl-overview.man
M	doc/src/naviserver/commandlist.man
M	doc/src/naviserver/keyl.man
M	doc/src/naviserver/ns_addrbyhost.man
M	doc/src/naviserver/ns_adp.man
M	doc/src/naviserver/ns_adp_abort.man
M	doc/src/naviserver/ns_adp_append.man
M	doc/src/naviserver/ns_adp_argc.man
M	doc/src/naviserver/ns_adp_argv.man
M	doc/src/naviserver/ns_adp_bind_args.man
M	doc/src/naviserver/ns_adp_break.man
M	doc/src/naviserver/ns_adp_ctl.man
M	doc/src/naviserver/ns_adp_debug.man
M	doc/src/naviserver/ns_adp_dir.man
M	doc/src/naviserver/ns_adp_dump.man
M	doc/src/naviserver/ns_adp_eval.man
M	doc/src/naviserver/ns_adp_exception.man
M	doc/src/naviserver/ns_adp_include.man
M	doc/src/naviserver/ns_adp_info.man
M	doc/src/naviserver/ns_adp_mime.man
M	doc/src/naviserver/ns_adp_mimetype.man
M	doc/src/naviserver/ns_adp_parse.man
M	doc/src/naviserver/ns_adp_puts.man
M	doc/src/naviserver/ns_adp_register.man
M	doc/src/naviserver/ns_adp_registeradp.man
M	doc/src/naviserver/ns_adp_registerproc.man
M	doc/src/naviserver/ns_adp_registertag.man
M	doc/src/naviserver/ns_adp_return.man
M	doc/src/naviserver/ns_adp_safeeval.man
M	doc/src/naviserver/ns_adp_stats.man
M	doc/src/naviserver/ns_adp_tell.man
M	doc/src/naviserver/ns_adp_trunc.man
M	doc/src/naviserver/ns_after.man
M	doc/src/naviserver/ns_atclose.man
M	doc/src/naviserver/ns_atsignal.man
M	doc/src/naviserver/ns_base64decode.man
M	doc/src/naviserver/ns_base64encode.man
M	doc/src/naviserver/ns_browsermatch.man
M	doc/src/naviserver/ns_cache.man
M	doc/src/naviserver/ns_cancel.man
M	doc/src/naviserver/ns_chan.man
M	doc/src/naviserver/ns_charsets.man
M	doc/src/naviserver/ns_checkurl.man
M	doc/src/naviserver/ns_choosecharset.man
M	doc/src/naviserver/ns_cond.man
M	doc/src/naviserver/ns_config.man
M	doc/src/naviserver/ns_conn.man
M	doc/src/naviserver/ns_conncptofp.man
M	doc/src/naviserver/ns_cookie.man
M	doc/src/naviserver/ns_cookiecharset.man
M	doc/src/naviserver/ns_cookietime.man
M	doc/src/naviserver/ns_critsec.man
M	doc/src/naviserver/ns_crypt.man
M	doc/src/naviserver/ns_encodingforcharset.man
M	doc/src/naviserver/ns_encodingfortype.man
M	doc/src/naviserver/ns_env.man
M	doc/src/naviserver/ns_event.man
M	doc/src/naviserver/ns_filestat.man
M	doc/src/naviserver/ns_findset.man
M	doc/src/naviserver/ns_fmttime.man
M	doc/src/naviserver/ns_formfieldcharset.man
M	doc/src/naviserver/ns_ftruncate.man
M	doc/src/naviserver/ns_getform.man
M	doc/src/naviserver/ns_getformfile.man
M	doc/src/naviserver/ns_geturl.man
M	doc/src/naviserver/ns_gifsize.man
M	doc/src/naviserver/ns_gmtime.man
M	doc/src/naviserver/ns_guesstype.man
M	doc/src/naviserver/ns_hashpath.man
M	doc/src/naviserver/ns_hostbyaddr.man
M	doc/src/naviserver/ns_hrefs.man
M	doc/src/naviserver/ns_htmlselect.man
M	doc/src/naviserver/ns_http.man
M	doc/src/naviserver/ns_httpget.man
M	doc/src/naviserver/ns_httpopen.man
M	doc/src/naviserver/ns_httppost.man
M	doc/src/naviserver/ns_httptime.man
M	doc/src/naviserver/ns_ictl.man
M	doc/src/naviserver/ns_imgmime.man
M	doc/src/naviserver/ns_imgsize.man
M	doc/src/naviserver/ns_imgtype.man
M	doc/src/naviserver/ns_info.man
M	doc/src/naviserver/ns_internalredirect.man
M	doc/src/naviserver/ns_issmallint.man
M	doc/src/naviserver/ns_job.man
M	doc/src/naviserver/ns_jpegsize.man
M	doc/src/naviserver/ns_kill.man
M	doc/src/naviserver/ns_library.man
M	doc/src/naviserver/ns_limits.man
M	doc/src/naviserver/ns_localtime.man
M	doc/src/naviserver/ns_locationproc.man
M	doc/src/naviserver/ns_log.man
M	doc/src/naviserver/ns_memoize.man
M	doc/src/naviserver/ns_mktemp.man
M	doc/src/naviserver/ns_moduleload.man
M	doc/src/naviserver/ns_modulepath.man
M	doc/src/naviserver/ns_mutex.man
M	doc/src/naviserver/ns_normalizepath.man
M	doc/src/naviserver/ns_pagepath.man
M	doc/src/naviserver/ns_paren.man
M	doc/src/naviserver/ns_parseargs.man
M	doc/src/naviserver/ns_parseheader.man
M	doc/src/naviserver/ns_parsehttptime.man
M	doc/src/naviserver/ns_parsequery.man
M	doc/src/naviserver/ns_parsetime.man
M	doc/src/naviserver/ns_pause.man
M	doc/src/naviserver/ns_pngsize.man
M	doc/src/naviserver/ns_purgefiles.man
M	doc/src/naviserver/ns_puts.man
M	doc/src/naviserver/ns_queryexists.man
M	doc/src/naviserver/ns_queryget.man
M	doc/src/naviserver/ns_querygetall.man
M	doc/src/naviserver/ns_quotehtml.man
M	doc/src/naviserver/ns_rand.man
M	doc/src/naviserver/ns_register.man
M	doc/src/naviserver/ns_register_adp.man
M	doc/src/naviserver/ns_register_adptag.man
M	doc/src/naviserver/ns_register_fastpath.man
M	doc/src/naviserver/ns_register_filter.man
M	doc/src/naviserver/ns_register_proc.man
M	doc/src/naviserver/ns_register_proxy.man
M	doc/src/naviserver/ns_register_trace.man
M	doc/src/naviserver/ns_register_url2file.man
M	doc/src/naviserver/ns_requestauthorize.man
M	doc/src/naviserver/ns_resume.man
M	doc/src/naviserver/ns_return.man
M	doc/src/naviserver/ns_returnerror.man
M	doc/src/naviserver/ns_rollfile.man
M	doc/src/naviserver/ns_runonce.man
M	doc/src/naviserver/ns_rwlock.man
M	doc/src/naviserver/ns_schedule.man
M	doc/src/naviserver/ns_schedule_daily.man
M	doc/src/naviserver/ns_schedule_proc.man
M	doc/src/naviserver/ns_schedule_weekly.man
M	doc/src/naviserver/ns_sema.man
M	doc/src/naviserver/ns_sendmail.man
M	doc/src/naviserver/ns_server.man
M	doc/src/naviserver/ns_serverpath.man
M	doc/src/naviserver/ns_serverrootproc.man
M	doc/src/naviserver/ns_set.man
M	doc/src/naviserver/ns_setexpires.man
M	doc/src/naviserver/ns_setformencoding.man
M	doc/src/naviserver/ns_setprivileges.man
M	doc/src/naviserver/ns_sha1.man
M	doc/src/naviserver/ns_shortcut_filter.man
M	doc/src/naviserver/ns_shutdown.man
M	doc/src/naviserver/ns_sleep.man
M	doc/src/naviserver/ns_sls.man
M	doc/src/naviserver/ns_sockaccept.man
M	doc/src/naviserver/ns_sockblocking.man
M	doc/src/naviserver/ns_sockcallback.man
M	doc/src/naviserver/ns_sockcheck.man
M	doc/src/naviserver/ns_socketpair.man
M	doc/src/naviserver/ns_socklisten.man
M	doc/src/naviserver/ns_socklistencallback.man
M	doc/src/naviserver/ns_socknonblocking.man
M	doc/src/naviserver/ns_socknread.man
M	doc/src/naviserver/ns_sockopen.man
M	doc/src/naviserver/ns_sockselect.man
M	doc/src/naviserver/ns_striphtml.man
M	doc/src/naviserver/ns_symlink.man
M	doc/src/naviserver/ns_tagelement.man
M	doc/src/naviserver/ns_tagelementset.man
M	doc/src/naviserver/ns_thread.man
M	doc/src/naviserver/ns_time.man
M	doc/src/naviserver/ns_tmpnam.man
M	doc/src/naviserver/ns_truncate.man
M	doc/src/naviserver/ns_upload_stats.man
M	doc/src/naviserver/ns_url2file.man
M	doc/src/naviserver/ns_urlcharset.man
M	doc/src/naviserver/ns_urldecode.man
M	doc/src/naviserver/ns_urlencode.man
M	doc/src/naviserver/ns_uudecode.man
M	doc/src/naviserver/ns_uuencode.man
M	doc/src/naviserver/ns_write.man
M	doc/src/naviserver/ns_writecontent.man
M	doc/src/naviserver/ns_writer.man
M	doc/src/naviserver/nsv.man
R099	doc/src/docs/module-nscgi.man	nscgi/doc/mann/nscgi.man
R099	doc/src/docs/module-nscp.man	nscp/doc/mann/nscp.man
M	nsdb/doc/mann/ns_buildsqldate.man
M	nsdb/doc/mann/ns_db.man
M	nsdb/doc/mann/ns_dbquotevalue.man
M	nslog/doc/mann/ns_accesslog.man
R099	doc/src/naviserver/ns_perm.man	nsperm/doc/mann/ns_perm.man
R099	doc/src/docs/module-nsperm.man	nsperm/doc/mann/nsperm.man
M	nsproxy/doc/mann/ns_proxy.man
R100	version_include.in	version_include.man.in

commit 284c69df17bed04c343fbf1f4fd8b78a0509a9e5
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-03-16

    To make huge uploads easy to handle, we put query into content and change method to GET so
    Ns_ConnGetQuery will parse it and return as query parameters. If later the conn Tcl page
    will decide to parse multipart/data file manually it may replace query with new parsed data
    but in case of batch processing with external tools it is good to know additional info
    about the uploaded content beforehand.

M	nsd/driver.c

commit 68989c487bd372f7f42bdbad2dc561baefd203bb
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-03-11

    Updated makefile target build-doc. Now it collects all man pages into temporary dir and then build documentation so that
    directory structure stays simple and plain, no deep src/doc/mann stuff anymore

M	Makefile

commit 8a94ad67e6bcf2dc0833a3723cb6cdeee5f0b8d1
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-03-10

    Remove extra Tc_FindExecutable

M	nsproxy/nsproxylib.c

commit 144e2b3727e9e6c17863a5eda12efcf98191612f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2009-03-10

    Ignore generated docs

M	.hgignore

commit 8fe25b0db377330b7ec8ee22a8b1fc29feacacd1
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2009-03-10

    Add RFC 5334 Ogg Media Types mimetypes

M	nsd/mimetypes.c

commit 61e53d33f412d3a625402256bdc9410de52505ee
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-03-08

    Updated documentation with correct vewrsion, moved around files and split generic docs and API commands into separate directories.

M	Makefile
R100	doc/src/README.doc	doc/src/README.txt
R099	doc/src/admin-db.man	doc/src/docs/admin-db.man
R098	doc/src/admin-install.man	doc/src/docs/admin-install.man
R099	doc/src/admin-maintenance.man	doc/src/docs/admin-maintenance.man
R097	doc/src/admin-tuning.man	doc/src/docs/admin-tuning.man
R099	doc/src/adp-overview.man	doc/src/docs/adp-overview.man
R099	doc/src/c-driverdb.man	doc/src/docs/c-driverdb.man
R096	doc/src/c-urlspace.man	doc/src/docs/c-urlspace.man
R096	doc/src/main-faq.man	doc/src/docs/main-faq.man
R099	doc/src/main-features.man	doc/src/docs/main-features.man
R095	doc/src/main-history.man	doc/src/docs/main-history.man
R099	doc/src/main-standards.man	doc/src/docs/main-standards.man
R099	doc/src/module-nscgi.man	doc/src/docs/module-nscgi.man
R098	doc/src/module-nscp.man	doc/src/docs/module-nscp.man
R099	doc/src/module-nsperm.man	doc/src/docs/module-nsperm.man
R095	doc/src/tcl-lib-file.man	doc/src/docs/tcl-lib-file.man
R097	doc/src/tcl-lib-nstrace.man	doc/src/docs/tcl-lib-nstrace.man
R098	doc/src/tcl-libraries.man	doc/src/docs/tcl-libraries.man
R099	doc/src/tcl-overview.man	doc/src/docs/tcl-overview.man
M	doc/src/header.inc
R099	doc/src/commandlist.man	doc/src/naviserver/commandlist.man
R097	doc/src/keyl.man	doc/src/naviserver/keyl.man
R090	doc/src/ns_addrbyhost.man	doc/src/naviserver/ns_addrbyhost.man
R098	doc/src/ns_adp.man	doc/src/naviserver/ns_adp.man
R093	doc/src/ns_adp_abort.man	doc/src/naviserver/ns_adp_abort.man
R091	doc/src/ns_adp_append.man	doc/src/naviserver/ns_adp_append.man
R093	doc/src/ns_adp_argc.man	doc/src/naviserver/ns_adp_argc.man
R094	doc/src/ns_adp_argv.man	doc/src/naviserver/ns_adp_argv.man
R094	doc/src/ns_adp_bind_args.man	doc/src/naviserver/ns_adp_bind_args.man
R093	doc/src/ns_adp_break.man	doc/src/naviserver/ns_adp_break.man
R098	doc/src/ns_adp_ctl.man	doc/src/naviserver/ns_adp_ctl.man
R088	doc/src/ns_adp_debug.man	doc/src/naviserver/ns_adp_debug.man
R086	doc/src/ns_adp_dir.man	doc/src/naviserver/ns_adp_dir.man
R091	doc/src/ns_adp_dump.man	doc/src/naviserver/ns_adp_dump.man
R092	doc/src/ns_adp_eval.man	doc/src/naviserver/ns_adp_eval.man
R092	doc/src/ns_adp_exception.man	doc/src/naviserver/ns_adp_exception.man
R097	doc/src/ns_adp_include.man	doc/src/naviserver/ns_adp_include.man
R092	doc/src/ns_adp_info.man	doc/src/naviserver/ns_adp_info.man
R091	doc/src/ns_adp_mime.man	doc/src/naviserver/ns_adp_mime.man
R090	doc/src/ns_adp_mimetype.man	doc/src/naviserver/ns_adp_mimetype.man
R096	doc/src/ns_adp_parse.man	doc/src/naviserver/ns_adp_parse.man
R092	doc/src/ns_adp_puts.man	doc/src/naviserver/ns_adp_puts.man
R098	doc/src/ns_adp_register.man	doc/src/naviserver/ns_adp_register.man
R090	doc/src/ns_adp_registeradp.man	doc/src/naviserver/ns_adp_registeradp.man
R098	doc/src/ns_adp_registerproc.man	doc/src/naviserver/ns_adp_registerproc.man
R098	doc/src/ns_adp_registertag.man	doc/src/naviserver/ns_adp_registertag.man
R092	doc/src/ns_adp_return.man	doc/src/naviserver/ns_adp_return.man
R080	doc/src/ns_adp_safeeval.man	doc/src/naviserver/ns_adp_safeeval.man
R096	doc/src/ns_adp_stats.man	doc/src/naviserver/ns_adp_stats.man
R092	doc/src/ns_adp_tell.man	doc/src/naviserver/ns_adp_tell.man
R091	doc/src/ns_adp_trunc.man	doc/src/naviserver/ns_adp_trunc.man
R093	doc/src/ns_after.man	doc/src/naviserver/ns_after.man
R089	doc/src/ns_atclose.man	doc/src/naviserver/ns_atclose.man
R098	doc/src/mann/ns_atsignal.man	doc/src/naviserver/ns_atsignal.man
R084	doc/src/ns_base64decode.man	doc/src/naviserver/ns_base64decode.man
R087	doc/src/ns_base64encode.man	doc/src/naviserver/ns_base64encode.man
R087	doc/src/ns_browsermatch.man	doc/src/naviserver/ns_browsermatch.man
R099	doc/src/mann/ns_cache.man	doc/src/naviserver/ns_cache.man
R085	doc/src/ns_cancel.man	doc/src/naviserver/ns_cancel.man
R098	doc/src/ns_chan.man	doc/src/naviserver/ns_chan.man
R086	doc/src/ns_charsets.man	doc/src/naviserver/ns_charsets.man
R089	doc/src/ns_checkurl.man	doc/src/naviserver/ns_checkurl.man
R089	doc/src/ns_choosecharset.man	doc/src/naviserver/ns_choosecharset.man
R096	doc/src/ns_cond.man	doc/src/naviserver/ns_cond.man
R099	doc/src/mann/ns_config.man	doc/src/naviserver/ns_config.man
R098	doc/src/ns_conn.man	doc/src/naviserver/ns_conn.man
R084	doc/src/ns_conncptofp.man	doc/src/naviserver/ns_conncptofp.man
R099	doc/src/mann/ns_cookie.man	doc/src/naviserver/ns_cookie.man
R089	doc/src/ns_cookiecharset.man	doc/src/naviserver/ns_cookiecharset.man
R084	doc/src/ns_cookietime.man	doc/src/naviserver/ns_cookietime.man
R096	doc/src/ns_critsec.man	doc/src/naviserver/ns_critsec.man
R094	doc/src/ns_crypt.man	doc/src/naviserver/ns_crypt.man
R085	doc/src/ns_encodingforcharset.man	doc/src/naviserver/ns_encodingforcharset.man
R088	doc/src/ns_encodingfortype.man	doc/src/naviserver/ns_encodingfortype.man
R093	doc/src/ns_env.man	doc/src/naviserver/ns_env.man
R095	doc/src/ns_event.man	doc/src/naviserver/ns_event.man
R095	doc/src/ns_filestat.man	doc/src/naviserver/ns_filestat.man
R087	doc/src/ns_findset.man	doc/src/naviserver/ns_findset.man
R094	doc/src/ns_fmttime.man	doc/src/naviserver/ns_fmttime.man
R089	doc/src/ns_formfieldcharset.man	doc/src/naviserver/ns_formfieldcharset.man
R087	doc/src/ns_ftruncate.man	doc/src/naviserver/ns_ftruncate.man
R097	doc/src/ns_getform.man	doc/src/naviserver/ns_getform.man
R075	doc/src/ns_getformfile.man	doc/src/naviserver/ns_getformfile.man
R093	doc/src/ns_geturl.man	doc/src/naviserver/ns_geturl.man
R090	doc/src/ns_gifsize.man	doc/src/naviserver/ns_gifsize.man
R092	doc/src/ns_gmtime.man	doc/src/naviserver/ns_gmtime.man
R098	doc/src/ns_guesstype.man	doc/src/naviserver/ns_guesstype.man
R091	doc/src/ns_hashpath.man	doc/src/naviserver/ns_hashpath.man
R090	doc/src/ns_hostbyaddr.man	doc/src/naviserver/ns_hostbyaddr.man
R087	doc/src/ns_hrefs.man	doc/src/naviserver/ns_hrefs.man
R096	doc/src/ns_htmlselect.man	doc/src/naviserver/ns_htmlselect.man
R096	doc/src/ns_http.man	doc/src/naviserver/ns_http.man
R090	doc/src/ns_httpget.man	doc/src/naviserver/ns_httpget.man
R097	doc/src/ns_httpopen.man	doc/src/naviserver/ns_httpopen.man
R093	doc/src/ns_httppost.man	doc/src/naviserver/ns_httppost.man
R083	doc/src/ns_httptime.man	doc/src/naviserver/ns_httptime.man
R099	doc/src/mann/ns_ictl.man	doc/src/naviserver/ns_ictl.man
R095	doc/src/ns_imgmime.man	doc/src/naviserver/ns_imgmime.man
R092	doc/src/ns_imgsize.man	doc/src/naviserver/ns_imgsize.man
R095	doc/src/ns_imgtype.man	doc/src/naviserver/ns_imgtype.man
R095	doc/src/ns_info.man	doc/src/naviserver/ns_info.man
R091	doc/src/ns_internalredirect.man	doc/src/naviserver/ns_internalredirect.man
R087	doc/src/ns_issmallint.man	doc/src/naviserver/ns_issmallint.man
R098	doc/src/ns_job.man	doc/src/naviserver/ns_job.man
R090	doc/src/ns_jpegsize.man	doc/src/naviserver/ns_jpegsize.man
R087	doc/src/ns_kill.man	doc/src/naviserver/ns_kill.man
R094	doc/src/ns_library.man	doc/src/naviserver/ns_library.man
R099	doc/src/mann/ns_limits.man	doc/src/naviserver/ns_limits.man
R092	doc/src/ns_localtime.man	doc/src/naviserver/ns_localtime.man
R086	doc/src/ns_locationproc.man	doc/src/naviserver/ns_locationproc.man
R099	doc/src/mann/ns_log.man	doc/src/naviserver/ns_log.man
R099	doc/src/mann/ns_memoize.man	doc/src/naviserver/ns_memoize.man
R093	doc/src/ns_mktemp.man	doc/src/naviserver/ns_mktemp.man
R090	doc/src/ns_moduleload.man	doc/src/naviserver/ns_moduleload.man
R091	doc/src/ns_modulepath.man	doc/src/naviserver/ns_modulepath.man
R097	doc/src/ns_mutex.man	doc/src/naviserver/ns_mutex.man
R085	doc/src/ns_normalizepath.man	doc/src/naviserver/ns_normalizepath.man
R087	doc/src/ns_pagepath.man	doc/src/naviserver/ns_pagepath.man
R087	doc/src/ns_paren.man	doc/src/naviserver/ns_paren.man
R084	doc/src/ns_parseargs.man	doc/src/naviserver/ns_parseargs.man
R084	doc/src/ns_parseheader.man	doc/src/naviserver/ns_parseheader.man
R080	doc/src/ns_parsehttptime.man	doc/src/naviserver/ns_parsehttptime.man
R089	doc/src/ns_parsequery.man	doc/src/naviserver/ns_parsequery.man
R091	doc/src/ns_parsetime.man	doc/src/naviserver/ns_parsetime.man
R090	doc/src/ns_pause.man	doc/src/naviserver/ns_pause.man
R098	doc/src/ns_perm.man	doc/src/naviserver/ns_perm.man
R090	doc/src/ns_pngsize.man	doc/src/naviserver/ns_pngsize.man
R086	doc/src/ns_purgefiles.man	doc/src/naviserver/ns_purgefiles.man
R085	doc/src/ns_puts.man	doc/src/naviserver/ns_puts.man
R090	doc/src/ns_queryexists.man	doc/src/naviserver/ns_queryexists.man
R097	doc/src/ns_queryget.man	doc/src/naviserver/ns_queryget.man
R089	doc/src/ns_querygetall.man	doc/src/naviserver/ns_querygetall.man
R095	doc/src/ns_quotehtml.man	doc/src/naviserver/ns_quotehtml.man
R094	doc/src/ns_rand.man	doc/src/naviserver/ns_rand.man
R099	doc/src/ns_register.man	doc/src/naviserver/ns_register.man
R099	doc/src/mann/ns_register_adp.man	doc/src/naviserver/ns_register_adp.man
R097	doc/src/ns_register_adptag.man	doc/src/naviserver/ns_register_adptag.man
R088	doc/src/ns_register_fastpath.man	doc/src/naviserver/ns_register_fastpath.man
R098	doc/src/ns_register_filter.man	doc/src/naviserver/ns_register_filter.man
R098	doc/src/ns_register_proc.man	doc/src/naviserver/ns_register_proc.man
R089	doc/src/ns_register_proxy.man	doc/src/naviserver/ns_register_proxy.man
R094	doc/src/ns_register_trace.man	doc/src/naviserver/ns_register_trace.man
R091	doc/src/ns_register_url2file.man	doc/src/naviserver/ns_register_url2file.man
R098	doc/src/ns_requestauthorize.man	doc/src/naviserver/ns_requestauthorize.man
R091	doc/src/ns_resume.man	doc/src/naviserver/ns_resume.man
R099	doc/src/mann/ns_return.man	doc/src/naviserver/ns_return.man
R099	doc/src/mann/ns_returnerror.man	doc/src/naviserver/ns_returnerror.man
R085	doc/src/ns_rollfile.man	doc/src/naviserver/ns_rollfile.man
R089	doc/src/ns_runonce.man	doc/src/naviserver/ns_runonce.man
R097	doc/src/ns_rwlock.man	doc/src/naviserver/ns_rwlock.man
R098	doc/src/ns_schedule.man	doc/src/naviserver/ns_schedule.man
R094	doc/src/ns_schedule_daily.man	doc/src/naviserver/ns_schedule_daily.man
R094	doc/src/ns_schedule_proc.man	doc/src/naviserver/ns_schedule_proc.man
R095	doc/src/ns_schedule_weekly.man	doc/src/naviserver/ns_schedule_weekly.man
R095	doc/src/ns_sema.man	doc/src/naviserver/ns_sema.man
R099	doc/src/ns_sendmail.man	doc/src/naviserver/ns_sendmail.man
R092	doc/src/ns_server.man	doc/src/naviserver/ns_server.man
R086	doc/src/ns_serverpath.man	doc/src/naviserver/ns_serverpath.man
R089	doc/src/ns_serverrootproc.man	doc/src/naviserver/ns_serverrootproc.man
R099	doc/src/ns_set.man	doc/src/naviserver/ns_set.man
R087	doc/src/ns_setexpires.man	doc/src/naviserver/ns_setexpires.man
R087	doc/src/ns_setformencoding.man	doc/src/naviserver/ns_setformencoding.man
R088	doc/src/ns_setprivileges.man	doc/src/naviserver/ns_setprivileges.man
R090	doc/src/ns_sha1.man	doc/src/naviserver/ns_sha1.man
R083	doc/src/ns_shortcut_filter.man	doc/src/naviserver/ns_shortcut_filter.man
R091	doc/src/ns_shutdown.man	doc/src/naviserver/ns_shutdown.man
R090	doc/src/ns_sleep.man	doc/src/naviserver/ns_sleep.man
R098	doc/src/mann/ns_sls.man	doc/src/naviserver/ns_sls.man
R089	doc/src/ns_sockaccept.man	doc/src/naviserver/ns_sockaccept.man
R083	doc/src/ns_sockblocking.man	doc/src/naviserver/ns_sockblocking.man
R093	doc/src/ns_sockcallback.man	doc/src/naviserver/ns_sockcallback.man
R088	doc/src/ns_sockcheck.man	doc/src/naviserver/ns_sockcheck.man
R085	doc/src/ns_socketpair.man	doc/src/naviserver/ns_socketpair.man
R087	doc/src/ns_socklisten.man	doc/src/naviserver/ns_socklisten.man
R084	doc/src/ns_socklistencallback.man	doc/src/naviserver/ns_socklistencallback.man
R082	doc/src/ns_socknonblocking.man	doc/src/naviserver/ns_socknonblocking.man
R084	doc/src/ns_socknread.man	doc/src/naviserver/ns_socknread.man
R094	doc/src/ns_sockopen.man	doc/src/naviserver/ns_sockopen.man
R097	doc/src/ns_sockselect.man	doc/src/naviserver/ns_sockselect.man
R085	doc/src/ns_striphtml.man	doc/src/naviserver/ns_striphtml.man
R091	doc/src/ns_symlink.man	doc/src/naviserver/ns_symlink.man
R093	doc/src/ns_tagelement.man	doc/src/naviserver/ns_tagelement.man
R093	doc/src/ns_tagelementset.man	doc/src/naviserver/ns_tagelementset.man
R096	doc/src/ns_thread.man	doc/src/naviserver/ns_thread.man
R096	doc/src/ns_time.man	doc/src/naviserver/ns_time.man
R087	doc/src/ns_tmpnam.man	doc/src/naviserver/ns_tmpnam.man
R086	doc/src/ns_truncate.man	doc/src/naviserver/ns_truncate.man
R091	doc/src/ns_upload_stats.man	doc/src/naviserver/ns_upload_stats.man
R090	doc/src/ns_url2file.man	doc/src/naviserver/ns_url2file.man
R088	doc/src/ns_urlcharset.man	doc/src/naviserver/ns_urlcharset.man
R081	doc/src/ns_urldecode.man	doc/src/naviserver/ns_urldecode.man
R093	doc/src/ns_urlencode.man	doc/src/naviserver/ns_urlencode.man
R087	doc/src/ns_uudecode.man	doc/src/naviserver/ns_uudecode.man
R088	doc/src/ns_uuencode.man	doc/src/naviserver/ns_uuencode.man
R099	doc/src/mann/ns_write.man	doc/src/naviserver/ns_write.man
R087	doc/src/ns_writecontent.man	doc/src/naviserver/ns_writecontent.man
R096	doc/src/ns_writer.man	doc/src/naviserver/ns_writer.man
R099	doc/src/nsv.man	doc/src/naviserver/nsv.man
D	doc/src/ns_register_adp.man

commit 8be3828219c75aa1160fd3fc80b6b2c7d98da3e8
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-03-08

    Added call to nsproxy Tcl_FindExecutable(argv[0]); to keep Tcl 8.5 from crashing in thread related initialization.

M	nsproxy/nsproxylib.c

commit cbfed0b193aee8b543eae96fadef7e0329a88139
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2009-02-24

    Add test for ns_cp command

A	tests/compat.test

commit 6dc125bc86b418376ba6e1205db9d8bd57a09300
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-02-18

    Added .htaccess mode for nsperm module. Similar to Apache but only to allow access.
    This is disabled by default, can be enabled in the ns/server/servername/module/nsperm section.
    Doc is updated. In this version only current directory is checked for .htaccess file.

M	doc/src/module-nsperm.man
M	doc/src/ns_perm.man
M	nsperm/Makefile
A	nsperm/htaccess.tcl
M	nsperm/nsperm.c

commit 89520d2e16bbe7e8a036e021bee9df84d34a911d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2009-02-18

    Fix bad merge changeset 77a71927a2a3

D	ChangeLog

commit 21884080d460930b07c817e6f2b60da4e35f584b
Merge: 0fa4e0e5 309880c0
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-02-18

    Fixed broken nsperm module

commit 0fa4e0e597cadf986d1ee6c0059a7d387c2da14b
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-02-18

    Fix broken nsperm module

M	ChangeLog
M	nsperm/nsperm.c

commit 309880c0f819102eb8cd07b1430602ca85794ec9
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2009-02-18

    Fix default make target (all)

M	Makefile
M	README

commit 469a620cb43ea1540807a75697a351c21787721a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2009-02-18

    Auto-generate ChangeLog for dist target

D	ChangeLog
M	Makefile

commit b65a6d67318cc1c82bc17fcf0706cf2326580cb6
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-02-18

    Minor additions to the NEWS about recent changes

M	NEWS

commit 097190e238cd0f15ceb8c73c2740c72cc3d087ee
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-02-17

    * nsd/range.c: Be more RFC compliant regarding HTTP date in If-Range header

M	ChangeLog
M	nsd/range.c

commit 6d0d27f40b508c9b241f979375f528f7b902cf25
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-02-05

    * nsd/range.c: Check If-Range: header first and return the whole content if
      it was changed before checking ranges

M	ChangeLog
M	nsd/range.c

commit b9f664f3b116a0ddb356dca2caa22fe71750de54
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2009-02-04

            * nsd/nsd.h:
            * nsd/fastpath.c: Added struct stat in the Conn struct to be reused by
            everyone. This will save extra stat call and i used in range.c to check
            last modified time
    
            * nsd/range.c: Check for If-Range: header and return the whole
            file if it was changed

M	ChangeLog
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/range.c

commit a4d4f91b7cea145110b73d026ddaaa44b33e9754
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2009-02-04

    Add 'help' target to Makefile with common usage hints

M	Makefile

commit 74b15d78221479877fb9d4bf8e69cedde9991fc1
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2009-02-04

    Add some missing NEWS

M	NEWS

commit 078694e0029d6611b87132d26c8b489af72ed0ef
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2009-02-04

    Update the README with new location of source code etc.

M	README

commit 551d8c1c4b6da4968352fc9fe1e6911a905f2b9f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-03-20

    Add .hgignore

A	.hgignore

commit 9d57ee7a3313b54100d5c0bd1245b6d8d8ed71cf
Author: Vlad Seryakov <vseryakov@gmail.com>
Date:   2008-12-21

    nsd/mime.c: Added .flv extension into default MIME types

M	ChangeLog
M	nsd/mimetypes.c

commit c2ce65e6ee7b3b882092b376206d0541baf752e4
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-11-24

    nsproxy: don't access interp result directly

M	nsproxy/nsproxylib.c

commit 0391bd3de27a48e89ab6d2d297b0945db4d077a9
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-11-24

    Manage lifetime of tcl synchronization objects without trampling memory
    
    The old scheme with both anonymous and named locks was makinf it difficult
    to know when to cleanup. The code was broken -- some memory corruption
    and some cases missed.
    
    With this change all locks are named, with anon locks receiving an auto-
    generated name. Also, we no longer destroy locks because we can't do it
    safely, and there seems little point.

M	nsd/nsd.h
M	nsd/tclinit.c
M	nsd/tclthread.c
M	tests/ns_thread.test

commit d491e186af4636d304a5f27b72088c037b51d6a7
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-11-18

    nsproxy: fix race-condition that could lead to starting more than one reaper thread

M	ChangeLog
M	nsproxy/nsproxylib.c

commit df734c6f974f5fcdb3cb91b63620040960d5b937
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-11-08

    Set the NS_CONN_SENT_LAST_CHUNK flag when last chunk is actually sent
    
    Fixes nsphp bug with chunked encoding and headers-only response
    triggered by PHP ext function.

M	ChangeLog
M	nsd/connio.c

commit 270e56ec9d34fdb09d8b3b37c0e1e9e846ee308d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-11-08

    Change a stray SOCKET to Ns_Sock in Ns_SockSendFileBufs

M	nsd/sockfile.c

commit bdef14af8ef7190d7be922207bf16dfd338914c7
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-11-07

    Drivers can now leave Ns_Driver.sendFileProc unimplemented - it is an optimization only
    
    The sendProc will be called as necessary to send files.
    
    Ns_SockSendFileBufsIndirect not exported.
    
    Ns_SockSendFile etc. now take an Ns_Sock rather than a plain
    file descriptor. This is kind of dissapointing because it breaks
    the symmetry with Ns_SockSendBufs etc., so this call can only be
    used with connection sockets, not sockets in general. However, the
    Ns_Sock context is needed in the fallback case to pass on to the
    drivers Ns_DriverSend proc, and there looks like no other option.

M	ChangeLog
M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sockfile.c
M	nssock/nssock.c

commit efbb6c0ad599567f82b04a16c5668db23c5573a7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-11-07

    Revert 0.0.0.0 fix back because it is bad and a security hole

M	ChangeLog
M	tcl/fastpath.tcl

commit f1ade1b5edcf466477b18f80e88cbe2ea7bfa52a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-11-07

    Check for 0.0.0.0 address in nssock and generated urls, use Host: header instead

M	ChangeLog
M	tcl/fastpath.tcl

commit b4788fb01a6d8de8e2c6a152a16f8527548b1488
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-30

    Change version to 4.99.3 to distinguish between incompatible versions

M	ChangeLog
M	NEWS
M	configure.in

commit cd72d618cf8a9dc163f556b6136ddcc63810ba6b
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-22

    Remove Ns_ConnSockContext, Ns_ConnDriverContext; fix check on SockAccept return code
    
    Ns_Sock already exposes the socket and driver contexts.

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c

commit 7eeb7004d419f8b374a30321167f3b8fffab196f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-22

    Add NS_DRIVER_ACCEPT_QUEUE to queue on accept; allocate empty request to prevent crash

M	ChangeLog
M	include/ns.h
M	nsd/driver.c

commit 7603d927c84b1ebba9d3664541ecd48e2d69828c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-22

    Add Ns_ConnSockContext, Ns_ConnDriverContext

M	ChangeLog
M	include/ns.h
M	nsd/conn.c

commit 7a083d256694c70a54b003f97b8d85b1ab2b96fc
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-21

    Add Ns_ConnContentSize; depreciate Ns_ConnSetRequiredHeaders; reformat ns.h

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/return.c
M	nssock/nssock.c

commit 894618ecebff45e4826e582d4a0ce53fe59a6c2d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-20

    Add Ns_DriverRequestProc callback for non-HTTP drivers; return binary from ns_conn content
    
    The result is the same as for regular filters but this is optional. No need
    to hack request anymore, it seemed very weird. All the code that handles
    request is now checking for not NULL values before using, mostly url space
    routines.
    
    Now, it is valid to have request structure NULL values, nothing will be
    called, not handlers will be invoked.
    
    Non HTTP drivers will have to provide requestProc, otherwise nothing will happen and
    nobody will notice this driver.

M	ChangeLog
M	include/ns.h
M	nscp/nscp.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/progress.c
M	nsd/queue.c
M	nsd/request.c
M	nsd/tclmisc.c
M	nsd/url2file.c
M	nsd/urlspace.c

commit af12109af310b84885d87e27dc92608b6b247525
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-15

    Reintroduced Ns_DriverSetRequest as the way to set request by the non-HTTP driver
    
    This is questionable but at this moment i do not have other solution.
    
    Also added new NS_DRIVER_NOPARSE flag to tell the driver no to parse
    incoming data. This way driver thread still read data from the socket
    into its own buffers instead of a driver to allocate extra memory to
    keep data.
    
    * include/nsd.h:
    * nsd/urlopen.c:
    * nsd/progress.c:
    * nsd/queue.c:
    * nsd/request.c: Changes public function Ns_ParseRequest, now it
    accepts pointer to Ns_Request and fills it with values, returns NS_OK
    or NS_ERROR.
    
    Changed Request structure to include Ns_Reqeust instead of pointer:
    this saves extra Alloc/Free and because this is required structure we avoid
    possible access to its fields if it is NULL.

M	ChangeLog
M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/progress.c
M	nsd/queue.c
M	nsd/request.c
M	nsd/urlopen.c
M	nslog/nslog.c
M	nssock/nssock.c

commit eea8118fc575ba167f84a6414c71db78e19274cb
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-15

    Update Ns_Sock/Sock structures to expose sockaddr_in sa, so drivers can update it
    
    This is the case for UDP drivers.

M	ChangeLog
M	include/ns.h
M	nsd/nsd.h

commit d2663cf7bb395d8cb6025baca6dc93395436c264
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-08

    Fixup the new nsv C api to not require a conn
    
    So, Ns_ConnNsvSet(char *array, char *key, char *value)
    becomes Ns_VarSet(char *server, char *array, char *key, char *value)
    etc.
    
    Looks like this was just an accident of the way the nsphp
    module was implemented which only support an ns_register_proc-like
    api.
    
    Also, optimize the array lookup for Tcl commands.

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/tclvar.c
M	tests/ns_nsv.test

commit 7e4dc5d0edf8f9a4d0dc197bd0f3d8cce1fc7c4b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-08

    Untabify and reformat nsd/tclset.c

M	ChangeLog
M	nsd/tclset.c

commit 07ae8f7e1d6e5b64ec1459172cfd8948cdb31c56
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-08

    Remove the -share option from ns_set

M	ChangeLog
M	include/ns.h
M	nsd/nsd.h
M	nsd/tclinit.c
M	nsd/tclset.c
M	tests/ns_set.test

commit 09522dfb266b06c39feeac7cb4485179a2410f86
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-08

    Remove the old ns_share command

M	ChangeLog
M	nsd/Makefile
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclinit.c
D	nsd/tclshare.c

commit 4ed976383324bc8c857952afe87020761a2a779c
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-08

    Remove the old ns_var command; add a simple compatibility wrapper in Tcl which uses nsv

M	ChangeLog
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclinit.c
M	nsd/tclvar.c
M	tcl/compat.tcl

commit 34fe603677ddc3ae5d3abfea0ae7539a52604a71
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-08

    Add 'flags' arguments to the Send and Recv driver callbacks
    
    These are passed directly to the underlying recv() etc. system call.

M	ChangeLog
M	include/ns.h
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sock.c
M	nsd/sockfile.c
M	nssock/nssock.c

commit 5562c5eb3577dc7f3610ab708fa4bf9767164415
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-08

    Cast away some CONSTness in Ns_SetVec

M	ChangeLog
M	include/ns.h
M	nsd/sock.c
M	nsd/sockfile.c

commit 2dda57955292bcb41898040e12a2c1aeda4be8fe
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-08

    Add new Ns_CompressBufsGzip routine which can compress a stream, handling multiple buffers with each write
    
    * nsd/queue.c:
    * nsd/conn.c: ns_conn compress is now available to
    request/disable compression for each request. Use this in
    preference to ns_adp_ctl gzip.
    
    * nsd/nsd.h:
    * nsd/server.c:
    * nsd/connio.c: Move the ADP compression code into
    Ns_ConnWriteVChars so that it is available for ns_return etc.
    Upgrade it to handle streaming and chunking.
    
    * nsd/tclcompat.tcl:
    * doc/src/man/mann/ns_register_adp.man
    * nsd/adpcmds.c: Remove the gzip option from some of the
    ADP commands. (these were a recent naviserver only thing).
    
    * nsd/adpeval.c:
    * nsd/adprequest.c: ADP pages are now also compressed
    when streaming.
    
    * sample-config.tcl.in: Add the compression params to config.
    
    * tests/testserver/modules/testhttp.tcl: Add new -getbinary option
    to nstest_http which returns the body as a list of hex characters.
    
    * tests/test.nscfg:
    * tests/ns_adp_compress.test:
    * tests/ns_conn.test:
    * tests/testserver/pages/ns_adp_compress.adp: Add extra tests for
    compressed streaming/chunking etc. and ns_return/ns_write.

M	ChangeLog
M	doc/src/mann/ns_register_adp.man
M	include/ns.h
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/compress.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c
M	sample-config.tcl.in
M	tcl/compat.tcl
M	tests/ns_adp_compress.test
M	tests/ns_conn.test
M	tests/test.nscfg
M	tests/testserver/modules/testhttp.tcl
M	tests/testserver/pages/ns_adp_compress.adp

commit a835372ceaabffb005214b7e0fa7467ff6145170
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-08

    Add Ns_SumVec utility routine and use it

M	ChangeLog
M	include/ns.h
M	nsd/connio.c
M	nsd/sock.c

commit f4f0bd958837cc8e701dd8c59fba7b284573990b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-08

    Re-add some missing code to Ns_ConnSend which caused it break it's promise to send everything

M	ChangeLog
M	nsd/connio.c

commit f6b1edf9afea7ed676eddb6b43e68cf09ee922ff
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-05

    Remove O_LARGEFILE because configure will set FILE_OFFSET_BITS automatically

M	ChangeLog
M	include/nsthread.h
M	nslog/nslog.c

commit 3ccb777990c9a98f21fa0be83f587aabf43a522a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-10-05

    OS X does not have O_LARGEFILE

M	ChangeLog
M	include/nsthread.h

commit 053dc0b37304009023ead85186e29d256e767085
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-03

    Add Linux native sendfie implementation

M	ChangeLog
M	configure.in
M	nsd/sockfile.c

commit f5a9bfc9abf35b7f9ef1bccc2e0888d36f74d0bc
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-03

    Reorder the functions in connio.c; no code change

M	ChangeLog
M	nsd/connio.c

commit abd94cdb805f4ba874218582cee5242f6deaf725
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-02

    Clarify Ns_ConnWriteVData with Ns_SetVec

M	ChangeLog
M	nsd/connio.c

commit 19d2baf082089390160342bdf7df340ed7f8cb9a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-02

    Pass timeouts to driver callbacks explicitly
    
    In the future nonblocking writes may be made if no timeout
    is given.

M	ChangeLog
M	include/ns.h
M	nsd/driver.c
M	nssock/nssock.c

commit 1088e5326c470636b7ceabce36a8f79866446df5
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-02

    Ns_SockSendBufs now handles buffer shuffling for UIO_MAXIOV
    
    Ns_ConnSend now much simpler. Use Ns_SetVec and new     Ns_ResetVec
    for clarity.

M	ChangeLog
M	include/ns.h
M	nsd/connio.c
M	nsd/sock.c

commit 88129ffe7d64a0397d4a670ed6dfd65c8bc98a03
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-02

    Expose the SendFile capability via new Ns_ConnSendFileVec(); use it for range requests

M	ChangeLog
M	include/ns.h
M	nsd/connio.c
M	nsd/nsd.h
M	nsd/range.c
M	nsd/return.c
M	nsd/sockfile.c
M	tests/http.test
M	tests/http_byteranges.test

commit 59a6a000b2025107544f6919acf148591c5fbce9
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-02

    Support the TCP_DEFER_ACCEPT option on the listen socket for Linux
    
    This causes the listen socket to return a newly connected socket
    only when data has also arrived, not when the initial TCP handshake
    is complete. The kernel can also save one packet round trip time.
    The first effect saves a trip through the poll loop and seems faster.
    
    This also uses the second mode of the accept callback which is
    essential for UDP sockets. So it seems generally useful.
    
    Unfortunately the Linux implementation is currently broken in that it
    doesn't handle timeouts correctly so this is turned off by
    default :-(

M	ChangeLog
M	configure.in
M	include/nsthread.h
M	nssock/nssock.c
M	sample-config.tcl.in
M	tests/test.nscfg

commit 05a7b04a07149c43a6f6e4e714d37c2ff37baa44
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-02

    Only set byterange headers if the programmer has not explicitly specified a length
    
    ie. they are writing the data in pieces, but they are not 'streaming'.

M	ChangeLog
M	nsd/conn.c
M	nsd/connio.c

commit 087073227e3791e56fd67e1b0e45594cd8b4e27e
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-02

    Create new 'DriverDebug' logging level to replace numerous driver debugging toggles
    
    Limit logged content to 100 bytes. Turn it on by default when running tests.

M	ChangeLog
M	nsd/driver.c
M	sample-config.tcl.in
M	tests/all.tcl

commit 034d41c406e4cc868a07d21662f83137756a1e76
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-02

    Remove the NS_DRIVER_* options and the code that handles them
    
    * include/ns.h:
    * nsd/nsd.h:
    * nsd/driver.c: Remove the NS_DRIVER_* options and the code that
    handles them. Should be possible to achieve the same effect with
    the new driver callbacks.
    
    * nsd/conn.c:
    * nsd/queue.c:
    * nsd/return.c:
    * tests/ns_conn.test: Remove the weird responseVersion string.
    Although it's called 'version' it actually includes the "HTTP/"
    string, which is surprising when it is being nulled with a literal 0...
    
    * nsd/request.c: Remove the weird protocol-agnostic
    versionstring and it's parsing. The confusion doesn't seem worth it.

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/request.c
M	nsd/return.c
M	tests/ns_conn.test

commit c777b6deb3faa1842d71535d409d842cbb6fbb7c
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-01

    Add new Ns_DriverAcceptProc callback which is responsible for accepting incoming socket connections from the driver listen socket
    
    It can opperate in two modes: in the first it accepts and returns
    the new socket (same as before), in the second it tells the driver
    thread it believes data is ready to be read from the socket.
    In this case the driver thread will skip pushing the socket onto
    the read queue and attempt the read immediately. This saves a trip
    throught the poll loop.
    
    The second mode could be used by UDP sockets where there is no
    accept phase.

M	ChangeLog
M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h
M	nssock/nssock.c

commit 493883eb12792b4d4541e49264044526c0c00ecb
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-01

    Add new Ns_DriverListenProc callback which is responsible for opening the listening driver socket at server startup

M	ChangeLog
M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h
M	nssock/nssock.c

commit 3bf6b97f2340f6e04b36371274b9a22a3b0effe0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-10-01

    Convert the Ns_DriverProc callback into 5 individual callbacks
    
    New callbacks: Ns_DriverRecvProc, Ns_DriverSendProc, Ns_DriverSendFileProc,
    Ns_DriverKeepProc, and Ns_DriverCloseProc.

M	ChangeLog
M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h
M	nssock/nssock.c

commit 2e31817c53c6362721f39ce07f47137dbf4ed628
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-09-11

    Add a sendfile() workalike
    
    * include/ns.h:
    * nsd/Makefile:
    * nsd/sockfile.c: Add a sendfile() workalike.
    Ns_SockSendFileBufs() is a library routine for nssock (or other
    interested driver) to call which sends the given file out the
    sock. It follows the Solaris style of sendfilev() and so takes an
    arbitrary mixture of memory/file offset/length pairs. Behind the
    scenes platform specific versions will use the native sendfile()
    implementation, although atm. there is only a fallback:
    
    Ns_SockSendFileBufsIndirect() is called if there is no
    native sendfile() implementation. It uses pread() and sendmsg().
    The reason it is public is that drivers which do some
    transformation on the stream before sending, such as nsssl, can
    call this directly passing their SockSend callback.
    
    Ns_SetFileVec() is a handy utility analogous to Ns_SetVec() and
    Ns_ResetFileVec() is used to update the current position after
    a partial send.
    
    What's required now is a change in Ns_RegisterDriver etc. to add
    a new SendFile callback, all the drivers need updating to that new
    API, and native versions and related autoconf checks for Linux,
    BSD/OSX, Solaris, Windows (TransmitFile?) added. Then the conn
    routines can call NsDriverSendFile()...

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
A	nsd/sockfile.c

commit db8a99ca5f6918027b3ef744cd67cc4702d184b8
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-09-11

    Add handy Ns_SetVec routine for manipulating struct iovec

M	ChangeLog
M	include/ns.h
M	nsd/sock.c

commit 53e746b55eac8413b2ab807711148a90fe98fca7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-08-29

    Revert ns_filestat to not raise exception and use native system call

M	ChangeLog
M	nsd/tclmisc.c

commit 52449e4e93c658c3e848793579980d81c08f8649
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-08-29

    Cleanup and move byte-range code to own file
    
    * nsd/nsd.h:
    * nsd/Makefile:
    * nsd/fastpath.c:
    * nsd/range.c: Cleanup and move byte-range code to own file.
    Fix bug where numerous ranges in a request caused a dstring to be
    reallocated, invalidating the pointers we had into it.
    
    * nsd/connio.c: The ConnSend routines now no longer responsible
    for setting the length header. The old way meant that the passed
    length dictated the length of the whole file you were to send, but
    that's exactly what the Ns_ConnReturnF* routines do. Now we can
    send pieces of files in multiple goes. Also, remove the call to
    the writer thread from this low-level routine.
    Don't switch to chunking mode when streaming is requested and the
    mime-type is multipart/byteranges: they are self delimited and we
    may need to send them in muliple chunks.
    
    * nsd/driver.c: Need to set the length in the writer explicitly
    now that the low-level Ns_ConnSendFile does not.
    
    * include/ns.h:
    * nsd/conn.c: Add Ns_ConnUnmodifiedSince().
    
    * nsd/return.c: No longer send the 'accept-ranges' header with
    all responses. Generate it only from the range faspath.
    Range support now available to more public Ns_ConnReturn* routines.
    
    * nsd/returnresp.c: Had to remove a call to Ns_ConnReturnData here
    from Ns_ConnReturnStatus, as this is called in the error handling
    path of RangeReturn and would result in an infinite loop.
    
    * tests/http_byteranges.test: Add a couple of tests for ranges on
    larger files to exercise the file descriptor path rather than the
    in memory mmap or cache path. Unfortunately, this actually
    triggers the writer thread and this has no support of ranges,
    which I guess is where it's actually most needed. TODO...

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/nsd.h
A	nsd/range.c
M	nsd/return.c
M	nsd/returnresp.c
M	tests/http_byteranges.test

commit 733ee5889a3d0b285ad58e1b56d5ba742109cdf3
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-08-28

    Remove calls to Tcl's VFS routines within the fastpath, as it adds a lot of noise
    
    For starkit users there is a new nsvfs module which provides pure Tcl
    VFS access to the filesystem for the fastpath, and wrappers for
    ns_return and ns_respond.
    
    This is actually more flexible: you can wrapp access to /admin*, for bundled
    starkit files, and native access to /fast*, for user added content.
    
    * nsd/rollfile.c:
    * nsd/tclmisc.c: Replace calls to the NsFast* wrappers with straight Tcl_* calls.

M	ChangeLog
M	configure.in
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/rollfile.c
M	nsd/tclmisc.c

commit ee350c375902ef2c5dcd24d31332b3a5c6d0ae1f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-08-28

    Use autoconf's AC_SYS_LARGEFILE macro to provide large file support
    
    With this system, the off_t and size_t types etc. are defined to be 64bit
    wide on 32bit machines, so the normal calls such as stat() work for large
    files, resulting in     cleaner code.
    
    * nsd/nsd.h:
    * nsd/log.c:
    * nsd/fastpath.c: Remove various #ifdef'ery.

M	ChangeLog
M	configure.in
M	include/nsthread.h
M	nsd/fastpath.c
M	nsd/log.c
M	nsd/nsd.h

commit 4a8271a0f0901bbb424a229f9400cc83885405e9
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-08-28

    Use simple pointer copying inplace of memcpy

M	ChangeLog
M	nsd/tcltime.c

commit 85e47d240365a1b297ab7d263abe9a2da73f473e
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-08-28

    Remove autogenerated file

M	ChangeLog
D	include/nsconfig.h.in

commit 8a6457ded8eb09649a725735bd7a989363c33898
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-08-28

    nsdb: add new API call rowcount and function Ns_DbGetRowCount to return number of affected rows
    
    All driver have this call implemented differently and it will not
    break old application but new code can use it.

M	ChangeLog
M	nsdb/dbdrv.c
M	nsdb/dbtcl.c
M	nsdb/doc/mann/ns_db.man
M	nsdb/nsdb.h

commit ee777a7e8ccdb15bab431b291c0b9e7e8e3d72f2
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-08-27

    Restructured driver polling code, use PollData structure to keep poll-related fields together

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h

commit 27b8aa611e62f4f8bbce087333b4c8d947434a36
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-08-27

    Fix the bug introduced earlier by using memcpy for silencing warnings

M	ChangeLog
M	nsd/tcltime.c

commit 88d32f6df68d57721fc563b438e2780cd28c142e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-08-26

    Update driver to run in separate threads, port from AOLserver 4.5
    
    Port some driver code from AOLserver 4.5 into our driver structure
    such as:
    
    - create separate thread for each driver
    - have driver thread create and shutdown its sockets and writer/spooler threads
    
    I made many tests comparing AS 4.5 driver and our based on 4.0.11 driver
    and every time is see old code is more stable and fatser.
    
    New AS 4.5 driver logic seems very complicated and with pretty heavy tests
    it even fails to sustain the load.
    
    My latest test with LiteSpeed Web server which claims to be even faster
    than lighttpd shows that for simple small files with fastpath enabled we
    perform almost the same as LiteSpeed, a little bit slower but not much.
    Having separate threads for each driver made it a tiny little bit faster
    which just proves that it is not bad to have each driver in different threads.

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h

commit fa1b520f8942e781701a87d3dc5384bde4fd0b44
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-08-25

    Add new logging flag to driver for logging config errors

M	ChangeLog
M	nsd-config.tcl
M	nsd/driver.c

commit 90abff08d4f15743e382953a2347d35be68e0b02
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-08-25

    Update sample-config.tcl with fastpath actual default values

M	sample-config.tcl.in

commit 02958a55b89feb683df2315185a1eb8268030e28
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-08-24

    Mark the connection which sent data via writer thread with specal flag which wil be honored by NsAdpFlush
    
    Updated examples with better description and fix writer example.

M	ChangeLog
M	contrib/examples/upload.tcl
M	contrib/examples/writer.tcl
M	include/ns.h
M	nsd/adprequest.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/tclvar.c

commit bee956ed7500e1853c404eebe2d3a35d27038bc9
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-08-24

    Put install-examples back which was lost and breaks make install

M	Makefile
M	include/nsconfig.h.in

commit 1d1cba3ac724e27b1776bf15f753b03697141e7a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-08-23

    Honor keep-alive flag in WriterThread; silence some compiler warnings

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/tcltime.c

commit 483762a1fea6e1dc24c8d0935ee9441b3296e4a7
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-08-23

    Convert some more documentation to new doctools syntax; fix cross-references; make module docs per-module

M	ChangeLog
M	Makefile
M	configure.in
A	doc/src/footer.inc
A	doc/src/header.inc
A	doc/src/man.css
D	doc/src/ns_buildsqldate.man
D	doc/src/ns_db.man
D	doc/src/ns_dbquotename.man
D	doc/src/ns_dbquotevalue.man
D	doc/src/ns_localsqltimestamp.man
D	doc/src/nsd.css
A	nsdb/doc/mann/ns_buildsqldate.man
A	nsdb/doc/mann/ns_db.man
A	nsdb/doc/mann/ns_dbquotevalue.man
R100	doc/src/mann/ns_accesslog.man	nslog/doc/mann/ns_accesslog.man
R075	doc/src/ns_proxy.man	nsproxy/doc/mann/ns_proxy.man
R100	doc/src/version_include.in	version_include.in

commit 43160a2dcf261881ad835878d2a44a93a095e38a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-08-19

    fastpath: fix info leak with filename -> stat -> cache lookup
    
    The intermediate stage of using the inode as the cache key is not
    reliable, as when the file is replaced within the granularity of
    the mtime an inode may be assigned which has already been seen and
    is still in the cache.
    
    The result is an information leak: the old contents of file a.html
    may appear when file b.html is requested.
    
    Reported by John Caruso on the AOLserver mailing list.
    
    * nsd/init.c:
    * nsd/modload.c: Remove dead code.

M	ChangeLog
M	nsd/adpeval.c
M	nsd/fastpath.c
M	nsd/init.c
M	nsd/modload.c
M	nsd/nsd.h

commit 87895dc6cf01def6b3257c9bb3ddebe30a2e1f49
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-07-29

    Fix bug in switch statement after Auth index, did not have break

M	ChangeLog
M	nsd/conn.c

commit 1736f19fcaedcdd19ff9306c7a93b4ef576f6fe2
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-07-29

    Add ns_conn auth description to docs

M	doc/src/ns_conn.man

commit 22f932be25787aeaa05c312a82b5c0916dab8c5d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-07-25

    New public C API for NSV
    
    Made NSV API public, introduced new Ns_ConnNsv* and
    NsNsv* families of functions that can be used inside
    the server or a connection to access NSV arrays.

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/tclvar.c

commit 51bcb96d21390523ac50c19f5149d0ec962ceae9
Author: Daniel P. Stasinski <mooooooo@avenues.org>
Date:   2008-05-27

    Fix ns_adp_compress.test to match new compression code

M	ChangeLog
M	Makefile
M	tests/ns_adp_compress.test

commit 7718afab39d12e5653acfa890ca96673e5df1fd6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-05-23

    Fix socket shutdown bug with ns_http and short downloads
    
    Not sure i can explain it but on Linux with fast Internet
    connection ns_http does not work when after write
    shutdown(sock, 1) is called. All downloads are short, after
    a while recv returns 0. Without shutdown() it works fine.
    
    Also, fixed timeout bug in Ns_TaskWait, timeout was not adjusted
    to absolute value.

M	ChangeLog
M	nsd/task.c
M	nsd/tclhttp.c

commit 5da540d0996a06c86ee20f08ff9c66a390ee03f3
Author: Daniel P. Stasinski <mooooooo@avenues.org>
Date:   2008-05-21

    Gzip compression fixes

M	ChangeLog
M	nsd/compress.c

commit 707da7878d00605ebb93e13222ad9dffec4bf641
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-05-17

    Remove sndbuf/rcvbuf parameters for setsockopt
    
    These should be auto-tuned by any modern OS.

M	ChangeLog
M	include/ns.h
M	nsd-config.tcl
M	nsd/driver.c
M	nsd/nsd.h
M	tests/test.nscfg

commit 28cc9ea59acf56106b96bc1ad461a2af34da94c2
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2008-05-12

    Expose Ns_AdpAppend, Ns_AdpFlush; add new Ns_AdpGetOutput
    
    These are for the benefit of adp commands written in external modules.

M	ChangeLog
M	include/ns.h
M	nsd/adpcmds.c
M	nsd/adprequest.c
M	nsd/nsd.h

commit fda61bd2f20c1740bc45cc71b8efde28f1b0cacc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-05-12

    Fix tests to handle recent change to format of job handles
    
    (using hyphens instead of blanks)

M	ChangeLog
M	tests/ns_thread.test

commit a6005f5a56408030311fab148b5036b3b88ffd93
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-05-12

    Initializes memory prior to usa to avoid UMR-kind of warnings in Purify

M	ChangeLog
M	nsd/driver.c

commit 799002c10c5c9ec553c94b7ccdc3053a9fc52450
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-05-11

    Return 404 when ADP registered with absolute page fails to find file; don't log error

M	ChangeLog
M	nsd/adprequest.c

commit 3a53a52756ac1b842c5950112fe1eeb5b53de49e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-05-10

    nsperm: Use inet_aton instead of inet_addr to parse netmask
    
    Thanks, Daniel Stasinski.

M	ChangeLog
M	nsperm/nsperm.c

commit 1e7d7611bf0b2fd317ca123be91637e01dd91e55
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-05-09

    Log an error when ADP registered with absolute path fails to find file

M	ChangeLog
M	nsd/adprequest.c

commit 679c1341f09c1679f2e504808836935485231717
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-05-05

    Allow sockets to be queued with empty request structure
    
    This is the case for drivers without DRIVER_ASYNC flag.
    
    Moved assigning IP/port into queue.c:ConnRun where Request should be properly
    initialized already.

M	ChangeLog
M	nsd/driver.c
M	nsd/queue.c

commit caad9c433feba041499abcac203179734c2a397a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-05-01

    Fix deadlock in job thread; fix trampling freed memory in LogFlush()
    
    nsd/tcljob.c: Fixed deadlock in job thread caused
    by obscure locking strategy of the existing code.
    Also, did some cosmetic changes on variables.
    
    nsd/log.c: Fixed trampling over freed memory in
    LogFlush() when last cache entry has been processed
    and the server is shutting down, tearing the cache down.

M	ChangeLog
M	nsd/log.c
M	nsd/tcljob.c

commit 3a3554ad0b7f63010b1f5e6c8af7bd8646182915
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-29

    Fix wrong access to queuePtr variable in the worker thread (Bug introduced 2008-04-26)
    
    Made LookupQueue errors trigger Fatal exceptions when run
    from within the worker threads.

M	ChangeLog
M	nsd/tcljob.c

commit eb0eb2f890f5fee105273a420ec87e065d388be0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-29

    Short-circuit LogToTcl for Fatal severity
    
    Otherwise we may get stucked in the depths of the memalloc.

M	ChangeLog
M	nsd/log.c

commit b1509fe80b7c1281c1c38cbf795ae796d5500193
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-28

    Silence compiler warnings in 2 Ns_Log calls

M	nsd/sched.c

commit 117c12689942395114233ffdced6eddda066affc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-28

    Conditionally include stdint.h as it is not present on older solaris versions (2.8, 2.9)

M	include/nsthread.h

commit e79c136d8530f982a31eaada8ec85dbf95cc09ee
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-28

    Make NS_GNUC_WARN_UNUSED_RESULT dependent on GCC 3.4 or above

M	include/nscheck.h

commit acbfbe9385683e24ed0de1eacf4d9a12c6dc9cd8
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-28

    JobAbort sets errorCode of ECANCEL for callers to programmatically check the cancellation event

M	nsd/tcljob.c

commit ce4d59e8ff5ceee27f06cb89bc2d097849558eb5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-27

    JobThread: attempt to minimize access to Job elements w/o mutex protection

M	nsd/tcljob.c

commit a7ba70b68d604cc7f7b2f2ae3838e845953898f6
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-27

    Fixed locking of job record. It has to be within the pool lock.

M	nsd/tcljob.c

commit 8550289385d02b768665323cc5daeb19a8370746
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-27

    Revert send/recv buffer change as it apparently works at least on one platform (Linux)

M	ChangeLog
M	nsd/driver.c

commit ea65e29f3f30ea0743e3259de073c1bb49c071c5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-26

    Use hyphens instead of spaces in Tcl handle format string
    
    Spaces create troubles with Tcl [eval].

M	ChangeLog
M	nsd/tcljob.c
M	nsd/tclobj.c

commit 83b94f847941244ca0950f3caa7b58fd19d3a20c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-26

    Cancel jobs properly by means of Tcl_AsyncAlert() mechanism
    
    Job record as reported by the [ns_job joblist] contains the thread ID suitable
    for passing to the [loopctl] facility for finer-grained control.

M	nsd/tcljob.c

commit 5cfab2a70eba30fafc3d292a7d397b06420e38a0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-04-26

    Socket send/recv buffer setup moved to NsStartDrivers() and commented as real NO-OP; too late in startup sequence
    
    TCP honours the buffer-size setup prior to listen() or connect() only.
    Without significant API plumbing, the per-driver values for send and
    receive buffers are just useless.

M	nsd/driver.c

commit 51ab2d4148647a68462e75e612f1f6db5b571334
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-04-09

    Add definition of LLONG_MAX and LLONG_MIN for old gcc versions

M	include/nsthread.h

commit db72e51ee72c03c3fc4e69eb83516e416ec23a34
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-04-09

    Add definition of LLONG_MAX for old gcc versions

M	ChangeLog
M	include/nsthread.h

commit d917d72c033c776d7f6ee26fd6c841a5020305ce
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-27

    Convert to detachable threads in scheduler

M	nsd/sched.c

commit 7092a41b8f767e04cc27f9a651438c0441be18dc
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-27

    Add config param schedsperthread, which causes thread to exit after n jobs
    
    This is for schedule taks with -thread flags only, schedule tasks which are
    executed inside the main sched thread still work as usuall.
    
    This new config parameter similar to jobsperthread will allow one to control threads
    allocation and memory usage by exiting thread and reclaiming memory back to the
    system in case of such memory allocator.

M	ChangeLog
M	nsd-config.tcl
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/sched.c
M	sample-config.tcl.in
M	simple-config.tcl

commit a21fca43e3958580f6f2e43962234a1551cb1a35
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-03-24

    (MakeConnChannel): Handle errors when Tcl_MakeTcpClientChannel fails

M	ChangeLog
M	nsd/conn.c

commit 56bc964ebb101b054970cfd270e24e47e3632ee7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-21

    Update documentation to the latest doctools format

M	doc/src/admin-db.man
M	doc/src/admin-install.man
M	doc/src/admin-maintenance.man
M	doc/src/adp-overview.man
M	doc/src/c-driverdb.man
M	doc/src/c-urlspace.man
M	doc/src/keyl.man
M	doc/src/main-features.man
M	doc/src/main-standards.man
M	doc/src/module-nscgi.man
M	doc/src/module-nscp.man
M	doc/src/module-nsperm.man
M	doc/src/ns_addrbyhost.man
M	doc/src/ns_adp.man
M	doc/src/ns_adp_ctl.man
M	doc/src/ns_adp_debug.man
A	doc/src/ns_adp_register.man
M	doc/src/ns_adp_safeeval.man
M	doc/src/ns_db.man
M	doc/src/ns_gmtime.man
M	doc/src/ns_guesstype.man
M	doc/src/ns_hashpath.man
M	doc/src/ns_hostbyaddr.man
M	doc/src/ns_http.man
M	doc/src/ns_httppost.man
M	doc/src/ns_job.man
M	doc/src/ns_localtime.man
M	doc/src/ns_locationproc.man
M	doc/src/ns_moduleload.man
M	doc/src/ns_parseargs.man
M	doc/src/ns_proxy.man
M	doc/src/ns_purgefiles.man
M	doc/src/ns_quotehtml.man
M	doc/src/ns_register.man
M	doc/src/ns_requestauthorize.man
M	doc/src/ns_runonce.man
A	doc/src/ns_schedule.man
M	doc/src/ns_sendmail.man
M	doc/src/ns_server.man
M	doc/src/ns_serverrootproc.man
M	doc/src/ns_sha1.man
M	doc/src/ns_shutdown.man
M	doc/src/ns_sockcallback.man
M	doc/src/ns_thread.man
M	doc/src/ns_truncate.man
M	doc/src/ns_upload_stats.man
M	doc/src/ns_writecontent.man
M	doc/src/ns_writer.man
M	doc/src/tcl-lib-nstrace.man
M	doc/src/tcl-libraries.man
M	doc/src/tcl-overview.man
M	doc/src/template.man

commit 2688819d56823a5501f6ffa517324435d3e9558c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-20

    Add ns_internalredirect command
    
    Use PACKAGE_NAME consistently.

M	ChangeLog
A	doc/src/ns_internalredirect.man
M	nsd/nswin32.c
M	nsd/tclcmds.c
M	nsd/tclresp.c

commit 4fbe062f8667afce30eab689092d2ed1bdbb8626
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-18

    Use PACKAGE_XXXX macros for consistency

M	ChangeLog
M	nsd/info.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/nsmain.c

commit 19f3a8bb220f05d82ceb6865883230ced9ceece8
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-11

    Remove old unsupported Makefile.win32 files

M	ChangeLog
D	Makefile.win32
D	include/Makefile.win32
M	nscgi/Makefile
M	nscp/Makefile
M	nsdb/Makefile
M	nslog/Makefile
M	nsperm/Makefile
M	nssock/Makefile

commit 6424f9de5b2684a9f4e945bafb951216002a0b22
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-09

    Use nsconfig.h if HAVE_CONFIG_H is defined
    
    This way config file can be distributed and will not be reason for config.h
    collisions.

M	ChangeLog
M	configure.in
A	include/nsconfig.h.in
M	include/nsthread.h
M	nsthread/nsthreadtest.c
M	nsthread/thread.h

commit 3b51aeca8b9ea5d380ba52b2711fa00bc5b912b8
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-09

    Move all platform specific definitions into nsthread.h; fix Win32 specific int64 and printf errors

M	ChangeLog
M	include/ns.h
M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/nsd.h
M	nsd/nswin32.c
M	nslog/nslog.c
M	nsthread/nsthreadtest.c

commit 2e786709034ddd648762090be3f962036888a69a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-09

    Add new public function Ns_HomePathExists
    
    Server now can be run from the current directlry if all required files are
    located in one place.
    
    This is for very small/embedded or test environments, previous functionality
    works as usual.

M	ChangeLog
M	include/ns.h
M	nsd/config.c
M	nsd/log.c
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/pidfile.c
M	nslog/nslog.c
M	nsthread/thread.c

commit 6d4ec6507b9304037a18108d75ac32f1b37f082d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-09

    Updates to sample config file

M	nsd-config.tcl

commit 25e80f55e0ac000b04a58e5f6e2cdf21ef39a6bc
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-09

    Instructions how to build using mingw

M	README

commit ca7395a3b6cb2de2b850d030d19d7fbc6ceaeed0
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-03-09

    Port to Win32 platform using Mingw32/Msys environment
    
    Msys is what Tcl project using, same basic archive is what needed to conpile
    naviserver for win32. Works stable as oppose to MSVC compiled code which used
    to crash for unknown reasons. Same configure script is used and config.h.

M	ChangeLog
M	Makefile
M	configure.in
M	include/Makefile.global.in
M	include/Makefile.module.in
M	include/ns.h
M	include/nsthread.h
M	nsd/Makefile
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/config.c
M	nsd/dns.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/nsd.h
M	nsd/nswin32.c
M	nsd/queue.c
M	nsd/sched.c
M	nsd/tclcache.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tcltime.c
M	nsd/unix.c
M	nsd/watchdog.c
M	nsdb/db.h
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsthread/Makefile
M	nsthread/fork.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	nsthread/signal.c
M	nsthread/thread.c
M	nsthread/winthread.c

commit 596abb7e59fad7568c7c7c3a6e77082880de6ce5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-02-19

    Fix Windows usage of vsnprintf() in Ns_DStringVPrintf()

M	ChangeLog
M	nsd/dstring.c

commit 2b4b3a8c96bb972b01d03bf8f1c0400786965387
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2008-01-30

    Use Tcl_GetStringResult to retrieve result
    
    In Tcl 8.5 accessing directly does not work anymore.

M	ChangeLog
M	nscp/nscp.c

commit 4abf02757101354f8d7b6c160e7ad2eb26b86850
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-01-11

    (NsMain): some platforms deliver RLIM_INFINITY on getrlimit call for RLIM_NOFILES
    
    Take that into consideration when generating log message.

M	ChangeLog
M	nsd/nsmain.c

commit fac31ac116c535f53cd8198aaa103655459c5703
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-01-11

    (NsInitFd): use OPEN_MAX only if defined, otherwise assume 256

M	nsd/fd.c

commit 4ac5697b1583dc9a69d88f262b613d5d24fa7db9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2008-01-11

    (NsInitFd): do not trust getrlimit on Darwin
    
    It returns bogus values (RLIM_INFINITY) for the query of
    RLIMIT_NOFILE. Instead, assume OPEN_MAX and obtain the value of
    the kernel parameter kern.maxfiles and use setrlimit to set
    that value. This usually works good.

M	ChangeLog
M	nsd/fd.c

commit d56a65b59058a89727506f6e6e54cece5f70891b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-12-26

    Don't add $(UNIXOBJS) to PGM target
    
    This results in double inclusion of Unix object files, once in
    the libnsd and once on the command line during the program
    linking. Some platforms (Darwin) complain about duplicate
    symbols in such cases.

M	ChangeLog
M	include/Makefile.module.in

commit 6892204f0987e6b0bfffbe076e96456638acc2ce
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-12-20

    Fixed wrong test of alarm signal trigger that caused the watchdog to restart the worker even when the worker exited regularly

M	ChangeLog
M	nsd/watchdog.c

commit 7a8320d89b78147d7d04f5251c25092015c4d0a1
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-12-18

    Fixed UDP drivers, async reads do not work with UDP packets
    
    Driver need to read packets as soon as possible and queue them
    instead of putting Sock into read/wait/close cycle like for TCP
    connections.

M	ChangeLog
M	nsd/driver.c
M	nsd/queue.c

commit 980432a575dff51585adf20dc804cb014a24b6ae
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-12-08

    When SIGQUIT signal is received make immediate shutdown by setting shutdowntimeout to 0

M	ChangeLog
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/unix.c

commit 170f4091a539e59d08ece5471193e6e8ff19ade4
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-12-02

    Temporarily change thread name to the queueId:id during callback execution for easier logging
    
    Thread name will clearly indicate which job is being executed.

M	ChangeLog
M	nsd/tcljob.c

commit 0e25ef0353870c7dbf644a7f0718ecfbe91404bc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-11-28

    Fix broken isint parsing for default values in NsTclConfigObjCmd

M	nsd/tclconf.c

commit 25b2df2a6be09674a68c6c4c34409ff948b565f6
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-11-28

    (NsTclConfigObjCmd): return canonical 1/0 true/false values
    
    Fixed NsTclConfigObjCmd() to correctly set the
    returned value of a default boolean param to 0/1 and not just
    blindly parrot what user has given (true/false for example) as
    this could (and it does!) break Tcl expressions.

M	ChangeLog
M	nsd/tclconf.c

commit c54d82e84c9afc3cc9bc1ba1fd15c7a57c27e871
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-21

    Use WideInt version of config function when reading readahead value

M	ChangeLog
M	nsd/driver.c

commit 52b2a6d64a191752469d37011f521027809e7947
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-11-18

    Do not attempt to set unlimited number of open files per process while this usually never succeeds

M	ChangeLog
M	nsd/fd.c

commit 19844ddd8046cdce64c4834e37072dcb8b53e222
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-18

    Use copy, not xcopy, because it is more portable and works everywhere

M	include/Makefile.win32

commit 827cced07d3f0e0a37ea912c56bfc0da3d442dd5
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-18

    Changes for final windows port settings

M	include/nsthread.h

commit e65cf9471007700ed6996e23fc34b8f4ea6d5c37
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-18

    Bad move, revert NsFastStat changes back
    
    Windows port just needs proper flags setup to work with the same
    stat or stat64 structures.

M	ChangeLog
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/rollfile.c
M	nsd/tclmisc.c

commit 5a0b06b8cc9ab37a789bdfc8d2da69198ab3c187
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-18

    Add private function NsFastAllocStatBuf to follow Tcl VFS API

M	ChangeLog
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/rollfile.c
M	nsd/tclmisc.c

commit 3e8f6bf7ec1acfa83953413090fde1dd2cccb0d0
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-18

    Fix absence of semicolon between paths for linker in -rpath

M	ChangeLog
M	configure.in

commit 1370b8d869c0d82fdb2782793297aece8c545ca4
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-18

    Use Tcl_AllocStatBuf for Tcl_FSStat to be portable
    
    * include/Makefile.win32:
    Make sure src include goes first
    
    * nsd/tclmisc.c:
    * nsd/rollfile.c:
    * nsd/fastpath.c: Use Tcl_AllocStatBuf for Tcl_FSStat to be
    portable. On Windows using static struct corrupts stack.

M	ChangeLog
M	include/Makefile.win32
M	nsd/fastpath.c
M	nsd/rollfile.c
M	nsd/tclmisc.c

commit b261b881140b8c1a311f307efcf9719579b1100d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-16

    Makefile updates to support debug

M	include/Makefile.win32
M	nsdb/Makefile

commit 2cf629f59c89e9a7e4f72464e96c6872f340f65c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-15

    Little update for win32 building process

M	Makefile.win32
M	include/Makefile.win32
M	include/nsthread.h
M	nsdb/Makefile
M	nsthread/winthread.c

commit 92480ee9615c17b884c8fca86ccb2d5d4f70aaea
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-14

    Minor win32 updates; still big problem is nsdbpg driver
    
    nsd runs fine without it but when connecting to db stack is
    corrupted only when using pg driver.

M	Makefile.win32
M	include/nsthread.h

commit 9b4a6602a568609db189eaa8170d71a82e64dbf7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-14

    Add win32 makefiles for several modules

M	include/Makefile.win32

commit 408a03919d9301bcc8250081fcb9d798dd193301
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-14

    Make Ns_UrlSpecificWalk public function
    
    It is used in many places already and thus should be public.
    
    * include/nsthread.h:
    * nsd/nsd.h: check HAVE_CONFIG_H before including config.h
    
    * Makefile.win32: Updated build process, put help instructions, removed
    automatic config/makefile generations

M	ChangeLog
M	Makefile.win32
M	include/Makefile.win32
M	include/ns.h
M	include/nsthread.h
M	nsd/Makefile
M	nsd/nsd.h
M	nsd/op.c
M	nsd/url2file.c
M	nsd/urlspace.c
M	nsperm/Makefile
M	nsperm/nsperm.c
M	nsthread/nsthreadtest.c
M	nsthread/thread.h

commit d27c76d576534f47f6949a24aa8fb4842b3f144d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-11-14

    Initial Windows port of build system, still work in progress
    
    New makefile added to perform compiling fromcommand line using the same top
    level makefile. To compile for windows, copy include/Makefile.win32
    into include/Makefile.module, the rest stays the same, only every module
    needs to be compiled separately, root Makefile is still unix specific.

M	ChangeLog
A	Makefile.win32
M	include/Makefile.module.in
A	include/Makefile.win32
M	include/nsthread.h
M	nscgi/Makefile
M	nscp/Makefile
M	nsd/Makefile
M	nsd/binder.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/sls.c
M	nsd/tclmisc.c
M	nsd/tcltime.c
M	nsdb/Makefile
M	nslog/Makefile
M	nssock/Makefile
M	nsthread/Makefile
M	nsthread/nsthreadtest.c
M	nsthread/winthread.c

commit 2ec8d559ec00389755671bec7774db232e32d5bc
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-10-23

    Add driver parameter 'maxupload' -- upload disk spooling
    
    * nsd/driver.c:
    * nsd/nsd.h:
    * nsd/conn.c:
    * docs/src/ns_conn.man:
    * include/ns.h: Added new parameter maxupload to the driver which if > 0 enables
    spooling of the whole request contents into regular temp file. After the content is
    put into the file, connection thread can access it using ns_conn contentfile command
    which will return name of temp file. Public function Ns_ConnContentFile and
    Ns_ConnContentFd added to access temporary file.
    
    * tcl/form.tcl: added ns_parseformfile proc which will parse raw content file into
    query parameters and uploaded files if content was in multipart/form-data format
    
    * contrib/examples:upload.tcl: Updated to support new maxupload option

M	ChangeLog
M	contrib/examples/upload.tcl
M	doc/src/ns_conn.man
M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	tcl/form.tcl
M	tests/ns_conn.test

commit 81c936dc3d2ef9ef99f6226f41666dcee2beadb6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-10-23

    Support uploads larger than 2GB
    
    Length fields are Tcl_WideInt now, printf output modifiers updated.

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/progress.c

commit 3c2a41b7348e375e2a518eab876e0be06fd9edf3
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2007-10-23

    (MsMemMap): it is necessary to map the file with the same flags with which it got opened on win32

M	ChangeLog
M	nsd/nswin32.c

commit ebfb0941bce8ce34e6354684f7bf2c6e630f3cd5
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-10-21

    Add test for wide int

M	ChangeLog
M	tests/ns_config.test
M	tests/test.nscfg

commit 4c727ed5b04a13a872583d6f0aa1805fc8d436c9
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-10-21

    ns_config -int now can handle wide integers

M	ChangeLog
M	include/ns.h
M	nsd/str.c
M	nsd/tclconf.c

commit 5dd15c37f02739583bff4f242c936748aa4d27f9
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-10-21

    Fix for DString being freed before used

M	nsd/unix.c

commit 5912db0e748333a304da385a68d16eab28e4cd50
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-10-21

    Add Ns_SetUser, Ns_SetGroup (replaces Privilege routines); add ns_setuser ns_setgroup
    
    * include/ns.h:
    * nsproxy/nsproxylib.c:
    * nsd/nsmain.c:
    * nsd/unix.c: New public API functions Ns_SetUser/Ns_SetGroup instead of
    deleted Ns_SetPrivileges. New Tcl commands ns_setuser/ns_setgroup instead of
    ns_setprivileges
    
    * nsd/nswin32.c: No need for extra stubs

M	ChangeLog
M	doc/src/ns_setprivileges.man
M	include/ns.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/str.c
M	nsd/tclcmds.c
M	nsd/tclmisc.c
M	nsd/unix.c
M	nsproxy/nsproxylib.c

commit a4abd0d7afb172e9694c76ef56d8667a527894cb
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-10-20

    Add Ns_SetPrivileges, Ns_GetPrivileges and ns_setprivileges
    
    * include/ns.h:
    * nsd/unix.c: Added 2 new public API functions Ns_SetPrivileges and Ns_GetPrivileges
    which are resolve and assign user uid/gid
    
    * nsproxy/nsproxylib.c:
    * nsd/nsmain.c: Switched to use new function that assign user real uid/gid
    
    * nsd/tclmisc.c: New Tcl command ns_setprivileges that sets real uid and gid

M	ChangeLog
A	doc/src/ns_setprivileges.man
M	include/ns.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/tclcmds.c
M	nsd/tclmisc.c
M	nsd/unix.c
M	nsproxy/nsproxylib.c

commit 054b1daed40602b184c3275cc65a33c1b0076834
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-19

    Mark driver shut down if none configured
    
    Fixes unclean shutdown in non-server situations when no drivers
    are configured listening.

M	ChangeLog
M	nsd/driver.c

commit a388b54185d6b42ea16824ace451986a3775d490
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-10-19

    Add large file support to NsFastOpen; support Tcl_WideInt in config routines
    
    * include/ns.h:
    * nsd/config.c: Aded new public function for supporting Tcl_WideInt values:
    Ns_ConfigWideInt, Ns_ConfigWideIntRange. This is only for C API currently,
    for Tcl it needs to be evaluated how to do it

M	ChangeLog
M	include/ns.h
M	nsd/config.c
M	nsd/fastpath.c
M	nsd/str.c

commit b47d93681632ecfe0971020f410245b0f403d6f4
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-19

    Disable file access through the Tcl VFS for the fastpath by default
    
    For make benefit glorious static file benchmark performance...

M	ChangeLog
M	configure.in

commit 9d32072282b9d9b98ca2fc618db4026c76934ad1
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-10-18

    Added mime type for .pac files as application/x-ns-proxy-autoconfig

M	ChangeLog
M	nsd/mimetypes.c

commit 096c6fd9bca7aafd6370e03236aa0e3a8187649c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-10-15

    Fixed seting of error related information to the caller of the [ns_job wait]

M	ChangeLog
M	nsd/tcljob.c

commit 2bdcf67d2c091bf3b5c31f93bebe05ff33e40eeb
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-15

    Enable modules to install more than one library header

M	ChangeLog
M	include/Makefile.module.in

commit 82c547a701c44f2dbce5d1476e9709ff8459de8d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-14

    (Nsthreads_LibInit): check for NPTL thread library on Linux and abort if not found

M	ChangeLog
M	nsthread/pthread.c

commit ac630b9711e3888689b94f6a6591fc103f6686e3
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-14

    Remove various bugs and ugliness found by strict compiler checking
    
    * include/ns.h: Add missing declaration for Ns_StopServer().
    
    * nsd/nsd.h: Add missing 'void' to function declaration.
    
    * nsd/adpparse.c: Quieten a compiler warning about int/char truncation.
    
    * nsd/binder.c: The file mode for unix domain sockets was being parsed
    but not used -- pass it on to Ns_SockBindUnix().
    
    * nsd/connio.c (Ns_ConnSend): Remove unused variable 'status'.
    
    * nsd/fastpath.c: Remove unused parameter servPtr.
    
    * nsd/httptime.c: Make sure UCHAR() macro is used consistently for all
    
    char checks. Add parentheses to disambiguate order of evaluation.
    
    * nsd/pathname.c: Remove unused 'path' variable. Make sure to use
    correct servPtr variable.
    
    * nsd/server.c: Remove unused 'spath' variable.
    
    * nsd/sls.c: Remove redundant comparison for < 0 on unsigned variable.
    
    * nsd/tclcmds.c: Add missing struct initializers.
    
    * nsproxy/nsproxylib.c: Fix confusion about return values from Eval(),
    Wait() and Send(). Eval() always returns a Tcl error code, the others
    always return proxy Err codes. Remove unused variable 'incr' from
    Wait().

M	ChangeLog
M	include/ns.h
M	nsd/adpparse.c
M	nsd/binder.c
M	nsd/connio.c
M	nsd/fastpath.c
M	nsd/httptime.c
M	nsd/nsd.h
M	nsd/pathname.c
M	nsd/server.c
M	nsd/sls.c
M	nsd/tclcmds.c
M	nsproxy/nsproxylib.c

commit b73a288b26434ccebf432f0b06f54abe83a0d2aa
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-13

    Quieten some compiler warnings

M	ChangeLog
M	nsd/log.c
M	nsd/tclfile.c

commit af0314e9a90cf75f792eacc95b3dbbda1af906ec
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-13

    Update to latest (3.6) tcl.m4

M	ChangeLog
M	configure.in
M	m4/tcl.m4

commit 687dcda1a0a4d8aeb272d4f4a92ede42d6a39ca7
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-13

    LIBINIT shared lib initialization scheme becomes Nslibname_LibInit()
    
    * nsthread/pthread.c: Abandon the old module LIBINIT system of
    redefining the initialization function to _init(). The loadable module
    _init scheme was only supported by gcc, and support was dropped a long
    time ago. Unfortunately, the _init() functions were clashing with other
    libraries, such as libgcc_s.
    
    New scheme: shared libraries explicitly export an Nswhateva_LibInit(), and
    programs and other libraries which depend on it call it during their own
    initialization.

M	ChangeLog
M	include/Makefile.global.in
M	include/Makefile.module.in
M	include/ns.h
M	include/nsthread.h
M	nsd/Makefile
M	nsd/init.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsproxy/nsproxy.h
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c
M	nsthread/Makefile
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c

commit 8bdee5b68ddea9ff11db7824738a4673f1370a87
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-13

    Use va_copy() before calling vsnprintf() so that it doesn't clobber our original va_list

M	ChangeLog
M	nsd/dstring.c

commit 2ad091d988e2e4e487fc29cfab648117a77cb85a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-12

    Make config commands Tcl obj based; clean up option parsing; catch type errors from config values; add -min and -max options for int types
    
    * tests/test.nscfg:
    * tests/ns_config.man: Add new config tests.
    
    * doc/src/ns_config.man:
    * doc/src/ns_configsection.man:
    * doc/src/ns_configsections.man:
    * doc/src/ns_section.man:
    * doc/src/ns_param.man:
    * doc/src/admin-config.man: Deleted.
    * doc/src/mann/ns_config.man: Add new consolidated config man page.

M	ChangeLog
D	doc/src/admin-config.man
A	doc/src/mann/ns_config.man
D	doc/src/ns_config.man
D	doc/src/ns_configsection.man
D	doc/src/ns_configsections.man
D	doc/src/ns_param.man
D	doc/src/ns_section.man
M	nsd/tclcmds.c
M	nsd/tclconf.c
A	tests/ns_config.test
M	tests/test.nscfg

commit 10b0ee4467d2a8689c47dd0118e62e27560fdd2d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-10-09

    Fixed 32/64bit integer formatting macros

M	include/nsthread.h

commit 68e3abdbfaeb1a13a88154a837ea12af4f027cc3
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-10-09

    Add macro definitions for some formatted IO macros, if not defined
    
    This is the case for older Solaris versions (2.8-).
    
    * nsd/auth.c: Removed stray Ns_PrintSet() call from
    NsParseAuth() call (obviously checked in by mistake).

M	include/nsthread.h
M	nsd/auth.c

commit 93178cf8e9ccf977af3cff3432dd0a75c6ef1971
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-07

    Rename ns_unregister_proc ns_unregister_op
    
    Let it serve to unregister any kind of Ns_OpProc. Remove the
    aliases ns_unregister_adp and ns_unregister_tcl.
    
    * nsd/adprequest.c: Fix missing white space in ADP arg proc.
    
    * tests/adp.test:
    * test/ns_register_proc.test: Use ns_unregister_op.
    
    * doc/src/mann/ns_register_adp.man: Update. Mention configuration
    options.

M	ChangeLog
M	doc/src/mann/ns_register_adp.man
M	nsd/adprequest.c
M	nsd/tclcmds.c
M	nsd/tclrequest.c
M	tcl/compat.tcl
M	tests/adp.test
M	tests/ns_register_proc.test

commit f84316929d8a050e5286baf6fdc1b386e5462a7f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-06

    Use TCL_LL_MODIFIER for content-sent length

M	ChangeLog
M	nslog/nslog.c

commit b6d410f393d49df7761238fa55760cae23cc2273
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-06

    Partition per-server urlspaces using an arrat of junctions rather than index nodes in the tree
    
    Add programmer notes about this tricky data structure.
    
    * nsd/limits.c:
    * nsd/queue.c:
    * nsd/url2file.c: Update to use internal convenience function
    NsUrlSpecificGet().

M	ChangeLog
M	nsd/limits.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/url2file.c
M	nsd/urlspace.c

commit e395ad802b4d87025be0be73ab3bcc51c7b878da
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-10-04

    Make file support over 2Gb working again
    
    Convert all response and content length variables into Tcl_WideInt.

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/connio.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c

commit 5a409cdde4606a22dd556d88feebfcab6d7c0678
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-02

    Update docs to new tclllib-1.10 syntax
    
    Unfortunately, new tcllib complains voluminously about the old
    syntax, and old tcllib dies on the new.
    
    We love the bleeding edge...

M	ChangeLog
M	doc/src/man3/Ns_Sls.man
M	doc/src/mann/ns_accesslog.man
M	doc/src/mann/ns_atsignal.man
M	doc/src/mann/ns_cache.man
M	doc/src/mann/ns_cookie.man
M	doc/src/mann/ns_ictl.man
M	doc/src/mann/ns_limits.man
M	doc/src/mann/ns_log.man
M	doc/src/mann/ns_memoize.man
M	doc/src/mann/ns_register_adp.man
M	doc/src/mann/ns_return.man
M	doc/src/mann/ns_returnerror.man

commit 4985e37bd3145db054e8a4b5f745ff84773980bb
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-10-02

    Differentiate between unspecified content-length and explicit zero length
    
    * include/ns.h:
    * nsd/connio.c:
    * nsd/queue.c:
    * nsd/return.c: Make sure we can tell the difference between an
    unspecified content-length and an explicit zero length body, such as a
    header flush. Shuffle the code around to try and make the relationship
    between length, streaming, chunking, keep-alive etc. clearer.
    
    * nsd/conn.c:
    * nsd/tclresp.c: Re-add the -binary switch to ns_headers. Binary
    streaming now possible.
    
    * tests/tclresp.test: Updates for mime-type/charset issues.
    * tests/tclconnio.test: Add tests for 'ns_conn chanel'.
    
    * doc/src/mann/ns_write.man: Explain the -binary switch.

M	ChangeLog
M	doc/src/mann/ns_write.man
M	include/ns.h
M	nsd/conn.c
M	nsd/connio.c
M	nsd/queue.c
M	nsd/return.c
M	nsd/tclresp.c
A	tests/tclconnio.test
M	tests/tclresp.test

commit 10374764ae2034e5a19f24791208ecea3c75bebd
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-09-29

    Send/Wait/Recv functions now return internal errorcode instead of standard Tcl error codes

M	nsproxy/nsproxylib.c

commit 351b4d78cab92ae4181c8a1fe5081ad279fcefec
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-09-29

    Ns_GetTime now relies on Tcl_GetTime to be platform-independent
    
    Also, untabified and formatted.
    
    * nsproxy/nsproxylib.c: send/receive timers now operate on
    absolute instead of relative time quantums.

M	ChangeLog
M	nsproxy/nsproxylib.c
M	nsthread/time.c

commit 2ce5d2b0ba8ff571b2efcde732f236c113931ed1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-09-29

    (ns_headers): allow -1 as length, allowing binary streams of unknown size

M	ChangeLog
M	nsd/tclresp.c

commit bf0b722f813d5b2fcf693906228ff75b2edc1095
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-09-26

    Make sure -jobid parameters ignored if empty string is given
    
    Also, add error message to the log for detached and failed jobs.

M	ChangeLog
M	nsd/tcljob.c

commit a523a60d34a242e1455ad8de7e54fbecceb5694a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-20

    Ns_Sls.man: fix stray curly-bracket and add extra markup around types, args etc.

M	ChangeLog
M	doc/src/man3/Ns_Sls.man

commit 95437231247dc42ed0f7b78813b35c722f896159
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-15

    Guard against disabling the Fatal log severity; make sure that Fatal log messages are always flushed, even when 'hold' is active

M	ChangeLog
M	nsd/log.c
M	tests/ns_log.test

commit c6d8aa7ed219975abe0eed47ed1535a9d3e75bac
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-15

    Call filters 'filters' instead of callbacks; remove some redundant wrappers; shuffle the code

M	ChangeLog
M	nsd/log.c

commit c82a9bd199d5f6de58308f48516a371f29968f61
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-15

    Add names to numeric log severity levels
    
    * include/ns.h:
    * nsd/log.c: Drop the idea of maxloglevel auxiliary logging levels and
    instead add a new Ns_CreateLogSeverity() which creates a named severity
    level. C code still passes round an integer severity level, the severity
    name appears in the log file.
    
    ns_logctl severity can create new severity levels on the Tcl side and
    enable/disable them individually, unlike the old scheme in which to
    enable level 100 levels 0-99 also had to be enabled. A reasonable number
    of integer levels are still supported for backwards compatibility.
    
    ns_logctl severities lists all created severities.
    
    * nsd/callbacks.c:
    * nsd/tclinit.c: Update after renaming Ns_LogLevel() to
    Ns_LogSeverityEnabled().
    
    * doc/src/mann/ns_log.man:
    * tests/ns_log.test: Updated.

M	ChangeLog
M	doc/src/mann/ns_log.man
M	include/ns.h
M	nsd/callbacks.c
M	nsd/log.c
M	nsd/tclinit.c
M	tests/ns_log.test

commit d50e37ca3ebd97f4a952f18e2f9a531218198d42
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-12

    (CmdThread): set the thread name for the command shell thread so that log messages are less ugly

M	ChangeLog
M	nsd/nsmain.c

commit 35c2435d3db6e387da5a29e5d395fa029c9659c7
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-12

    Combine the error logging commands docs and move into place; update

M	ChangeLog
A	doc/src/mann/ns_log.man
D	doc/src/ns_log.man
D	doc/src/ns_logctl.man
D	doc/src/ns_logroll.man

commit accca2298ee0633b3bae2348770d69dcd2c29f69
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-12

    (LogObjCmd): fix inconsistent use of CamelCase in return value of [ns_accesslog flags] command

M	ChangeLog
M	nslog/nslog.c

commit 0043e847e83e5b4ff27fd916cf9dc979437fa443
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-12

    Remove redundant embedded documentation in nslog.c

M	ChangeLog
M	nslog/nslog.c

commit 5d8b24f6acd41a08ba1f9f07a9a09656cc0e7375
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-12

    Fix mix-up with static/dynamic memory and the result from the [ns_accesslog file] command

M	ChangeLog
M	nslog/nslog.c

commit e3031781337d5eaebf35bb543988b3067710866d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-12

    Update and move ns_accesslog man page

M	ChangeLog
A	doc/src/mann/ns_accesslog.man
D	doc/src/ns_accesslog.man

commit 62b78f63d4d145ff780c0b679856df96d14df4de
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-11

    (LogFlush): remove redundant and annoying error logging
    
    Error occurred when a log-flush failed due to a previous error
    rolling and re-opening the file. Shuffle some code around to
    put public API at the top of the file.

M	ChangeLog
M	nslog/nslog.c

commit 927dcddafdb06a839b0de7840c81f50870d336a0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-09-11

    Enable ns_write to construct response headers
    
    * nsd/nsd.h:
    * nsd/tclresp.c: Re-enable the ability to use ns_write to manually
    construct headers or some other non-HTTP response. It does not now
    auto-generate a set of headers on first write -- ns_headers must be
    called first.
    
    * doc/src/mann/ns_return.man:
    * doc/src/mann/ns_write.man: Split ns_write, ns_headers and
    ns_connsendfp into their own man page, the distinction being that they
    all construct responses incrementally whereas ns_return, ns_respond,
    ns_returnfile and ns_returnfp return a fully formed HTTP response.
    
    * tests/tclresp.test: Test the headers/no-headers case for ns_write and
    ns_startcontent.

M	ChangeLog
M	doc/src/mann/ns_return.man
A	doc/src/mann/ns_write.man
M	nsd/nsd.h
M	nsd/tclresp.c
M	tests/tclresp.test

commit 7001f92c05f94bb6c542bf7ae2a1f570ce50b0ab
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-22

    Fix bug with missreported content-length of static files
    
    * nsd/connio.c (ConnSend):
    * tests/http.test:
    * tests/testserver/pages/16480bytes: Add a call to
    Ns_ConnSetLengthHeader() at the start of ConnSend() with the total
    length of the file to send, otherwise Content-Length gets reported as
    8192 which is the size of the buffer (IOBUFSZ) used to read the file off
    disk.

M	ChangeLog
M	nsd/connio.c
M	tests/http.test
A	tests/testserver/pages/16480bytes

commit 9f75ca8e79894d125a6cffd3017f18326d5a6ad2
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-08-21

    Add support for stat64 in FastStat
    
    It uses TCL defined HAVE_STRUCT_STAT64.

M	ChangeLog
M	nsd/adprequest.c
M	nsd/fastpath.c
M	nsd/nsd.h

commit 2978f19956b597dc03a0ecf3da78d32d17b7f1c9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-08-20

    Proxy ID is now allocated dynamically instead of having limited/fixed length of 16 characters

M	ChangeLog
M	nsproxy/nsproxylib.c

commit 7eec4f690d5ff0d8ea208ced7e4d5b840d9e465c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-08-14

    Replaced uint32 with ns_uint32

M	ChangeLog
M	nsd/tclmisc.c

commit 2c183864a4e3ed8a6d19a4297fa547560ba88731
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-12

    Use Ns_ConfigFlag() for flags

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h

commit f9f071d4c4a539ff22694ac2abb5dac04f78d975
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-12

    Set cookies with the HttpOnly option by default, making cookie data unavailable to client javascript engines
    
    (on those browsers which support it)
    
    A new -scriptable option is available to ns_setcookie to get the
    old behaviour. HttpOnly cookies are not as susceptible to XSS
    attacks: secure by default.
    
    The C API has a couple of new flags: NS_COOKIE_SECURE and
    NS_COOKIE_SCRIPTABLE, which replace the old 1/0 flag to
    Ns_ConnSetCookieEx().

M	ChangeLog
M	NEWS
M	doc/src/mann/ns_cookie.man
M	include/ns.h
M	nsd/cookies.c
M	tests/cookies.test

commit ecaa8e89b6b7a53b5b9499fd9d945d3e16bde1de
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-12

    (ns_cookie): rename -maxage -expires matching common usage throughout API; handle absolute and relative time values

M	ChangeLog
M	NEWS
M	doc/src/mann/ns_cookie.man
M	nsd/cookies.c
M	tests/cookies.test

commit f42b9d2658c325c6c10de1369cfe1b39004bfaab
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-12

    Remove the async cancel stuff; see module: nsloopctl

M	ChangeLog
M	nsd/tclinit.c

commit b78408a288eac78a85d604f8d274ec9bdf7fec38
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-11

    Catch NS_TIMEOUT errors for Tcl and ADP pages
    
    Fixes failing test timeout-1.1.
    
    * nsd/tclrequest.c: The timeout error code can now be a list, with
    NS_TIMEOUT as the first element and whatever else as the remaining
    elements.

M	ChangeLog
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/nsd.h
M	nsd/tclrequest.c
A	tests/testserver/pages/timeout-inc.adp
A	tests/testserver/pages/timeout.adp
M	tests/timeout.test

commit cccc83606ad0aee493e50c41fe9e9e92c0f61aa4
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-11

    Fix encoding declaration in mime-type header
    
    * include/ns.h:
    * nsd/return.c: Add new Ns_ConnSetEncodedTypeHeader. The distinction
    between this and Ns_ConnSetTypeHeader is that the mime-type header is
    set in an encoding aware manner with a charset declaration. Either it is
    provided as part of the mime-type and the connection encoding is set
    accordingly, or a charset name is constructed according to current
    connection encoding (see Ns_ConnSetEncoding).
    
    This is a change from the old way of doing it in which whether to add a
    charset declaration depended on the mime-type being of type
    text/*. Unfortunately, this doesn't work with modern XML types which are
    often declared as application/xml+whatever.
    
    You usually know whether you're sending binary or character data anyway
    because you have to choose between Ns_ConnReturnData() and Ns_ConnReturnCharData().
    
    * nsd/tclresp.c: Add the -binary switch to ns_headers to signify that you
    intend sending binary data (probably with ns_write) and that the
    mime-type header should not have a charset declaration appended.
    
    * nsd/encoding.c: Depreciate Ns_GetEncoding(). There's never a situation
    in which you want can't use Ns_GetCharsetEncoding() which handles
    naviserver charset aliases as well as Tcl encoding names.
    
    Add Ns_GetEncodingCharset() which prefers to return a naviserver charset
    alias given a Tcl encoding, falling back to the Tcl encoding name.
    
    * nsd/conn.c: ns_conn encoding and urlencoding now correctly return a
    charset name, not Tcl encoding name.
    
    * nsd/nsd.h: Don't force iso-8859-1 encoding for the default text/html
    types via NSD_TEXTHTML.
    
    * nsd/tclcmds.c: ns_encodingforcharset is now an obj command.
    
    * nsd/adpcmds.c:
    * nsd/adpeval.c:
    * nsd/adprequest.c:
    * nsd/connio.c:
    * nsd/queue.c: Various updates to use Ns_ConnSetEncodedTypeHeader() etc.
    
    * tests/encoding.test:
    * tests/tclresp.test:
    * tests/test.nscfg: encoding-7.1 knownBug: not a bug any more. This was
    serving a static HTML file and adding an unneeded charset to the
    mime-type.  Add some more tests, and some fix-ups.

M	ChangeLog
M	include/ns.h
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/encoding.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c
M	nsd/tclcmds.c
M	nsd/tclresp.c
M	tests/encoding.test
M	tests/tclresp.test
M	tests/test.nscfg

commit 6929d51bf4a01a20d3f733d78b8f496ab7d41828
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-06

    Test for namespace variables: should get duplicated or not?

M	ChangeLog
M	tests/init.test
M	tests/testserver/modules/init-test.tcl

commit 7b1654c74809a9273019ac56739894039f51ad96
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-08-05

    Add new ns_perm commands deluser, delgroup, delperm and reload

M	ChangeLog
M	doc/src/ns_perm.man
M	nsperm/init.tcl
M	nsperm/nsperm.c

commit bffd109a3d597d149a8ece78381eb09f39dbffb5
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-04

    Really fix the nsproxy tests. For sure

M	ChangeLog
A	nsproxy/test-nsproxy.sh
M	tests/test.nscfg

commit dbfd143a306ba20834a771c18ef97f80fbccdef4
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-04

    Add a couple of tests of the interp cloning code

M	ChangeLog
A	tests/init.test
A	tests/testserver/modules/init-test.tcl

commit 7c7b1e0165555468bccb69a8dc41edd7c29f63af
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-04

    Fix nsproxy tests; add 'memcheck' valgrind make target
    
    * Makefile: Add the nsproxy directory to the library path so that tests
    run without being installed. Add 'memcheck' target to run valgrind with
    the memcheck tool.

M	ChangeLog
M	Makefile

commit 861faeb603af1ad8f5ebcce822f1d6834da9bf5e
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-04

    Less verbose logging of default adp/tcl URL mappings

M	ChangeLog
M	tcl/config.tcl

commit 76b3d998bd01751df4a8fc4f97fb14f3e8af3a2f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-04

    Don't leave the Tcl system encoding to chance
    
    Either it's utf-8 or some one set it specifically in the config
    file using the new ns/server/$server:systemencoding parameter.

M	ChangeLog
M	nsd/init.tcl

commit 597f7d38b7d5ff882212c772b0855e2f09c1265c
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-08-01

    Make tests robust to unrelated logging activity

M	ChangeLog
M	tests/ns_log.test

commit bae4ff845dd5da1a5ff2d986cf22e7cd285cec6c
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-07-31

    Fix progress clobering and SLS cleanup callbacks (bug #1724222)
    
    * nsd/driver.c:
    * nsd/progress.c:
    * tests/http.tcl: Make sure progress for duplicate URLs don't clobber
    each other. Cleanup the reset handling. Make sure SLS callbacks run only
    when a socket actually closes, not when set aside for keepalive.
    
    * tests/all.tcl: Typo: s/Devel/Dev/

M	ChangeLog
M	nsd/driver.c
M	nsd/progress.c
M	tests/all.tcl
M	tests/http.test

commit 4e07827e7499c37721b3b135826a06294ceee746
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-07-22

    Fix chunking by redesigning the output headers mechanism
    
    * include/ns.h:
    * nsd/nsd.h:
    * nsd/return.c:
    * nsd/connio.c: Depreciated: Ns_ConnSetRequiredHeaders(),
    Ns_ConnQueueHeaders(), Ns_ConnFlushHeaders(). Default headers and
    flushing are now handled at last moment by Ns_ConnWriteVData() which
    knows exactly how many bytes are to be sent. The Ns_ConnWrite* routines
    now take a flags argument and an NS_CONN_STREAM flag which enables
    chunking if possible.
    
    This fixes streaming and chunking and enables it in more situations. We
    were also needlessly flushing headers early causing an extra TCP packet
    and corresponding RTT.
    
    Ns_ConnSend() no longer flushes headers. Don't call this directly unless
    you really need to skip all HTTP specific logic (and don't call it in a
    loop).
    
    * nsd/conn.c: ns_conn chunked*, Ns_Conn*Chunk* etc. removed.
    
    * nsd/encoding.c: New NsEncodingIsUtf8() to allow null utf8-to-utf8
    transformation to be skipped on write.
    
    * nsd/queue.c: No more write-behind buffer, which was header specific
    anyway.
    
    * nsd/adprequest.c:
    * nsd/driver.c:
    * nsd/fastpath.c:
    * nsd/returnresp.c:
    * nsd/tclresp.c:
    * nscgi/nscgi.c:
    * tcl/compat.tcl: Various old to new API updates, removing direct calls
    to flush headers etc.
    
    * tests/encoding.test:
    * tests/http_chunked.test:
    * tests/ns_conn.test:
    * tests/tclresp.test: Various extra tests for corner cases and removing
    knownBug constraints.

M	ChangeLog
M	include/ns.h
M	nscgi/nscgi.c
M	nsd/adprequest.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c
M	nsd/returnresp.c
M	nsd/tclresp.c
M	tcl/compat.tcl
M	tests/encoding.test
M	tests/http_chunked.test
M	tests/ns_conn.test
M	tests/tclresp.test

commit ec78e5c38b2dd80c785464c635666ed9b0a0f18f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-07-22

    Various test cleanups and additions; some new bugs exposed
    
    * tests/all.tcl: Log a messages (Devel) as each test begins to help
    correlate other log messages to tests, when debugging.
    
    * tests/testserver/pages/hello.html:
    * tests/testserver/pages/hello.xhtml: Static pages to check mime-type
    header w/hackcontenttype enabled. (test encoding-7.1, currently failing).
    
    * tests/testserver/modules/testhttp.tcl: Handle case where content is
    returned chunked and keep-alive is enabled. i.e. connection-close can
    not be used as an end-of-message marker.
    
    * tests/testserver/pages/http_chunked.adp: Manipulate ADP buffer size if
    requested to force streaming with test-sized ADP pages.
    
    * tests/test.nscfg:
    * tests/http.test: Distinguish between writersize and uploadsize and add
    another test. (Two bugs here: long standing read-buffer misshandling
    causing endless loops, and new progress crash caused by multiple
    SockClose() from different threads (?) )
    
    * tests/http_keep.test: New tests for keep-alive logic for HTTP 1.0 and
    1.1 clients. (1 POST bug: is the test or the code broken?).

M	ChangeLog
M	tests/all.tcl
M	tests/http.test
A	tests/http_keep.test
M	tests/test.nscfg
M	tests/testserver/modules/testhttp.tcl
A	tests/testserver/pages/hello.html
A	tests/testserver/pages/hello.xhtml
M	tests/testserver/pages/http_chunked.adp

commit 7499893ac26d9fa23ec8c300c7679cffa8578d04
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-07-10

    Move ns_startcontent to tclresp.c
    
    Command isn't documented in ns_return.man -- doesn't this overlap
    with ns_headers and ns_conn encoding?

M	ChangeLog
M	nsd/conn.c
M	nsd/tclresp.c

commit 7379e6ad463960b5c79f146276afd4bf71b2e365
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-07-10

    Auto detect binary data in ns_write, ns_return etc.; remove ns_conn write_encoded etc.

M	ChangeLog
M	doc/src/mann/ns_return.man
M	include/ns.h
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/tclobj.c
M	nsd/tclresp.c
M	tests/http_chunked.test
M	tests/ns_conn.test
M	tests/tclresp.test

commit c9f1fd2bc7effe5d681029e04a1a5d6d8f822ab1
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-07-05

    Break out ns_register_adp etc. into own man page

M	ChangeLog
A	doc/src/mann/ns_register_adp.man
A	doc/src/ns_register.man

commit 45bbaa4fd25dd2f676287c3a2bca47f32decb3f7
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-07-05

    Add ns_register_adp -options; rename -cache -expires; code cleanup and fixes
    
    * include/ns.h:
    * nsd/nsd.h:
    * nsd/adprequest.c:
    * nsd/tclrequest.c:
    * nsd/adpeval.c:
    * nsd/proc.c: Public function Ns_AdpRequestEx() was defined to take a
    flags argument, but all the flags are private. Dropped the flags
    argument and added a private version for the benefit of ns_register_tcl,
    which was the only user of this.
    
    Add an -options switch to ns_register_adp which takes all the same
    options as ns_adp_ctl.
    
    Renamed -cache -expires.
    
    Dropped the public Ns_AdpRequestProc and Ns_TclRequestProc -- it doesn't
    make as much sense as exposing  Ns_FatPathProc.
    
    Shuffled some code around: ns_register_adp etc. moved from tclrequest.c
    to adprequest.c.

M	ChangeLog
M	include/ns.h
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/nsd.h
M	nsd/proc.c
M	nsd/tclrequest.c

commit 7af0b4ac7f73e7be3b50a0c378b059952dd9e759
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-07-03

    Make Ns_StrToInt to convert hex and decimal numbers

M	ChangeLog
M	nsd/str.c

commit 3bcdb724360c9713ef7830f09c54257103f01854
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-07-03

    sample-config: use new parameter for progress reporting; examplepage fixed

M	ChangeLog
M	contrib/examples/upload.tcl
M	doc/src/ns_upload_stats.man
M	nsd-config.tcl
M	nsd/progress.c

commit f40ef4f212acdcf84b78f08e18ee66c65f60737a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-06-29

    Remove URLDECODE_RELAXED ifdef as not needed any more
    
    Plus, it made ns_urldecode/ns_urlencode unsymmetric.

M	ChangeLog
M	nsd/urlencode.c

commit 20b281231009c6cffe7e6680d19fc87a38874c9b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-28

    Add a couple of more ADP tests (ns_adp_ctl, ns_adp_append, ns_adp_puts, ns_adp_eval, ...)

M	ChangeLog
M	tests/adp.test

commit 0d476616e9bc4eecc346e795febd0137f599466f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-28

    Delete some unneeded ADP man pages

M	ChangeLog
D	doc/src/ns_adp_compress.man
D	doc/src/ns_adp_stream.man

commit d3ff76f1b70111994557662308c47b4528ad7147
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-28

    ADP command cleanup
    
    Add a couple of missing ADP commands (ns_adp_close, ns_adp_flush)
    to the list.
    
    Remove a couple of deprecated commands (ns_adp_stream, ns_adp_compress)
    and add Tcl implementations to compat.tcl.
    
    Clean up the arg parsing of the ADP commands in adpcmds.c.

M	ChangeLog
M	nsd/adpcmds.c
M	nsd/tclcmds.c
M	tcl/compat.tcl

commit b86b1bbf62c3db45cf1ebea140edeac9dd4a2e23
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-28

    Don't try to close a NULL conn

M	ChangeLog
M	nsd/adprequest.c

commit 4cfaf55a7e6c682cb993c0c267bd851eb2493159
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-27

    Update interp documentation

M	ChangeLog
A	doc/src/mann/ns_ictl.man
D	doc/src/ns_cleanup.man
D	doc/src/ns_cleanupchans.man
D	doc/src/ns_eval.man
D	doc/src/ns_ictl.man
D	doc/src/ns_init.man
D	doc/src/ns_markfordelete.man
D	doc/src/ns_reinit.man

commit d66477b062af676d6375fb6cd5a33e002a49ebc1
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-26

    Add missing space before appending 'referer' log entry

M	ChangeLog
M	nslog/nslog.c

commit 0534de518d15b1bbe93869bbe969406b0af1b736
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-26

    Use modern autoconf macros to check for various integer types
    
    Define them if not provided by the host OS. This should be enough
    to kill off ns_int8/16/32 etc. in ns.h
    
    Add checks for intptr_t and intmax_t which we now use.

M	ChangeLog
M	configure.in

commit 48254c2a8f55f8e1eb991d1c718437d4a59814b4
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-26

    Check compiler earlier in sequence to avoid redundant checks later

M	ChangeLog
M	configure.in

commit 03e736cf2d5c51a758633b7e3ca065a12d4b7e33
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-26

    Log the request time in the access log, for testing

M	ChangeLog
M	tests/test.nscfg

commit 64434b8bce4704db30749d33f964c7a89ce2a1bc
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-26

    Implement Ns_DStringVPrintf() using OS vsnprintf() to pick up modern format specifiers and bug fixes
    
    (dsprintf.c was 7 year old NetBSD code)
    
    This is similar to the old AOLserver 3.x implementation except that
    instead of printing into a large stack buffer and ignoring overflows,
    taking the hit of always copying the result into the dstring, we
    manipulate the dstring buffer and print directly into it. (There are
    only 2 instances in the current test suite where we overflow static
    space and need to grow.)
    
    NB: Win32 is handled, but untested. I don't think we care about Irix any
    more, which seems to have been a concern of the old code.
    
    * nsd/tcltime.c: Quieten some compiler warnings when platform time_t is
    not a long.

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
D	nsd/dsprintf.c
M	nsd/dstring.c
M	nsd/sched.c
M	nsd/tclcache.c
M	nsd/tcltime.c

commit 8fcd8c67e6c4e35cf164b12d4eeb665c997a0255
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-25

    Don't protect inttypes.h with an ifdef in a public header
    
    Unfortunately this will never be picked up from the private
    config.h. Explicitly include stdint.h which doesn't get dragged
    in by other means on freebsd.

M	ChangeLog
M	include/nsthread.h

commit 9501e9710a0ccefeb41e78ac49519e620b2e5626
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-25

    An uninitialized variable was being read in a non-critical config routine

M	ChangeLog
M	nsd/config.c

commit aa25ff3e01602a82bd970c08078e61ca01f1de1c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-06-11

    Silence compier warning
    
    make test now fails on encoding tests after last updates

M	ChangeLog
M	nsd/tcltime.c

commit c1bdcfdb65a8119781fd6231a2503d1b3842dd20
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-09

    Replace various calls to sprintf() into fixed-sized buffers with safer routines
    
    Replace with calls to Ns_DStringPtrintf(), direct use of Tcl
    objects for return values, or use of bounded snprintf()
    calls. Make sure buffer sizes are reasonable and have well
    defined lifetimes.

M	ChangeLog
M	include/nsthread.h
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/config.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/httptime.c
M	nsd/log.c
M	nsd/nswin32.c
M	nsd/pidfile.c
M	nsd/queue.c
M	nsd/return.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tcljob.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tcltime.c
M	nsdb/dbtcl.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c
M	nsthread/mutex.c
M	nsthread/reentrant.c
M	nsthread/thread.c
M	nsthread/winthread.c

commit c83a8687c8a71d4ed598926999ea8bd8162d4566
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-09

    Use TCL_LL_MODIFIER to format Tcl_WideInt types to prevent warnings on certain 64bit systems

M	ChangeLog
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/return.c

commit a18035f7ecff2e5fc87ce1257241c5556f202be0
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-06-07

    Update config parameters debug into logdebug

M	ChangeLog
M	nsd-config.tcl
M	sample-config.tcl.in

commit 3b3d81cdad5316711d564b72432c47b9c4012e76
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-04

    Add a lot of ugly casting when passing int's through void pointer storage
    
    This prevent compiler warnings when an int and a pointer are not
    the same size.
    
    (mainly Tcl hash tables)

M	ChangeLog
M	nsd/binder.c
M	nsd/cls.c
M	nsd/conn.c
M	nsd/limits.c
M	nsd/listen.c
M	nsd/returnresp.c
M	nsd/sched.c
M	nsd/sls.c
M	nsd/sockcallback.c
M	nsd/tclfile.c
M	nsd/tclobjv.c
M	nsd/tclsock.c
M	nsdb/dbinit.c
M	nsperm/nsperm.c
M	nsproxy/nsproxylib.c

commit 959dbe1d035c17e11d01a2d65ac80277169c6aee
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-04

    Include pthread.h for definition of pthread_sigmask() on FreeBSD

M	nsthread/signal.c

commit 9d336e4543e8303e0f71b3de6cb99e611016297c
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-04

    Convert Ns_ThreadId() to return a uintptr_t
    
    An uintptr_t is an integral type which is as long as a pointer, so
    that it can accurately hold an opaque pthread_t whether it is
    implemented as an integer type, a pointer, and on 32/64 bit
    machines. This fixes many pointer/integer of different size warnings.
    
    Log messages now print the thread ID in hex, for brevity on
    64bit machines.
    
    NB: depending on the architecture of your machine, the ABI may have
    changed and require a recompile.

M	include/nsthread.h
M	nsd/log.c
M	nsd/tclinit.c
M	nsd/tclthread.c
M	nsthread/cslock.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	nsthread/thread.c
M	nsthread/tls.c
M	nsthread/winthread.c

commit 7d264543ef81b5f29d6522b866ad5920f0bd0073
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-02

    Remove redundant code which was reading an uninitialized variable

M	nsd/adpparse.c

commit acb9dacebec447d4e51bdb0bc0037e5114a828d6
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-06-02

    Match using globbing to handle different Tcl version error messages

M	tests/ns_nsv.test

commit 8a9a521ae944ec6e5d5c9a842dbfb111e591353d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-25

    Fixup a variety of tests
    
    * tests/ns_gifsize.test:
    * tests/ns_jpegsize.test: Remove redundant checks for sample files. Be
    more explicit about where the files live in the filesystem.
    
    * tests/ns_info.test: Be a little less brittle when checking the binary
    name.
    
    * tests/timeout.test: Temporarily mark a timeout test knownBug until I add
    support to the ADP code.
    
    * tests/test.nscfg: Add a log-level Devel placeholder (default off),
    which is handy for checking config values etc.

M	tests/ns_gifsize.test
M	tests/ns_info.test
M	tests/ns_jpegsize.test
M	tests/test.nscfg
M	tests/timeout.test

commit 447174565587afb4f867348f8710a6c527dd3e7a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-25

    Move the ADP config into a ServerInitProc callback within the ADP code

M	nsd/adpeval.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/server.c

commit 70472534c4c874624de885c877dc22c6cc023a2c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-25

    Fixed install-doc target so it will not put .html in the top dir anymore

M	Makefile

commit e4650ef29fe7b932298604bfc80df5b08bdf2f74
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-25

    Add Ns_ConfigFlags() to simplify setting flag options

M	include/ns.h
M	nsd/config.c

commit b00ac182edffd898694efbfd020fcf73832efa0b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-25

    Move ADP and Tcl page mapping config, with existing semantics, from C to Tcl

A	tcl/config.tcl

commit ff65e612e8d8258998c6becb2998b90daf1923f0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-25

    Add ns_register_tcl, analogous to ns_register_adp; make mapped pages respect -cache; allow relative pathnames for mapped pages

M	nsd/proc.c
M	nsd/tclcmds.c
M	nsd/tclrequest.c
A	tests/adp.test

commit 219077ecf0168d9a43bb8d8e5727e7aa633fecae
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-25

    (NsTclRegisterAdpObjCmd): add -cache option to ns_register_adp to enable output caching
    
    Add simple plain ADP page test.

A	tests/testserver/pages/helloworld.adp

commit f384a481bb7a2bec2c75f7dd5452c400a4306612
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-24

    Make ADP and Tcl page handlers public (Ns_AdpPageProc, Ns_TclPageProc) and use them directly from ns_register_adp etc.
    
    Clean up arg handling -- get the NsServer via the Conn rather than explicitly passing it around.

M	nsd/adprequest.c
M	nsd/fastpath.c

commit 83e6dfc7b99963eb8bbd8bab3bfc45badbd767b3
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-24

    Update config parameter because of dropping file.tcl; parameters moved to ns/server/servername/adp

M	sample-config.tcl.in

commit 2cc691bba860bb5f6f0976cecfd5d4e6e25019c3
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-24

    Use a more robust check for buffer full condition
    
    Tcl may not fill it all the way when it complains of lack of space.
    Fixes bug reported by Neophytos Demetriou, Thanks.

M	nsd/connio.c
M	tests/encoding.test

commit e90f287481769890f5d21c01c88669cbe683e8ee
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-24

    Remove tabs and re-indent

M	nsd/adpcmds.c

commit 7d78898ea92193d400b23322efea8797d037efbf
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-24

    Add basic test of Tcl page processing, short and long pages

A	tests/testserver/pages/helloworld.tcl

commit 52496aa5dbec6c6e7afc9845480a254d317ad5b3
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-24

    Make global file encodings to per-server; make url and content encodings per-server only

M	ChangeLog
M	nsd/adpeval.c
M	nsd/encoding.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/server.c
M	nsd/urlencode.c
M	tests/test.nscfg

commit 3fddc815b6a4650b0331e9619cb89e5ba05ed876
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-24

    Consolidate encoding configuration; convert ns_charsets to Obj command

M	ChangeLog
M	nsd/encoding.c
M	nsd/init.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/tclcmds.c

commit 0b7e7decbeecbe1ea33dc2c3ec1cae73407fb9aa
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-23

    Use the http charset aliases to convert ADP pages as they are read from disk; add a couple of tests
    
    This fixes the log warning "encoding: could not load: iso-8859-1", and
    unfortunately highlights another broken test: encoding-3.3 added
    to knownBug...

M	ChangeLog
M	nsd/encoding.c
M	tests/encoding.test
M	tests/test.nscfg
A	tests/testserver/pages/encoding.iso-8859-2_adp

commit 088ec6c63d9a122b8ddcf6bc4c0c78311a51b414
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-23

    Re-enable some encoding tests which actually do work and reformat the tests for clarity

M	ChangeLog
M	tests/encoding.test

commit e7c686d64f89be35da31f70de98d3753baa90952
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-23

    (nstest_http): revert to chunk-agnostic mode; fix chunk tests
    
    * tests/testserver/modules/testhttp.tcl: Revert the chunk handling
    code -- it obscures the test expectations for the chunk tests as worse:
    it hides bugs in various parts of the server.
    
    * tests/http_chunked.test: Revert to explicit chunk checking, and mark a
    couple of tests knownBug which are being chunked but shouldn't be.
    
    * tests/http.test: Mark some tests knownBug which are being sent back
    chunk encoded, but shouldn't be.
    
    * tests/ns_adp_compressed.test: Revert the sense of this test: we do in
    fact expect a newline byte as part of the binary byte stream, not a
    carriage return which we were accidentally converting.

M	ChangeLog
M	tests/http.test
M	tests/http_chunked.test
M	tests/ns_adp_compress.test
M	tests/testserver/modules/testhttp.tcl

commit 2fb3471e4deb245b8da1a401d02aa15ebfec43c0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-23

    (NsTclProgressObjcmd): make sure progress monitoring is enabled before checking an uninitialized hash table

M	ChangeLog
M	nsd/progress.c

commit f858cb7c91e3e562fa684cc3407771151b3b61e6
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-23

    Uncomment tests 3.5 and 3.6 and mark as knownBug
    
    They now show up in the test summary as skipped. Untabify code.

M	ChangeLog
M	tests/encoding.test

commit d30c66de3d5254863c7dbd406aafa3bfe5c1b80f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-21

    nsperm: support clear text passwords

M	ChangeLog
M	doc/src/ns_perm.man
M	nsperm/nsperm.c

commit 891116f37ef93d91363ac2a74a09b383c3d82093
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-21

    (ns_md5): new command using public domain md5 implementation
    
    * include/ns.h:
    * nsd/tclmisc.c: Added public domain MD5 implementation, new command ns_md5 created,
    new C API public functions added:
    Ns_CtxMD5Init(Ns_CtxMD5 *ctx)
    Ns_CtxMD5Update(Ns_CtxMD5 *ctx, unsigned const char *buf, unsigned len)
    Ns_CtxMD5Final(unsigned char digest[16], Ns_CtxMD5 *ctx)
    Ns_CtxSHAInit(Ns_CtxSHA1 *ctx)
    Ns_CtxSHAUpdate(Ns_CtxSHA1 *ctx, const unsigned char *buf, unsigned len)
    Ns_CtxSHAFinal(unsigned char digest[20], Ns_CtxSHA1 *ctx)
    
    * nsperm/nsperm.c: Added first pieces to support both Basic and Digest
    authentications

M	ChangeLog
M	doc/src/ns_perm.man
M	include/ns.h
M	nsd/auth.c
M	nsd/conn.c
M	nsd/tclcmds.c
M	nsd/tclmisc.c
M	nsperm/nsperm.c

commit d4cae902664306d460d913841cf056b9b49e23b0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-21

    Fix broken ns_conn test due to signature changing

M	ChangeLog
M	tests/ns_conn.test

commit 928a995ae345505ebbca24821779f7d01b375389
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-21

    Log before running callbacks (making sure not to log an uninitialized pointer this time)

M	ChangeLog
M	nsd/callbacks.c

commit 1ea40d76fdae426fc56dc1cec0702b87fe395a3c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-20

    Redesign authentication mechanism
    
    * include/ns.h:
    * include/nsthread.h:
    * nsd/nsd.h:
    * nsd/auth.c:
    * nsd/queue.c:
    * nsd/callbacks.c:
    * nsd/op.c:
    * nsd/conn.c:
    * nsperm/nsperm.c: Changed the internal format of
    authentication mechanism. Instead of keeping jusr user/passwd
    in the Conn struct, there is Ns_Set *auth which keeps all auth related
    data as name/value pairs. By default for Basic auth 2 entries will
    be put there: User and Password. For Digest method there will be more.
    All references to authUser and authPassword in the code have been replaced with
    Ns_ConnAuthUser and Ns_ConnAuthPasswd.
    
    Added public function Ns_ConnAuth which returns Ns_Set with all securoty tokens.
    
    ns_info also got additional argument ns_info auth, return name os the set
    
    * nslog/nslog.c:
    * nscgi/nscgi.c: Updated not to use authUser directly but use
    Ns_ConnAuthUser function instead
    
    * nsd/set.c: Added public function Ns_SetPutSz that take additional
    parameter as size of the string to put into set
    
    * nsthread/memory.c: Added public function ns_strncopy for
    duplicating part of the string only

M	ChangeLog
M	doc/src/ns_perm.man
M	include/ns.h
M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/auth.c
M	nsd/callbacks.c
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/queue.c
M	nsd/set.c
M	nslog/nslog.c
M	nsperm/init.tcl
M	nsperm/nsperm.c
M	nsthread/memory.c

commit cb8ab4de0d3a82912cacd22630af47f6b8427282
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-20

    Cleanups and improvements to interp initialization, ns_ictl
    
    * nsd/nsd.h:
    * nsd/tclinit.c:
    * nsd/init.tcl:
    * nsd/tclcmds.c: Run interp finalization traces in LIFO order
    (initialization still FIFO) and drop the explicit calls to ns_init and
    ns_cleanup (which haven't existed in the code for a while). Re-create
    ns_init and ns_cleanup and register them as traces from the init.tcl
    bootstrap script. They should fire first and last on
    allocation/deallocation.
    
    Add the runtraces subcommand to ns_ictl which provides the trigger
    necessary to re-run the traces from ns_reinit for long running
    threads. Previously, module specific cleanup was not happening.
    
    Add the gettraces subcommand to ns_ictl for introspection of registered
    traces, and add some extra debug level logging.
    
    (Much of this is inspired by, and should be similar to AOLserver,
    although the trace implementation is a little different.)

M	ChangeLog
M	nsd/init.tcl
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclinit.c

commit ae2b035c8dafd07aef63cfd8496dedc6d3e16757
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-20

    Rearrange code for clarity; add debug logging when at-startup, at-signal etc. callbacks are run

M	ChangeLog
M	nsd/callbacks.c

commit 7defe643d46030d2cc389fc0ee2b4257e2fd0b17
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-20

    (Ns_ConnReturnUnauthorized): check if header WWW-Authenticate already exists
    
    This is in anticipation of new Digest auth method to be
    implemented soon.

M	ChangeLog
M	nsd/returnresp.c

commit b630f859a47943d1a5959c57099e7a90d284519a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-20

    (Ns_TclEvalCallback): don't log debug messages unconditionally for all callbacks
    
    This can cause infinite loops e.g. with log filter callbacks.

M	ChangeLog
M	nsd/tclcallbacks.c

commit 5b40495cf703186e3a094b492aff8b535d4ef45d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-20

    Add introspection info for the ADP (and Tcl) page callbacks, including a new arg proc for Ns_Time values

M	ChangeLog
M	nsd/proc.c

commit e7e068914dd1e57c954709c51cbb03917b11e701
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-20

    Add introspection info for nsproxy callbacks

M	ChangeLog
M	nsdb/nsdb.c
M	nslog/nslog.c
M	nsproxy/nsproxymod.c

commit bb56f1e663f39e58cf13e7212e88a74baa0f2b30
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-20

    (Ns_LogLevel): new function, return true if the given log severity level is enabled
    
    Sometimes the message you need to log is expensive to
    construct, so you'd like to construct it only if it's needed.

M	ChangeLog
M	include/ns.h
M	nsd/log.c

commit 129cdab22d42022db50bf5d1a9060e74a8f9661a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-16

    Add NsRegisterServerInit and use it throughout core
    
    * nsd/nsd.h:
    * nsd/server.c: Add new function NsRegisterServerInit() which registers
    an Ns_ServerInitProc callback. These are called once for each virtual
    server, after the config file has been parsed, to allow subsystems to
    configure themselves.
    
    Much of the 'crazy state' of NsInitServer() has been broken out into
    Ns_ServerInitProc callbacks within each subsystem.
    
    * nsd/op.c (ConfigServerProxy):
    * nsd/fastpath.c (ConfigServerFastpath):
    * nsd/url2file.c (ConfigServerUrl2File):
    * nsd/pathname.c (ConfigServerVhost):
    * nsd/returnresp.c (ConfigServerRedirects):
    * nsd/tclinit.c (ConfigServerTcl): Add Ns_ServerInitProc configuration
    callbacks. Code migrated from NsServerInit().
    
    * nsd/nsconf.c (NsConfUpdate): Add new hooks NsConfigRedirects() and
    NsConfigVhost() so that the per-server initialization callbacks can be
    registered.
    
    * nsd/log.c: Move existing initialization functions to top of source
    file.
    
    * include/ns.h (Ns_ServerInitProc):
    * nsd/main.c (ServerInit):
    * nsd/tclvar.c (NsTclCreateBuckets): Add CONST declarations.

M	ChangeLog
M	include/ns.h
M	nsd/fastpath.c
M	nsd/log.c
M	nsd/main.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/pathname.c
M	nsd/returnresp.c
M	nsd/server.c
M	nsd/tclinit.c
M	nsd/tclvar.c
M	nsd/url2file.c

commit d99941ee742b22d2d34db95037dd8c92d609472e
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-15

    Move functions which return standard HTTP responses, and which may have the response HTML templated, together

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
M	nsd/return.c
A	nsd/returnresp.c

commit 4240b7e82e1eff6f0d19f5e72c7412dd57f5108e
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-14

    Auto-generate DOAP release data

M	.cvsignore
M	ChangeLog
M	Makefile
M	configure.in
R083	naviserver.rdf	naviserver.rdf.in

commit e635082bf5b51a6392adcdaf2be8faf5b48f3880
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-14

    Update NEWS with stuff that has been added, not complete list yet

M	NEWS
M	sample-config.tcl.in

commit 6154698990a81f9d362088b518e3feb34ce7a5f1
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-14

    Remove duplicate definition of public functions from private header

M	ChangeLog
M	nsd/nsd.h

commit db4ae9a520bbd200b6d9145729c911b419d278ac
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-14

    Consolidate dns configuration into single NsConfigDNS() function

M	ChangeLog
M	nsd/dns.c
M	nsd/nsconf.c
M	nsd/nsd.h

commit 2a0fa509f14cbbd2e63a08ff4975a8fb9901504b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-14

    Cleanup the various variables needed to run the tests

M	ChangeLog
M	Makefile

commit 8c6b8c877ce5fe61b86af583f2fd809fc90eaead
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-13

    Move the watchdog code into it's own file

M	ChangeLog
M	nsd/Makefile
M	nsd/nsd.h
M	nsd/nsmain.c
A	nsd/watchdog.c

commit fa77b9aa507e0ebe76e167b7868c6d22307979f3
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-13

    Backport changes from AOLserver to cleanup stdin/stdout/stderr initialization
    
    Move it out of the crazy nsmain.c.

M	ChangeLog
M	nsd/fd.c
M	nsd/init.c
M	nsd/nsd.h
M	nsd/nsmain.c

commit 56e454b5bb3cd957b7e04e0f80388ac18a91ffe6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-13

    Combine all nsv commands into one man page

M	ChangeLog
R059	doc/src/tcl-nsv.man	doc/src/nsv.man
D	doc/src/nsv_append.man
D	doc/src/nsv_array.man
D	doc/src/nsv_exists.man
D	doc/src/nsv_get.man
D	doc/src/nsv_incr.man
D	doc/src/nsv_lappend.man
D	doc/src/nsv_names.man
D	doc/src/nsv_set.man
D	doc/src/nsv_unset.man

commit 259f0cb6acaa5a90e6eec7d179fe5a63537e3800
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-13

    Add first run tips to Makefile install notice

M	Makefile

commit 9ed9eabfbf386ee15bc1c439708ec6a87052e0b2
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-05-13

    Autoconf macro cleanup; link only libnsd against libz, libcrypt
    
    * configure.in:
    * m4/cmmsg.m4:
    * m4/dns.m4:
    * m4/zlib.m4:
    * include/Makefile.global.in: Remove some deprecated autoconf macros
    and move more of the dns checks out of configure.in and into
    m4/dns.m4. Make sure only libnsd gets linked against libz and libcrypt.

M	ChangeLog
M	configure.in
M	include/Makefile.global.in
M	m4/cmmsg.m4
M	m4/dns.m4
A	m4/zlib.m4

commit 7bcd917a9bf299609871f7bce5cb43e9e260b748
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-13

    Add missing files, including autogen.sh to 'make dist' target

M	ChangeLog
M	Makefile

commit 639630fac17b28582859ae305dc9c5c2b39bb72c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-12

    Reflect recent changes into sample-config.tcl

M	ChangeLog
M	sample-config.tcl.in

commit 945f964b2663c304d13256043d251006fd0c86bc
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-05-12

    Silence compiler warnings

M	ChangeLog
M	nsd/adpparse.c
M	nsd/tclhttp.c

commit cf6c2fb1c02b922c1fd6d4e9649685004bfe273a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-04-30

    Add missing ns_perm checkpass, setpass; add new listusers, listgroups
    
    Update all commands to use Tcl_Objs.

M	ChangeLog
M	doc/src/ns_perm.man
M	nsperm/init.tcl
M	nsperm/nsperm.c

commit 7408fd9f88c3a12b4f1ddaff6f94a9eb5b5832f5
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-04-27

    Similar to ns_int64, define same types for 8, 16, 32 bits

M	ChangeLog
M	include/ns.h

commit ddaef76a63ce2b9155ae91be1da049cf6484d47a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-04-24

    Changed NS_SOCK_DROP to NS_SOCK_DONE; call NS_SOCK_DONE for cleanup callbacks

M	ChangeLog
M	include/ns.h
M	nsd/adpparse.c
M	nsd/sockcallback.c
M	nsd/task.c
M	nsd/tclhttp.c

commit 4d6eff247d368d2207020403cef986be88023a9b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-04-19

    Add debug logging of the callback that is about to run

M	ChangeLog
M	nsd/tclcallbacks.c

commit 50dc9e3214040c548ccd1fc800b99853f1b6435c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-04-19

    Change size_t variable to int as size_t is unsigned on Windows and this makes troubles

M	nscp/nscp.c

commit 723663c1708a60908b2b58173b7a876073432ae1
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-04-05

    Use poll in WriterThread instead of active pushing; faster, simpler

M	ChangeLog
M	nsd/driver.c

commit 5082de84a013baed3e8c4b0b2ccade9f44e19894
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-03-27

    (ns_http): handle binary results properly

M	ChangeLog
M	nsd/tclhttp.c

commit 652dc8f630370f078c81be3574cf34a68f7202d9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-03-24

    Silence some compiler warnings (how come I haven't seen them before?)

M	nsproxy/nsproxylib.c

commit f4e4631e6425fc75449b4fe31c55045546d614ae
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-03-24

    Old Solaris sh does not recognize [ == ] constructs...

M	Makefile

commit 547d3195367fd7100490fbb3a249f7ee6a569f22
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-03-24

    Remove check for "dtplite" as this is now mandatory part of build-doc
    
    Also, "which" utility, as provided by Solaris is very clumsy and emits
    spurious messages on stdout when the argument cannot be located. This
    makes it useless for programmatic executable checks.

M	ChangeLog
M	Makefile

commit 18475173b273eee323feafb6fc549fc47f3942c3
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-03-24

    Make install-doc fault-tolerant: if no generated doc-files found, do not bark

M	Makefile

commit 5822c1de4b6bdd77c1c4548fbadc1f516fb44579
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-03-24

    Separated build-doc from the install target
    
    Doc building has nothing to do with the installation. It must be
    performed as a separate step prior making the distribution file.

M	ChangeLog
M	Makefile

commit 5bec2f297ea3db012ebacd74f3017f76447ab69c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-03-24

    Silence mkdir during installation

M	include/Makefile.module.in
M	nsperm/Makefile

commit 2888d529d490881ff9127ec06eda7c81a7bb1c70
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-03-24

    Scrapped MACOSX_DEPLOYMENT_TARGET as this is not needed for 10.4

M	m4/tcl.m4

commit 27cc8c5af68fabceeba50c1203889024aef70535
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-03-24

    Move ns_proxy man page to docs directory

D	nsproxy/ns_proxy.man

commit 60c47619d4e0775776e83075f6835508ae3afe5c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-03-23

    Remove home-brew windows mutex code in favour of Win CriticalSection

M	ChangeLog
M	nsthread/winthread.c

commit 53cec1883b450db2fbfb4b4b3fe21a6f286dea8b
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-03-22

    Copy .css files when installing .html docs

M	ChangeLog
M	Makefile

commit 2bdf6cb59064495f4f1cb25ac329578d41922ff1
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-03-21

    Amend ChangeLog with API change warning for large-file support
    
    IMPORTANT API changes: (length, nsend) parameters are now Tcl_WideInt, so it requires
    to recompile all modules that use those functions:
    
    int Ns_ConnSendChannel(Ns_Conn *conn, Tcl_Channel chan, Tcl_WideInt nsend)
    int Ns_ConnSendFp(Ns_Conn *conn, FILE *fp, Tcl_WideInt nsend)
    int Ns_ConnSendFd(Ns_Conn *conn, int fd, Tcl_WideInt nsend)
    
    void Ns_ConnSetRequiredHeaders(Ns_Conn *conn, CONST char *type, Tcl_WideInt length)
    void Ns_ConnSetLengthHeader(Ns_Conn *conn, Tcl_WideInt length)
    int Ns_ConnReturnOpenChannel(Ns_Conn *conn, int status, CONST char *type,
                                 Tcl_Channel chan, Tcl_WideInt length)
    int Ns_ConnReturnOpenFile(Ns_Conn *conn, int status, CONST char *type,
                              FILE *fp, Tcl_WideInt length)
    int Ns_ConnReturnOpenFd(Ns_Conn *conn, int status, CONST char *type,
                            int fd, Tcl_WideInt length)

M	ChangeLog

commit 9ff7db3d1b22f45f292e37f9ed768529ae86fdaf
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-03-18

    Add O_LARGEFILE flag to open calls in logging modules
    
    This will allow us to support files > 2Gb. If that is not
    supported, fake O_LARGEFILE is defined.

M	ChangeLog
M	include/nsthread.h
M	nsd/log.c
M	nsd/nsd.h
M	nslog/nslog.c

commit facdcc9e4db22c38074cee7ed9fd1c521ffdf555
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-03-17

    Updated ns_http command with correct parameters description

M	doc/src/ns_http.man

commit 0b07b9525fb8eedbfd2aa40159618244168755ee
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-03-17

    Port task system from AOLserver 4.5; add 'list' to ns_http; add Ns_ObjvSet
    
    * nsd/tclhttp.c: Ported task-based http retrieval facility from AS 4.5
    tree, changed to use Ns_ParseArgs. Added new subcommand list which shows
    currerntly running tasks with url and completion status
    
    * nsd/task.c: Added Ns_TaskCompleted function which just returns
    0 or 1 for any given task
    
    * nsd/tclobjv.c: Added new public function Ns_ObjvSet that retrieves
    ns_Set given as a parameter

M	ChangeLog
M	include/ns.h
M	nsd/task.c
M	nsd/tclhttp.c
M	nsd/tclobjv.c

commit f088a7230873e1a0a4d3b1592d480af5648ec78d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-03-17

    Make build-doc detect dtplite when building documentation

M	ChangeLog
M	Makefile

commit 7ccf1b3cbf0a52a7ed74d2a6f4b78ef25746d4ac
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-03-15

    Changed type to size_t to be compatible with 64 bits systems, e.g. CentOS

M	ChangeLog
M	nsd/binder.c

commit 3f9249275bbbe797e6865f5f983f8802de226cb2
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-03-10

    Correct automatic sed replacament of licenseing

M	doc/src/main-history.man

commit 2701cb75b1be5bb726482315e1d872b697692bca
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-03-10

    Add clean-bak into main makefile to quickly remove backup files if needed

M	Makefile

commit c484f232854c10c9b06b310880fffd3c0428d714
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-03-10

    Global change of all source files, replacing AOLserver license with Mozilla license

M	doc/src/main-history.man
M	include/nscheck.h
M	m4/cmmsg.m4
M	m4/dns.m4
M	nscgi/Makefile
M	nscgi/nscgi.c
M	nscp/Makefile
M	nscp/nscp.c
M	nsd/Makefile
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/cache.c
M	nsd/cls.c
M	nsd/compress.c
M	nsd/connio.c
M	nsd/crypt.c
M	nsd/dsprintf.c
M	nsd/encoding.c
M	nsd/exec.c
M	nsd/fd.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/index.c
M	nsd/lisp.c
M	nsd/listen.c
M	nsd/main.c
M	nsd/mimetypes.c
M	nsd/nsconf.c
M	nsd/nsthread.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/quotehtml.c
M	nsd/random.c
M	nsd/request.c
M	nsd/return.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/stamp.c
M	nsd/tclcache.c
M	nsd/tclconf.c
M	nsd/tclenv.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tclsched.c
M	nsd/tclshare.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsd/url.c
M	nsd/url2file.c
M	nsd/urlencode.c
M	nsd/urlspace.c
M	nsd/uuencode.c
M	nsdb/db.h
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbutil.c
M	nsdb/nsdb.c
M	nslog/Makefile
M	nsperm/Makefile
M	nsperm/compat.tcl
M	nsperm/init.tcl
M	nsperm/nsperm.c
M	nssock/Makefile
M	nssock/nssock.c
M	nsthread/Makefile
M	nsthread/cslock.c
M	nsthread/error.c
M	nsthread/fork.c
M	nsthread/master.c
M	nsthread/memory.c
M	nsthread/mutex.c
M	nsthread/pthread.c
M	nsthread/reentrant.c
M	nsthread/rwlock.c
M	nsthread/sema.c
M	nsthread/signal.c
M	nsthread/thread.c
M	nsthread/thread.h
M	nsthread/time.c
M	nsthread/tls.c
M	nsthread/winthread.c
M	tests/all.tcl
M	tests/http-test-config.tcl
M	tests/http.test
M	tests/http_byteranges.test
M	tests/ns_addrbyhost.test
M	tests/ns_adp_compress.test
M	tests/ns_hostbyaddr.test
M	tests/ns_hrefs.test
M	tests/ns_uuencode.test
M	tests/progress.test
M	tests/testserver/modules/testhttp.tcl
M	tests/testserver/modules/vhost.tcl

commit 22aa801285a79be1385840df74a5f3eccf4c0cec
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-02-24

    Remove doc for long-dead ns_stats command

M	ChangeLog
D	doc/src/ns_stats.man

commit fa5dae8332c65e31bcf3638975276735ac97a37d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-02-24

    Consolidate response construction commands into one man page

M	ChangeLog
A	doc/src/mann/ns_return.man
D	doc/src/ns_connsendfp.man
D	doc/src/ns_headers.man
D	doc/src/ns_respond.man
D	doc/src/ns_return.man
D	doc/src/ns_returnfile.man
D	doc/src/ns_returnfp.man
D	doc/src/ns_startcontent.man
D	doc/src/ns_write.man
D	doc/src/ns_writefp.man

commit 453b20e0389e2f108e4883ef92b13d44287597f2
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-02-24

    Consolidate commands which return HTTP response codes into a single man page

M	ChangeLog
A	doc/src/mann/ns_returnerror.man
D	doc/src/ns_returnadminnotice.man
D	doc/src/ns_returnbadrequest.man
D	doc/src/ns_returnerror.man
D	doc/src/ns_returnforbidden.man
D	doc/src/ns_returnmoved.man
D	doc/src/ns_returnnotfound.man
D	doc/src/ns_returnnotice.man
D	doc/src/ns_returnok.man
D	doc/src/ns_returnredirect.man
D	doc/src/ns_returnunauthorized.man
D	doc/src/ns_returnunavailable.man

commit ddabbf62be54e16090f21e6b4a188c00faa6e0da
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-02-23

    Consolidate the server callbacks into a single man page

M	ChangeLog
A	doc/src/mann/ns_atsignal.man
D	doc/src/ns_atexit.man
D	doc/src/ns_atprestartup.man
D	doc/src/ns_atshutdown.man
D	doc/src/ns_atsignal.man
D	doc/src/ns_atstartup.man

commit 1ee9a3250cf58c90ae0fb01f7802f0c9f8f6822d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-02-23

    Move the memoize command documentation into the mann directory

M	ChangeLog
R100	doc/src/ns_memoize.man	doc/src/mann/ns_memoize.man

commit ed9aa2d0281bde48576b2c3ea14c9307ad0f5ee0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-02-23

    Consolidate the Tcl cache commands documentations into one man page

M	ChangeLog
M	doc/src/commandlist.man
A	doc/src/mann/ns_cache.man
D	doc/src/ns_cache_append.man
D	doc/src/ns_cache_create.man
D	doc/src/ns_cache_eval.man
D	doc/src/ns_cache_flush.man
D	doc/src/ns_cache_incr.man
D	doc/src/ns_cache_keys.man
D	doc/src/ns_cache_lappend.man
D	doc/src/ns_cache_names.man
D	doc/src/ns_cache_stats.man

commit 1d0316a6775d0e29d8176787b7f9930ece5c027b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-02-23

    Remove the documentation for old, deprecated commands

M	ChangeLog
M	doc/src/commandlist.man
D	doc/src/ns_chmod.man
D	doc/src/ns_cp.man
D	doc/src/ns_getchannels.man
D	doc/src/ns_link.man
D	doc/src/ns_mkdir.man
D	doc/src/ns_rename.man
D	doc/src/ns_rmdir.man
D	doc/src/ns_share.man
D	doc/src/ns_var.man

commit 9c70a063e6ff456396186109ab35285503573259
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-02-23

    Initialise jobsperthread and jobtimeout correctly

M	ChangeLog
M	nsd/tcljob.c

commit 9e6fc6009374dc6c368c64eae098b0782c52b006
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-02-22

    (ns_sendmail): check socket writable before sending each line, not just once
    
    In case of pretty big email it sometimes stuck because socket
    cannot accept data anymore and we do not check if it is ready.

M	ChangeLog
M	tcl/sendmail.tcl

commit ed7f4e6f3c271e65441a0a83d2c2e1af46549430
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-02-20

    Allow nstrace::excludensp to string-match registered namespaces
    
    This way we can exclude the whole namespace hierarchy if needed.

M	ChangeLog
M	tcl/nstrace.tcl

commit ebfd70c127d41b47a68a6c315288d761ed5078d8
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-02-20

    Suppress command echo during HTML files install

M	Makefile

commit 6e564fea41075eb7c4640861837718d82bb81c63
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-02-20

    Add platform-specific def of UIO_MAXIOV; if not defined, set to 16

M	ChangeLog
M	nsd/connio.c
M	nsd/nsd.h

commit 5bcf89c350e77bf6554486f1a5444e68001bd59f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-02-20

    Simplify calculation of TCL_LIB

M	configure.in

commit 72285348ab7ec448e33906578da72d4d661d78b5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2007-02-20

    Use ns_poll instead of plain poll

M	nsproxy/nsproxylib.c

commit 38fc929ce37b18c92a69544d09449ec5cfd4df97
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-02-19

    Ooops, wrong version of driver.c got into CVS, reverting to original

M	nsd/driver.c

commit f59c4b1f5dc876e61f2ef4c4f11f0e58b5d806ee
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-02-19

    Return chunked response to HTTP/1.1 clients, otherwise return as HTTP/1.0 without Content-Length header

M	ChangeLog
M	nsd-config.tcl
M	nsd/adprequest.c
M	nsd/driver.c
M	nsd/return.c

commit d983e5977b9a86976574aefb28a5637bece601b4
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-02-14

    Update documentation, add CSS stylesheet

M	Makefile
M	doc/src/admin-install.man
A	doc/src/keyl.man
D	doc/src/keyldel.man
D	doc/src/keylget.man
D	doc/src/keylkeys.man
D	doc/src/keylset.man
M	doc/src/man3/Ns_Sls.man
M	doc/src/mann/ns_sls.man
A	doc/src/nsd.css

commit 113e6488c63b9dffa1ac75801dda536b79700913
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-02-07

    Changed inet_ntop macro to use AC_CHECK_FUNC

M	ChangeLog
M	configure.in

commit 9a0d73258054771b2b8df8ab57d3dccb6aade3f8
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-02-03

    Documentation updates...
    
    Still a lot to do but it looks more or less filled now and not
    abandoned anymore.

M	doc/src/man3/Ns_Sls.man
M	doc/src/mann/ns_limits.man
M	doc/src/mann/ns_sls.man
M	doc/src/ns_checkurl.man
M	doc/src/ns_http.man
M	doc/src/ns_kill.man
M	doc/src/ns_locationproc.man
M	doc/src/ns_memoize.man
M	doc/src/ns_moduleload.man
M	doc/src/ns_parseargs.man
M	doc/src/ns_proxy.man
M	doc/src/ns_purgefiles.man
M	doc/src/ns_puts.man
M	doc/src/ns_register_fastpath.man
D	doc/src/ns_register_fasturl2file.man
M	doc/src/ns_register_proc.man
M	doc/src/ns_register_url2file.man
M	doc/src/ns_requestauthorize.man
M	doc/src/ns_respond.man
M	doc/src/ns_schedule_proc.man
M	doc/src/ns_sendmail.man
M	doc/src/ns_shortcut_filter.man
M	doc/src/ns_startcontent.man
D	doc/src/ns_unregister_adp.man
D	doc/src/ns_unregister_proc.man
D	doc/src/ns_unregister_url2file.man
D	doc/src/ns_unschedule_proc.man
M	doc/src/ns_var.man

commit 7291e1afdacb6a7a0fea57a18cbb1de402a92757
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-01-20

    Change message about encoding loaded from Notice to Debug level
    
    This message is printed on server start before even log file
    is opened.

M	ChangeLog
M	nsd/encoding.c

commit 689ef5273e653ae9039e68259defd2be6c8e7f13
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-01-16

    Consolidate the cookie documentation.

M	ChangeLog
A	doc/src/mann/ns_cookie.man
D	doc/src/ns_deletecookie.man
D	doc/src/ns_getcookie.man
D	doc/src/ns_setcookie.man

commit 493df3f1e70dadd2e2b3394cacbd858eacbf21ce
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-01-16

    Document the ns_limits commands

M	ChangeLog
A	doc/src/mann/ns_limits.man
D	doc/src/ns_limits_get.man
D	doc/src/ns_limits_list.man
D	doc/src/ns_limits_register.man
D	doc/src/ns_limits_set.man

commit 0d76d0336d4deba31f87119d0bef41aea59ac361
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2007-01-16

    (NsTclInitTimeType): Remove unneeded (and wrong on x86-64) int/long size test (bug #1636688)
    
    Thanks, Martin Matuska.

M	ChangeLog
M	nsd/tcltime.c

commit f530bcbe59bff9ae141bcf077e0740c32544fd39
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-01-09

    Fix bug when ADP flag for processing .tcl files was not set correctly

M	ChangeLog
M	nsd/adprequest.c

commit 7373d1b4d5a06e14eea07cd9735b94b27f8cac78
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-01-08

    Fix improper use of tag in docs

M	doc/src/ns_cleanupchans.man
M	doc/src/ns_cp.man
M	doc/src/ns_normalizepath.man

commit 57b81d12a3b42f88e191c8df3cd4f77b470c450c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-01-07

    If no config file is specified, try to find nsd.tcl in the conf/ subdir, taking base path from executable
    
    This requirements looks very non-modern nowadays. Apache uses
    default but can take full path, for example.

M	ChangeLog
M	nsd/nsconf.c
M	nsd/nsmain.c

commit 4013c7d14d5e39c9af86c65e0c544ced55499cb0
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-01-03

    Fixed bug in ns_adp_parse command line parsing

M	nsd/adpcmds.c

commit 6c809dd10c417c6da9126a22acffe7956802c53e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-01-02

    Updated so flags can be set/unset using ns_adp_ctl command only
    
    ADP flags are saved before executing include or parse command
    and then restored.

M	ChangeLog
M	doc/src/ns_adp_include.man
M	doc/src/ns_adp_parse.man
M	nsd/adpcmds.c

commit 014bb80f7d5923bd5a3d94bd5270bafd3431b50e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2007-01-01

    Minor updates to ADP commands regarding cache/nocache options

M	doc/src/ns_adp_parse.man
M	nsd/adpcmds.c
M	nsd/adpeval.c

commit 92d4102f11a62ff3347dc9e1ce7459e2f9467dba
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-30

    Add public functions Ns_SockWrite, Ns_SockWriteV which will try to send all data provided

M	ChangeLog
M	include/ns.h
M	nsd/sock.c

commit afb8caa0bd172e1a856c77a30dd700cb28b1c445
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-30

    Don't cache ADP output by default
    
    Changed default mode of ADP to no cache, cache if enabled breaks
    all existing dynamic applications, with cache enabled special
    care must be taken in producing correct result and also cache
    does not account for query parameters, so dynamic ADP page
    cannot be cached if it depends on different query parameters.
    
    Setting it to no cache by default sets behaviour to 4.0 ADP
    processing. Caching can be disabled also inside the script, AdpEval
    check for flags during page evaluation.

M	ChangeLog
M	doc/src/ns_adp_ctl.man
M	nsd-config.tcl
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/nsd.h
M	nsd/server.c

commit 74505ac99f8cf1bb59f5de6a85257437abbac8ae
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-29

    Possible uninitialized usage of pointer

M	ChangeLog
M	nsd/tcljob.c

commit 4be072e72edb5aef5823ae05f8e150d9402ca3bb
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-29

    (ns_filestat): return correct ctime, mtime

M	ChangeLog
M	nsd/tclmisc.c

commit c093e7d015e900868bad748de16c96a48a26bb49
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-27

    Evaluate Tcl scripts at the global level
    
    * nsd/adpcmds.c:
    * nsd/adpeval.c:
    * nsd/adpparse.c: In Tcl caching mode use uplevel
    with bytecode to evaluate proc on global level for
    easy integration with other ADP pages and other Tcl scripts
    running inside the same request
    
    * doc/src: Updated documentation files
    * configure.in: Updated the script to produce correct output on
    --help command

M	ChangeLog
M	configure.in
M	doc/src/admin-config.man
M	doc/src/admin-db.man
M	doc/src/admin-install.man
M	doc/src/admin-maintenance.man
M	doc/src/admin-tuning.man
M	doc/src/adp-overview.man
M	doc/src/commandlist.man
M	doc/src/ns_adp_include.man
A	doc/src/ns_adp_info.man
M	doc/src/ns_adp_parse.man
M	doc/src/tcl-lib-file.man
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/nsd.h

commit 8e41f923c3d8895d7db9e28dfe621729e1a64843
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-26

    Updated cached Tcl processing, make it conditional compilation if cache is enabled

M	ChangeLog
M	nsd-config.tcl
M	nsd/adpparse.c
M	nsd/nsd.h

commit 7d4e4d39ab0e24a4fca1fd16453d33c27127e055
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-26

    Add ns_job configure -timeout parameter and config parameter jobtimeout
    
    They control how long an idle job thread can wait for a job to arrive.

M	ChangeLog
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/tcljob.c

commit 1f21e09c95fc81dd1e6075e356ed8bbcd1d9d5f8
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-26

    Make jobsperthread a config parameter for easy system-wide configuration

M	ChangeLog
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/tcljob.c

commit 94ae310eb15d57fa27ab62181abdc11fb7976435
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-26

    Make ADP singlescript complete in one pass without copying the whole page using temp buffer
    
    Added new ns_adp_info command that can be useful in the
    templating engines based on ADP.

M	ChangeLog
M	doc/src/ns_adp_include.man
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/connio.c
M	nsd/nsd.h
M	nsd/server.c
M	nsd/tclcmds.c

commit 2827a4653a7fbe43dcd85f6c1c852480b0389af3
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-25

    Update ADP engine to support .tcl files instead of Tcl based handler
    
    ADP engine will perform caching and compiling Tcl files into Tcl
    procs and automatic expiration if needed.
    
    New parameter enabletclpages in the ns/server/server1/adp section
    now can be used to turn this option on, the old Tcl-only handler
    is still in the file.tcl.
    
    Speed benchmarks show pretty significate speed boost using
    ADP engine for .tcl files along with less memory consumption.

M	ChangeLog
M	include/ns.h
M	include/nsthread.h
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/nsd.h
M	nsd/server.c

commit 52159d9288aeba2acac3a5b325b950b61d66f73a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-24

    Port ADP engine from AOLserver 4.5, with minor modifications
    
    This port brings much better performance to ADP pages and more
    options for controlling ADP behavior.
    
    Before the port, NS was much slower than AS in benchmarks with
    default index.adp page from AOLserver, now it is about 20-30%
    faster which I believe because of Naviserver driver.

M	ChangeLog
A	doc/src/ns_adp.man
A	doc/src/ns_adp_ctl.man
M	doc/src/ns_adp_include.man
M	doc/src/ns_adp_parse.man
M	doc/src/ns_adp_registertag.man
M	include/ns.h
M	include/nsthread.h
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/init.c
M	nsd/nsd.h
M	nsd/return.c
M	nsd/server.c
M	nsd/tclcmds.c
M	nsd/tclinit.c
M	nsd/tclrequest.c
M	tests/test.nscfg

commit 42e3a9443689d7e3ac17b3acde3b09c1ed21bc5a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-22

    Simplify ADP processing and the way the parser outputs the result
    
    Almost all ns_adp_ functions now will return result to the caller
    as Tcl result. This will make it much easier and more effective
    to build templating or other engines on top of adp parser.
    
    All adp pages I could find works the same way as before.

M	ChangeLog
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/nsd.h

commit a2b9819df9559529e5a19e4aae9f0dabbe235efa
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-22

    Update test with new ns_mutex syntax

M	tests/ns_thread.test

commit 4f66047d4265e067a079400d9c9303569645b488
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-22

    Add ns_job configure, with -jobsperthread that defines how many jobs a thread can process and then gracefully exit
    
    This works the same way as connsperthread config parameter for
    connection threads to help reduce memory consumption and cleanup
    Tcl resources.

M	ChangeLog
M	doc/src/ns_job.man
M	nsd/tcljob.c

commit 18862f4907591a6ada8b6daa946f10e624d62873
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-19

    Remove extra definition of ns_getcsv command

M	ChangeLog
M	nsdb/dbtcl.c

commit 992100be6a64abc54d197d7bd222b60cedd3a8f5
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-12-16

    Move the large file upload progress tracker from driver.c into it's own file
    
    Config knob is now: ns/parameters:progressminsize and works for
    both conventional and spooled uploads.
    
    * nsd/sls.c: Fix bug resizing memory for new sls slots.

M	ChangeLog
M	nsd/Makefile
M	nsd/driver.c
M	nsd/nsconf.c
M	nsd/nsd.h
A	nsd/progress.c
M	nsd/sls.c
M	nsd/tclcmds.c
A	tests/progress.test
M	tests/test.nscfg

commit 21a5985c78fa73322a9fdfaac27d55aa95a49728
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-14

    Optimize Tcl file handler, smaller and simpler now

M	ChangeLog
M	nsd/adpeval.c
M	tcl/file.tcl

commit 715619b861ed0277a04ffb6f3167f36ccebd3a17
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-14

    Update and correct documentation files

M	doc/src/admin-install.man
M	doc/src/admin-tuning.man
M	doc/src/adp-overview.man
M	doc/src/ns_filestat.man
M	doc/src/ns_logctl.man

commit d1960db0c7789c08ea5e24d58c34fb436daa8492
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-14

    Update ns_filestat to support optional varname

M	doc/src/ns_filestat.man
M	nsd/tclmisc.c

commit ba3425bd4c7662c3db159183cfa5d78b02efb1fc
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-14

    Add new command and documentation file

M	ChangeLog
A	doc/src/ns_filestat.man

commit 222cf0255ef3c1fd07bc28acac16ae2ebb288892
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-14

    Add configure option --disable-tclvfs; add filesystem wrappers
    
    Introduces several internal functions nsFastXXX which implement open, read,
    write, stat, close operations. Most of them are defines, open and stat are
    C wrapper functions. Testing showed 30% speed increase in serving static
    files using fatspath with native system calls. Same goes for adp reading.
    
    By default Tcl VFS is compiled in.

M	ChangeLog
M	configure.in
M	nsd/adpeval.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/rollfile.c
M	nsd/tclcmds.c
M	nsd/tclmisc.c

commit bc924129224f2a6cfb1fc8a0a772a8e44aac6a38
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-12

    Slightly changed acceptsize code to be more clear

M	nsd/driver.c

commit 6ec9935ac68d931a33154a6dfbfaf87cabcd0beb
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-12

    Split into separate cache and coookie procs, runs faster

M	ChangeLog
M	tcl/file.tcl

commit de004957c43fd490412d88b63a5629f45b4fa3d4
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-12

    Add driver parameter 'acceptsize'
    
    It is 1 by default, if set to higher number it will tell the driver to
    accept more than one request, which as tests showed helps to process
    more requests, because if we have many sockets in the driver's queue it takes
    time to scan all of them and new requests are waiting to be accepted. Some
    benchmarking showed that if set to 10 it improves req/sec rate by 10% on simple
    ADP requests. If not set, driver works as usually.

M	ChangeLog
M	nsd-config.tcl
M	nsd/driver.c
M	nsd/nsd.h
M	sample-config.tcl.in

commit 00ad3cef1c8766546da50721f0a4deee4571ed44
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-07

    Fixed bug in ns_eval initialization using non-existent nsv array

M	ChangeLog
M	nsd/init.tcl

commit 8957a7f9ee42be6ba42f86ed32e53a5b1d6a8ffe
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-12-05

    Minor changes to make installation work; smoothed some edges

M	ChangeLog
M	Makefile
M	index.adp

commit 91d87880384611947165c51a50f322c7443d3a35
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-29

    Add ns_mutex trylock command to Tcl API
    
    This is valid C API function, return 0 on lock or < 0 if
    already locked.

M	ChangeLog
M	doc/src/ns_mutex.man
M	nsd/tclthread.c

commit ba3b171f42e744ef96f18a2b4c1c24fc6ba51681
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-29

    Return files bigger than 2Gb in size

M	ChangeLog
M	include/ns.h
M	nsd/connio.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/return.c

commit 1b8a27a9993324b5ad034352c78e1d1eafbdeeb1
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-28

    Update Writer functions to Tcl_WideInt to support files over 2Gb in size
    
    Still a lot of routines need to be updated which return
    files, like Ns_ConnSend and etc.
    
    The minor obstacle also that GNU printf checker does not support
    new formats like %q in Ns_DStringPrintf.

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h

commit 372660edc432cc3d76a23fd7cf77495d55821f6d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-28

    (ns_writer): fix submitfile command; add -headers, -offset, size options
    
    Add example of ns_writer usage.

M	ChangeLog
M	contrib/examples/index.adp
A	contrib/examples/writer.tcl
M	doc/src/ns_writer.man
M	nsd/driver.c

commit d30181c05bc181b58da41ca0cbc3c6dd2a23b164
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-27

    Add ns_job queue -head, place new job at beginning of queue
    
    By default all new jobs are added to the end.

M	ChangeLog
M	doc/src/ns_job.man
M	nsd/tcljob.c

commit 59ac8869f6df3f37fa58f7a7cdc266d0730fecc0
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-20

    Minor changes to make build-doc work and docs fixes

M	doc/src/main-features.man
M	doc/src/man3/Ns_Sls.man
M	doc/src/mann/ns_sls.man

commit 755394d7dc70d9578071a2b3d84cb8614015fb59
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-11-17

    Added recommended MIME types for OpenDocument documents

M	ChangeLog
M	nsd/mimetypes.c

commit b0d669a2624863972b038cfa9541d0b8749a9f55
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-11-16

    Remove excessive check for shared object when converting internal rep of time type

M	ChangeLog
M	nsd/tcltime.c

commit 1872a702d07a982f667f7141c32309c327c473f1
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-14

    (ns_sendmail): send data line-by-line for benefit of large attachments
    
    Because socket is nonblocking sending big chunk in one puts
    does not work, so need to do split and send line by line.

M	ChangeLog
M	tcl/sendmail.tcl

commit 758fe0317a88bf344775f777b534563d2d5104f1
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-11-14

    Document the C API for SLS data
    
    Tcl doctools is hurting...

M	ChangeLog
A	doc/src/man3/Ns_Sls.man

commit 42ffcc93c3e6ae599af40f3cba1df5a96537cb8e
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-11-13

    Don't clobber editor backup files

M	ChangeLog
M	Makefile
M	include/Makefile.module.in

commit 0a93bdb865756f80d95e8c8c2ed85f7523af02cc
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-11-13

    Quiten some compiler alias warnings, including some ugly casts in tcltime.c

M	ChangeLog
M	configure.in
M	nsd/sls.c
M	nsd/tcltime.c
M	nsd/unix.c

commit fe102501204ced192b80406dbff91c867a0c45dd
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-11-13

    Check for presence of Tcl_GetMemoryInfo in Tcl library
    
    This isn't exported when Tcl is built with the custom memory
    allocator disabled.

M	ChangeLog
M	configure.in
M	nsd/info.c
M	nsthread/nsthreadtest.c

commit 1dd8982fcd7d7dc2d50ed953fba15015ad306db3
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-11-12

    Add Ns_Sls* and ns_sls commands supporting socket-local-storage (bug #1522162)
    
    (data which persists for the lifetime of an open TCP connection)

M	ChangeLog
A	doc/src/mann/ns_sls.man
M	include/ns.h
M	nsd/Makefile
M	nsd/driver.c
M	nsd/init.c
M	nsd/nsd.h
A	nsd/sls.c
M	nsd/tclcmds.c
A	tests/ns_sls.test

commit 663a4e1d1cf110b898e10f202da8ac8e7ddd97c1
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-11-09

    Add config parameter smtpauthmode; check for it case-insensitively

M	ChangeLog
M	nsd-config.tcl
M	tcl/sendmail.tcl

commit 1ad3211c77fccf1d11fa8932570af5ad79669dd9
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-09

    Updated ns_job docs regarding new API additions

M	doc/src/ns_job.man

commit 906019fd361a07d5911058718add79a5a93a68d7
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-11-09

    (ns_sendmail): add AUTH LOGIN support (which is very similar to AUTH PLAIN)
    
    * doc/src/ns_sendmail.man: Updated documentation for ns_sendmail

M	ChangeLog
M	doc/src/ns_sendmail.man
M	tcl/sendmail.tcl

commit 7f0a99a63f84d0d7f4ffcd5c33b6dcabb26d8c70
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-09

    Add ns_job exists, add ns_job queue -jobid

M	ChangeLog
M	nsd/tcljob.c

commit 5baa28c11aa92a6eba0093324c47000bfce9450d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-08

    Fix bug in writer thread not handling partial writes

M	ChangeLog
M	nsd/driver.c

commit 662c89b15b6cfab558215a6b5bf751cb647d26b0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-11-06

    Split even more the roles of Nsproxy_Init and Ns_ProxyInit
    
    The former role is to initialize per-process global data whereas
    the latter is used to initialize per-thread-interp only.

M	nsproxy/nsproxy.h
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c

commit 941d634bd5160fe731ec9815c1988223263f80cd
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-11-06

    Nsproxy_Init initializes thread-wide data while Ns_ProxyInit initializes only the Tcl interface

M	ChangeLog
M	nsproxy/nsproxylib.c

commit f659e21f5fc84ac362f2275b5e25817235066618
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-11-02

    Update src documentation with mode commands

M	doc/src/ns_accesslog.man
M	doc/src/ns_cond.man
M	doc/src/ns_conn.man
M	doc/src/ns_conncptofp.man
M	doc/src/ns_connsendfp.man
M	doc/src/ns_critsec.man
M	doc/src/ns_crypt.man
M	doc/src/ns_db.man
M	doc/src/ns_dbquotename.man
M	doc/src/ns_dbquotevalue.man
M	doc/src/ns_encodingforcharset.man
M	doc/src/ns_encodingfortype.man
M	doc/src/ns_env.man
M	doc/src/ns_eval.man
M	doc/src/ns_event.man
M	doc/src/ns_findset.man
M	doc/src/ns_fmttime.man
M	doc/src/ns_formfieldcharset.man
M	doc/src/ns_ftruncate.man
M	doc/src/ns_getchannels.man
M	doc/src/ns_getform.man
M	doc/src/ns_getformfile.man
M	doc/src/ns_geturl.man
M	doc/src/ns_gifsize.man
M	doc/src/ns_gmtime.man
M	doc/src/ns_guesstype.man
M	doc/src/ns_headers.man
M	doc/src/ns_hrefs.man
M	doc/src/ns_htmlselect.man
M	doc/src/ns_http.man
M	doc/src/ns_httpget.man
M	doc/src/ns_httpopen.man
M	doc/src/ns_httppost.man
M	doc/src/ns_ictl.man
M	doc/src/ns_imgmime.man
M	doc/src/ns_imgsize.man
M	doc/src/ns_imgtype.man
M	doc/src/ns_info.man
M	doc/src/ns_init.man
M	doc/src/ns_issmallint.man
M	doc/src/ns_job.man
M	doc/src/ns_jpegsize.man
M	doc/src/ns_kill.man
M	doc/src/ns_library.man
M	doc/src/ns_link.man
M	doc/src/ns_localsqltimestamp.man
M	doc/src/ns_localtime.man
M	doc/src/ns_logctl.man
M	doc/src/ns_logroll.man
M	doc/src/ns_markfordelete.man
M	doc/src/ns_mkdir.man
M	doc/src/ns_mktemp.man
M	doc/src/ns_modulepath.man
M	doc/src/ns_mutex.man
M	doc/src/ns_normalizepath.man
M	doc/src/ns_param.man
M	doc/src/ns_paren.man
M	doc/src/ns_parseargs.man
M	doc/src/ns_parseheader.man
M	doc/src/ns_parsequery.man
M	doc/src/ns_parsetime.man
M	doc/src/ns_pause.man
M	doc/src/ns_perm.man
M	doc/src/ns_queryexists.man
M	doc/src/ns_queryget.man
M	doc/src/ns_querygetall.man
M	doc/src/ns_quotehtml.man
M	doc/src/ns_rand.man
M	doc/src/ns_register_adp.man
M	doc/src/ns_register_adptag.man
M	doc/src/ns_register_filter.man
M	doc/src/ns_register_proc.man
M	doc/src/ns_register_trace.man
M	doc/src/ns_reinit.man
M	doc/src/ns_rename.man
M	doc/src/ns_requestauthorize.man
M	doc/src/ns_respond.man
M	doc/src/ns_resume.man
M	doc/src/ns_returnadminnotice.man
M	doc/src/ns_returnbadrequest.man
M	doc/src/ns_returnerror.man
M	doc/src/ns_returnfile.man
M	doc/src/ns_returnforbidden.man
M	doc/src/ns_returnfp.man
M	doc/src/ns_returnmoved.man
M	doc/src/ns_returnnotfound.man
M	doc/src/ns_returnnotice.man
M	doc/src/ns_returnok.man
M	doc/src/ns_returnredirect.man
M	doc/src/ns_returnunauthorized.man
M	doc/src/ns_returnunavailable.man
M	doc/src/ns_rmdir.man
M	doc/src/ns_rollfile.man
M	doc/src/ns_rwlock.man
M	doc/src/ns_schedule_daily.man
M	doc/src/ns_schedule_proc.man
M	doc/src/ns_schedule_weekly.man
M	doc/src/ns_section.man
M	doc/src/ns_sema.man
M	doc/src/ns_server.man
M	doc/src/ns_serverrootproc.man
M	doc/src/ns_set.man
M	doc/src/ns_setexpires.man
M	doc/src/ns_share.man
M	doc/src/ns_sleep.man
M	doc/src/ns_sockaccept.man
M	doc/src/ns_sockblocking.man
M	doc/src/ns_sockcallback.man
M	doc/src/ns_sockcheck.man
M	doc/src/ns_socketpair.man
M	doc/src/ns_socklisten.man
M	doc/src/ns_socklistencallback.man
M	doc/src/ns_socknonblocking.man
M	doc/src/ns_socknread.man
M	doc/src/ns_sockopen.man
M	doc/src/ns_sockselect.man
M	doc/src/ns_stats.man
M	doc/src/ns_striphtml.man
M	doc/src/ns_symlink.man
M	doc/src/ns_tagelement.man
M	doc/src/ns_tagelementset.man
M	doc/src/ns_thread.man
M	doc/src/ns_time.man
M	doc/src/ns_tmpnam.man
M	doc/src/ns_unregister_proc.man
M	doc/src/ns_url2file.man
M	doc/src/ns_write.man
M	doc/src/ns_writecontent.man
M	doc/src/ns_writefp.man
M	doc/src/ns_writer.man

commit b7df39ad6ea83018d2d39c5983189d16b3938751
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-11-01

    (LogFlush): accept an extra argument that controls internal locking
    
    Previously, the locking was done based on the value of the passed
    callback list and that was not correct.

M	ChangeLog
M	nsd/log.c

commit adbcaaa25c9ffafab3460f9af91b73892ad657a8
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-10-31

    (Ns_SetGetValue, Ns_SetIGetValue): return default value if NULL or empty string

M	ChangeLog
M	nsd/set.c

commit c778fc319023f972adb32f2bad7f3e85ee13047f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-10-20

    (ns_proxy_handler_http):return after redirect; (ns_httpopen): don't overwrite Host header

M	ChangeLog
M	tcl/http.tcl

commit cd7c2d4dd50bacd1c948ad60ecb0e9bfc1ca3e22
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-10-19

    Rename a variable that prohibited starting the server in chroot mode

M	ChangeLog
M	contrib/start-scripts/naviserver.SuSE

commit 2a49e9728131a6a1c2783b713f65239f9e23fbde
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-10-18

    (ns_proxy_handler): fix bug with access denied not returning

M	tcl/http.tcl

commit caf59c080d0adc79341034feddde7af0442c4985
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-10-17

    (ns_httpget): add chunked support

M	ChangeLog
M	tcl/http.tcl
M	tests/testserver/modules/testhttp.tcl

commit 43c4d5c46dc2ea648889bbe3f84f89503d4151af
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-10-09

    Drop per-thread private list of callbacks; use refcounting on the callback structure
    
    This avoids clashes with callback removal.

M	ChangeLog
M	nsd/log.c
M	tests/ns_log.test

commit 577bbd73480f941a545696e2b7c5c454871362b6
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-10-09

    Avoid holding locks in LogFlush by keeping private list of registered callbacks on per-thread basis

M	ChangeLog
M	nsd/log.c

commit eb7536c5e72c59001c4260a9531a90c95487c1bb
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-10-09

    (ns_sourcepproc): fix variable typo

M	tcl/file.tcl

commit 3f44879d333a44b60bbed2e24733e1f7d40e359c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-10-07

    Invalidate cache proc on Tcl error

M	ChangeLog
M	tcl/file.tcl

commit 505bd021f5dda36e124fc562ac0d90c74df1477a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-10-07

    Update to latest tcl.m4 from Tcl CVS
    
    No more annoying messages about underquoted macros when
    generating the build scripts!

M	ChangeLog
M	m4/tcl.m4

commit ef9e5295ff5eb7dd04b4f994139f03d4024b0274
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-10-06

    Update docs for cookie commands

M	doc/src/ns_deletecookie.man
M	doc/src/ns_getcookie.man
M	doc/src/ns_setcookie.man

commit 200dce00fb92ec734a18ed57cf1d5149d64cfd71
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-10-05

    Set a variable "version" and substitute the PACKAGE_VERSION into it; use it in doc header

M	ChangeLog
M	configure.in
M	doc/src/ns_memoize.man
A	doc/src/version_include.in

commit 7f8ebc30a91b29faa891d362d7bbbabc18e1c002
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-10-05

    Add description of the memoize commands. (All 3 commands described in a single man page.)

M	ChangeLog
A	doc/src/ns_memoize.man

commit dd7f73bf8cdfd03689e809c2419f70984ada1931
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-10-04

    Make UDP sockets support broadcast option by default

M	ChangeLog
M	nsd/binder.c

commit 73eb7735234cf93c5a9893722141cd284bc7f841
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-10-04

    (ns_cond wait): allow string-based mutex handles, as the rest of the code

M	ChangeLog
M	nsd/tclthread.c

commit eda2f14c724b6cc8e60ffa6b56aaf69cfae6045a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-10-03

    Driver change to support Unix domain drivers of stream and udp types

M	ChangeLog
M	nsd/driver.c

commit 5b0f46a6cf738a73a1f6f2101a9b43373da03bbd
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-10-02

    Minor fixes for man pages to compile with dtplite

M	doc/src/ns_adp_safeeval.man
M	doc/src/ns_cache_append.man
M	doc/src/ns_cache_create.man
M	doc/src/ns_cache_eval.man
M	doc/src/ns_cache_incr.man
M	doc/src/ns_cache_lappend.man
M	doc/src/ns_pagepath.man
M	doc/src/ns_serverpath.man
M	doc/src/ns_upload_stats.man

commit 34ec5f0c8ad570711a13d15ff4afe149f47f3f7d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-27

    Add examples dir under contrib and upload example test page

M	ChangeLog
M	Makefile
A	contrib/examples/index.adp
A	contrib/examples/upload.tcl
M	index.adp

commit 7414200c43ac0d65c653d4a9986e524d0966dadb
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-27

    Fix bug in ns_upload_stats

M	ChangeLog
M	nsd/driver.c

commit d960aa49b1f6e8aaaf5606d079b8dca97a7c92f4
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-27

    Change log Debug level to Dev level, cut down on excessive log chatter

M	ChangeLog
M	doc/src/ns_upload_stats.man
M	nsd/config.c

commit e6b0bd101fc9e5a489f38564d2fe4cbaafa811f3
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-27

    Updating more documentation files

M	doc/src/ns_hashpath.man
M	doc/src/ns_pagepath.man
M	doc/src/ns_runonce.man
M	doc/src/ns_serverpath.man
M	doc/src/ns_truncate.man

commit 3a42ee8e343041338a2c6bc5be2383bdafb01659
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-09-27

    Documentation for ns_gifsize, ns_imgmime, ns_imgsize, ns_imgtype, ns_jpegsize, ns_pngsize

M	doc/src/ns_gifsize.man
M	doc/src/ns_imgmime.man
M	doc/src/ns_imgsize.man
M	doc/src/ns_imgtype.man
M	doc/src/ns_jpegsize.man
M	doc/src/ns_pngsize.man

commit b0f0c6ae78c9f2e4cd338933b8d5b6ffa97ca062
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-27

    Continue working on documentation...

M	doc/src/ns_adp_abort.man
M	doc/src/ns_adp_append.man
M	doc/src/ns_adp_argc.man
M	doc/src/ns_adp_bind_args.man
M	doc/src/ns_adp_break.man
M	doc/src/ns_adp_compress.man
M	doc/src/ns_adp_debug.man
M	doc/src/ns_adp_dir.man
M	doc/src/ns_adp_dump.man
M	doc/src/ns_adp_eval.man
M	doc/src/ns_adp_exception.man
M	doc/src/ns_adp_include.man
M	doc/src/ns_adp_mime.man
M	doc/src/ns_adp_mimetype.man
M	doc/src/ns_adp_parse.man
M	doc/src/ns_adp_puts.man
M	doc/src/ns_adp_registeradp.man
M	doc/src/ns_adp_registerproc.man
M	doc/src/ns_adp_registertag.man
M	doc/src/ns_adp_return.man
M	doc/src/ns_adp_safeeval.man
M	doc/src/ns_adp_stats.man
M	doc/src/ns_adp_stream.man
M	doc/src/ns_adp_tell.man
M	doc/src/ns_adp_trunc.man
M	doc/src/ns_after.man
M	doc/src/ns_atclose.man
M	doc/src/ns_atexit.man
M	doc/src/ns_atprestartup.man
M	doc/src/ns_atshutdown.man
M	doc/src/ns_atsignal.man
M	doc/src/ns_atstartup.man
M	doc/src/ns_base64decode.man
M	doc/src/ns_base64encode.man
M	doc/src/ns_buildsqldate.man
M	doc/src/ns_cache_append.man
M	doc/src/ns_cache_create.man
M	doc/src/ns_cache_eval.man
M	doc/src/ns_cache_incr.man
M	doc/src/ns_cache_keys.man
M	doc/src/ns_cache_lappend.man
M	doc/src/ns_cache_names.man
D	doc/src/ns_cache_size.man
M	doc/src/ns_cache_stats.man
M	doc/src/ns_cancel.man
M	doc/src/ns_chan.man
M	doc/src/ns_charsets.man
M	doc/src/ns_chmod.man
M	doc/src/ns_choosecharset.man
M	doc/src/ns_cleanup.man
M	doc/src/ns_cleanupchans.man
M	doc/src/ns_cond.man
M	doc/src/ns_config.man
M	doc/src/ns_configsection.man
M	doc/src/ns_configsections.man
M	doc/src/ns_conn.man
M	doc/src/ns_conncptofp.man
M	doc/src/ns_connsendfp.man
M	doc/src/ns_cookiecharset.man
M	doc/src/ns_cookietime.man
M	doc/src/ns_cp.man
M	doc/src/ns_critsec.man
M	doc/src/ns_crypt.man
M	doc/src/ns_db.man
M	doc/src/ns_uudecode.man
M	doc/src/ns_uuencode.man

commit b05bc94da8f9bdd1ec2ac32eba426262a69f1516
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-27

    Add "-maxruns" parameter for proxy queue to limit number of runs in the proxy
    
    After reaching the limit the proxy slave process is
    automatically restarted.
    
    * nsproxy/ns_proxy.man: Updated docs.
    
    * tests/ns_proxy.test: Added tests to check -maxruns option.
    
    * nsd/tclxkeylist.c: Fix to avoid setting object in interp result.

M	ChangeLog
M	nsd/tclxkeylist.c
M	nsproxy/ns_proxy.man
M	nsproxy/nsproxylib.c
M	tests/ns_proxy.test

commit 3e1d6774560a9603b7b270064728f0efdcdb126a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-26

    Small corrections for makefile and remove unneeded file

M	doc/src/README.doc
D	doc/src/man.macros

commit 9c5e84a193356296b382edf496726da2ad3c1666
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-09-26

    Add two sets of banners (GIF/PNG)for NaviServer

M	ChangeLog
A	contrib/banners/README
A	contrib/banners/msie.html
A	contrib/banners/ns_logobig.gif
A	contrib/banners/ns_logobig.png
A	contrib/banners/ns_logosmall.gif
A	contrib/banners/ns_logosmall.png
A	contrib/banners/ns_poweredby.gif
A	contrib/banners/ns_poweredby.png

commit aaa1b81d80a96d4a76633340e1ee4394808586f5
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-25

    Update docs, all docs from Wiki are integrated into source docs

M	Makefile
M	README
M	doc/src/admin-install.man
M	doc/src/admin-maintenance.man
M	doc/src/ns_log.man
A	doc/src/tcl-lib-file.man
A	doc/src/tcl-lib-nstrace.man

commit 7a8bf15ebc239c6b4dbf0fc28745790a3fe3150a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-25

    Updated makefile with doc installation script

M	Makefile
D	doc/install-doc
D	doc/man.macros

commit bdb13a2f87cd5fb55258d9893f92491f43152cdd
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-23

    Documentation updates, formatting, testing crossreferencing

M	Makefile
D	doc/html/index.html
D	doc/html/ns_logo.gif
D	doc/html/ns_powered.gif
D	doc/html/ns_small.gif
D	doc/man/ns_sendmail.n
M	doc/src/adp-overview.man
M	doc/src/c-driverdb.man
M	doc/src/c-urlspace.man
M	doc/src/commandlist.man
M	doc/src/keyldel.man
M	doc/src/keylget.man
M	doc/src/keylkeys.man
M	doc/src/keylset.man
M	doc/src/main-features.man
M	doc/src/main-history.man
M	doc/src/main-standards.man
M	doc/src/ns_accesslog.man
M	doc/src/ns_addrbyhost.man
M	doc/src/ns_adp_abort.man
M	doc/src/ns_adp_append.man
M	doc/src/ns_adp_argc.man
M	doc/src/ns_adp_argv.man
M	doc/src/ns_adp_bind_args.man
M	doc/src/ns_adp_break.man
M	doc/src/ns_adp_compress.man
M	doc/src/ns_adp_debug.man
M	doc/src/ns_adp_dir.man
M	doc/src/ns_adp_dump.man
M	doc/src/ns_adp_eval.man
M	doc/src/ns_adp_exception.man
M	doc/src/ns_adp_include.man
M	doc/src/ns_adp_mime.man
M	doc/src/ns_adp_mimetype.man
M	doc/src/ns_adp_parse.man
M	doc/src/ns_adp_puts.man
M	doc/src/ns_adp_registeradp.man
M	doc/src/ns_adp_registerproc.man
M	doc/src/ns_adp_registertag.man
M	doc/src/ns_adp_return.man
M	doc/src/ns_adp_safeeval.man
M	doc/src/ns_adp_stats.man
M	doc/src/ns_adp_stream.man
M	doc/src/ns_adp_tell.man
M	doc/src/ns_adp_trunc.man
M	doc/src/ns_after.man
M	doc/src/ns_atclose.man
M	doc/src/ns_atexit.man
M	doc/src/ns_atprestartup.man
M	doc/src/ns_atshutdown.man
M	doc/src/ns_atsignal.man
M	doc/src/ns_atstartup.man
M	doc/src/ns_base64decode.man
M	doc/src/ns_base64encode.man
M	doc/src/ns_browsermatch.man
M	doc/src/ns_buildsqldate.man
M	doc/src/ns_cache_append.man
M	doc/src/ns_cache_create.man
M	doc/src/ns_cache_eval.man
M	doc/src/ns_cache_flush.man
M	doc/src/ns_cache_incr.man
M	doc/src/ns_cache_keys.man
M	doc/src/ns_cache_lappend.man
M	doc/src/ns_cache_names.man
M	doc/src/ns_cache_size.man
M	doc/src/ns_cache_stats.man
M	doc/src/ns_cancel.man
M	doc/src/ns_chan.man
M	doc/src/ns_charsets.man
M	doc/src/ns_checkurl.man
M	doc/src/ns_chmod.man
M	doc/src/ns_choosecharset.man
M	doc/src/ns_cleanup.man
M	doc/src/ns_cleanupchans.man
M	doc/src/ns_cond.man
M	doc/src/ns_config.man
M	doc/src/ns_configsection.man
M	doc/src/ns_configsections.man
M	doc/src/ns_conn.man
M	doc/src/ns_conncptofp.man
M	doc/src/ns_connsendfp.man
M	doc/src/ns_cookiecharset.man
M	doc/src/ns_cookietime.man
M	doc/src/ns_cp.man
M	doc/src/ns_critsec.man
M	doc/src/ns_crypt.man
M	doc/src/ns_db.man
M	doc/src/ns_dbquotename.man
M	doc/src/ns_dbquotevalue.man
M	doc/src/ns_deletecookie.man
M	doc/src/ns_encodingforcharset.man
M	doc/src/ns_encodingfortype.man
D	doc/src/ns_encrypt.man
M	doc/src/ns_env.man
M	doc/src/ns_eval.man
M	doc/src/ns_event.man
M	doc/src/ns_findset.man
M	doc/src/ns_fmttime.man
M	doc/src/ns_formfieldcharset.man
M	doc/src/ns_ftruncate.man
M	doc/src/ns_getchannels.man
M	doc/src/ns_getcookie.man
M	doc/src/ns_getform.man
M	doc/src/ns_getformfile.man
M	doc/src/ns_geturl.man
M	doc/src/ns_gifsize.man
M	doc/src/ns_gmtime.man
M	doc/src/ns_guesstype.man
M	doc/src/ns_hashpath.man
M	doc/src/ns_headers.man
M	doc/src/ns_hostbyaddr.man
M	doc/src/ns_hrefs.man
M	doc/src/ns_htmlselect.man
M	doc/src/ns_http.man
M	doc/src/ns_httpget.man
M	doc/src/ns_httpopen.man
M	doc/src/ns_httppost.man
M	doc/src/ns_httptime.man
M	doc/src/ns_ictl.man
M	doc/src/ns_imgmime.man
M	doc/src/ns_imgsize.man
M	doc/src/ns_imgtype.man
M	doc/src/ns_info.man
M	doc/src/ns_init.man
M	doc/src/ns_issmallint.man
M	doc/src/ns_job.man
M	doc/src/ns_jpegsize.man
M	doc/src/ns_kill.man
M	doc/src/ns_library.man
M	doc/src/ns_limits_get.man
M	doc/src/ns_limits_list.man
M	doc/src/ns_limits_register.man
M	doc/src/ns_limits_set.man
M	doc/src/ns_link.man
M	doc/src/ns_localsqltimestamp.man
M	doc/src/ns_localtime.man
M	doc/src/ns_locationproc.man
M	doc/src/ns_log.man
M	doc/src/ns_logctl.man
M	doc/src/ns_logroll.man
M	doc/src/ns_markfordelete.man
M	doc/src/ns_mkdir.man
M	doc/src/ns_mktemp.man
M	doc/src/ns_moduleload.man
M	doc/src/ns_modulepath.man
M	doc/src/ns_mutex.man
M	doc/src/ns_normalizepath.man
M	doc/src/ns_pagepath.man
M	doc/src/ns_param.man
M	doc/src/ns_paren.man
M	doc/src/ns_parseargs.man
M	doc/src/ns_parseheader.man
M	doc/src/ns_parsehttptime.man
M	doc/src/ns_parsequery.man
M	doc/src/ns_parsetime.man
M	doc/src/ns_pause.man
M	doc/src/ns_perm.man
M	doc/src/ns_pngsize.man
M	doc/src/ns_proxy.man
M	doc/src/ns_purgefiles.man
M	doc/src/ns_puts.man
M	doc/src/ns_queryexists.man
M	doc/src/ns_queryget.man
M	doc/src/ns_querygetall.man
M	doc/src/ns_quotehtml.man
M	doc/src/ns_rand.man
M	doc/src/ns_register_adp.man
M	doc/src/ns_register_adptag.man
M	doc/src/ns_register_fastpath.man
M	doc/src/ns_register_fasturl2file.man
M	doc/src/ns_register_filter.man
M	doc/src/ns_register_proc.man
M	doc/src/ns_register_proxy.man
M	doc/src/ns_register_trace.man
M	doc/src/ns_register_url2file.man
M	doc/src/ns_reinit.man
M	doc/src/ns_rename.man
M	doc/src/ns_requestauthorize.man
M	doc/src/ns_respond.man
M	doc/src/ns_resume.man
M	doc/src/ns_return.man
M	doc/src/ns_returnadminnotice.man
M	doc/src/ns_returnbadrequest.man
M	doc/src/ns_returnerror.man
M	doc/src/ns_returnfile.man
M	doc/src/ns_returnforbidden.man
M	doc/src/ns_returnfp.man
M	doc/src/ns_returnmoved.man
M	doc/src/ns_returnnotfound.man
M	doc/src/ns_returnnotice.man
M	doc/src/ns_returnok.man
M	doc/src/ns_returnredirect.man
M	doc/src/ns_returnunauthorized.man
M	doc/src/ns_returnunavailable.man
M	doc/src/ns_rmdir.man
M	doc/src/ns_rollfile.man
M	doc/src/ns_runonce.man
M	doc/src/ns_rwlock.man
M	doc/src/ns_schedule_daily.man
M	doc/src/ns_schedule_proc.man
M	doc/src/ns_schedule_weekly.man
M	doc/src/ns_section.man
M	doc/src/ns_sema.man
M	doc/src/ns_server.man
M	doc/src/ns_serverpath.man
M	doc/src/ns_serverrootproc.man
M	doc/src/ns_set.man
M	doc/src/ns_setcookie.man
M	doc/src/ns_setexpires.man
M	doc/src/ns_setformencoding.man
M	doc/src/ns_share.man
M	doc/src/ns_shortcut_filter.man
M	doc/src/ns_shutdown.man
M	doc/src/ns_sleep.man
M	doc/src/ns_sockaccept.man
M	doc/src/ns_sockblocking.man
M	doc/src/ns_sockcallback.man
M	doc/src/ns_sockcheck.man
M	doc/src/ns_socketpair.man
M	doc/src/ns_socklisten.man
M	doc/src/ns_socklistencallback.man
M	doc/src/ns_socknonblocking.man
M	doc/src/ns_socknread.man
M	doc/src/ns_sockopen.man
M	doc/src/ns_sockselect.man
M	doc/src/ns_startcontent.man
M	doc/src/ns_stats.man
M	doc/src/ns_striphtml.man
M	doc/src/ns_symlink.man
M	doc/src/ns_tagelement.man
M	doc/src/ns_tagelementset.man
M	doc/src/ns_thread.man
M	doc/src/ns_time.man
M	doc/src/ns_tmpnam.man
M	doc/src/ns_truncate.man
M	doc/src/ns_unregister_adp.man
M	doc/src/ns_unregister_proc.man
M	doc/src/ns_unregister_url2file.man
M	doc/src/ns_unschedule_proc.man
M	doc/src/ns_upload_stats.man
M	doc/src/ns_url2file.man
M	doc/src/ns_urlcharset.man
M	doc/src/ns_urldecode.man
M	doc/src/ns_urlencode.man
M	doc/src/ns_uudecode.man
M	doc/src/ns_uuencode.man
M	doc/src/ns_var.man
M	doc/src/ns_write.man
M	doc/src/ns_writecontent.man
M	doc/src/ns_writefp.man
M	doc/src/ns_writer.man
M	doc/src/nsv_append.man
M	doc/src/nsv_array.man
M	doc/src/nsv_exists.man
M	doc/src/nsv_get.man
M	doc/src/nsv_incr.man
M	doc/src/nsv_lappend.man
M	doc/src/nsv_names.man
M	doc/src/nsv_set.man
M	doc/src/nsv_unset.man
M	doc/src/tcl-overview.man
M	doc/src/template.man

commit c6c1e26e2d6cf1f7b5da32a3c141619722b9bc7d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-23

    Minor html index changes

M	doc/html/index.html
A	doc/html/ns_logo.gif
A	doc/html/ns_powered.gif
A	doc/html/ns_small.gif

commit 51fe3e6e3fba3abd5eaef0651ecd5cc8cc16adf8
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-23

    (Ns_ConnWriteVChars): send multiple small buffers correctly
    
    Update test to mark encoding as knownBug until fixed and http
    chunked test according to updated ns_httptest.

M	ChangeLog
M	nsd/connio.c
M	tests/encoding.test
M	tests/http.test
M	tests/http_chunked.test
M	tests/tclresp.test

commit ee5afdd65f886aa3d340820cfde674e48cd2076c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-23

    Documentation minor fixes in doctools

M	doc/src/module-nscp.man
M	doc/src/ns_urlencode.man

commit 04d34be373fa5ba7c6866ed2457db2f5770f8d31
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-22

    Avoid setting Tcl objects obtained from the interpreter result
    
    The result may contain objects that are shared. So constructs
    like this:
    
        Tcl_SetIntObj(Tcl_GetObjResult(interp), n));
    
    are rewritten to read:
    
        Tcl_SetObjResult(interp, Tcl_NewIntObj(n));
    
    This is done for all "known" Tcl object types like: int, string,
    boolean, long, and our custom object types like: time.
    
    * include/ns.h:
    * nsd/tcltime.c: Added Ns_TclNewTimeObj() exported API.

M	ChangeLog
M	include/ns.h
M	nsd/adpcmds.c
M	nsd/conn.c
M	nsd/httptime.c
M	nsd/mimetypes.c
M	nsd/nsmain.c
M	nsd/random.c
M	nsd/tclcache.c
M	nsd/tclenv.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclthread.c
M	nsd/tcltime.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c

commit b6ec8dac21a4e3dc0eaea2a854605804afdd3410
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-20

    Add debug support for malformed requests; more detailed error logging if enabled
    
    Introduced new parameter for nssock: badrequestlogging. If enabled
    all bad requests will be logged

M	ChangeLog
M	nsd/driver.c

commit bd5c369d75c96bd2d6f259d1ff473e6d1325eb55
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-19

    Update to be valid doctools files; next, figure out cross-referencing with [uri] tag

M	doc/src/ns_adp_compress.man
M	doc/src/ns_adp_debug.man
M	doc/src/ns_adp_registeradp.man
M	doc/src/ns_adp_registertag.man
M	doc/src/ns_atprestartup.man
M	doc/src/ns_atstartup.man
M	doc/src/ns_base64decode.man
M	doc/src/ns_base64encode.man
M	doc/src/ns_cache_append.man
M	doc/src/ns_cache_create.man
M	doc/src/ns_cache_eval.man
M	doc/src/ns_cache_incr.man
M	doc/src/ns_cache_lappend.man
M	doc/src/ns_cache_size.man
M	doc/src/ns_cache_stats.man
M	doc/src/ns_conncptofp.man
M	doc/src/ns_connsendfp.man
M	doc/src/ns_deletecookie.man
M	doc/src/ns_getcookie.man
M	doc/src/ns_geturl.man
M	doc/src/ns_hashpath.man
M	doc/src/ns_headers.man
M	doc/src/ns_imgmime.man
M	doc/src/ns_imgsize.man
M	doc/src/ns_imgtype.man
M	doc/src/ns_limits_get.man
M	doc/src/ns_limits_list.man
M	doc/src/ns_limits_register.man
M	doc/src/ns_limits_set.man
M	doc/src/ns_locationproc.man
M	doc/src/ns_moduleload.man
M	doc/src/ns_pagepath.man
M	doc/src/ns_parseargs.man
M	doc/src/ns_parseheader.man
M	doc/src/ns_perm.man
M	doc/src/ns_pngsize.man
M	doc/src/ns_proxy.man
M	doc/src/ns_purgefiles.man
M	doc/src/ns_register_adptag.man
M	doc/src/ns_register_fastpath.man
M	doc/src/ns_register_fasturl2file.man
M	doc/src/ns_register_proxy.man
M	doc/src/ns_register_trace.man
M	doc/src/ns_register_url2file.man
M	doc/src/ns_returnadminnotice.man
M	doc/src/ns_returnbadrequest.man
M	doc/src/ns_returnerror.man
M	doc/src/ns_returnfp.man
M	doc/src/ns_returnnotice.man
M	doc/src/ns_returnunavailable.man
M	doc/src/ns_rollfile.man
M	doc/src/ns_runonce.man
M	doc/src/ns_rwlock.man
M	doc/src/ns_serverpath.man
M	doc/src/ns_serverrootproc.man
M	doc/src/ns_setcookie.man
M	doc/src/ns_shortcut_filter.man
M	doc/src/ns_sockaccept.man
M	doc/src/ns_sockblocking.man
M	doc/src/ns_sockcallback.man
M	doc/src/ns_sockcheck.man
M	doc/src/ns_socketpair.man
M	doc/src/ns_socklisten.man
M	doc/src/ns_socklistencallback.man
M	doc/src/ns_socknonblocking.man
M	doc/src/ns_socknread.man
M	doc/src/ns_sockopen.man
M	doc/src/ns_sockselect.man
M	doc/src/ns_startcontent.man
M	doc/src/ns_truncate.man
M	doc/src/ns_unregister_adp.man
M	doc/src/ns_unregister_url2file.man
M	doc/src/ns_upload_stats.man
M	doc/src/ns_url2file.man
M	doc/src/ns_urlencode.man
M	doc/src/ns_var.man
M	doc/src/ns_writecontent.man
M	doc/src/ns_writefp.man
M	doc/src/ns_writer.man
M	doc/src/template.man

commit f1919a8633055162fcab0350cfaf484987e73eb3
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-19

    Make it valid doctools format

M	doc/src/module-nscgi.man

commit 3bd7c3180f372fe45d1c56c929f58af3fc508ea6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-19

    .html files can be produced from .man file with doctools

D	doc/html/ns_sendmail.html

commit eea2ee44ccf0082dc68c34788bc691e4559a5dee
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-19

    Remove unneeded broadcast on the pool condition variable
    
    Also, in PushProxy(), the pool condition variable is
    conditionally broadcasted.
    
    Renamed Proc to Slave to avoid name-clashes with the rest of the
    code where procPtr usually means something else.
    
    nsproxy/nsproxymod.c: Structure holding the server and module
    information is now allocated from the heap instead of being static.

M	ChangeLog
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c

commit bf49207839e98b6a9f1a44b23a26e1a916b70756
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-18

    Update and fix minor bugs in http proxy script

M	ChangeLog
M	tcl/http.tcl

commit e44d7c84b8dcd2cb09021613d4032dcdb187d7b7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-17

    Make docs doctools parsable

M	Makefile
M	doc/src/admin-install.man
M	doc/src/admin-maintenance.man
M	doc/src/adp-overview.man
M	doc/src/c-driverdb.man
M	doc/src/c-urlspace.man
M	doc/src/main-history.man
M	doc/src/tcl-nsv.man
M	doc/src/tcl-overview.man

commit fbe9106c4d3a8d3ecc9e215293a73b4181a4cf1d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-17

    Converted .html fiels into doctools .man files

M	ChangeLog
D	doc/html/sample-config.tcl.txt
R064	doc/html/admin-config.html	doc/src/admin-config.man
R071	doc/html/admin-db.html	doc/src/admin-db.man
R057	doc/html/admin-install.html	doc/src/admin-install.man
R074	doc/html/admin-maintenance.html	doc/src/admin-maintenance.man
R083	doc/html/admin-tuning.html	doc/src/admin-tuning.man
R066	doc/html/adp-overview.html	doc/src/adp-overview.man
R079	doc/html/c-driverdb.html	doc/src/c-driverdb.man
R087	doc/html/c-urlspace.html	doc/src/c-urlspace.man
R065	doc/html/main-faq.html	doc/src/main-faq.man
R064	doc/html/main-features.html	doc/src/main-features.man
R072	doc/html/main-history.html	doc/src/main-history.man
R065	doc/html/main-standards.html	doc/src/main-standards.man
R080	doc/html/module-nscgi.html	doc/src/module-nscgi.man
R069	doc/html/module-nscp.html	doc/src/module-nscp.man
R082	doc/html/module-nsperm.html	doc/src/module-nsperm.man
R075	doc/html/tcl-libraries.html	doc/src/tcl-libraries.man
R079	doc/html/tcl-nsv.html	doc/src/tcl-nsv.man
R079	doc/html/tcl-overview.html	doc/src/tcl-overview.man

commit 276b4633b771af45b06521e36f13bc06f5f915fe
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-15

    Cleaned up docs, reformatted HTML files, removed unsused files

D	doc/Ns_Alloc.3
D	doc/Ns_CritSec.3
D	doc/Ns_Encrypt.3
D	doc/Ns_IntPrint.3
D	doc/Ns_Master.3
D	doc/Ns_Mime.3
D	doc/Ns_QuoteHtml.3
D	doc/Ns_String.3
D	doc/Ns_Uid.3
D	doc/Ns_Url.3
M	doc/html/admin-config.html
M	doc/html/admin-db.html
M	doc/html/admin-install.html
M	doc/html/admin-maintenance.html
M	doc/html/admin-tuning.html
M	doc/html/adp-overview.html
M	doc/html/c-driverdb.html
M	doc/html/c-urlspace.html
M	doc/html/index.html
M	doc/html/main-faq.html
M	doc/html/main-features.html
M	doc/html/main-history.html
M	doc/html/main-standards.html
M	doc/html/module-nscgi.html
M	doc/html/module-nscp.html
M	doc/html/module-nsperm.html
D	doc/html/tcl-examples.html
M	doc/html/tcl-libraries.html
M	doc/html/tcl-nsv.html
M	doc/html/tcl-overview.html
M	doc/install-doc
D	doc/mkLinks
D	doc/ns_adp.n
D	doc/ns_cache.n
D	doc/ns_crypt.n
D	doc/ns_filter.n
D	doc/ns_geturl.n
D	doc/ns_headers.n
D	doc/ns_info.n
D	doc/ns_sock.n
D	doc/ns_thread.n
D	doc/ns_time.n

commit 6d08de130744cffa4ba48e29681b8a87d17f58a1
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-15

    Regularize configuration paths
    
    Make all path related parameters work  the same way:
    
     - if not specified, use default
     - if absolute, use as given
     - if relative, construct under server home dir
    
    This affects the following parameters:
    home, pagedir, library, tcllibrary, initfile, serverlog

M	ChangeLog
M	nsd/log.c
M	nsd/nsconf.c
M	nsd/server.c

commit 5582217b545a7a71d9a1b05054645644048ee01e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-15

    (NsInitServer): fix wrongly calculated path to the server-private Tcl library
    
    According to the new simplified schema, the path to the private
    tcl lib is "$home/modules/tcl" but the code calculated
    "$home/modules/modules/tcl" instead.
    
    This has now been fixed.

M	ChangeLog
M	nsd/server.c

commit 13a68982d3d6ffa63a9dd5916b18b40dc01614b2
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-15

    Update nsproxy default parameters

M	sample-config.tcl.in

commit a9ce747624bb56b5655284d243c4d9bdf2c36430
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-15

    Add some new nsproxy tests

M	ChangeLog
M	tests/ns_proxy.test

commit d969dc2611377b788dbfb66c0b6dce6f3d195b60
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-15

    Update documentation for new/changed commands

M	nsproxy/ns_proxy.man

commit 62fdba94f9c143bdeee7504c06e84f8468c7ccb9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-15

    Add new command [ns_proxy stop] which kills slaves of the running proxies
    
    Changed format of the result of the [ns_proxy active] to be a
    list of lists. Each sublist is in key/value format containing
    information about the proxy handle, the pid of the slave, the
    start-time and the executing script.
    
    Also, the command now accepts one optional argument: the handle
    of the proxy for which to return the status report.
    
    Changed [ns_proxy clear] to require the pool argument. The
    [ns_proxy clear] and [ns_proxy stop] commands are now symmetric
    where the former operates on the idle proxies and the latter on the
    running proxies.

M	nsproxy/nsproxylib.c

commit 55657e6f3e7883ce707e491dea26389f00a8af2b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-15

    Register Ns_Shutdown instead of Ns_Exit callback to teardown the proxy

M	nsproxy/nsproxymod.c

commit 52bcaefdb00289ba74ee3e3e41e61383a7a4997d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-15

    Export Ns_ProxyShutdown instead of Ns_ProxyExit

M	nsproxy/nsproxy.h

commit 1388ea48b0d20c6621e90313aa08934857cc0f1d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-15

    Updating documentation HTML files...

M	doc/html/admin-config.html
M	doc/html/admin-db.html
M	doc/html/admin-install.html
M	doc/html/admin-maintenance.html
M	doc/html/admin-tuning.html
M	doc/html/index.html
M	doc/html/main-faq.html
M	doc/html/main-features.html
M	doc/html/module-nscp.html

commit 53ee3af3180a287d7b64497693f446b793ba3926
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-14

    Fix various MT-safeness issues all around the code; new commands
    
    Removed "-minslaves" pool configuration option, as it was both
    broken and meaningless.
    
    Returning a non-idle proxy back to the pool forcefully closes
    the corresponding slave process.
    
    Added new command [ns_proxy pools] to dynamically obtain the
    list of available pools.
    
    Fixed broken [ns_proxy active] which failed to report all but
    the first active proxy.
    
    nsproxy/ns_proxy.man: Added some flesh.
    
    tests/ns_proxy.test: Adjusted to match new command line and
    sytax. Added couple of tests to check [ns_proxy active] command.

M	ChangeLog
M	nsproxy/ns_proxy.man
M	nsproxy/nsproxylib.c
M	tests/ns_proxy.test

commit e32f8b294b12c6c7d0c4440a2ea3c7dd3b28a329
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-13

    Fixed bug in init.tcl not loading .tcl files on start

M	ChangeLog
M	nsd/init.tcl
M	tests/http.test
M	tests/test.nscfg
M	tests/testserver/modules/testhttp.tcl

commit d7fb2f92a2373fd9ab1fb637c6ad1e18ddcbbd23
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-13

    (Ns_ProxyExit): avoid tearing down pools with slaves on the run list
    
    This may lead to memory violations. At the moment we just "leak"
    those pools.

M	ChangeLog
M	nsproxy/nsproxylib.c

commit 517449cf14b19555d89ddca59954c90c285c009d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-12

    In progress work for updating documentation...

M	doc/html/admin-config.html
M	doc/html/admin-install.html
M	doc/html/admin-maintenance.html
M	doc/html/admin-tuning.html
M	doc/html/adp-overview.html
M	doc/html/index.html
M	doc/html/main-faq.html
M	doc/html/main-features.html
D	doc/html/tcl-general.html
M	doc/html/tcl-overview.html

commit a0c01d0973770a31c017a10222acf09d27f8dd21
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-09-12

    Add missing documentation templates for commands

M	ChangeLog
A	doc/src/ns_adp_compress.man
A	doc/src/ns_adp_debug.man
A	doc/src/ns_adp_registeradp.man
A	doc/src/ns_adp_registertag.man
A	doc/src/ns_atprestartup.man
A	doc/src/ns_atstartup.man
A	doc/src/ns_base64decode.man
A	doc/src/ns_base64encode.man
A	doc/src/ns_cache_append.man
A	doc/src/ns_cache_create.man
A	doc/src/ns_cache_eval.man
A	doc/src/ns_cache_incr.man
A	doc/src/ns_cache_lappend.man
A	doc/src/ns_cache_size.man
A	doc/src/ns_cache_stats.man
A	doc/src/ns_conncptofp.man
A	doc/src/ns_connsendfp.man
A	doc/src/ns_deletecookie.man
A	doc/src/ns_getcookie.man
A	doc/src/ns_geturl.man
A	doc/src/ns_hashpath.man
A	doc/src/ns_headers.man
A	doc/src/ns_imgmime.man
A	doc/src/ns_imgsize.man
A	doc/src/ns_imgtype.man
A	doc/src/ns_limits_get.man
A	doc/src/ns_limits_list.man
A	doc/src/ns_limits_register.man
A	doc/src/ns_limits_set.man
A	doc/src/ns_locationproc.man
A	doc/src/ns_moduleload.man
A	doc/src/ns_pagepath.man
A	doc/src/ns_parseargs.man
A	doc/src/ns_parseheader.man
A	doc/src/ns_perm.man
A	doc/src/ns_pngsize.man
A	doc/src/ns_proxy.man
A	doc/src/ns_purgefiles.man
A	doc/src/ns_register_adptag.man
A	doc/src/ns_register_fastpath.man
A	doc/src/ns_register_fasturl2file.man
A	doc/src/ns_register_proxy.man
A	doc/src/ns_register_trace.man
A	doc/src/ns_register_url2file.man
A	doc/src/ns_returnadminnotice.man
A	doc/src/ns_returnbadrequest.man
A	doc/src/ns_returnerror.man
A	doc/src/ns_returnfp.man
A	doc/src/ns_returnnotice.man
A	doc/src/ns_returnunavailable.man
A	doc/src/ns_rollfile.man
A	doc/src/ns_runonce.man
A	doc/src/ns_rwlock.man
A	doc/src/ns_serverpath.man
A	doc/src/ns_serverrootproc.man
A	doc/src/ns_setcookie.man
A	doc/src/ns_shortcut_filter.man
A	doc/src/ns_sockaccept.man
A	doc/src/ns_sockblocking.man
A	doc/src/ns_sockcallback.man
A	doc/src/ns_sockcheck.man
A	doc/src/ns_socketpair.man
A	doc/src/ns_socklisten.man
A	doc/src/ns_socklistencallback.man
A	doc/src/ns_socknonblocking.man
A	doc/src/ns_socknread.man
A	doc/src/ns_sockopen.man
A	doc/src/ns_sockselect.man
A	doc/src/ns_startcontent.man
A	doc/src/ns_truncate.man
A	doc/src/ns_unregister_adp.man
A	doc/src/ns_unregister_url2file.man
A	doc/src/ns_upload_stats.man
A	doc/src/ns_var.man
A	doc/src/ns_writecontent.man
A	doc/src/ns_writefp.man
A	doc/src/ns_writer.man

commit 934b3581413ebe2eec3bace03f46f9b010fbf066
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-12

    Cleanup of docs, added top level HTML files, removed empty man pages

M	ChangeLog
M	Makefile
D	doc/Ns_Adp.3
D	doc/Ns_Auth.3
D	doc/Ns_Cache.3
D	doc/Ns_Cls.3
D	doc/Ns_Cond.3
D	doc/Ns_Config.3
D	doc/Ns_Conn.3
D	doc/Ns_ConnCopy.3
D	doc/Ns_ConnDriver.3
D	doc/Ns_ConnHeaders.3
D	doc/Ns_ConnRead.3
D	doc/Ns_ConnRequest.3
D	doc/Ns_ConnReturn.3
D	doc/Ns_ConnSend.3
D	doc/Ns_ConnWrite.3
D	doc/Ns_DString.3
D	doc/Ns_Db.3
D	doc/Ns_DbDriver.3
D	doc/Ns_DbPool.3
D	doc/Ns_DbSp.3
D	doc/Ns_DbUtil.3
D	doc/Ns_Driver.3
D	doc/Ns_Encoding.3
D	doc/Ns_Env.3
D	doc/Ns_Exec.3
D	doc/Ns_ExtDb.3
D	doc/Ns_Fd.3
D	doc/Ns_Fetch.3
D	doc/Ns_Filter.3
D	doc/Ns_HttpTime.3
D	doc/Ns_Htuu.3
D	doc/Ns_Index.3
D	doc/Ns_InetAddr.3
D	doc/Ns_Info.3
D	doc/Ns_List.3
D	doc/Ns_Location.3
D	doc/Ns_Log.3
D	doc/Ns_Module.3
D	doc/Ns_Mutex.3
D	doc/Ns_Nsd.3
D	doc/Ns_Pathname.3
D	doc/Ns_Pool.3
D	doc/Ns_ProcInfo.3
D	doc/Ns_RWLock.3
D	doc/Ns_Rand.3
D	doc/Ns_Reentrant.3
D	doc/Ns_Register.3
D	doc/Ns_Request.3
D	doc/Ns_RollFile.3
D	doc/Ns_Sched.3
D	doc/Ns_Sema.3
D	doc/Ns_ServerSpecific.3
D	doc/Ns_Set.3
D	doc/Ns_Signal.3
D	doc/Ns_Sock.3
D	doc/Ns_SockCallback.3
D	doc/Ns_SockErrno.3
D	doc/Ns_SockIO.3
D	doc/Ns_TclConn.3
D	doc/Ns_TclDbGetHandle.3
D	doc/Ns_TclFile.3
D	doc/Ns_TclInit.3
D	doc/Ns_TclInterp.3
D	doc/Ns_TclRegister.3
D	doc/Ns_TclSet.3
D	doc/Ns_TclThread.3
D	doc/Ns_TclTimeObj.3
D	doc/Ns_TempFile.3
D	doc/Ns_Thread.3
D	doc/Ns_Thread2.3
D	doc/Ns_ThreadAlloc.3
D	doc/Ns_Time.3
D	doc/Ns_Tls.3
D	doc/Ns_UrlEncode.3
D	doc/Ns_UrlSpecific.3
D	doc/Ns_UrlToFile.3
A	doc/html/admin-config.html
A	doc/html/admin-db.html
A	doc/html/admin-install.html
A	doc/html/admin-maintenance.html
A	doc/html/admin-tuning.html
A	doc/html/adp-overview.html
A	doc/html/c-driverdb.html
A	doc/html/c-urlspace.html
A	doc/html/index.html
A	doc/html/main-faq.html
A	doc/html/main-features.html
A	doc/html/main-history.html
A	doc/html/main-standards.html
A	doc/html/module-nscgi.html
A	doc/html/module-nscp.html
A	doc/html/module-nsperm.html
A	doc/html/sample-config.tcl.txt
A	doc/html/tcl-examples.html
A	doc/html/tcl-general.html
A	doc/html/tcl-libraries.html
A	doc/html/tcl-nsv.html
A	doc/html/tcl-overview.html
D	doc/ns_at.n
D	doc/ns_chan.n
D	doc/ns_checkurl.n
D	doc/ns_config.n
D	doc/ns_conn.n
D	doc/ns_crash.n
D	doc/ns_db.n
D	doc/ns_env.n
D	doc/ns_eval.n
D	doc/ns_file.n
D	doc/ns_getchannels.n
D	doc/ns_guesstype.n
D	doc/ns_html.n
D	doc/ns_http.n
D	doc/ns_httptime.n
D	doc/ns_img.n
D	doc/ns_init.n
D	doc/ns_job.n
D	doc/ns_kill.n
D	doc/ns_library.n
D	doc/ns_log.n
D	doc/ns_logroll.n
D	doc/ns_markfordelete.n
D	doc/ns_module.n
D	doc/ns_modulepath.n
D	doc/ns_normalizepath.n
D	doc/ns_parseheader.n
D	doc/ns_parsequery.n
D	doc/ns_proc.n
D	doc/ns_purgefiles.n
D	doc/ns_rand.n
D	doc/ns_requestauthorize.n
D	doc/ns_return.n
D	doc/ns_rollfile.n
D	doc/ns_sched.n
D	doc/ns_set.n
D	doc/ns_share.n
D	doc/ns_sleep.n
D	doc/ns_sync.n
D	doc/ns_tmp.n
D	doc/ns_url2file.n
D	doc/ns_urlencode.n
D	doc/ns_uuencode.n
D	doc/ns_writefp.n
D	doc/nsd.1
M	doc/src/ns_sleep.man
M	doc/src/ns_url2file.man
M	doc/src/ns_urlencode.man
M	index.adp

commit 9c77314535f2b8e147e28983d5b39b38baabd2c8
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-11

    Move nsd.tcl from contrib into top as nsd-config.tcl

A	nsd-config.tcl

commit 4f43a1892912aa7fa54384d3889627696533acc5
Author: Michael Cleverly <michael@cleverly.com>
Date:   2006-09-10

    Add missing ChangeLog entries

M	ChangeLog

commit dada18f906d26800c9ec8d6ae1df35fb2576ce6e
Author: Michael Cleverly <michael@cleverly.com>
Date:   2006-09-10

    Add pedantic [list] quoting of commands being [eval]'ed
    
    Add -- to [glob] in case anyone ever mistakingly named a $sharedlib with a
    beginning hyphen.

M	nsd/init.tcl

commit 5309c4e814ae0c1c309ab844ee7e75205e0b543b
Author: Michael Cleverly <michael@cleverly.com>
Date:   2006-09-10

    Pedantic addition of -- to [switch] to signal end of switches
    
    On the off chance someone mistakingly passes an $opt that begins with a hyphen.
    
    Added a catch around [ns_db bouncepool] in ns_dbshutdown to any errors.

M	nsdb/util.tcl

commit 91b6c6aead0e11cca1431a86fa4f5d39544a94a2
Author: Michael Cleverly <michael@cleverly.com>
Date:   2006-09-10

    Use [file join] to construct filenames for maximum portability
    
    Add [list] quoting when building up a $cmd script to be [eval]'ed.

M	nsperm/init.tcl

commit 49ef566fcaf76a787af830f5cadbc1d7896a63ca
Author: cleverly <none@none>
Date:   2006-09-10

    Add -- (end of switches) to the regexp in ns_cookiecharset
    
    In case the $name of the cookie ever happened to begin with a
    hyphen, we are safe.

M	tcl/charsets.tcl

commit 35096db719e1d1cae5e65ed72ede4ebe1d233e80
Author: Michael Cleverly <michael@cleverly.com>
Date:   2006-09-10

    Add -- (end of switches) in front of regexp/regsub where the regexp comes from a $variable
    
    Specifically specified the level-to-upvar in getformdata as 1 to avoid
    errors if the name of the formVar were ever an integer.
    
    Changed remaining instances of string comparisons using == and != to
    eq and ne.

M	tcl/util.tcl

commit 319e751a377c42353cc10315c7d18dccdfd39b65
Author: Michael Cleverly <michael@cleverly.com>
Date:   2006-09-10

    Pedantic additions of [list] quoting while constructing the script(s) used to initialize interp state
    
    This is so that they won't blow up if someone were ever foolish
    enough to create a namespace (or proc) that contains a space or
    other meaningful Tcl punctuation ($, [], \, etc.)
    
    Changed all instances of:
        uplevel <command> <args>
    to explicitly be
        uplevel 1 <command> <args>
    in case <command> were ever interpretable as an integer itself.
    
    Changed "switch -glob $nop" to "switch -glob -- $nop" in case $nop were
    to ever begin with a hyphen.

M	tcl/nstrace.tcl

commit 135878629211cdcaa5336277aa479bfe9a292f12
Author: Michael Cleverly <michael@cleverly.com>
Date:   2006-09-10

    Replaced [expr 10*1024*1000] with the actual result of the computation
    
    (Alternatively, if it is desirable to have it as a calculation, it should
    be braced as [expr {10*1024*1000}]).

M	tcl/limits.tcl

commit d3904158804528838f4c09ce92696ca22c7fef10
Author: Michael Cleverly <michael@cleverly.com>
Date:   2006-09-10

    (ns_httpget): follow redirects other than 302
    
    As per RFC 2616:
    
      301 = Moved Permanently
      303 = See Other
      307 = Temporary Redirect

M	tcl/http.tcl

commit bbfe4b38cea176ac1505542cd9b4404129394188
Author: Michael Cleverly <michael@cleverly.com>
Date:   2006-09-10

    Change one instance of string comparisons using == and != to eq and ne

M	tcl/file.tcl

commit 8a7c18a48e296d43cede01a734eae572e88ddd6e
Author: Michael Cleverly <michael@cleverly.com>
Date:   2006-09-10

    Add [list $dst] quoting to the final eval in [ns_cp -preserve]
    
    (in case $dst were ever a filename with spaces in it).

M	tcl/compat.tcl

commit ec9a17c0102f494d1e63ce5c46d8eee73e33a7be
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-08

    Rearranged config files, updated new paths

M	Makefile
D	contrib/nsd.tcl

commit 3441d6f80813b6a7b33adedcf51146afe61c712e
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-09-08

    Rewrote Vlads auto-imported documentation so that it compiles with dtplite
    
    Next step is to finetune the contents during the documentation process.
    doc/src/commandlist.man should finally become a TOC and reference the files.

M	ChangeLog
M	doc/src/keyldel.man
M	doc/src/keylget.man
M	doc/src/keylkeys.man
M	doc/src/keylset.man
M	doc/src/ns_accesslog.man
M	doc/src/ns_addrbyhost.man
M	doc/src/ns_adp_abort.man
M	doc/src/ns_adp_append.man
M	doc/src/ns_adp_argc.man
M	doc/src/ns_adp_argv.man
M	doc/src/ns_adp_bind_args.man
M	doc/src/ns_adp_break.man
M	doc/src/ns_adp_dir.man
M	doc/src/ns_adp_dump.man
M	doc/src/ns_adp_eval.man
M	doc/src/ns_adp_exception.man
M	doc/src/ns_adp_include.man
M	doc/src/ns_adp_mime.man
M	doc/src/ns_adp_mimetype.man
M	doc/src/ns_adp_parse.man
M	doc/src/ns_adp_puts.man
M	doc/src/ns_adp_registerproc.man
M	doc/src/ns_adp_return.man
M	doc/src/ns_adp_safeeval.man
M	doc/src/ns_adp_stats.man
M	doc/src/ns_adp_stream.man
M	doc/src/ns_adp_tell.man
M	doc/src/ns_adp_trunc.man
M	doc/src/ns_after.man
M	doc/src/ns_atclose.man
M	doc/src/ns_atexit.man
M	doc/src/ns_atshutdown.man
M	doc/src/ns_atsignal.man
M	doc/src/ns_browsermatch.man
M	doc/src/ns_buildsqldate.man
M	doc/src/ns_cache_flush.man
M	doc/src/ns_cache_keys.man
M	doc/src/ns_cache_names.man
M	doc/src/ns_cancel.man
M	doc/src/ns_chan.man
M	doc/src/ns_charsets.man
M	doc/src/ns_checkurl.man
M	doc/src/ns_chmod.man
M	doc/src/ns_choosecharset.man
M	doc/src/ns_cleanup.man
M	doc/src/ns_cleanupchans.man
M	doc/src/ns_cond.man
M	doc/src/ns_config.man
M	doc/src/ns_configsection.man
M	doc/src/ns_configsections.man
M	doc/src/ns_conn.man
M	doc/src/ns_cookiecharset.man
M	doc/src/ns_cookietime.man
M	doc/src/ns_cp.man
M	doc/src/ns_critsec.man
M	doc/src/ns_crypt.man
M	doc/src/ns_db.man
M	doc/src/ns_dbquotename.man
M	doc/src/ns_dbquotevalue.man
M	doc/src/ns_encodingforcharset.man
M	doc/src/ns_encodingfortype.man
M	doc/src/ns_encrypt.man
M	doc/src/ns_env.man
M	doc/src/ns_eval.man
M	doc/src/ns_event.man
M	doc/src/ns_findset.man
M	doc/src/ns_fmttime.man
M	doc/src/ns_formfieldcharset.man
M	doc/src/ns_ftruncate.man
M	doc/src/ns_getchannels.man
M	doc/src/ns_getform.man
M	doc/src/ns_getformfile.man
M	doc/src/ns_gifsize.man
M	doc/src/ns_gmtime.man
M	doc/src/ns_guesstype.man
M	doc/src/ns_hostbyaddr.man
M	doc/src/ns_hrefs.man
M	doc/src/ns_htmlselect.man
M	doc/src/ns_http.man
M	doc/src/ns_httpget.man
M	doc/src/ns_httpopen.man
M	doc/src/ns_httppost.man
M	doc/src/ns_httptime.man
M	doc/src/ns_ictl.man
M	doc/src/ns_info.man
M	doc/src/ns_init.man
M	doc/src/ns_issmallint.man
M	doc/src/ns_job.man
M	doc/src/ns_jpegsize.man
M	doc/src/ns_kill.man
M	doc/src/ns_library.man
M	doc/src/ns_link.man
M	doc/src/ns_localsqltimestamp.man
M	doc/src/ns_localtime.man
M	doc/src/ns_log.man
M	doc/src/ns_logctl.man
M	doc/src/ns_logroll.man
M	doc/src/ns_markfordelete.man
M	doc/src/ns_mkdir.man
M	doc/src/ns_mktemp.man
M	doc/src/ns_modulepath.man
M	doc/src/ns_mutex.man
M	doc/src/ns_normalizepath.man
M	doc/src/ns_param.man
M	doc/src/ns_paren.man
M	doc/src/ns_parsehttptime.man
M	doc/src/ns_parsequery.man
M	doc/src/ns_parsetime.man
M	doc/src/ns_pause.man
M	doc/src/ns_puts.man
M	doc/src/ns_queryexists.man
M	doc/src/ns_queryget.man
M	doc/src/ns_querygetall.man
M	doc/src/ns_quotehtml.man
M	doc/src/ns_rand.man
M	doc/src/ns_register_adp.man
M	doc/src/ns_register_filter.man
M	doc/src/ns_register_proc.man
M	doc/src/ns_reinit.man
M	doc/src/ns_rename.man
M	doc/src/ns_requestauthorize.man
M	doc/src/ns_respond.man
M	doc/src/ns_resume.man
M	doc/src/ns_return.man
M	doc/src/ns_returnfile.man
M	doc/src/ns_returnforbidden.man
M	doc/src/ns_returnmoved.man
M	doc/src/ns_returnnotfound.man
M	doc/src/ns_returnok.man
M	doc/src/ns_returnredirect.man
M	doc/src/ns_returnunauthorized.man
M	doc/src/ns_rmdir.man
M	doc/src/ns_schedule_daily.man
M	doc/src/ns_schedule_proc.man
M	doc/src/ns_schedule_weekly.man
M	doc/src/ns_section.man
M	doc/src/ns_sema.man
M	doc/src/ns_server.man
M	doc/src/ns_set.man
M	doc/src/ns_setexpires.man
M	doc/src/ns_setformencoding.man
M	doc/src/ns_share.man
M	doc/src/ns_shutdown.man
M	doc/src/ns_sleep.man
M	doc/src/ns_stats.man
M	doc/src/ns_striphtml.man
M	doc/src/ns_symlink.man
M	doc/src/ns_tagelement.man
M	doc/src/ns_tagelementset.man
M	doc/src/ns_thread.man
M	doc/src/ns_time.man
M	doc/src/ns_tmpnam.man
M	doc/src/ns_unregister_proc.man
M	doc/src/ns_unschedule_proc.man
M	doc/src/ns_url2file.man
M	doc/src/ns_urlcharset.man
M	doc/src/ns_urldecode.man
M	doc/src/ns_urlencode.man
M	doc/src/ns_uudecode.man
M	doc/src/ns_uuencode.man
M	doc/src/ns_write.man
M	doc/src/nsv_append.man
M	doc/src/nsv_array.man
M	doc/src/nsv_exists.man
M	doc/src/nsv_get.man
M	doc/src/nsv_incr.man
M	doc/src/nsv_lappend.man
M	doc/src/nsv_names.man
M	doc/src/nsv_set.man
M	doc/src/nsv_unset.man

commit 40b1843fd0cc672f0e929696b9851ca9d07b4c2c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-08

    (SeverityName):accept one more argument: the buffer where the result is to be returned
    
    Before we were just returning the pointer to a buffer allocated
    on the stack, which was a bad thing to do.

M	ChangeLog
M	nsd/log.c

commit 9626654140e0a3bab15643779cf26e1065e6e8e6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-07

    Auto-import documentation from man pagea and wiki etc.
    
    Guys, we have a job to do with this Tcl API.

M	ChangeLog
M	Makefile
D	doc/ns_addr.n
D	doc/ns_shutdown.n
A	doc/src/keyldel.man
A	doc/src/keylget.man
A	doc/src/keylkeys.man
A	doc/src/keylset.man
A	doc/src/ns_accesslog.man
A	doc/src/ns_addrbyhost.man
A	doc/src/ns_adp_abort.man
A	doc/src/ns_adp_append.man
A	doc/src/ns_adp_argc.man
A	doc/src/ns_adp_argv.man
A	doc/src/ns_adp_bind_args.man
A	doc/src/ns_adp_break.man
A	doc/src/ns_adp_dir.man
A	doc/src/ns_adp_dump.man
A	doc/src/ns_adp_eval.man
A	doc/src/ns_adp_exception.man
A	doc/src/ns_adp_include.man
A	doc/src/ns_adp_mime.man
A	doc/src/ns_adp_mimetype.man
A	doc/src/ns_adp_parse.man
A	doc/src/ns_adp_puts.man
A	doc/src/ns_adp_registerproc.man
A	doc/src/ns_adp_return.man
A	doc/src/ns_adp_safeeval.man
A	doc/src/ns_adp_stats.man
A	doc/src/ns_adp_stream.man
A	doc/src/ns_adp_tell.man
A	doc/src/ns_adp_trunc.man
A	doc/src/ns_after.man
A	doc/src/ns_atclose.man
A	doc/src/ns_atexit.man
A	doc/src/ns_atshutdown.man
A	doc/src/ns_atsignal.man
A	doc/src/ns_browsermatch.man
A	doc/src/ns_buildsqldate.man
A	doc/src/ns_cache_flush.man
A	doc/src/ns_cache_keys.man
A	doc/src/ns_cache_names.man
A	doc/src/ns_cancel.man
A	doc/src/ns_chan.man
A	doc/src/ns_charsets.man
A	doc/src/ns_checkurl.man
A	doc/src/ns_chmod.man
A	doc/src/ns_choosecharset.man
A	doc/src/ns_cleanup.man
A	doc/src/ns_cleanupchans.man
A	doc/src/ns_cond.man
A	doc/src/ns_config.man
A	doc/src/ns_configsection.man
A	doc/src/ns_configsections.man
A	doc/src/ns_conn.man
A	doc/src/ns_cookiecharset.man
A	doc/src/ns_cookietime.man
A	doc/src/ns_cp.man
A	doc/src/ns_critsec.man
A	doc/src/ns_crypt.man
A	doc/src/ns_db.man
A	doc/src/ns_dbquotename.man
A	doc/src/ns_dbquotevalue.man
A	doc/src/ns_encodingforcharset.man
A	doc/src/ns_encodingfortype.man
A	doc/src/ns_encrypt.man
A	doc/src/ns_env.man
A	doc/src/ns_eval.man
A	doc/src/ns_event.man
A	doc/src/ns_findset.man
A	doc/src/ns_fmttime.man
A	doc/src/ns_formfieldcharset.man
A	doc/src/ns_ftruncate.man
A	doc/src/ns_getchannels.man
A	doc/src/ns_getform.man
A	doc/src/ns_getformfile.man
A	doc/src/ns_gifsize.man
A	doc/src/ns_gmtime.man
A	doc/src/ns_guesstype.man
A	doc/src/ns_hostbyaddr.man
A	doc/src/ns_hrefs.man
A	doc/src/ns_htmlselect.man
A	doc/src/ns_http.man
A	doc/src/ns_httpget.man
A	doc/src/ns_httpopen.man
A	doc/src/ns_httppost.man
A	doc/src/ns_httptime.man
A	doc/src/ns_ictl.man
A	doc/src/ns_info.man
A	doc/src/ns_init.man
A	doc/src/ns_issmallint.man
A	doc/src/ns_job.man
A	doc/src/ns_jpegsize.man
A	doc/src/ns_kill.man
A	doc/src/ns_library.man
A	doc/src/ns_link.man
A	doc/src/ns_localsqltimestamp.man
A	doc/src/ns_localtime.man
A	doc/src/ns_log.man
A	doc/src/ns_logctl.man
A	doc/src/ns_logroll.man
A	doc/src/ns_markfordelete.man
A	doc/src/ns_mkdir.man
A	doc/src/ns_mktemp.man
A	doc/src/ns_modulepath.man
A	doc/src/ns_mutex.man
A	doc/src/ns_normalizepath.man
A	doc/src/ns_param.man
A	doc/src/ns_paren.man
A	doc/src/ns_parsehttptime.man
A	doc/src/ns_parsequery.man
A	doc/src/ns_parsetime.man
A	doc/src/ns_pause.man
A	doc/src/ns_puts.man
A	doc/src/ns_queryexists.man
A	doc/src/ns_queryget.man
A	doc/src/ns_querygetall.man
A	doc/src/ns_quotehtml.man
A	doc/src/ns_rand.man
A	doc/src/ns_register_adp.man
A	doc/src/ns_register_filter.man
A	doc/src/ns_register_proc.man
A	doc/src/ns_reinit.man
A	doc/src/ns_rename.man
A	doc/src/ns_requestauthorize.man
A	doc/src/ns_respond.man
A	doc/src/ns_resume.man
A	doc/src/ns_return.man
A	doc/src/ns_returnfile.man
A	doc/src/ns_returnforbidden.man
A	doc/src/ns_returnmoved.man
A	doc/src/ns_returnnotfound.man
A	doc/src/ns_returnok.man
A	doc/src/ns_returnredirect.man
A	doc/src/ns_returnunauthorized.man
A	doc/src/ns_rmdir.man
A	doc/src/ns_schedule_daily.man
A	doc/src/ns_schedule_proc.man
A	doc/src/ns_schedule_weekly.man
A	doc/src/ns_section.man
A	doc/src/ns_sema.man
A	doc/src/ns_server.man
A	doc/src/ns_set.man
A	doc/src/ns_setexpires.man
A	doc/src/ns_setformencoding.man
A	doc/src/ns_sha1.man
A	doc/src/ns_share.man
A	doc/src/ns_shutdown.man
A	doc/src/ns_sleep.man
A	doc/src/ns_stats.man
A	doc/src/ns_striphtml.man
A	doc/src/ns_symlink.man
A	doc/src/ns_tagelement.man
A	doc/src/ns_tagelementset.man
A	doc/src/ns_thread.man
A	doc/src/ns_time.man
A	doc/src/ns_tmpnam.man
A	doc/src/ns_unregister_proc.man
A	doc/src/ns_unschedule_proc.man
A	doc/src/ns_url2file.man
A	doc/src/ns_urlcharset.man
A	doc/src/ns_urldecode.man
A	doc/src/ns_urlencode.man
A	doc/src/ns_uudecode.man
A	doc/src/ns_uuencode.man
A	doc/src/ns_write.man
A	doc/src/nsv_append.man
A	doc/src/nsv_array.man
A	doc/src/nsv_exists.man
A	doc/src/nsv_get.man
A	doc/src/nsv_incr.man
A	doc/src/nsv_lappend.man
A	doc/src/nsv_names.man
A	doc/src/nsv_set.man
A	doc/src/nsv_unset.man

commit 6748c6bdc64b7ff98c5a9ccebc00059ed168fc6a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-07

    Until decided, minimal config will have explicit definition of default server

M	simple-config.tcl

commit 6a945a05bcc9d51cd3c8169f1aa61485c1e21ffe
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-07

    Make nsstats and nsconfig disabled by default

M	ChangeLog
M	Makefile
D	contrib/nsconfig.tcl
D	contrib/nsstats.tcl
R100	contrib/index.adp	index.adp
R071	contrib/nsd-min.tcl	simple-config.tcl

commit b9e534eefcb15a87596aeefec83202b862bbf942
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-07

    Disable nscp; remove unnessary contrib/mime file

M	ChangeLog
D	contrib/mimetypes.tcl
M	contrib/nsconfig.tcl
M	contrib/nsd-min.tcl
M	contrib/nsd.tcl
M	contrib/nsstats.tcl
M	sample-config.tcl.in

commit 965e45380bdda14df265d7a53318a3479616ba39
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-07

    Added comments to minimal nsd.tcl config

M	contrib/nsd-min.tcl

commit db9a637a4d323a65e99a1ee76cf556ca23e5fc88
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-07

    Makefile fixes during contrib install

M	Makefile

commit 864e41e427cb58cf5a3b41db4fb16009fb7ad7e6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-07

    Make it easy to track runtime confguration; simplify config and stats scripts
    
    * nsd/server.c:
    * nsd/config.c:
    * nsd/nsmain.c: This is experimental but i think it can stay in the core
    because i ran all tests and i do not see any problems but only benefits:
    
    Any call to Ns_ConfigXXX family will try to locate config parameter but if it
    does not exists it will auto-create section and parameter key. If default was given,
    it will assign default value. this way we have the whole config tree in the memory
    which can be view now more effectivelly with nsconfig.tcl script which will be
    installed now by default with make install. Ns_ConfigCreateSection will auto-create
    section during startup only, it does call Ns_InfoStarted() which is very quick and
    after server started, config behaves as usual.
    
    contrib/nsconfig.tcl:
    contrib/nsstats.tcl: those script now act as page not tcl library file which
    makes it easy to administer without server restart

M	ChangeLog
M	Makefile
M	contrib/index.adp
M	contrib/nsconfig.tcl
R086	tcl/stats.tcl	contrib/nsstats.tcl
M	nscp/nscp.c
M	nsd/config.c
M	nsd/server.c

commit a7988f9a8adeda399cdcb974a832dc0c1e2c923f
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-09-07

    First shot of a document listing all available server commands, to act as a TOC
    
    Alpha stage.

M	ChangeLog
A	doc/src/commandlist.man

commit c9566e528e719fc3477bae19a5d16d02af12c0e2
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-07

    Added more options into template.man

M	doc/src/template.man

commit 32677de2edd4c4cf45d54c4d74e07038aa872379
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-07

    Removed some non-template strings (left from copy/paste)

M	doc/src/template.man

commit 4d0ceee8e326a2cfd9ee51c4072ec5e8712466fc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-07

    Added more info where to find tcllib and how to write doc pages.

M	doc/src/README.doc

commit 61f3fc7482c3e89d4db98f3542f95a9e9a2aa1bc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-09-07

    New file as template for the doc sources

A	doc/src/template.man

commit d1452ac567e9dea534c56637e0590980ea4302f7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-07

    A lot of small changes enabling a minimal nsd.tcl config with working defaults
    
    * tcl/fastpath.tcl:
    * nsd/server.c: Make default diirectorylisting type as simple
    
    * nscp/nscp.c: If module enabled without any config, by default
    listen on 127.0.0.1:2080 and add empty user so locally it is possible to
    telnet without password
    
    * include/ns.h:
    * nsd/config.c: Added new public function Ns_ConfigCreateSection which works
    like Ns_ConfigGetSection but creates new section if it does not exist
    
    * nsd/nsmain.c: If no servers defined in the config, server with name "default"
    will be auto-created and started with default config values.
    
    * nsd/nsmain.c: If home parameter is not specified, installation path
    will be taken from executable binary, Unix support for now only
    
    * contrib/nsd-min.tcl: Added example of smallest and minimum config file
    that can be loaded and have working functional server

M	ChangeLog
A	contrib/nsd-min.tcl
M	include/ns.h
M	nscp/nscp.c
M	nsd/config.c
M	nsd/nsmain.c
M	nsd/server.c

commit cd15c091e1f47dbbbb32e27bbc4918fbbbbe9f1d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-06

    Various changes to path defaults to simplify default configuration
    
    * nsd/nsconf.c:
    * nsd/server.c: Make tcllibrary, library, serverdir to reflect
    defaults from the sample config according to simplified one-server
    configuration which is common and easy to understand for newcomers.
    
    This will also allow one to run server with minimal nsd.tcl
    which could be good to have with required settings only for easy
    maintenance.
    
    ns/parameters/tcllibrary points to [ns_info home]/tcl
    ns/server/${server}/tcl/library points to [ns_info home]/modules/tcl
    ns/server/${server}/fastpath/serverdir points to [ns_info home]
    ns/server/${server}/fastpath/directoryfile points to "index.adp index.tcl index.html index.htm"
    ns/server/${server}/adp/map points to "/*.adp"
    
    * nsd/pidfile.c: Make it thread safe and reflect default config value
    
    * nslog/nslog.c: Make it use default log file in logs/access.log if logs/ directory
    exists or create new directory under servers/server/modules/nslog as fallback if
    no file config options is specified

M	ChangeLog
M	nsd/log.c
M	nsd/nsconf.c
M	nsd/pidfile.c
M	nsd/server.c
M	nslog/nslog.c
M	tests/test.nscfg

commit be2ce1df8d048e04142d45774a6bd8ad30a12130
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-04

    Make nstest_http chunked-encoding aware
    
    i.e. it will concatenate all chunk sinto single body which will
    be returned.
    
    This solved a lot of http related errors in the tests but still multiple test are needed to
    be converted or encoding stuff needs to be corrected or improved.

M	ChangeLog
M	tests/testserver/modules/testhttp.tcl

commit 7d32f1516035ca9e1b0007c569714fdbc08ba2c0
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-09-04

    Silence compiler and chnaged the way ready sockets are submitted to queue
    
    Removed limitation in the DriverThread/SpoolerThread during
    queueing read sockets. If one failed to queue it will not skip
    queuing other read sock but will try to submit all.

M	ChangeLog
M	nsd/driver.c

commit a7d77b82576bed0c3f61dbe94e123614c12ea120
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-08-31

    NEWS: update with latest; add new section highlighting config changes

M	ChangeLog
M	NEWS

commit 0ab3bba08c5451c629b25603fc45c5c2d58b5586
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-08-31

    Merge in the mime-types from contrib; add new command ns_info mimetypes
    
    ns_info mimetypes returns the list of file extension to mime-type
    mappings at runtime.

M	ChangeLog
M	nsd/info.c
M	nsd/init.c
M	nsd/mimetypes.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	tests/ns_info.test
M	tests/ns_mime.test

commit ec11067cf28e5946a061f65fe44b8e6414477ea5
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-08-31

    Don't update the interp result directly as under some circumstances it can be a shared object

M	ChangeLog
M	nsd/tclresp.c

commit ab9622e03521bef2224db62e3b4eec1c028aaa86
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-08-26

    Fix http proxy bug; add simple IP access restrictions

M	ChangeLog
M	tcl/http.tcl

commit 5eb8f6ee82b6208dcd79daffa56fe28dfa4d96b0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-21

    Use our own defined macros HTTP11_HDR_TE and HTTP11_HDR_TE_ENCODED instead of plain strings

M	ChangeLog
M	nsd/return.c

commit 25e7ea56246944319a38dbd06cf0343d1a3caac4
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-14

    Defined ETIMEDOUT to 1 for Windows
    
    The defined value for ETIMEDOUT has no other meaning then to be
    accepted by eventual strerror() so we had to "invent" something
    appropriate.
    
    Unfortunately the built-in set of errno values in Windows does
    not seem to have any "near" candidate to the Unix pendant so
    we just defined it to one (1). This way it will at least
    work, albeit not have too much sense in error messages.

M	ChangeLog
M	include/ns.h

commit 664f554689e11369bd033589acba6332271f9348
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-14

    Win32: add definitions for poll() emulation, as we do not include poll.h there

M	ChangeLog
M	include/ns.h

commit c3d2d4811a7f12a2c521b443768ea3d72e82bbab
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-13

    (LogFlush): remove unused variable

M	ChangeLog
M	nsd/log.c

commit fd1847445d96bf3f0f3cd17fd01a4a79c9373638
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-13

    Rewritten caching of log entries to use separate caches for entry structures and log texts
    
    Attempt to stuff both in a dynamic string and cast when needed
    did not work on some architectures because of
    padding/alignment requirements.

M	nsd/log.c

commit 16a1b4624bcc77f7574d11bdee4c543c81b1fb16
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-13

    (PushProxy): honour expiration for proxies without associated slave

M	nsproxy/nsproxylib.c

commit c2fc39b8545abaaddeed7d5575b3710ce3a898b3
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-13

    Add tests for [ns_proxy handles ?pool]

M	ChangeLog
M	tests/ns_proxy.test

commit a7daec5d9d6be5a82cfd916073995fb7ff9e17c9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-12

    (ReaperThread): remove Ns_Log calls outside the global locks
    
    This may lead to deadlocks in Ns_ProxyInit() when somebody registered
    Tcl callbacks to the ns_log facility.
    
    If the current thread has never loaded a Tcl interpreter (and the
    reaper thread does not do that explicitly) one will be loaded at
    the latest at that point when first call to Ns_Log has been made
    and there is a Tcl callback registered.
    
    In this scenario, the Ns_ProxyInit will be called by the server Tcl
    tracing facility and this will lock the global proxy lock. If at that
    time somebody is already holding the global lock, we'll have a deadlock.

M	nsproxy/nsproxylib.c

commit b314e5ca472dc4208c9972931e40eb11f4da7151
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-08-08

    Many encoding fixes and enhancements to the test suite
    
    * tests/testserver/pages/encoding.*: Various helper files.
    * tests/testserver/modules/testhttp.tcl: nstest_http is now
    encoding aware.
    
    * tests/test.nscfg: Sections for mimetypes and encodings added,
    along with parameters URLCharset, OutputCharset and
    HackContentType.
    
    * tests/encoding.test: tests for ns_return and ns_write, changing
    charsets and verifying URL and ADP encoding.
    
    * tests/tclresp.test: minor modification in tests 3.1 and 4.2
    after change in test.nscfg.
    
    Thanks to Michael Lex for writing the tests.

M	tests/encoding.test
M	tests/tclresp.test
M	tests/test.nscfg
M	tests/testserver/modules/testhttp.tcl
A	tests/testserver/pages/encoding.iso2iso_adp
A	tests/testserver/pages/encoding.iso2utf_adp
A	tests/testserver/pages/encoding.iso_adp
A	tests/testserver/pages/encoding.utf2iso_adp
A	tests/testserver/pages/encoding.utf2utf_adp
A	tests/testserver/pages/encoding.utf_adp

commit 1ed897080b213dde4e60f9407d410e82db604ff1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-04

    Update proxy expiry time every time we put it back to the list of free proxies

M	nsproxy/nsproxylib.c

commit d971d97f599d6ea4e6d5508d7d1dc31acb843c3e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-04

    Silenced some compiler warnings

M	nsproxy/nsproxylib.c

commit e5c7f04e1675541f1509b4e429c9f427d8a172ef
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-04

    Improved teardown of nsproxy at process exit.
    
    Fixed teardown of idle proxies.
    Increased default max. count of proxies per pool to 8.
    Add ns_log's to monitor nsproxy teardown steps.

M	ChangeLog
M	nsproxy/nsproxylib.c

commit 6fdb023c05b1088c77fde10312e6491b9a8c20e5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-03

    Force-fill in the last argument of the proxy command line with some string after the evaluation
    
    Otherwise the previously executed command is shown. This is
    observed only on Linux.

M	ChangeLog
M	nsproxy/nsproxylib.c

commit 6571f32aaa6078a0ca43dcea69fcb6670c03452a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-03

    Always use wrappers when operating on Tcl/Ns Dstrings; fix startup/encoding bug
    
    The Ns_ProxyMain explicitly calls Tcl_FindExectuable() so the default
    encoding is properly set. Otherwise troubles arise when sending scripts
    containing paths which in turn contain special multinational characters.

M	ChangeLog
M	nsproxy/nsproxylib.c

commit e40bb64b6976b7045da4f52c44f325dfbd63422f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-03

    Calls Ns_ProxyExit with 30 seconds graceful timeout

M	ChangeLog
M	nsproxy/nsproxymod.c

commit 10902a8e189a4b920bcbe14d1f605c1f75eb6a5a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-03

    Define 30 seconds grace period to wait for proxies cleanup on application exit

M	ChangeLog
M	nsproxy/nsproxylib.c

commit efa18deb787e4a5bd6c76705b91580ca88e9e694
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-02

    Set pipes in the child proxy to close-on-exec
    
    Otherwise we may block forever if we attempt to kill the proxy
    running "exec" Tcl command.
    
    Redesigned reaper thread not to block the caller by
    waiting on slave proxy processes to exit.
    
    The [ns_proxy handle] command accepts one optional argument
    which is interpreted as pool name and only those handles
    belonging to the given pool are reported.

M	ChangeLog
M	nsproxy/nsproxylib.c

commit b0771acded4cf98fcb4d23de1dc61c6a4f5e6565
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-08-02

    (Ns_WaitForProcess): log also the signal name in addition to signal number

M	nsd/exec.c

commit c652c4ffb41118fabf1212c85cc50adbc31a17c4
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-30

    Damn uint typedefs are just not possible to get w/o braking the leg so we opt to provide our own definition

M	nsproxy/nsproxylib.c

commit e901f4bf428d81e76c8df1ce68bf7866508ca9b5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-30

    Always  include poll.h as we assume it is present on all supported platforms so far

M	ChangeLog
M	include/nsthread.h

commit 6908e84ad74e4893741d2de3a9efe79407f07301
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-30

    Do not use u_int8/16/32_t typedefs as some platforms (Solaris) do not declare them
    
    Use uint8/16/32_t instead as they are defined everywhere in sys/types.h.

M	nsproxy/nsproxylib.c

commit 365a66b4f1970fc86f5cee82ebbf67b180cbc728
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-30

    config.h is now (again) only included in nsd.h
    
    It otherwise causes trouble when linking another TEA compatible
    packages with the server as it re-declares PACKAGE_* definitions

M	include/ns.h
M	include/nsthread.h
M	nsd/nsd.h

commit 5399f3065737f8c8788bca3ec72b2a9571047d52
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-29

    Remove debugging code checked-in by mistake

M	nsproxy/nsproxylib.c

commit 9f73368c2ee78c25a9b2e9ed15937f5e29e37fae
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-29

    Fix enumeration of tests

M	ChangeLog
M	tests/ns_proxy.test

commit 1e1859218453e03c5fc5b093f972d924075e9506
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-29

    List of free proxies could get corrupted under some circumstances -- fixed

M	nsproxy/nsproxylib.c

commit 9369a9f159b3d8ccf053153bd4d85dd72158846e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-25

    Add tests for u_int16_t and corresponding use corresponding defines in the nsproxylib.c

M	configure.in
M	nsproxy/nsproxylib.c

commit e9caa0cdbdb6ebb034d7cb315b03bd13922896a7
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-25

    ns.h includes config.h directly

M	include/ns.h
M	nsd/nsd.h

commit 42031f72c74955f3ec112296d3d9ae01dd1a4b87
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-25

    Replace poll() with ns_poll which defaults to poll() on all platforms except Darwin

M	ChangeLog
M	configure.in
M	include/ns.h
M	include/nsthread.h
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/nswin32.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/unix.c
M	nsproxy/nsproxylib.c

commit fa7b571ac99a4004ea24cfd8de04550ae9a23933
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-25

    Add ns_proxt send, wait, recv; synch error codes with AS
    
    Improved error codes (made them match the nsproxy module from AS).
    Added [ns_proxy send] [ns_proxy wait] and [ns_proxy recv] and made
    the [ns_proxy eval] wrap those three.
    Adjusted test suite.

M	nsproxy/ns_proxy.man
M	nsproxy/nsproxylib.c
M	tests/ns_proxy.test

commit 56be2cc5d2d8efb145114337213f1592bea91392
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-22

    Add PTHREAD_STACK_MIN definition for Solaris

M	ChangeLog
M	nsthread/pthread.c

commit 9745125afdd3b5149081195a04f70f70e439f2d9
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-07-22

    Fix request-.tcl file cache so that it actually caches Tcl byte-code, per-interp

M	ChangeLog
M	tcl/file.tcl

commit a278531422bcc46928e2de323b7904fd895c220f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-07-19

    nscp listens on localhost only, so having know password is not a problem

M	sample-config.tcl.in

commit 04bca7045014ade8a3226fb78117997b36458036
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-07-19

    Minor config files changes

M	contrib/nsd.tcl
M	sample-config.tcl.in

commit 90eebf78a8de38c36b02ac88b5ce1ddcac80b228
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-07-18

    Make sure given ttl and timeout are saved and used by dns cache

M	ChangeLog
M	nsd/dns.c

commit 35f687c92da2749947a978dda1f1349ea5948941
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-17

    Adjust tests for expanded syntax of ns_logctl command

M	ChangeLog
M	tests/ns_log.test

commit 94747e7033c8f329aa0d55278ee8dd92b53a171d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-07-13

    Make sure upload stats lock is always unlocked

M	ChangeLog
M	nsd/driver.c

commit 9c264e455b6eae348216fbdf79bf8ef423e420e3
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-07-13

    Don't enforce an upper bound on thread stack size, use the OS provided default
    
    It only makes sense to *reduce* the size of the stack if you
    have many threads and you know for sure you have low stack
    usage.  As this is (currently) a process-wide setting, you
    never can be sure...

M	ChangeLog
M	nsd/nsconf.c
M	nsthread/pthread.c
M	nsthread/thread.c

commit a6fddcd72609761d4949e94bbd3cd855cba4c823
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-07-13

    Fix bug with missing path when setting cookies
    
    Add tests so this doesn't happen again...

M	ChangeLog
M	nsd/cookies.c
A	tests/cookies.test

commit bd82e3e8d96f1c224f0975804569c9390fb723d4
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-07-13

    (ReturnCharData): return chunked when output encoding is not default UTF-8 (hack)

M	ChangeLog
M	nsd/return.c

commit d97a78ce5426d05fc50353d9e2a5992815aaa8b6
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-12

    (LogToTcl): fix command building when registered script contains blanks

M	ChangeLog
M	nsd/log.c

commit 1f038f6929346c06074300f71a856a13bbf7e0e2
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-12

    (LogToTcl): pass timestamp in [clock seconds], not Ns_Time format
    
    We still do not have proper ns_time commands/wrappers.

M	ChangeLog
M	nsd/log.c

commit 5ebb8ec64cea39189d6fff1047573cb6b86ca05f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-07-10

    Fix driver crash; put back functionality to make nsopenssl work again
    
    In one of the previous changes that got broken.

M	ChangeLog
M	nsd/driver.c

commit eb24e87aa22a5fb9320424b7ad19db26c7831c51
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-07-10

    Another fix for potential crash when spooler sock is submitted

M	nsd/driver.c

commit dfc020c4d2b719722d36ae08e160846c1ae07e9e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-07-10

    Fix crash when accessing writer sock after it has been submitted to the queue

M	ChangeLog
M	nsd/driver.c

commit d0e24e497f5f2c80addd1bef5e990d8e1f7ef288
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-07-10

    Create wrappers for the driver callback functions and document
    
    Wrap some of the messy error reporting code.

M	ChangeLog
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h

commit dc294ac2b1f7be0983e4127e99160813832fa9cf
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-10

    Removed some unused variables

M	nsd/conn.c

commit e8f0cb7dd1ab51e6d083438f9ddba79e90406f1f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-07-08

    Add new ns_limits_ commands to manipulate per-request limits
    
    Not hooked up to request processing yet, requires some work to
    move conn allocation back into the driver code.

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
M	nsd/conn.c
M	nsd/init.c
A	nsd/limits.c
M	nsd/nsd.h
M	nsd/tclcmds.c
A	tcl/limits.tcl
M	tests/ns_conn.test
A	tests/ns_limits.test
M	tests/test.nscfg

commit 5e82dace32cd8bd06828da99c552b6a7fc102cf9
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-07-08

    Add per-tcl-cache default timeouts; -timeout can be absolute or relative
    
    Timeout values passed using the -timeout switch can now be
    absolute or relative to the current time. Large values are
    assumed to be absolute, small values relative.

M	ChangeLog
M	include/nsthread.h
M	nsd/tclcache.c
M	nsthread/time.c
M	tests/ns_cache.test

commit ef6a6c7d996d88eec66b1e3142098d2770dc9530
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-07

    (LogAdd): fix wrong struct arithmetic writing over already freed memory

M	ChangeLog
M	nsd/log.c

commit 7501d3b5eb39caa0137f287630993a43260fc024
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-07-07

    Make ns_conn keepliave 0|1 to enable or disable keep-alive on current connection
    
    Removed flag NS_CONN_KEEPALIVE and instead connPtr->keep is used to
    control keepailve behaviour.

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/connio.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c

commit 4397340894fb07d5fad699b5d79a89f98a4e8c8b
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-07-06

    Updated with new error message

M	ChangeLog
M	tests/nsdb.test

commit c408db582348e49afbd95b46c09d8febacf6ecc8
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-05

    Uses internal Ns_Fatal wrapper for Ns_SetLogFlushProc and Ns_SetNsLogProc

M	ChangeLog
M	nsd/log.c

commit 080c0dd9239cf9d0f6158d0e98ca40a9cd1eef36
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-07-05

    Add init.d script for SuSE
    
    contrib/start-scripts/naviserver.SuSE: Added start script
    suitable for /etc/init.d which implements start, stop, restart,
    try-restart, realstop, version, probe, status.
    
    Configurable for use with or without watchdog and chroot environment.

M	ChangeLog
A	contrib/start-scripts/naviserver.SuSE

commit 7512c206dd4d02b194d1a30d7d55bb6d3dc7ec3a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-05

    Fixed so the compilation works again after cache.c and related changes

M	ChangeLog
M	include/ns.h

commit 9bea70e743ad51d579dc889bc7c0628c1723e4a5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-07-04

    Rewritten to support any number of user-assigned callbacks
    
    * nsd/tclcallbacks.c: Use our own wrapper Ns_TclCallbackProc()
    in ShutdownProc().
    
    * include/ns.h: Some cosmetic formatting to honour the 80-chars
    margin-width. Declared Ns_SetLogFlushProc() and Ns_SetNsLogProc()
    deprecated in favour of Ns_AddLogFilter() and Ns_RemoveLogFilter().
    
    * nsd/log.c: Make Ns_SetLogFlushProc() and Ns_SetNsLogProc() issue
    fatal message when used. Added Ns_AddLogFilter() and
    Ns_RemoveLogFilter() C-API calls as hook into new log processing.
    
    The log processing/cache is now always handled by the server. Users
    can register log callbacks and those will be invoked in the LIFO
    fashion for each log entry added by the Ns_Log() function or
    [ns_log] Tcl command. Each callback can prevent execution of all
    registered callbacks below by triggering Tcl error.
    
    One predefined callback is always registered: the callback to
    write to the standard error file-descriptor (routed to the server
    log file). Any log entries are always emitted there.
    
    The [ns_logctl] is extended to include [ns_log logctl register] and
    [ns_log logctl unregister] commands which in turn call the C-API
    calls from above. Those two serve for doing registration and
    unregistration of Tcl-based log callbacks. Each Tcl
    based log callbacck is called by the C-code as follows:
    
      <callback> severity timestamp logmsg ?args?
    
    Example:
      # Declare Tcl callback
      proc logclbk {severity stamp logmsg myarg} {
          # do something
      }
      # Register it with NsLog
      ns_log logctl register logclbk my_own_arg
    
      # Emit some log line
      ns_log notice "The test"
    
      # The callback will be executed as follows
      logclbk 1152034107:2399005 Notice "The test" my_own_arg
    
      The timestamp is in the string representation of the Ns_Time
      structure (<seconds>:<microseconds>).
    
    The [ns_log logctl truncate] semantic is changed: before it was
    used to truncate the log cache to a given number of bytes; now
    it truncates the log cache to the given number of cache entries.

M	ChangeLog
M	include/ns.h
M	nsd/log.c
M	nsd/tclcallbacks.c

commit e50ec72fc8756fc7baebd5e6419c890a28008401
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-30

    Add -delimiter parameter to ns_getcsv that will allow parsing CSV files with different delimiters

M	ChangeLog
M	nsdb/dbtcl.c

commit 2b62abe05378f8fc8d1fff5acf024e757a3de780
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-30

    Update the driver module callback interface with new functions, remove old ones
    
    * include/ns.h:
    * nsd/driver.c: Redefine driver hooks, remove not very
    well defined API functions.
    
    Add 2 new flags, NS_DRIVER_QUEUE_ONACCEPT and
    NS_DRIVER_QUEUE_ONREAD. They will tell driver when to queue
    socket, just after accept or after first network read. Primary
    purpose to cut driver processing early for TCP driver that
    need its own protocol (e.g. SMTP, POP3) or for others and UDP protocols,
    driver will read the request and will try to queue the socket after
    first read.
    
    Add new driver command DriverQueue, which will be called
    just before socket queue. Only special drivers that need to setup
    request url/protocol will use it, that's why new public API
    Ns_DriverSetRequest.
    
    Module installed request proc for method/url/protocol, like:
    
      Ns_RegisterRequest(server, "SYSLOG",  "/", RequestProc, NULL, srvPtr, 0);
    
    In order this proc will be called, socket need to set request line
    with "SYSLOG /", so it will be set in DriverQueue call just before
    driver will put the socket into connection queue. This change does
    not affect existing HTTP request processing.
    
    * nsd/queue.c: Removed old and unused API function.

M	ChangeLog
M	include/ns.h
M	nsd/driver.c
M	nsd/queue.c

commit b307eb41e5d696b1bd68055f7eb27ee27fec24cc
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-29

    Clear hash entry on interp delete

M	nsd/tclinit.c

commit b695be84176ab2368cda9c91956eb044bce65684
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-29

    Port ns_ictl cancel and threads commands from AOLserver 4.5
    
    * nsd/driver.c: Removed meaningless Ns_Log call

M	ChangeLog
M	nsd/driver.c
M	nsd/tclinit.c

commit 6a84cf90612c1e297243438842cf40724d90dcb3
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-28

    Converted all Tcl string commands into object commands

M	ChangeLog
M	nsdb/dbtcl.c
M	tcl/stats.tcl

commit 690bb54859ccde5eb225b5ccbbbfd90ed83457b4
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-25

    (ns_writer): use TclVFS open call

M	ChangeLog
M	nsd/driver.c

commit 6ba0923d8f8a06cf7bf09200fff28f0bcceae753
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-25

    (Ns_SockTimedWait): NULL timeout now means infinite; (WriterThread): poll sockets with 0 timeout

M	ChangeLog
M	nsd/driver.c
M	nsd/sock.c

commit 2a3888536be40be296f78737cebb2f92ec1c79e3
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-21

    Add online help for each parameter

M	contrib/nsconfig.tcl

commit bded03916c09263acc66ac4ca708f95eb1a9d264
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-21

    Add simple nsd.tcl configurator similar to stats.tcl which implements _nsconfig and allows one to browse and replace nsd.tcl entries

A	contrib/nsconfig.tcl

commit 32b8ca99807b6149c6a6cce49a7b54dcf1c93b60
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-06-19

    Various cache additions and removals, particularly timeouts and flushing
    
    * nsd/fastpath.c:
    * nsd/adpeval.c: Use Ns_CacheDeleteEntry instead of
    Ns_CacheFlushEntry to prevent genuine flush stats being inflated.
    
    * tcl/cache.tcl:
    * nsd/nsconf.c:
    * nsd/dns.c: Update to new API.
    
    * nsd/nsd.h:
    * nsd/server.c: Remove tcl cache timeout param in anticipation of new
    limits API.
    
    * nsd/tclcmds.c: Remove ns_cache _get _set _exists _info
    commands. The first three are racey and can be emulated with _eval
    and the new -force switch.  The new -contents switch to the _stats
    command replaces _info, discouraging racey check-and-set usage.
    
    * nsd/tcltime.c:
    * nsd/tclobjv.c: New Ns_ObjvTime parse callback for the Ns_Time
    type. Handy for passing absolute time deadlines to routines which
    timeout.
    
    * include/ns.h:
    * nsd/cache.c: New Ns_CacheResetStats routine.
    
    Ns_CacheGetConfig removed -- caches are immutable; the current
    settings can be looked up in the config file.
    
    Directly expire entries from within all routines which return one,
    but but only if the value is not null, indicating no concurrent
    update is in progress.
    
    Use Ns_CacheDeleteEntry to remove an entry from the cache without
    updating the stats. Flush stats should reflect explicit flushes
    only.
    
    Log stats when a cache is destroyed.
    
    * nsd/tclcache.c: ns_cache_create now takes a -maxentry option
    which is the maximum size of an entry allowed in the cache. This
    prevents one large entry completely emptying anotherwise usefully
    full cache.
    
    The ns_cache_create -timeout switch has been removed in
    anticipation of a general purpose limits scheme.
    
    The -timeout option is now expected to be an absolute time in the
    future, not an offset from the current time. This is awkward to
    use manually, but should not be needed with the above mentioned
    limits scheme. The -ttl option has been renamed -expires and is
    also an absolute time.
    
    ns_cache_eval now takes a -force switch which will unconditioanly
    replace any exiting entry, whether it has expired or not. Replaces
    _set.
    
    ns_cache_stats -content dumps the size and expiry for each
    entry in the cache. Adding the -reset switch to either mode resets
    the stats to zero.
    
    * tests/ns_cache.test: Try to exercise the underlying Ns_CacheFind
    harder with some more flush tests.

M	ChangeLog
M	include/ns.h
M	nsd/adpeval.c
M	nsd/cache.c
M	nsd/dns.c
M	nsd/fastpath.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/server.c
M	nsd/tclcache.c
M	nsd/tclcmds.c
M	nsd/tclobjv.c
M	nsd/tcltime.c
M	tcl/cache.tcl
M	tests/ns_cache.test

commit 63afca2501a348a2486976a8a438298156640b5e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-19

    Changed ns_parseargs format to {-param {=$script}}
    
    Keeping it this cryptic will ensure backward compatibility and
    guard against accidental Tcl evals.

M	ChangeLog
M	nsd/tclobjv.c
M	tests/ns_parseargs.test

commit 2be141de66d4b4c67bc3c0eda47472910cc1e810
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-19

    Add Ns_ObjvEval for runtime argument evaluation; extend ns_parseargs
    
    Extend ns_parseargs so that params in form:
    
      {-$name {script}}
    
    will be assigned with default value of the script result.

M	ChangeLog
M	include/ns.h
M	nsd/tclimg.c
M	nsd/tclobjv.c
M	tests/ns_parseargs.test

commit b8b092367318bd6eaa5dc23f7030babe14ba215e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-19

    Make scheduler queue Events in increments of 50, not 1000 in order to save memory

M	ChangeLog
M	nsd/sched.c

commit b0c10942490c18e43f205809c632c5e605ecc673
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-15

    Improved WriterThread to not to block on sending data and honor timeout if socket still not ready
    
    * nsd/sock.c: Make Ns_SockTimedWait have NULL as timeoutPtr so it will
    check for immediate condition of the socket without waiting.
    
    * nsd/nsd.h:
    * nsd/driver.c: Improved WriterThread to not to block on sending
    data and honor timeout if socket still not ready.
    
    * nsd/return.c: Added Accept-Ranges header as default to
    inform clients that we support range requests. Tested with
    mplayer HTTP streaming.
    
    * tests/testserver/pages/timeout.tcl:
    * tests/testserver/pages/400return.adp: Added missing files

M	ChangeLog
M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/return.c
M	nsd/sock.c
M	tests/errordoc.test
A	tests/testserver/pages/400return.adp
A	tests/testserver/pages/timeout.tcl

commit ff8d45ae31408e8b6f90ec69a59ab294a3f5936e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-14

    Add Ns_CacheGetExpiration; add ns_cache_info that returns entry size and expiration if set

M	ChangeLog
M	include/ns.h
M	nsd/cache.c
M	nsd/tclcache.c
M	nsd/tclcmds.c

commit 319e8f6f177d4f3786ce9dd7c86e9a78cf649540
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-14

    Updated test ns_cache.test to the new API check

M	ChangeLog
M	tests/ns_cache.test

commit 34f80a880162763bc7b558d2889d7ce1223c528e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-14

    Get rid of extra timeout2 by converting pointer into (void*) to get rid of type-punned error messages

M	nsd/tclcache.c

commit 715f60b5c7ed8ccf3f480c093b0547e6a49325a7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-14

    Introduce new API function Ns_CacheGetConfig that returns configured cache parameters

M	ChangeLog
M	include/ns.h
M	nsd/cache.c
M	nsd/tclcache.c

commit a4675f3aa78878bf0ddc0474832355f9171ed976
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-06-14

    Add timeout parameter to Ns_CacheCreateEx to assign cache-specific timeout
    
    This will be used instead of global config.tcl.cachetimeout and
    will eliminate specifying -timeout on every ns_cache_eval call.
    
    If specified as 0 on cache create, cache will behave as
    before, taking -timeout or using global value from the config.
    
    * nsd/nsconf.c:
    * nsd/dns.c: Updated to reflect API  change and added new config
    parameter dnswaittimeout which is set to 0 by default

M	ChangeLog
M	include/ns.h
M	nsd/cache.c
M	nsd/dns.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/tclcache.c

commit 6f38c9d59e5d41a4cb53b826c6a967d6c894fbe0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-06-14

    Add typedefs for u_int32_t, u_int16_t if the platform does not include stdint.h or declare those elsewhere

M	nsproxy/nsproxylib.c

commit 5ea7fd3062697f61774c16e0276e1c93daa367ad
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-06-14

    (Ns_CacheSetValueExpires): correctly set expiry time
    
    Changed Ns_CacheFindEntry NOT to auto-expire expired entries as this
    collides with Ns_CacheWaitCreateEntry API call.

M	ChangeLog
M	nsd/cache.c

commit 258720699cfdf2a2cd7773bd483b1bc6325fb6d1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-06-14

    Fix return value of non-void call

M	nsd/tclinit.c

commit c8802113a40ee92dc374ef471476f97224e3fce0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-05-26

    Tcl error code NS_TIMEOUT now sends HTTP status code 503 Unavailable
    
    Catch Tcl errors with error code NS_TIMEOUT and return an
    HTTP 503 Unavailable response. Update some Tcl commande to set
    the NS_TIMEOUT error code.

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/return.c
M	nsd/tclcache.c
M	nsd/tclcallbacks.c
M	nsd/tclcmds.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
A	tests/timeout.test

commit bba8adcbcb4e88f4aec1f4afed5c408d08a95ebf
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-05-26

    Make sure custom error documents return the correct HTTP error code

M	ChangeLog
M	nsd/queue.c
M	nsd/return.c
A	tests/errordoc.test
M	tests/test.nscfg

commit 8b6dd8e8a265e59a4f6b0952947c1ffb1ff694af
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    Fix short typo re stdint

M	nsproxy/nsproxylib.c

commit 4e53ecef181879bc9b820045b494bcebc59feae5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    Added checking for stdint.h header (this defines uint32_t on some OS'es)

M	configure.in
M	nsproxy/nsproxylib.c

commit 5ee3a0e812adc5a13c5a6cc394e6d8317f96eb55
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    Use unsetenv() if present to unset the env variable instead of doing some dirty tricks

M	ChangeLog
M	configure.in
M	nsd/tclenv.c

commit 5fad98d15a4f72c1710601cdd54ca4efa4b12fe1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    Fixed PutEnv to work correctly on all platforms we support
    
    The problem was that it was not simple to unset an env variable
    w/o empolying some dirty tricks.

M	ChangeLog
M	nsd/tclenv.c

commit 8775c9df3f2cbcb47fb7b3ce3dee6d75e8e37826
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    Include stdint.h for uint32_t definition on macOS < 10.4

M	nsproxy/nsproxylib.c

commit 47fe80638d740d39e87108978d9eecd8e0c8833e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    (Ns_ProxyExit): broadcast the cond variable to prevent hang on exit

M	nsproxy/nsproxylib.c

commit d2d58e7573c85ebd831491d51e094f714872db3e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    Fixed pickieness of the compiler and of the Sun thread library

M	nsproxy/nsproxylib.c

commit c4dfd5436dbf397e3a7e9be753c1dc09684b6738
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    NEWS: nsproxy module

M	NEWS

commit 9d48cbdca8cbe0dec5b00486d1197cdade29a594
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    New file for testing ns_proxy module

A	tests/ns_proxy.test

commit 4fe07aa0c606c1d8b862ebb334d607d7bcacbf2d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    Many fixes to nsproxy; include in sample config file; add docs
    
    * sampe-config.tcl.in: Loads nsproxy module and initializes
    with all the default values. The default values are the same
    as ones compiled in the code. Those are just listed for the
    illustration purposes.
    
    * nsproxy/Makefile
    * nsproxy/ns_proxy.man:
    * nsproxy/ns_proxy.test:
    * nsproxy/nsproxy.c:
    * nsproxy/nsproxy.h:
    * nsproxy/nsproxylib.c:
    * nsproxy/nsproxymod.c: Summary of changes below:
    
    o. Fixed deadly embrace between the reaper and user threads.
    o .Improved reaper functionality and made -minslaves/-maxslaves
       behave properly.
    o. Made all pool config options now settable over the configuration
       file. The config command now properly returns result dependent
       on the command arguments in style of other similar Tcl commands,
       like [fconfigure] for example.
    o. Added rudimentary but sufficient C-API for evaluating Tcl
       code over the proxy from within of the C-code. One must include
       nsproxy.h and link with -lnsproxy library. See nsproxy.h for the
       list of supported calls.
    
    Code is now fairly tested and can be evaluated in lab environment;
    consider feature full but still beta-quality for now.
    
    * tests/ns_proxy.test: First couple of tests. Still more
    to come...
    
    * tests/test.nscfg: Added loading of nsproxy in the test server.

M	ChangeLog
M	nsproxy/ns_proxy.man
M	nsproxy/nsproxy.c
M	nsproxy/nsproxy.h
M	nsproxy/nsproxylib.c
M	nsproxy/nsproxymod.c
M	sample-config.tcl.in

commit 761dd14a91e1c51b707128cf4c058d9f964a2c85
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    Add nsproxy to list of loaded modules for the test server

M	tests/test.nscfg

commit 79af128f73172f6e15449fdd74a306dfaac20e39
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-13

    Remove unneeded ns_tls tests

D	tests/ns_tls.test

commit 4db213b66aa276e3f9178020571399179b252334
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-05-12

    (ReturnCharData): use Ns_WriteConn when sendRaw is specified, enabling binary data

M	ChangeLog
M	nsd/return.c

commit 48457509c50e78c15edc2ec9339dbd77f99486ed
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-05-08

    Update compress test; checked against Firefox

M	ChangeLog
M	tests/ns_adp_compress.test

commit 408f5162cb435f35b4c577cf9b23c1a066467bd9
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-05-08

    Add keepalive command to ns_conn for easy keepliave manipulation

M	ChangeLog
M	nsd/conn.c
M	nsd/return.c
M	nsd/tclinit.c
M	tests/ns_conn.test

commit 128fcd454a874b8570d55002b7eded110ffca32f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-07

    Include nsproxy into make process

M	ChangeLog
M	Makefile

commit 4cdd671da15f3e1c7e8c6814b12c5fd23beae457
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-06

    Include grp.h so it compiles cleanly on Linux

M	nsproxy/nsproxylib.c

commit ae5cbf34a7e3e7bc268e125bed320ea2d883e0ee
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-06

    Add Ns_BinPath() (was it deleted by somebody before?, was it me?)

M	ChangeLog
M	include/ns.h
M	nsd/pathname.c

commit 30843bfbbb21e0e093d011512b6c0b488dca4bd1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-05-06

    New files with improved version of ns_proxy; appeared first in AOLserver 4.5
    
    Improvements vs. the original code:
    
      o. proxy handles can be used as Tcl commands for simpler
         OO-like programming
      o. proxy slaves can be told to expire automatically
         after some predefined idle time
      o  proxy slaves can setuid() to some other user ID
         if the parent process runs as superuser.
      o. proxy subsystem is garbage-collected properly on exit
    
    NOTE: ns_proxy module is work in progress and is this not
    included in the standard make machinery. There are still
    things to do: complete the doc, write testsuite.

A	nsproxy/Makefile
A	nsproxy/ns_proxy.man
A	nsproxy/nsproxy.c
A	nsproxy/nsproxy.h
A	nsproxy/nsproxylib.c
A	nsproxy/nsproxymod.c

commit 052b5f8924c8a4a9f282508733e7e75cbd3aa499
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-05-02

    Add contrib directory to the distfiles

M	ChangeLog
M	Makefile

commit 6e140351ce3412fe099f3edbf1b4e520b86cb4b6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-05-02

    Add dbcloseonexit optional parameter for closing db connections on exit

M	ChangeLog
M	contrib/nsd.tcl
M	nsdb/util.tcl

commit 33d43a1816bc987203d55ab8a3d9b00946d68864
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-04-30

    Make ifdef _WIN32 more clear and unified
    
    At some point we should create separate file in order not to
    obfuscate code with numerous ifdef's.

M	ChangeLog
M	nsd/binder.c

commit 275a973a6d197fee309d5efabd7d01c7cf963321
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-04-30

    Call Tcl_FindExecutable before fork(); assure Tcl version is logged
    
    Reorganize so first call to a Tcl_FindExecutable()
    is done after all ns_fork's - see large comment in-place.
    
    Assure Tcl version is logged to the log-file.
    
    Add descriptive run state enumerator so run states can
    now be easier tracked by looking at the code.

M	nsd/nsmain.c

commit 312a3f743e2228cf4869b2478c2311b146006e80
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-04-30

    Add helpful description to make install command

M	Makefile

commit d56c60e67fd4562f3494f0cc0cdb3d0ee67a7718
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-04-22

    Add new event driven I/O API
    
    Unlike the existing task and sockcallback mechanisms, this deals
    only with IO, not threads, and allocates no memory at
    runtime, making it suitable for the main driver
    thread, spooler etc.
    
    Things should be merged at some point.

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
A	nsd/event.c

commit 7568e82daf3950ffba72544e114bb87025840859
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-04-19

    Make page cache process global rather than per virtual server

M	ChangeLog
M	nsd/fastpath.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/server.c
M	tests/test.nscfg

commit bd12f65deca0fa0fc26a6d1b012bdc7bca87f00d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-04-19

    Only reverse look-up hostname at startup if not given in config
    
    Perform reverse lookup on hostname given the IP address only if hostname
    param not specified in nssock section for the socket driver.
    
    In some situations, reverse lookup will not be successful which
    inhibits us to start properly, when we could.

M	ChangeLog
M	nsd/driver.c

commit 537da8d7de14021d9fabab571f4a229078891318
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-04-18

    Remove ns_tls implementation from the core

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclinit.c

commit cb88468bc021f35089affd7495e3dfe28be34c4c
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-04-18

    Add a couple of tests for scheduled procs

M	ChangeLog
A	tests/ns_schedule.test

commit 807f83768b2963316d23a24a680a036290b9ee5f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-04-18

    Use new API for DNS cache code

M	ChangeLog
M	nsd/cache.c
M	nsd/dns.c
M	nsd/nsconf.c

commit 47f17956fc14f71a9d393be214b9a3bb2ef74729
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-04-18

    Run command interpreter in separate thread
    
    This leavs the main thread free to shut down the server cleanly
    when the exit command is run.

M	ChangeLog
M	nsd/nsmain.c
M	nsd/tclinit.c

commit 4c6624261aa9b828e7d622c0464c8f459de9a88f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-04-15

    (Ns_Main): Copy executable name as memory is freed and reused later during Tcl initialization

M	ChangeLog
M	nsd/nsmain.c

commit ffbc0e859d8e1ce98a98c687a2a0ab5df7986a9a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-04-15

    ns_cache_* commands require a server; don't inflate flush stats
    
    * nsd/tclcmds.c: Cache commands require a virtual server context.
    
    * nsd/tclcache.c: Don't artificially inflate flush stats when a
    Tcl script under evaluation errors.

M	ChangeLog
M	nsd/tclcache.c
M	nsd/tclcmds.c

commit 3be8276538949e84c8f3b6ad4cfa4f94bca15bda
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-04-15

    Clarify responsibilities of Ns_CacheCreateEntry and Ns_CacheWaitCreateEntry
    
    The first guarantees an Ns_Entry as a result and handles
    expiry, the second can return NULL only on timeout waiting for
    another thread to update the same entry.  Previously a
    simultaneous flush would also cause a NULL return -- now however
    the entry is recreated.
    
    Fix bug with ExpireEntry: unset the value but do not delete the entry.

M	ChangeLog
M	nsd/cache.c
M	tests/ns_cache.test

commit 4081c8a70138e6da580e70d8d9bda20fb2053880
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-04-15

    Add NS_FATAL error code; make driver thread handle error and DoS attacks more reliably
    
    Update all UDP-based drivers.

M	ChangeLog
M	include/nsthread.h
M	nsd/driver.c

commit 6a48eab31a5da93b6541adff3e7b066a14ac63fc
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-04-14

    Add new Tcl command ns_tls for thread specific local caches
    
    Tcl tls is ns_set structure, so thread specific storage is key
    value pairs.

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclinit.c
A	tests/ns_tls.test

commit d38368d09404bafe11ed5a753e8b729c03be1f59
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-04-14

    (Ns_CacheWaitCreateEntry): don't delete expired entry
    
    This is one possible fix for this call, as it was trashing memory
    by reusing already deleted (expired) entries before. Another
    possible fix is to delete and re-create expired entry, but
    this costs more time, although it may be a more correct thing
    to do.

M	ChangeLog
M	nsd/cache.c

commit 5ce31a214a3ffdefb3c26a294faf7ad1b46876a2
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-04-14

    Update tests to match new image command error codes

M	ChangeLog
M	tests/ns_gifsize.test
M	tests/ns_jpegsize.test

commit 8dd5237ec6acf9e083a6b92de3e6e2f3aa8d054a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-04-13

    Make sure cache value is zero ended

M	ChangeLog
M	nsd/tclcache.c

commit 61192e20f2ae638431ba63975d133c52f1ff66b3
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-04-13

    Add support for PNG images; add commands to compute image type, mimetype and size regardless of type

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclimg.c

commit 08c3452b669b274c3a03046eca9d25d51c647ede
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-04-07

    Add cache test -- works for old ns_cache module, core dumps ns_cache_eval

M	tests/ns_cache.test

commit 22f938eca02b4c8a7e9c196d2adbdbaece1ba9db
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-04-07

    (Ns_SockWait): small typo oops fixed

M	nsd/sock.c

commit faa9a69659ab08dd8dd24cd90b343d0ff2607b14
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-04-07

    Add Ns_SockWait (nsopenssl compatibility); remove extra byte from allocating in Tcl cache API

M	ChangeLog
M	include/ns.h
M	nsd/sock.c
M	nsd/tclcache.c

commit cb7dab0bb3bc4583214763358278df8d753cef24
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-04-05

    Disable spooler tests for now; add 2 new tests for ns_cache_get/set

M	ChangeLog
M	tests/http.test
M	tests/ns_cache.test

commit 6c0c5b9160fbd487ac32924dee8e4e304f7aab8b
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-04-05

    Add ns_cache_get, ns_cache_set for easier cache manipulation

M	ChangeLog
M	nsd/tclcache.c
M	nsd/tclcmds.c

commit c35b18c7b2031ac8aa474c0453e232ce9e14de5c
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2006-03-30

    (ParseFile): read adp files with binary translation
    
    Otherwise reading Windows files may break (size != n).

M	ChangeLog
M	nsd/adpeval.c

commit 1978db0fbd24347c9258527ef3f438eeda075498
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-28

    Ensure result of ns_write* etc. commands is 0 success, 1 failure
    
    Reformatted and indented

M	ChangeLog
M	nsd/tclresp.c

commit b35aba6dbc5143f949e9f93e0c18917c396c56db
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-03-27

    Add smtp configuration parameters to example config file

M	ChangeLog
M	contrib/nsd.tcl

commit e3dd4dc210ef901e3e0f0db875283b31ca14544f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-23

    Add new public API Ns_ConnSetPeer

M	ChangeLog
M	include/ns.h
M	nsd/conn.c

commit 16e36956c07081ed2ef6fb50c2f61c88310aebf9
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-21

    Add DGRAM socket types for Unix domain sockets

M	ChangeLog
M	include/ns.h
M	nsd/binder.c

commit 0b237dec510f5d7a1cd9927b3ca45063ac51f75f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-21

    (Ns_SockListenUnix): accept 'mode' arg for unix domain socket file

M	ChangeLog
M	include/ns.h
M	nsd/binder.c
M	nsd/driver.c

commit f20c7ddb76cf930040f388f7fdbde96c43159293
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-21

    (Ns_SockBindUnix): don't delete socket file

M	ChangeLog
M	nsd/binder.c

commit 3a69697b9e2a0a88c5277c753cba1861b661a4d3
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-20

    (Ns_ConnSockConnect): cleanup unneeded dstring

M	nsd/conn.c

commit 43ef1e5fab62222f004c157fc52599b28114fa01
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-20

    Add Ns_DriverSockContent, Ns_ConnSockContent and Ns_ConnSetContentSent; improved UDP driver support

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c

commit db3777c111b529e2b53c10eb561b3a841fe2591c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-19

    Set spoolerthreads to 0 by default

M	ChangeLog
M	nsd/driver.c

commit 59f1e28ff83d21ea10052e1d377be470635ba0f6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-18

    (Ns_SockCallbackEx): change timeout handling; poll every 5 secs

M	ChangeLog
M	include/ns.h
M	nsd/sockcallback.c
M	nsd/tclsock.c

commit 0476d448592bf8917c569be58b7a81c14b494bdc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-18

    Amend ChangeLog

M	ChangeLog

commit 133085ad93a2769fcd8add941b20d9c6f869b2d7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-18

    Update to support timeouts in socket callbacks, minor reformats

M	ChangeLog
M	nsd/sockcallback.c
M	nsd/task.c

commit 776d5574bf8aa3d621ae2beabecffd713d683431
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-18

    (ns_crypt): use native crypt() on Linux (md5 support); NS_ENCRYPT_BUFSIZE increased

M	ChangeLog
M	configure.in
M	include/ns.h
M	nscp/nscp.c
M	nsd/crypt.c
M	nsperm/nsperm.c

commit 13979c988924fd7252dfe73c75b579da84f62058
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-13

    Made install modular to be able to install only parts

M	ChangeLog
M	Makefile

commit 55f5bb711058d6288e8ce21d0ce570a61405211e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-13

    Make install more modular

M	Makefile

commit e9f68b48f734b8d9b0d7e2c07d92f37affd9b492
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-13

    (ns_setexpires): fix typo

M	ChangeLog
M	tcl/util.tcl

commit 08b2525fccf83a8814799152bec09ed3dd1ded44
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-12

    Remove warnings when running http tests 4.4, 4.5, 4.6

M	ChangeLog
M	tests/http.test

commit 643238b071a29285cf8c65d8bbfaf3bed68dda1a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-12

    Correctly report HTTP status as often as possible

M	tests/testserver/modules/testhttp.tcl

commit 32d30b7444d559fe049bb0e8dc2e2f7e4b81a5ef
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-12

    Add missing ChangeLog entries

M	ChangeLog

commit f8a54fc862b6d109bcdf5dbea0273c8f0337c05d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-12

    Block SIGPIPE for interactive shell
    
    Otherwise, our process gets killed during tests.

M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/unix.c

commit ffa611799e1f4e840f52af926571e7d052c9d598
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-12

    ns_thread id's can be very small (single digit numbers) on solaris

M	tests/ns_thread.test

commit 4b504d82c2479911f4825d0f1839e49701e11421
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-12

    Make regexp for checking thread/mutex handles platform-independent

M	tests/ns_thread.test

commit 7d5abc96831415545b051aa0b4575e1cdd58226a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-11

    Reformatted, newly indented and made more readable

M	nsd/driver.c

commit 699cdcae9c334827bb9493369d1c3d133eabff85
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-11

    Add typedefs for some internally used structures; cosmetic cleanup

M	nsd/nsd.h

commit 112ce2d31d0e84030bdaec7e0caec92300184aea
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-11

    Add nstest_http_write function to upload content

M	tcl/http.tcl
M	tests/testserver/modules/testhttp.tcl

commit 0a7e38e6e37def8a4a1220bc125f93bdc0a72f71
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-11

    Fix endless loop in SpoolerThread when adding more connections from the spooler queue

M	nsd/driver.c

commit fc3f6a295e00a0d0ba85fdc123016c3095070cf0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-03-11

    (Ns_RegisterAtShutdown): pass timeout to callbacks; remove obsolete AtShutdown* API
    
    Remove old variants of shutdown registration:
    
      Ns_RegisterServerShutdown()
      Ns_RegisterAtServerShutdown()
      Ns_RegisterShutdown()
    
    Ns_RegisterAtShutdown() now takes an Ns_ShutdownProc callback, whos
    signature includes an absolute timeout arg. This callback will be
    run twice:  First with a NULL timeout to indicate shutdown
    processing should be initiated. If shutdown work can be completed
    quickly, it should be done here.  Second, with a timeout parameter
    which can be passed to e.g. Ns_CondTimedWait() etc.
    
    The idea is to make the pattern NsStartFooShutdown(),
    NsWaitFooShutdown(toPtr) cleaner to implement.

M	ChangeLog
M	include/ns.h
M	nsd/callbacks.c
M	nsd/tclcallbacks.c
M	nslog/nslog.c

commit 0ca8f988c9342a92acaac6a204ff296d8c4b2e6b
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-10

    (nstest_http): handle network errors, report them; re-enable HTTP tests

M	ChangeLog
M	tests/http.test
M	tests/testserver/modules/testhttp.tcl

commit 4c8b8c4aa5e836030e1d97ff8fc993c5f4db7d75
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-10

    Fix tests to accommodate nstest_http eol changes
    
    Data returned from nstest_http calls is now in standard internal newline
    format and not in the network format, so we had to fix some regexps which
    check returned results accordingly.

M	ChangeLog
M	tests/http_byteranges.test
M	tests/http_chunked.test

commit a18d79117fc4f8d25969295f23f090859c0e48c9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-10

    (_ns_http_readable): refresh nbutes pending after wait
    
    The _ns_http_readable was broken as it did not correctly refresh the
    number of bytes in the socket after waiting for the data to arrive.

M	tcl/http.tcl

commit bb7c3de39946d0e58d0f9ffb1eda7d4fd6222f99
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-10

    Make self-consistent; do not attempt to use unpublished Tcl APIs
    
    Also, preform implicit network-line-end translations by Tcl sock
    handling instead of passing this task to user. Means: data sent
    and received are always in normalized internal new-line format
    instead of the network new-line/carriage-return format.

M	tests/testserver/modules/testhttp.tcl

commit d40ed5684e75bea14e2bf5c544d07b7d8ba97714
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-09

    Untabified, re-indented, fixed some comments

M	nsd/queue.c

commit 471762da558af678d559667f7ac84337156de6eb
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-09

    Fix argument type to Ns_ConnClearQuery()

M	ChangeLog
M	nsd/queue.c

commit af1d3472c1ca3d9c2159357d2f4fd03873922f01
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-09

    Remove _serializeproc, _serializevar; remove includeproc wrapper

M	tcl/nstrace.tcl

commit d822e4f00cb2a3570380314f7df306e2c8ac31f5
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-09

    Replace ns_init, ns_cleanup with ns_ictl trace allocate, deallocate

M	nsd/init.tcl

commit da59fec060053c8769854f3f2581a13f330967ae
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-09

    Add clarifying comments about useless connection form caching

M	tcl/form.tcl

commit 1fe12a76ccee64ade6a95b0d7b9a05617bce83ed
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-09

    Use Ns_ConnClearQuery() in ConnRun() to avoid code duplication

M	nsd/queue.c

commit 38e8afc96cb55ae1dd876d69d9f312c599e39c84
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-09

    Fix some typos in comments

M	tcl/nstrace.tcl

commit a4d1a0a0ab681be9c83cb09ddfdcce5e5c421e8f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-09

    Various bug fixes and cleanups to Tcl files
    
    Reformat, add proper function headers, newly indented.
    
    The http.tcl and sendmail.tcl are rewritten to take advantage of
    automatic end-of-line handling of Tcl channels. Also, fix some
    bugs in EOF handling in both files.
    
    Fix bug in line-break algorithm for quoted-printable MIME content
    with non-ascii data in sendmail.tcl.
    
    The nstrace.tcl is now self-contained and requires nor loads no
    external modules.

M	ChangeLog
M	tcl/cache.tcl
M	tcl/charsets.tcl
M	tcl/compat.tcl
M	tcl/fastpath.tcl
M	tcl/file.tcl
M	tcl/form.tcl
M	tcl/http.tcl
M	tcl/nstrace.tcl
M	tcl/sendmail.tcl
M	tcl/stats.tcl
M	tcl/util.tcl

commit 14d13f05c8a1e9ad404b342a0d8ac1752da09a5f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-09

    Move introspective script to tcl/nstrace.tcl
    
    The nstrace is now the sole interface for handling script
    generation for interp initializations.

M	nsd/init.tcl

commit ad8c2628f199305f44878bcc4b35a670217003fc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-08

    (Ns_SockTimedConnect2): set errno to ETIMEDOUT if unable to connect and optional timer expired

M	nsd/sock.c

commit 47f1513e258ac52a44d2544ea0c91b0b819dda9f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-08

    Remove ancient TclPro support files
    
    I doubt that anybody is still using this.

D	tcl/debug.tcl
D	tcl/prodebug.tcl

commit 64e3c4f672b73ae13891d6755936af18f48a9d8f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-07

    More experiments in attempt to narrow down spooler bug

M	ChangeLog
M	nsd/driver.c
M	tests/http.test
M	tests/testserver/modules/testhttp.tcl

commit de17daa3b861fc3fff106feb2105e64ca94d488e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-04

    Add missing ChangeLog entries

M	ChangeLog

commit 8a14e08742f3ddbf3bec1b7a3e69aa3e9bf1ee53
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-04

    Reorganize for better readability
    
    All temporary procs are now prepended "_" instead of "_ns_" prefix.
    
    Added clarification comment about possible choices for interp
    initialization strategy.
    
    Always load nstrace.tcl library even if not configured for use. This
    allows extensions to use nstrace::isenabled procedure to find out if
    the trace is active or not.

M	nsd/init.tcl

commit 891d0d6aa1ba82abefa3e7198a7b2e31a3d9e70e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-04

    Fix comment about default username/password for stats interface

M	sample-config.tcl.in

commit de5bc54f1b6ae97dd89dbc14ad64e38d8d607906
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-04

    Fix some broken expressions, perhaps due to a bug in Tcl expression evaluator

M	tcl/stats.tcl

commit 7b7b616ff1730ceda3001e59c90ce1a23faad43e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-03-04

    New version of trace feature in nstrace.tcl from ttrace.tcl

R067	tcl/ttrace.tcl	tcl/nstrace.tcl

commit 7cfbacc8e86e3834b56caa154795bd1609c6c5b9
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-03

    UDP driver improved, streaming of packets added

M	ChangeLog
M	nsd/driver.c

commit fe4dcb273d61e02b64dd22126eb02d1c94334530
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-03

    Use driver proc in WriterThread to ensure proper driver's protocol processing

M	ChangeLog
M	nsd/driver.c

commit 6962a518d37436423da59935e1137a31c8aef6d5
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-03

    Add versionstring field to Ns_Request struct for more general protocol parsing
    
    * include/ns.h:
    * nsd/request.c:
    * nsd.conn.c: Add versionstring into Ns_Request struct
    and made request parser more generic regarding protocol version
    to allow other http-like protocols to be parsed by same code
    
    * nsd/driver.c: Some minor cleanups and temp hack in SpoolerThread
    until the real bug will be discovered

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/request.c
M	tests/http.test
M	tests/ns_conn.test
M	tests/test.nscfg

commit 115c9414c7131f32be6d3097a03c639bfbb1ab5c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-02

    Make test harness more robust against network errors

M	tests/testserver/modules/testhttp.tcl

commit 62e7e29d953c9dca6ede1fc154c1b80ad8672932
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-01

    Update SockParse to check Content-Length header for maxinput limit

M	nsd/driver.c

commit 1a3d448ff230301be7ea81befe3356dccb3443a2
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-03-01

    Fix error reporting during request parsing
    
    Now server returns 414/400 return codes and honors
    maxinput/maxheaders parameters.
    
    Test http-4.5 does not hang actually but with sndbuf/rcvbug set
    to so small values it takes very logn time to read the
    request, by putting Ns_Log in SockRead i was seeing reading by
    64/192 bytes but the server was operational.

M	ChangeLog
M	nsd/driver.c
M	tests/http.test
M	tests/test.nscfg
M	tests/testserver/modules/testhttp.tcl

commit 0ca1fd4a3b02430aec4ae30ea2ed79ee3cb4fe94
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-03-01

    Add test which exposes off by 1 bug in encoding buffer management
    
    Bug reported by Vlad on the 24th.

M	ChangeLog
A	tests/encoding.test

commit 75ea4081e020848d7407463f95027cf51ee9c193
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-03-01

    Add some test which verify basic HTTP read/write operations and limits
    
    Highlights some bugs...

M	ChangeLog
M	nsd/driver.c
M	tests/http.test
M	tests/tclresp.test
M	tests/test.nscfg
M	tests/testserver/modules/testhttp.tcl
A	tests/testserver/pages/2048bytes

commit a2fe0827d38bf6a999a3bb8b2ecd7d9b3f7dd3b1
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-02-28

    Add a simple http proxy, disabled by default

M	ChangeLog
M	tcl/http.tcl

commit f195678b5d04f14df7667bfa65c9a0fe998cfa0f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-02-28

    (ns_register_proxy): new command; make Ns_RegisterProxyRequest public

M	ChangeLog
M	include/ns.h
M	nsd/tclcmds.c
M	nsd/tclrequest.c

commit f846535e39875e197a67bc1df18d6536e4770ce7
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-27

    Reverted recent change about when global modules are being loaded

M	ChangeLog
M	nsd/init.tcl

commit 99e048841fd4c5027ac4c63e507edef226505a64
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-27

    (Ns_ConnSend): fix multi-buffer send bug; reduce data copying
    
    Fix bug with buffer management triggered by data too large to be
    sent in a single call to the OS. Don't copy unsent iovec's
    around if there are no additional ones to be added to the set.

M	ChangeLog
M	nsd/connio.c
M	tests/tclresp.test

commit eb026c42fc32b79aae9011430786e55a7a9f7c96
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-25

    Global modules loaded before per-server modules

M	ChangeLog
M	nsd/init.tcl

commit 41838cee46064fbdcba746960fcbcb07575b3c3b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-25

    Untabify and reformat

M	ChangeLog
M	nsd/dns.c

commit 377b5213acbcfa17da88028d97e322c1c6cea1bd
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-25

    ttrace: handle XOTcl automatically
    
    Auto [package req XOTcl 1.3] and [package req xotcl::serializer]
    to enable/disable tracing of XOTcl classes during runtime.
    
    Add implicit [package req XOTcl] in tcl/ttrace.tcl so we can turn on
    automatic class tracing. Also, the load-tracer is now loading packages
    which were not traced.

M	ChangeLog
M	tcl/ttrace.tcl

commit 361f64fc773af608e615d1bbcdba391aef0620cd
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-25

    ttrace: better handle non-ttraced modules
    
    Modified load-script-generator to emit load commands for modules
    loaded w/o trace control in addition to those known to ttrace.

M	tcl/ttrace.tcl

commit 8561eb3534576f29f0f282e64dd99c3e7945e4eb
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-02-24

    Fix hang in connio.c due to incorrect return size

M	ChangeLog
M	nsd/connio.c

commit cc20ab77303d9f00d16ef5a64604dadde418de64
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-24

    Use 'eq', 'ne' tests; add debug logging to module loading; untabify, reindent

M	ChangeLog
M	nsd/init.tcl

commit 674c81a45a2ceace5b3ea6ddd0cb02d1c98fed3d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-24

    (ns_headers): queue, don't flush; (ns_write): scatter/gather args; (ns_return): cleanup char i/o
    
    * nsd/tclresp.c:
    * tests/tclresp.test:
    * tests/http_chunked.test: ns_headers now queues, but does not
    flush, the headers.  Headers are sent when the first data packet.
    
    ns_write will send multiple args efficiently using
    scatter/gather IO.
    
    ns_return no longer handles character encoding redundantly. Now
    handled by the underlying Ns_WriteCharConn().

M	ChangeLog
M	nsd/tclresp.c
M	tests/http_chunked.test
M	tests/tclresp.test

commit fc371cc14dda8fc2c6c18fdc3f81ae2a6e8801c3
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-24

    Let connio.c handle character encoding

M	ChangeLog
M	nsd/return.c

commit 0a0a8b52832fcb07a5773a91440ca94a762fdb03
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-24

    (ns_conn): use Tcl boolean objects instead of ints

M	ChangeLog
M	nsd/conn.c

commit 20f86bd294ddd03ab3155008d8ed705d8d0e1773
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-24

    Remove config.h.in which should be autogenerated; add to .cvsignore

M	include/.cvsignore
D	include/config.h.in

commit 0f04f1ca2a55db5ebeec9fa355465b98de020717
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-24

    (Ns_ConnSend): remove send limit of 16 iovec buffers; optimizations
    
    * configure.in:
    * include/ns.h:
    * nsd/connio.c: Make Ns_ConnSend() write all the buffers it is
    given to the connection, writing in batches up to the OS limit for
    max number of iovec buffs. Previous behaviour was to give up
    after buffer 16.
    
    UIO_MAXIOV is now detected as on some OS' it is significantly
    larger than the old default of 16 (e.g. on Linux it is 1024).
    
    Increased the IO buffer size used for encoding character data
    before sending and for transferring data from disk to network. Up
    from 2k to 8k. This is allocated on the stack so can't be too
    big. It is important for this buffer to be large as it controls
    the number of network packets used to send common items such as
    ADP pages when the encoding != utf-8.
    
    New routines Ns_ConnWriteV() and Ns_ConnWriteVChars() expose a
    scatter/gather interface for sending data. WriteVChars encodes
    character data as required and calls down to WriteV. WriteV
    performs HTTP chunked encoding if required and calls down to
    Ns_ConnSend().
    
    Ns_ConnClose now flushes unsent queued headers/data before
    closing, allowing headers and first data to be sent as a single
    packet in some cases.

M	ChangeLog
M	configure.in
M	include/ns.h
M	nsd/connio.c

commit fdd09c1a0286d6fde43eb01febdf2ed120d5f077
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-24

    Add debug logging for socket send timeouts; code cleanup
    
    Untabify, reformat and move code around. Add new comments and
    clarify existing ones. Add some debug logging for socket
    send timeouts.

M	ChangeLog
M	nsd/sock.c

commit 7711dff9d22d0732ca817dd2344551567d6a4acf
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-21

    (ns_mutex): add 'eval' subcommand which ensures lock release after script return
    
    Add "eval" subcommand to ns_mutex etc. which takes a lock, evals
    the given script, then ensures the lock is unlocked before
    returning. Useful when the script has an error.

M	ChangeLog
M	nsd/tclthread.c
M	tests/ns_thread.test

commit 6e116a237851c00e5f776b17332930307626f941
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-21

    Tcl thread synch commands now accept names; objects auto-created/initialized

M	ChangeLog
M	nsd/nsd.h
M	nsd/server.c
M	nsd/tclcmds.c
M	nsd/tclthread.c
M	tests/ns_thread.test

commit 781e92b92d6c914adb54aed60f020caea0774c24
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-02-21

    Update writer to be threadsafe; rename NsQueueWriter NsWriterQueue
    
    Changed writer to duplicate given memory buffer because
    using Tcl_Obj between threads is not thread-safe.
    
    Renamed NSQueueWriter into NsWriterQueue to be in the same
    convention with Tcl API.

M	ChangeLog
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h

commit c0df405d03d7fdc82298eb9b76e66424be0e23be
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-19

    Remove unused getopt.h header

M	ChangeLog
D	nsd/getopt.h

commit 72d5d10adb2ca617dfae9ac35cba46c57d3c97ad
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-19

    Win32: (NsConnectService): simplify stdio setup
    
    Just freopen() stdio streams instead of close'ing them in
    advance (useless step).
    
    Also, all stdio streams are bound to NUL device as they will
    be later re-bound to log-file in LogReOpen.

M	nsd/nswin32.c

commit 2ef83b23846c07f28c512608a7aa3aab3b12c8d9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-19

    Replace Ns_DStringTrunc with Ns_DStringSetLength; fix double-free in LogFlush/LogFreeCache sequence

M	ChangeLog
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/log.c
M	nsd/pathname.c
M	nsd/request.c
M	nsd/return.c
M	nsd/server.c
M	nsd/tclcallbacks.c
M	nsd/tclhttp.c
M	nsd/tclobjv.c
M	nsd/url2file.c
M	nsd/urlopen.c

commit 076f1cd73c38593e4920ba15e5521387fff8c480
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-02-18

    (ns_writer): renamed from ns_queue_writer; add options submit, submitfile, list

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/tclcmds.c

commit 6e58d9d26dd7d35f07a5d334a3b995ef9ec29e39
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-02-16

    (ns_queue_writer): new command that submits data to the writer thread
    
    Writer thread will send this Tcl object to the client.

M	ChangeLog
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/tclcmds.c

commit c219c652ba1eaef5c6e2e44d788d3b901e3128d6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-02-16

    Make struct sockaddr_in publicly available to driver modules in Ns_Sock

M	ChangeLog
M	include/ns.h
M	nsd/nsd.h

commit 58b007ce103e309dc8047b7debbe5a1f12be8a68
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-02-15

    Add maxqueuesize parameter to limit incoming socket queue size
    
    Prevents a possible DoS attack. Default size set to 256.

M	ChangeLog
M	include/config.h.in
M	nsd/driver.c
M	nsd/nsd.h

commit 9cc758d3e9ede33249b22ad50b3ee368213c0c6e
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2006-02-13

    Win32: fix stdin, stdout, stderr channels for interp/thread creation

M	ChangeLog
M	nsd/nswin32.c

commit 783c0f5ee31941cc9b9fd7bfab8f496ad239523a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-08

    Clarified that "man -l" will only work on Linux

M	ChangeLog
M	doc/src/README.doc
A	doc/src/man.macros

commit 3cba774d8029113e79c2370d50a4a355ae4fa573
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-08

    Reduce number of threads testing cache stability from 100 to 16
    
    It was blowing up smaller machines.

M	ChangeLog
M	nsd/cache.c
M	tests/ns_cache.test

commit 9afad96f927186ce17ca008a54dfda9ec533f5b4
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-08

    Set cachetimeout to 360 secs

M	tests/test.nscfg

commit 72ab700024b9eed629c81f1e373e897089ff4b61
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-08

    Gather npruned, nexpired cache stats (rfe #1427620)

M	nsd/cache.c

commit 5658c5834668cde0e1178a0ec83ee2c4090334f6
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-08

    Add TEA3.5

M	ChangeLog
M	configure.in
M	m4/tcl.m4

commit 4e5cf1003bedeab6d463725468bcc9e3fd32d0db
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-02-07

    Fix non-braced expressions and standardized comparisons with TCL string operators
    
    Thanks to Gustaf Neumann for providing the fixes!
    There are still some legacy files left.

M	ChangeLog
M	nsdb/util.tcl
M	nsperm/init.tcl
M	tcl/cache.tcl
M	tcl/charsets.tcl
M	tcl/fastpath.tcl
M	tcl/file.tcl
M	tcl/form.tcl
M	tcl/http.tcl
M	tcl/sendmail.tcl
M	tcl/stats.tcl
M	tcl/ttrace.tcl
M	tcl/util.tcl

commit 3720dc8272d67e15ed2468c17ac9deda91fa7b53
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-07

    Set to load only once, at startup

M	ChangeLog
M	tcl/ttrace.tcl

commit 1cc1f3b1075aafa24883f34dca1ba9b8cd5ea53e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-07

    Trace inits now controlled under ns/section/$server/tcl and lazyloader ns_param

M	nsd/init.tcl
M	sample-config.tcl.in

commit aa9b7aceb22c4a40de62dd652a046410e11b68dd
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-07

    Remove compatibility code for Tcl threading extension; changed license to Mozilla

M	tcl/ttrace.tcl

commit f307916c50eae0aa109a9440a285a7d2007871ee
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-07

    Change to Mozilla License

M	nsthread/nsthreadtest.c

commit 1231df4241809e7dee4bd5ac70f86cd1c706b8b1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-07

    Include "config.h" to get STATIC_BUILD defined

M	nsthread/nsthreadtest.c

commit 4365a3c2f7bb136b03e4755110673e076c22e61c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-06

    Add DL_LIBS and MATH_LIBS as those are expected by TCL_LIBS
    
    Also, accumulate all required libraries to link with in NSLIBS variable,
    as LIBS is used by TCL_LIBS as well.

M	include/Makefile.global.in

commit a8940224191b891afe1d0f095a171d4bb145b468
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-06

    The "distclean" target removes auto-generated sample-config.tcl

M	Makefile

commit 731dfee7c24dce95d1208ddccb388179dadfd713
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-06

    Replaced AOLserver->Naviserver

M	tcl/init.tcl

commit 717ab4c6e41c02428c5d6253ac822915e296eb59
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-06

    NEWS: mention trace based interp inits

M	ChangeLog
M	NEWS

commit f50034eb62fe0abb6ede0fa2e8ea210693972e40
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-06

    Add remark about ttrace

M	sample-config.tcl.in

commit e8a369a91390d631832923530584a88dbfc294d8
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-06

    Change to Mozilla license

M	nsd/init.tcl

commit 2d7a61e848ccdbedb2d55638be8903377c91c037
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-06

    Tell "make dist" to Include sample-config.in the distribution file

M	Makefile

commit 7d563552f11386e492b1f2abc7076a247de5768d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-06

    Add optional trace-based interp init

M	nsd/init.tcl

commit 0ec484ba0d6bc6b79f03e7c4b60ca9c9a83bb611
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-06

    New file implementing Tcl-trace based interp initialization

A	tcl/ttrace.tcl

commit 4aedb393109865430cd70d24b7cf9db086cc13b9
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-05

    Make cvs not complain about some more auto-generated files

M	.cvsignore
A	tests/testserver/.cvsignore

commit a5a8e3ee8b23f5361ecf294adf83bc46638e8c29
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-05

    Add missing file include/nsversion.h.in

M	ChangeLog
M	include/.cvsignore
A	include/nsversion.h.in

commit ef4a2199bf8d750d844e3d2e059bd19311530a55
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-05

    Remove 'doit' variables with local scope
    
    Prevents warning about unused variable with same name in
    function scope.

M	ChangeLog
M	nsd/urlspace.c

commit eac58b94dd1bd9d1da99ad4345b024df6fa19550
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-05

    Update version info in DOAP project description

M	ChangeLog
M	naviserver.rdf

commit f62a7b414bd0e3e4f0db137f555119bfad5662e5
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-05

    Emit a warning if zlib compression support requested (default) but the zlib.h header or compress2 function not found

M	ChangeLog
M	configure.in

commit 4fb4bc72ff50e72c3c0bb117a4282c96f7ca6c77
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-05

    Move nsd version info to private nsversion.h header
    
    * Makefile:
    * configure.in:
    * include/config.h.in:
    * include/nsconfig.h.in:
    * include/ns.h:
    * include/nsthread.h:
    * nsthread/thread.h:
    * include/.cvsignore: Autoconf config defs now saved in private
    config.h which is not installed so we don't pollute the namespace
    of modules.  Version info now substituted into nsversion.h.
    
    * nsd/compress.c:
    * nsd/main.c:
    * nsd/nsd.h:
    * nsd/tclcallbacks.c:
    * nsd/tclobjv.c: Include the private nsd.h header to pick up
    config definitions.

M	ChangeLog
M	Makefile
M	configure.in
M	include/.cvsignore
A	include/config.h.in
M	include/ns.h
M	include/nsthread.h
M	nsd/compress.c
M	nsd/main.c
M	nsd/nsd.h
M	nsd/tclcallbacks.c
M	nsd/tclobjv.c
M	nsthread/thread.h

commit 19d06adda209b3a9d3f150a5f32865b079075528
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-02-05

    Fix test for ns_info pools when Tcl built with --enable-symbols; fix test for ns_info builddate, for night owls

M	ChangeLog
M	tests/ns_info.test

commit f0aae4b8640c53cf81de16368a6cc187f8033023
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-04

    Bumped working version to 4.99.2

M	ChangeLog
M	configure.in

commit cc94c146c313bd62fa4c707280bec2ca1f71b73c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-04

    Tag naviserver-4.99.1

M	.hgtags

commit 91f1b5748b92872a9d80e3ec68501e3e7defc88c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-04

    Tag naviserver-4.99.1-release

M	ChangeLog

commit dd76b358fe8648fc49fd810e20420737e8990ed5
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-02-03

    Add clean-bak Makefile target

M	ChangeLog
M	include/Makefile.module.in

commit a7a67cf340eee1554d42e99e931c1203e0586860
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-03

    (LogTclVersion): new, log Tcl version after initialsing library

M	ChangeLog
M	nsd/nsmain.c

commit 1b72b63d62a87a81f47bd5c84d915bb63b961047
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-03

    Pre-process the sample-config.tcl file for installation directory

M	ChangeLog
M	configure.in
R099	sample-config.tcl	sample-config.tcl.in

commit 400ac475920c88d18d7505c4b458592a2740d71d
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2006-02-03

    Win32: define vsnprintf as _vsnprintf

M	nsthread/thread.c

commit ff7052a0421c490a41b9d416dd21990f48239292
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2006-02-03

    (NsCreatePidFile): open channel in binary mode
    
    Otherwise the Windows pidfile is garbled with a CR at the end.

M	nsd/pidfile.c

commit 2ff707e281111a183f3d84677c4a4b2edfcb7cb6
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2006-02-03

    Make binder compile on Windows

M	nsd/binder.c

commit 6cbb70409f715d73e09610c72b092c874517fccb
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2006-02-03

    (JunctionFind): add missing variable declaration

M	nsd/urlspace.c

commit 88ee13027a1be228b289de26eebe8bec153f0409
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-02

    Malloc test now uses random block-sizes up to 16K max to test the speed difference between the malloc and ns_malloc

M	ChangeLog
M	nsthread/nsthreadtest.c

commit ccd2aef84b0ad7e42931c2ce7f6d443a27afec34
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-02-02

    README: synch Tcl and NaviServer ./configure args in compile example; add note for use of autogen.sh

M	ChangeLog
M	README

commit 286e095c497c841a14e3afd7c763a26fd1eadaaa
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-01

    dist target now depends on clean, otherwise we get objects in tarball

M	Makefile

commit 31ed1891da63c9463f5a3b6e60afe36cd369d1fb
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-01

    Reflect 4.99.1 and latest 8.4.12 Tcl

M	ChangeLog
M	README

commit cfba88c2f346c7875095d67bca26f1021f41b291
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-01

    Add hint about new runtime dir structure

M	NEWS

commit f6d41b8f522fbb624032d568684ecd5739d2b288
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-01

    NEWS: new things and code changes since 4.99.0

M	NEWS

commit f2de83786c65819ec41f754089827be4876134bb
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-01

    Revert back to 4.99.1 as we did not release this one yet

M	configure.in

commit 10589db039bc550d921212544bc3944686a6e3bc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-01

    Omit -P option for cp as it is not supported on Solaris

M	include/Makefile.global.in

commit 0d2fe45ce31109adcb1c045de742fc776d452b57
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-01

    Make CP using -pPR and not -an as this is only the Linux option

M	include/Makefile.global.in

commit 9154813b985959672d8d391b969981a9355fc655
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-01

    Purge some junk files before generating distribution

M	Makefile

commit dd5195f7826a21cee44691dbf092bb0fb1954122
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-02-01

    Bumped version to 4.99.2 for an interim release

M	configure.in

commit 4bbae51b0b31f95820bfa90e651a4afab90360ad
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-28

    Fix comment typo in sample-config.tcl

M	sample-config.tcl

commit 7b3ff6fffe0344183f59939d290ae7034d6db4a7
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-24

    (JunctionFind): fix typo causing compile failure for standard C

M	ChangeLog
M	nsd/urlspace.c

commit 97f4112cc6125ef2bcd5e9bace32287e988d5f58
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-24

    Untabified, indented

M	nsd/tcljob.c

commit cfe64265644baade34ccd0c5e193c4d75afe7abd
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-24

    Untabified, indented

M	nsd/tclsock.c

commit a2369a3aafbc529eecfada0ddba52b395e6843e6
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-24

    Untabified, indented

M	nsd/sock.c

commit 59adbd945bb31ace5a023107f4cdad8c13d3e598
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-24

    Accept Ns_Time ptr instead of integer timeout in secs (rfe #1413620)

M	ChangeLog
M	include/ns.h
M	nsd/sock.c
M	nsd/tcljob.c
M	nsd/tclsock.c
M	nssock/nssock.c

commit cab41348f98c80ae6f4edffe7d7293d03fb0292c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-23

    Add ns_cache_exists
    
    Used for cases when just existence needed without retrieving the
    whole cache entry.

M	ChangeLog
M	nsd/tclcache.c
M	nsd/tclcmds.c
M	tests/ns_cache.test
M	tests/ns_info.test

commit c36246dbb207261e84fb4102bbf8b8864a97064b
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-23

    Fix bug with extra single quote for bash 3.1

M	ChangeLog
M	m4/tcl.m4

commit 1dd33491c3df715885152e3916e8d034410cbe73
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-01-23

    (ns_sendmail): add character encoding of subject, body; quoted-printable; AUTH-PLAIN
    
    * tcl/sendmail.tcl: Added character encoding for subject and body,
    message-id creation, quoted printable text and AUTH PLAIN
    mechanism (all optional).
    
    * doc/src/ns_sendmail.man:
    * doc/src/README.doc:
    * doc/man/ns_sendmail.n:
    * doc/html/ns_sendmail.html: Doctools documentation file for new
    ns_sendmail functionality as well as examples created with dtplite

M	ChangeLog
A	doc/html/ns_sendmail.html
A	doc/man/ns_sendmail.n
A	doc/src/README.doc
A	doc/src/ns_sendmail.man
M	tcl/sendmail.tcl

commit 56b758798df02193237ef6bd29755143dc0cfec6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-21

    Massage sample-config.tcl

M	contrib/nsd.tcl
M	sample-config.tcl

commit 6c2d3e4ae9e0213ef6c7d10111dccdb702ff5e9d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-20

    Use new ns_cache_* procs in fastpath code; add ns_fileread, ns_filewrite utils

M	ChangeLog
M	tcl/file.tcl
M	tcl/util.tcl

commit 262f9c89526503173fbf5da1fbbf1da01ee97295
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-20

    Various installation layout changes; enhance sample-config.tcl
    
    * m4/tcl.m4: check for USE_THREAD_ALLOC in tclConfig.sh
    
    * Makefile: simplify installation  structure, create conf/, logs/,
    tcl/ directories.
    
    * sample-config.tcl: re-formatted and make it run, added more
    descriptions
    
    * contrib/nsd.tcl:
    * contrib/mimetypes.tcl: added new example configs
    
    * include/Makefile.global.in: chanage to simpler installation
    structure
    
    * contrib/index.adp: Added default index page

M	ChangeLog
M	Makefile
M	README
A	contrib/index.adp
A	contrib/mimetypes.tcl
A	contrib/nsd.tcl
M	include/Makefile.global.in
M	m4/tcl.m4
M	sample-config.tcl

commit 462157256e12e26ebc3ad6fbc82015fb026bd5db
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-20

    Fix all stats bugs; now runs under naviserver properly

M	ChangeLog
M	tcl/stats.tcl

commit 43815033f7981b266aac6a936d0b17dba76c6a5b
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-01-20

    Update README with latest info

M	README

commit dd87a997dbcea132c5c9fbfa51764a92cbdc4065
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-20

    (Ns_DriverSockRequest): fix struct reuse bug; return NS_ERROR if URL unparsable

M	ChangeLog
M	include/ns.h
M	nsd/driver.c

commit 4c3d89618351e5b9e2fca3f00e004e4cf8bb06e2
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-18

    Add spooler/writer related options to sample-config.tcl

M	ChangeLog
M	sample-config.tcl

commit 03aa1a120491487b03dcf4853d7c38de03d7b653
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-18

    Cleanup spooler/writer thread code; fix bug when multiple drivers loaded
    
    Rewrote driver's spooler/writer support to make them cleaner and
    to support multiple spooler/writer threads for each driver. Before
    that, global spooler variables got overwritten if multiple drivers
    are loaded.
    
    Also, simplified driver thread, removed rotating driver's list, in
    case of usual one driver operation that was just waste of CPU
    cycles. For multiple drivers, spawning separate thread for each
    would be better solution, it can be considered for future driver
    encancements.

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h

commit 96793d96b489284ecd2d77e24550114b6cb52715
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-18

    Remove spurious debug log message

M	nsd/driver.c

commit 669c95d5ef47f6c8949e10ebfab28e93766c49dd
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-18

    (Ns_ThreadSetName): accept sprintf-like arg list

M	ChangeLog
M	include/nsthread.h
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/sched.c
M	nsd/task.c
M	nsd/tcljob.c
M	nsthread/thread.c

commit 032b7f1b989acfaed42a93614525112f22fc950e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-17

    Writer support improved with thread pool

M	ChangeLog
M	nsd/connio.c
M	nsd/driver.c

commit 713998f679c799975eb4d8d8804cc109d4c5be9b
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2006-01-16

    (ns_base64encode): fix appending of extra newline in certain line break situations (bug #1407112)

M	ChangeLog
M	nsd/uuencode.c
A	tests/ns_base64encode.test

commit d51bab6a5b458c02a54a66558e94bc27b1c7b025
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-16

    Use pool of independent threads to write large files (disabled)
    
    * nsd/driver.c:
    * nsd/connio.c:
    * nsd.nsd.h: This is experimental feature to use separate writer
    thread for sending large files to multiple clients. By default it
    is disabled so nobody should be affected by this feature. Still need
    more testing but can be very useful, keeping it in CVS makes it easier
    to track then in local copy, i keep losing local modifications
    all the time.
    
    * nsd/driver.c: Changes poolto from -1 to 60 seconds in DriverThread and
    SpolerThread to wake up from pool. Once a minute will not kill the server
    but will ensure it will never get into race condition.

M	ChangeLog
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h

commit a873f2c9b85b6462f83d0899b2400367c8efcfc9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-14

    Made all places related to spooler shutdown conditional on spoolerDisabled

M	nsd/driver.c

commit 409f859fe64315db6bdbb69e77b73a8e4bf10781
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-14

    Do not trigger spooler pipe on NsStopDrivers if spooler thread disabled

M	ChangeLog
M	nsd/driver.c

commit 1db8646951de72f5d03429a76ffcfea1e521e2ab
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-14

    Indented

M	nsd/tclmisc.c

commit 23326404dc71dcd1b09237ccffd286e16abdf5f0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-14

    (NsTclHTUUEncodeObjCmd): properly handle binary strings (bug #1405988)

M	ChangeLog
M	nsd/tclmisc.c

commit e57f0a73b92407d6179aa344337ee81b9f87b7b3
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-13

    Tcl callbacks accept multiple args (rfe #1404901)

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/pathname.c
M	nsd/tclcallbacks.c
M	nsd/tclinit.c
M	nsd/tclrequest.c
M	nsd/tclsched.c
M	nsd/url2file.c
M	tests/ns_register_filter.test
M	tests/ns_register_proc.test
M	tests/url2file.test

commit f439481ac5ae689ccb5e304e88d972e3707fe2a3
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2006-01-12

    Handle large uploads in independent spooler thread; add ns_upload_stats

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/tclcmds.c

commit 245c637ad25c840adb6efab6c424466533b38370
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-11

    Fixed off-by-one error in Ns_SetDelete

M	ChangeLog
M	nsd/set.c

commit e01d4aabce5270665aa346bcccc43d2a9866b480
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-10

    Added some clarifying comments

M	ChangeLog
M	nsd/driver.c

commit d087d4f75cf61fe29566bd5e2d5a8e0bc964d809
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-01-07

    (DriverThread): add Push() macro to clarify list processing of sockets and drivers

M	ChangeLog
M	nsd/driver.c

commit d1f190087fd0aeca298b335b0f5a7814b43c1968
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-06

    Fix ns_conn.test to recognize new contentsentlength option during basic command test

M	ChangeLog
M	tests/ns_conn.test

commit 9c62b74049eafd0a12b68217971847804ece154c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2006-01-04

    Fix ns_conn contentsentlength logging; fix 64bit inet_ntop bug
    
    * configure.in:  added test for inet_ntop.
    * nsthread/reentrant.c: use inet_ntop when available which fixes a
    bug on 64 bit ppc, at least under linux.
    
    * nsd/conn.c: added option to [ns_conn] to set/query contentsentlength
    for getting the correct length into the logfile, when files are
    delivered via event driven I/O.
    
    Thanks to Gustaf Neumann for providing above fixes.

M	ChangeLog
M	configure.in
M	nsd/conn.c
M	nsthread/reentrant.c

commit 7b24e9201ab55c0934654b97f2084951e33eb299
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2006-01-04

    Backport AOLserver 4.5 task queues
    
    Callbacks are registered to run in a separate thread in response
    to socket read/write events.

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/sock.c
A	nsd/task.c

commit 091c11885c572d0b920d13e1d9faf75e45df1df2
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-30

    Remove global urlspace lock; cleanup NsUrlSpecificWalk output (rfe #1377113)
    
    * include/ns.h:
    * nsd/init.c:
    * nsd/urlspace.c:
    * tests/url2file.test: Split the urlspace by key ID and remove the
    global lock. Remove unused Ns_ServerSpecific*() routines.
    
    Make NsUrlSpecificWalk() emit an entry for both inherit and
    noinherit data, identifying each with a keyword.  Don't emit the
    server name, which is redundant, and separate the URL from the
    filter. (RFE: 1377113)

M	ChangeLog
M	include/ns.h
M	nsd/init.c
M	nsd/op.c
M	nsd/url2file.c
M	nsd/urlspace.c
M	tests/url2file.test

commit 03987b8b99218fb71e0cce089ff81fa271dcdc4f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-30

    Add ns_cache_*, ns_memoize; various tweaks to the guts of cache system
    
    * include/ns.h:
    * nsd/nsd.h:
    * nsd/init.c:
    * nsd/proc.c:
    * nsd/cache.c: Global hash of cache names removed; access no
    longer available via Ns_CacheFind() or ns_cache_names.  Caches
    have unique locking requirements and lifetimes which could be
    violated by e.g. running ns_cache_stats on a thread local cache as the
    thread is exiting.
    
    New Ns_CacheCreateEx() allows creating a cache which has both a
    size and a time limit.
    
    Caches with time limits are calculated differently.  Previous
    behaviour was to periodically check the last access time of each
    cache entry and flush those which had expired.  A busy cache could
    grow without bound.  New behaviour is to check for expiry each time
    an entry is retrieved from the cache.  All caches can (and should)
    be size limited.  Timeouts may be specified per cache and per
    entry using new Ns_CacheSetValueExpires().
    
    Ns_CacheFlush() now returns the number of entries flushed.
    
    New Ns_CacheStats() takes over from ns_cache_stats for non-Tcl
    caches. Stats are returned in Tcl "array get" format.
    
    Removed Ns_CacheMalloc(), Ns_CacheFree() and Ns_CacheName().
    
    Move Tcl commands to tclcache.c.
    
    * nsd/Makefile:
    * nsd/tclcmds.c:
    * nsd/tclcache.c:
    * tests/ns_cache.test: Add new Tcl commands ns_cache_create,
    _eval, _append, _lappend, and _incr. (RFE# 1119257)
    
    Old commands ns_cache_names, _keys, _flush and _stats now only
    work on Tcl caches.  ns_cache_size has been removed; the size is
    now reported along with other statistics. These commands now only
    work on Tcl caches.
    
    * tcl/cache.tcl: New ns_memoize and related commands which act
    just like ns_cache_eval but use the script as a key into the
    memoize cache.

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
M	nsd/cache.c
M	nsd/init.c
M	nsd/nsd.h
M	nsd/proc.c
M	nsd/server.c
A	nsd/tclcache.c
M	nsd/tclcmds.c
A	tcl/cache.tcl
A	tests/ns_cache.test

commit a834e1e7b494cd5d8019fc4a57059c5ad53544a0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-23

    Don't pass "" as arg to filter/trace callbacks when no arg registered

M	ChangeLog
M	nsd/tclrequest.c
M	tests/ns_info.test
M	tests/ns_register_filter.test

commit 4631a4949a604ed87bfc3b086680817eef33bced
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-11

    Add -first to ns_register_filter; add ns_shortcut_filter (rfe #1012103)
    
    Add switch -first to ns_register_filter command, allowing
    filters to be registered at the head of the queue.
    
    Add new command ns_shortcut_filter which registers a C filter
    callback which simply returns NS_FILTER_BREAK, preventing any
    other filters of the same type from running.
    
    For further explanation, see:
    
    http://sf.net/tracker/index.php?func=detail&aid=1012103&group_id=3152&atid=353152

M	ChangeLog
M	include/ns.h
M	nsd/filter.c
M	nsd/nsd.h
M	nsd/proc.c
M	nsd/tclcmds.c
M	nsd/tclrequest.c
M	tests/ns_register_filter.test

commit 572e62a9dcc688d19a63ed0819ff97471ece62e4
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-11

    Don't log filter errors twice; handle inline script callbacks correctly
    
    * tests/ns_register_filter.test: Add tests for registered filters
    and traces.
    
    * nsd/tclrequest.c: Fix bug where filter errors were being logged
    twice. Fix bug where filter callback procs were being constructed
    incorrectly, making it impossible to register inline script
    fragments, rather than proc names.

M	ChangeLog
M	nsd/tclrequest.c
A	tests/ns_register_filter.test

commit b792521064f052586ab9e5ceb1bf81caa6177e94
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-11

    Typo: s/-setup/-body/

M	ChangeLog
M	tests/ns_nsv.test

commit a72278da80f707cefef69b2f9631d9a844db30f3
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-11

    Add -nocomplain switch to nsv_unset, matching Tcl unset command

M	ChangeLog
M	nsd/tclvar.c
M	tests/ns_nsv.test

commit 119862a41642a9c0c3073b4e9432a0f5c2915558
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-11

    Untabify and reformat

M	ChangeLog
M	nsd/tclvar.c

commit 39d38ac91404416a796db69f245c7d8cabac854f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-11

    Add ns_register_fastpath (rfe #1012770)
    
    Add new Tcl command ns_register_fastpath which
    re-register the original fastpath proc for static file serving,
    for the specified method and URL.  This allows e.g. a Tcl proc to
    be registered as the default handler for the URL / and then
    override this with the fastpath proc for /images.
    
    The fastpath proc invokes no Tcl and therefore does not
    allocate an interp. Non-Tcl using threads can be segregated
    using the conn pool mechanism.
    
    (RFE: http://sf.net/tracker/index.php?func=detail&aid=1012770&group_id=3152&atid=353152)

M	ChangeLog
M	include/ns.h
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/proc.c
M	nsd/server.c
M	nsd/tclcmds.c
M	nsd/tclrequest.c
M	tests/ns_register_proc.test

commit db68786cb1a25fbbfba0e44fd6acaca440a3794a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-11

    (ns_httptime): format date using snprintf to ensure English used (bug #1340755)
    
    * nsd/httptime.c:
    * tests/hs_httptime.test: Use snprintf to format the date to ensure the
    English week and month names are always used, no matter which
    locale is in effect. (Bug# 1340755)

M	ChangeLog
M	nsd/httptime.c
M	tests/ns_httptime.test

commit f7b8fc158c953c3410e1049cf2976fffa2c411e9
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-11

    Add tests for ns_parsehttptime; untabify and reformat httptime.c

M	ChangeLog
M	nsd/httptime.c
M	tests/ns_httptime.test

commit fbd191973a6a80d26df2b9d4aa319dc68eed9a63
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-05

    Add Ns_UnregisterProcEx; add -recurse to ns_unregister_proc
    
    * include/ns.h:
    * nsd/op.c: Add new function Ns_UnRegisterProcEx which
    allows all urlspace flags to be set.
    
    * nsd/tclrequest.c: Fix bug where noinherit procs were not being
    deleted. Add new -recurse flag to ns_unregister_proc which deletes
    all registered procs below the given URL.
    
    * tests/ns_register_proc.test: Exercise the ns_register_proc API.

M	ChangeLog
M	include/ns.h
M	nsd/op.c
M	nsd/tclrequest.c
A	tests/ns_register_proc.test

commit 40c192297c19f7fdcc05dba83150a347af28d9a4
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-12-04

    Add new sub-commands to failing ns_info test

M	ChangeLog
M	tests/ns_info.test

commit d8fc90eaf8e024d62ec32e9640fd88f05b289a3d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-11-24

    (NsMain): remove Tcl_ExitThread() as it changes exit behaviour in incompatbile way

M	ChangeLog
M	nsd/nsmain.c

commit e307d25be22e0a15c1c7a23947c3c919ec89b9dc
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-11-24

    Removed unused variable in NsMain()

M	nsd/nsmain.c

commit 3c7a2396480a11e4b6f564d539590a7d2f1bb839
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-11-24

    (NsMain): call Tcl_ThreadExit() instead of returning to caller, triggering exit handlers
    
    This triggers invocation of exit handlers registered by Tcl extensions
    loaded into the main thread and cleanup of TLS slots (indirectly, from
    the therad library exit call, pthread_exit or _endthreadex).

M	ChangeLog
M	nsd/nsmain.c

commit edf5eb0020a69decea9298d78bef5574162b1e49
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-11-24

    (Ns_WaitForProcess): ignor EINTR in waitpid

M	nsd/exec.c

commit bd1c1b143222b93f191af54e22f093a34eabf4f1
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-11-15

    (ns_info): add 'started' and 'shutdownpending' sub-commands

M	ChangeLog
M	nsd/info.c

commit 1fbc3a3aa05dddab53d6d2e6e02d4f368cb4a534
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-11-12

    Don't use C++ reserved keyword 'delete'

M	include/ns.h

commit b643f1fa6d6866aac1616c3659e38d27d1621aae
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-11-12

    Add new DriverAccept callback; add Ns_DriverSetRequest to allocat Sock's; add Ns_ConnSockPtr
    
    * include/ns.h: Add new DriverAccept call for drivers
    to be called after accept the connection. If request struct will
    be provided by the driver, connection will be queued immediately and
    driver will handle it completely. This is temporary until more generic
    driver support will be designed.
    
    * nsd/driver.c: add new Ns_DriverSetRequest function that allocates request
    struct for new connection socket.
    
    * nsd.conn.c: New Ns_ConnSockPtr function

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/sock.c

commit 6b891f828617cb4a1454c4fd2b8c069c7d6fcad0
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-11-12

    Rewrite driver SockRead/SockParse; make Ns_SockRecvBufs, Ns_SockSendBufs public
    
    * nsd/driver.c: Split SockRead into SockRead and SockParse,
    added new SetRequest static function that allocates request struct
    for new connection socket.
    
    * nssock/nssock.c:
    * include/ns.h:
    * nsd/sock.c: Moved and made as public two functions from sock
    driver: Ns_SockRecvBufs, Ns_SockSendBufs. for new drivers, now it
    will be easy to re-use send/recv data from within driver's proc.
    
    * nsd/info.c: Fixed sockcallbacks as unrecognosed error

M	ChangeLog
M	include/ns.h
M	nsd/driver.c
M	nsd/info.c
M	nsd/sock.c
M	nssock/nssock.c
M	tests/ns_info.test

commit a96a4741cc68031f1a7054c95b6a7ca224b8a588
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-11-07

    (ns_info): handle non server-specific sub-commands

M	ChangeLog
M	nsd/info.c

commit 8d2ba50ec47fcba4508d97140c41f192876ac82b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-11-07

    Add new, flexible urlspace-based Url2File C API and matching Tcl commands (rfe #1333811)

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
M	nsd/fastpath.c
M	nsd/info.c
M	nsd/init.c
M	nsd/nsd.h
M	nsd/proc.c
M	nsd/server.c
M	nsd/tclcmds.c
M	nsd/tclfile.c
A	nsd/url2file.c
M	tests/ns_info.test
A	tests/url2file.test

commit 0a0d1a83042fdb95ff32512da9018b02dbb71417
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-11-03

    All Ns_SockListen* routines support forked binder if direct socket allocation failed

M	ChangeLog
M	nsd/binder.c

commit 2dce35d4db5d63822747129ee9e49d7577103d3b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-11-03

    Untabify, reindent

M	nsd/binder.c

commit 8ab19504babcf29fc0559de900331b6392f71a51
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-11-02

    Minor fixes regarding new binder support

M	configure.in
A	m4/cmmsg.m4
M	nsd/binder.c

commit 96915b47896ae944c309619750c91d4577822df4
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-11-02

    Add support for binder as separate process, forked before dropping root privs
    
    In this mode, no need to specify all ports in the command line
    parameter -b. For now all modules have to call new API function
    in order to create sockets if they are not specified using -b
    command line parameter.

M	ChangeLog
M	configure.in
M	include/ns.h
M	nsd/binder.c
M	nsd/nsmain.c

commit a3d0278573b4d71f0ced32692b623c9a03a35832
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-11-02

    Add 1 second delay to test to make 'ns_info uptime' report uptime > 0

M	ChangeLog
M	tests/ns_info.test

commit 4844419ddba3e40c0bcbb0eba4b0d1a8aa40a075
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2005-10-28

    (ns_rename): do not delete file if "from" and "to" match

M	ChangeLog
M	tcl/compat.tcl

commit 07e83a1bf0bdf1ea7b7f5adbc1c0c75edc6b57c4
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-27

    Add Ns_VALog with varargs interface

M	ChangeLog
M	include/ns.h
M	nsd/log.c

commit 9275eefccaa30480d53bf867d011af58cba7dd7d
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2005-10-24

    Add basic tests for ns_set command

M	ChangeLog
A	tests/ns_set.test

commit 3331dd777e54fc81175542573f0ad3d3231514e9
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-22

    (ns_env): fix bugs with -nocomplain switch and unset command (bug# 1333280)
    
    Untabify and reformat code, convert to Tcl objects.

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclenv.c
M	tests/ns_env.test

commit fb034d5b05989d72a04792b7e29bb9535cbc08e3
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-22

    Make watchdog wake up every 10 minutes on all platforms; add platform neutral checking for u_int32_t and u_int8_t types

M	ChangeLog
M	configure.in
M	nsd/nsmain.c
M	nsd/tclmisc.c

commit 4d7ef91927e466ac86d124f006061d69b3a69ef6
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-22

    Make the passed file path absolute before attempting to load the module

M	ChangeLog
M	nsd/modload.c

commit 41c7a0fd80be6205e0dd61774d55e5bc24377352
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-22

    Initialize Tcl library in the server process only; fix broken SIGINT hadling
    
    Previous signal handling all allowed us to CTRL-C the booting
    process at any time.

M	nsd/nsmain.c

commit ffe3a32f36a8b243b9c09c703178a6d5a451468d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-21

    Build fixes for nsdbtest; build fixes for Darwin
    
    Add MODNAME of nsdbtest so we can do more checks when linking
    the module.
    
    Link against libnsd library when linking new nsdbstest driver.
    
    Removed "-prebind" for Darwin builds.

M	ChangeLog
M	configure.in
M	include/Makefile.global.in
M	m4/tcl.m4
M	nsdbtest/Makefile

commit 5ac0de9c63e1e0ba201db0f37b99aaf8d0654d85
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-21

    Re-born ns_normalizepath as C command

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclfile.c
M	tcl/compat.tcl

commit c1b7c98cc73124ba9466bba85a7ee88a888d229e
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2005-10-21

    Minor fix for test 2.27.1

M	ChangeLog
M	tests/ns_info.test

commit df03d20f0fa67f71c76bc65eb10d1ddd13789407
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-21

    Add missing tracker RFE numbers to ChangeLog entries

M	ChangeLog

commit 466b06005099b80bf694d952c242d99f1b058aaf
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-21

    (Ns_ModuleLoad): don't use per-thread cache for interp of unknown vserver
    
    * nsd/modload.c (Ns_ModuleLoad): Although the first two arguments
    to Ns_ModuleLoad are called server and module, they're really just
    two arbitrary strings passed to the module.  The nsdb module for
    examples passes the driver name and configuration path.  For this
    reason we cannot rely on knowing the current virtual server and
    so cannot allocate an interp from the per-thread cache.

M	ChangeLog
M	nsd/modload.c

commit bad8e59599c9cfce51dc64c3a1ba4a4deaa704d1
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-21

    Add new generalised struct->object mapping code, derived from ns_thread
    
    * include/ns.h:
    * nsd/tclobj.c: Generalise the ns_thread routines for wrapping a C
    structs with a Tcl obj handle.  Slighlty enhanced: also allows
    wrapping of statically allocated C structs which always have a direct
    string name -> struct relationship.
    
    * nsd/tclcmds.c:
    * nsd/tclthread.c: Convert to Tcl objects, remove some duplicated
    code and convert to the new ns:addr Tcl object type interface.
    
    * tests/ns_thread.test: Exercise the ns_thread command and the
    new ns:addr Tcl object type.

M	ChangeLog
M	include/ns.h
M	nsd/tclcmds.c
M	nsd/tclobj.c
M	nsd/tclthread.c
A	tests/ns_thread.test

commit 7380d72d2097cb5eb491b1a32e0113b4e09e47b5
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-21

    Remove unused function declaration

M	ChangeLog
M	nsdbtest/nsdbtest.c

commit 9fc7dc00e807cb191096665f26c6df673362c6af
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-21

    (Ns_TclRegisterTrace): Remove debug logging code

M	ChangeLog
M	nsd/tclinit.c

commit 648065a9d7dddeb5655e2477c5a183db119e25b2
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-21

    (Ns_TclTraceCreate): Run CREATE traces as they are registered
    
    * nsd/nsd.h:
    * nsd/tclinit.c (Ns_TclTraceCreate): Run CREATE traces as they are
    registered in order to make Tcl commands registered by binary
    module available to the boot script and Tcl module files.
    
    * nsd/init.tcl: Rename use of depraciated api.
    
    * nsdb/db.h:
    * nsdb/nsdb.c:
    * nsdb/dbtcl.c: Fix bug where Ns_TclRegisterTrace was being called
    after server startup.
    
    * tests/test.nscfg:
    * tests/ns_accesslog.test: Add stub tests for the nslog module.

M	ChangeLog
M	nsd/init.tcl
M	nsd/tclinit.c
M	nsdb/db.h
M	nsdb/dbtcl.c
M	nsdb/nsdb.c
A	tests/ns_accesslog.test
M	tests/test.nscfg

commit 64b4a30a899906d99c772422ec868ec396e62c51
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-21

    Implement a simple nsdb driver for testing and add the beginnings of some tests

M	ChangeLog
M	Makefile
A	nsdbtest/Makefile
A	nsdbtest/nsdbtest.c
A	tests/nsdb.test
M	tests/test.nscfg

commit 62fc586b9f9b6df3e887bf18d63c4705e6950f62
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-10-20

    Don't use C++ reserved keyword 'delete'

M	ChangeLog
M	include/ns.h

commit e1faae88663b312041a50fe07854a77879f0a27f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-10-20

    Fix Tcl module loading problem

M	ChangeLog
M	nsd/init.tcl

commit 730cd85e0f095b8ab92fab0ef83dc9734b86884d
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2005-10-20

    Add variety of new tests for images, mime, env, conn, info etc.

M	ChangeLog
A	tests/images/broken.gif
A	tests/images/broken.jpg
A	tests/images/color5x200.gif
A	tests/images/color5x200.jpg
A	tests/images/color5x200_progressive.jpg
A	tests/images/empty.gif
A	tests/images/empty.jpg
A	tests/images/small.gif
A	tests/ns_conn.test
A	tests/ns_crypt.test
A	tests/ns_env.test
A	tests/ns_gifsize.test
A	tests/ns_httptime.test
A	tests/ns_info.test
A	tests/ns_jpegsize.test
A	tests/ns_mime.test
A	tests/ns_sha1.test

commit dea1b8da06719204c0329771c54a4dc951cc7220
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-20

    Untabified, indented...

M	nsd/callbacks.c

commit 7dc32cbab3f3ca52081fab87a0effa33df72e433
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-20

    Add options to run registered callbacks in both FIFO and LIFO fashion
    
    All of the start-type callbacks are now executed in FIFO and all
    stop-type in LIFO.

M	ChangeLog
M	nsd/callbacks.c

commit 3377325af011344507a7284282f18064e0598aa7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-10-20

    Fix bug with ns_uuencode segfault on a 1 byte string

M	ChangeLog
M	nsd/tclmisc.c
M	nsd/uuencode.c
A	tests/ns_uuencode.test

commit 9725abdb34a54d3cc0d7e8cb11bb58ec72312cf1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-19

    Ns_ModuleInit failed to create the log file if given relative path to the file

M	ChangeLog
M	nslog/nslog.c

commit 7be9709bc3c23c67ecc76ef8ecb2bd7433625012
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-17

    Add new sub-command: ns_logctl severity, for run-time control
    
    With this you can query and set the status of any of the log
    levels at runtime.  For example, you could log into the control
    port -- ns_logctl severity debug on -- to track down a problem.

M	ChangeLog
M	nsd/log.c
M	tests/ns_log.test

commit d208ea28876c4e3f5a18a6806c463723222af2c6
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-17

    Fix missed initialization of logfile descriptor
    
    This caused us to close invalid descriptor in LogOpen. As the
    result, the interactive NS mode assumed noninteractive use and
    prematurely exited.

M	ChangeLog
M	nslog/nslog.c

commit 2e39f746140db6e80a983804f77b141a9dd0f2e3
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-17

    Use new config routines

M	ChangeLog
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsdb/dbinit.c
M	nslog/nslog.c

commit a78c9892a56abdb4d33d1bde347acc3d99b349cb
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-16

    Log config values at startup; initialize logging earlier
    
    * nsd/config.c: Log the section, key, value and any default, min
    or max whenever a configuration value is looked up.  Log at level
    Debug which by default is off. Can now quickly determine which config
    keys are valid/used.
    
    * nsd/nsmain.c:
    * nsd/nsconf.c:
    * nsd/log.c: Initialise log system earlier -- disable Dev and
    Debug log levels during early boot up.
    
    * nsd/driver.c:
    * nsd/nsd.h: Some logging cleanup.

M	ChangeLog
M	nsd/config.c
M	nsd/driver.c
M	nsd/log.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/nsmain.c

commit 73910debb298ab02855a1201d572259cb1e8304e
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-16

    Drop acinclude.m4 and move dns checking macros into own file in m4 directory; use built-in AC_CHECK_MEMBERS macro

M	ChangeLog
M	Makefile
M	configure.in
R099	acinclude.m4	m4/dns.m4
M	nsd/dns.c

commit 238baea19c89c9b897d0234f6dec796cf42ab92e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-15

    Add MIN/MAX macros since Solaris does not define those in sys/param.h like other OS'es

M	ChangeLog
M	include/nsthread.h

commit c55356574ffb7ba107dde34467dd45ed55eb9e40
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-15

    Reformatted, untabified...

M	ChangeLog
M	nsd/tclfile.c

commit ac03573db6c9aec85dcce6908b7d11d3a056bd70
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-15

    Fix multithreaded DNS bugs, espescially on Darwin
    
    Added checking for HAVE_MTSAFE_DNS and add protective locks if not (Darwin)
    
    Added checking for HAVE_SOCKADDRIN_SIN_LEN because Darwin
    version of getnameinfo fails if sin_len has unsane values.
    
    Fixed bug while processing results of gethostbyname.

M	ChangeLog
M	configure.in
M	nsd/dns.c

commit 4bd9f9fff2b2e6451149ae16e1b96ce0899ba313
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-15

    Added checking for sin_len in sockaddr_in

M	configure.in

commit eabe8b87f67f7083003bbd6ae63f63312bafbcff
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-15

    Removed m4 checking for structure members

M	acinclude.m4

commit ded8f82a56dcd8b2000208f75042836796cb82e4
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-15

    (UnspliceChannel): disable ready-to-fire events in the event queue prior detachment of the channel

M	ChangeLog
M	nsd/tclfile.c

commit 7891e461defa94b40d37bee5ea597497533a4848
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-11

    (StartWatchedServer): clear signal handlers before re-starting the server

M	ChangeLog
M	nsd/nsmain.c

commit 956da8aa11f85e365918678f62b892924e8693f4
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-10

    Fixed one Tcl_Stat() usage which was wrong

M	nsd/fastpath.c

commit 8c64eeff17ce9ac09aba789d701060f54118244f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-10

    Use Tcl_FSStat and Tcl_StatBuf instead of the Tcl_Stat compat wrapper

M	nsd/adpeval.c
M	nsd/fastpath.c

commit 2950d83ec570b4e7e311c24084ed622f5421e673
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-10

    Remove OS/FS fallbacks, use TclVFS wrappers always for ADP
    
    This simplifies code and (hopefully) does not introduce any
    (perceivable) speed penalties.

M	ChangeLog
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/fastpath.c
M	nsd/urlopen.c

commit fac2f9953943f22c46ad1ff2b79fbb3abcf0a6ec
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-10

    Various build fixes and additions to remove generated scripts from CVS control
    
    * Makefile:
    * autogen.sh: New script to run the various autotools to generate
    the build system.
    
    * missing: Add this default automake helper script.
    * configure.in: Initialise automake, even though we don't use it,
    so that we can use aclocal to manage our m4 scripts.
    
    * aclocal.m4:
    * acinclude.m4: Contents of aclocal.m4 now moved to acinclude.m4.
    aclocal.m4 is now autogenerated by the aclocal tool, called from
    within autogen.
    
    * configure:
    * include/nsconfig.h.in: Remove autogenerated scripts from cvs.
    New strategy is to call autogen.sh on first checkout to initialise
    the build environment.
    
    * tcl.m4:
    * m4/tcl.m4: Move into m4 subdirectory.  Upgrade to revision 1.74
    from Tcl cvs.  Fully quote macro names (needs to go upstream).
    
    * .cvsignore:
    * include/.cvsignore: Ignore some new autogenerated build scripts,
    and some old ones we no longer keep in cvs.

M	.cvsignore
M	ChangeLog
M	Makefile
R078	aclocal.m4	acinclude.m4
A	autogen.sh
D	configure
M	configure.in
M	include/.cvsignore
D	include/nsconfig.h.in
R091	tcl.m4	m4/tcl.m4
A	missing

commit 6b2b5258010c855aa25107e28eb72a8a175f9817
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-09

    (ns_moduleload): new command to load a binary module; add ns_atprestartup
    
    * nsd/nsd.h:
    * nsd/modload.c:
    * nsd/nsmain.c:
    * nsd/server.c:
    * nsd/init.tcl: Add new Tcl command ns_moduleload which loads a
    binary module into the server and calls it's initialising
    function.  Remove NsLoadModules and instead call ns_moduleload
    from the init.tcl bootstrap.  Policy about where modules are
    located and when they are loaded is now easily accessible to Tcl.
    
    * nsd/tclcallbacks.c:
    * nsd/tclmisc.c:
    * nsd/tclcmds.c: Add new command ns_atprestartup as a simple
    wrapper for the C equivalent.  Add new command ns_runonce which
    ensures that the given script is run only once, either globally or
    per virtual server, during the lifetime of the server process.
    This simplifies initialization.

M	ChangeLog
M	nsd/init.tcl
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/server.c
M	nsd/tclcallbacks.c
M	nsd/tclcmds.c
M	nsd/tclmisc.c

commit e2ead342d05f161fface47f60407c5659b05baf2
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-09

    MIN and MAX are defined after all, in sys/param.h; don't delete interp, de-allocate

M	ChangeLog
M	include/ns.h
M	include/nsthread.h
M	nsd/modload.c

commit 9c730a0f76124b4db2c2741a39ac3682170fc0b0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-09

    Quiten some compiler complaints
    
    * nsd/rollfile.c (Ns_PurgeFiles): Quiet compiler complaints about
    an uninitialized variable, which was fine.  Add missing error
    return statement.
    
    * nsd/tclimg.c (NsTclGifSizeObjCmd): Clarify signedness of
    character comparisons to quiten compiler.

M	ChangeLog
M	nsd/rollfile.c
M	nsd/tclimg.c

commit 1cc20edf128dfca8e00176c5c7691507c0213ebf
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-09

    (Ns_ModuleLoad): Quiet compiler complaints about pointer aliasing; allocate interp from per-thread cache

M	ChangeLog
M	nsd/modload.c

commit 2cdfb76b4d45749d83c3ee45a5c0f7df16060a8b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-09

    Add definition of MIN and MAX macros used by fastpath.c if not already defined, which aren't standard on e.g. Linux
    
    Convert config.c and driver.c to use this common definition.

M	ChangeLog
M	include/ns.h
M	nsd/config.c
M	nsd/driver.c

commit 9a53ba1fc640435cd6f7becf4cb23f55c24ad9b5
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-09

    Ignore generated nsconfig.h

M	ChangeLog
M	include/.cvsignore

commit fe5e707a808289dccedaaea81be030844263eeb7
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-08

    Fixed GetHost to compile in Linux

M	nsd/dns.c

commit 2a5c0653664c7e01516e41aea861c6dab162ac01
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-08

    Tightened check on process existence in WaitSIGALRMHandler

M	nsd/nsmain.c

commit 1c7b8914bb12abd21d80bf6753e33bbfe73b9be0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-08

    Add alarm of 300 seconds for the watchdog on Darwin
    
    When the alarm triggers, the watchdog re-checks the
    existence of the server process (by sending kill 0) and
    clears nsconf-pid value if the process is gone. This is the
    signal to re-start the server again.
    
    All this mess is needed because under some strange
    circumstances, the WaitForServer() never returns although the
    server process is already gone.
    
    This smells of a broken signal delivery to me...

M	ChangeLog
M	nsd/nsmain.c

commit bfea8549b5605ce101054483375a5539356fce98
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-08

    Use (where possible) Tcl_FS wrappers when handling files on the filesystem
    
    Exceptions are: temp files and logs.
    
    Special cases are in fastpath.c, adpeval.c, adprequest.c and urlopen.c
    where the native call is performed first, and if failed, the Tcl
    companion is tried next. This way the simple but effective VFS
    fallback is assured.

M	ChangeLog
M	include/ns.h
M	include/nscheck.h
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/binder.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/fastpath.c
M	nsd/init.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/nsmain.c
M	nsd/pidfile.c
M	nsd/rollfile.c
M	nsd/tclcmds.c
M	nsd/tclfile.c
M	nsd/tclimg.c
M	nsd/urlopen.c
M	tcl/compat.tcl
M	tests/http_byteranges.test

commit 745677b7bc911f1359c27105b62b078da1d47a0b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-08

    Resolving 0.0.0.0 on Darwin always succeeds hence this test is constrainted on "nonDarwin"

M	ChangeLog
M	tests/ns_hostbyaddr.test

commit a4549a76340ce7b8c07f2f99814e7119f9ce1109
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-08

    Regenerated configure

M	ChangeLog
M	configure

commit 04f3c05b281567ffe2105f54704047cb7552d179
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-08

    Emit warning for Darwin builds about MT-unsafeness of DNS calls (getnameinfo, getaddrinfo)

M	configure.in

commit 5fb575ab55be76be7636602a578a3eb561386de8
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-08

    Add critical sections in GetHost/GetAddr when using getnameinfo/getaddrinfo on Darwin
    
    Also, in GetHost(), explicitly initialize the struct sockaddr_in
    sin_len element because this is needed for the Darwin getnameinfo
    implementation.

M	nsd/dns.c

commit 23f4b01640f0088f95dc6a45f0824dc814369dc1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-05

    Fixed typo in GetAddr using non-mt-safe gethostnbyname

M	nsd/dns.c

commit f710493ff0655c17b8f6fddc23dc3cad316d3788
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-10-05

    LogObjCmd rewritten with Tcl_Obj interface and using TclVFS wrappers for handling files; proper locking when accessing the Log structure elements in the LogObjCmd
    
    Untabified, reformatted, improved comments.

M	ChangeLog
M	nslog/nslog.c

commit 51d65b4c618108aba492912c4fe4c4db63489fd2
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-02

    Remove NsParam* wrapper macros, directly using Ns_Config* is clearer (and grep-able)
    
    * nsd/server.c:
    * nsd/nsconf.c:
    * nsd/queue.c: Use new Ns_Config* routines which handle defaults
    and range checking.  Note: config file values which are less than
    the lower bound of a range are rounded up and not converted to the
    default value, as before.
    
    * nsd/driver.c: Some config defaults have changed.
    * nsd/nsconf.h: Removed.  Incroporated default values directly
    into code.

M	ChangeLog
M	nsd/driver.c
M	nsd/log.c
M	nsd/nsconf.c
D	nsd/nsconf.h
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c

commit 9f5311c228221e5f8281444313741210eeb55f01
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-02

    Untabify, reformat, add CONST declarations and GNUC attributes

M	ChangeLog
M	include/ns.h
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/connio.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/form.c
M	nsd/mimetypes.c
M	nsd/nsd.h
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/request.c
M	nsd/return.c
M	nsd/rollfile.c
M	nsd/str.c
M	nsd/tclrequest.c
M	nsd/unix.c
M	nsd/url.c
M	nsd/urlspace.c

commit 535fa9e9dff39c1566d457eb53d3c43e18986b16
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-02

    Untabify and reformat

M	ChangeLog
M	nsd/adprequest.c
M	nsd/op.c
M	nsd/return.c
M	nsd/urlspace.c

commit 8a0bc08069b914e7cb92c5f3a02041f11beba931
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-10-01

    Tell cvs about files which it should ignore

A	.cvsignore
M	ChangeLog
A	include/.cvsignore
A	nsd/.cvsignore
A	nsthread/.cvsignore

commit 28168111e2f096d4a8ac118b2292f21682bea290
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-08-19

    Don't log host/address not found error messages; these aren't really errors

M	ChangeLog
M	nsd/dns.c

commit 4dc4c401ca69e73814fd6667145e73b9a139232a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-08-19

    Make sure ctype functions are always passed an unsigned char

M	ChangeLog
M	nsd/fastpath.c
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/str.c

commit 1fb8801b132651a32e0c40f70381fdfea6e52535
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-08-19

    (Ns_StrToInt): Convenience function for parsing integers
    
    atoi is not always threadsafe (e.g. Darwin) and makes it
    impossible to handle errors, strtol makes it difficult.

M	ChangeLog
M	include/ns.h
M	nsd/str.c

commit a28201a706e9d7cdabc147fdd6f851f01967e30c
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-08-19

    Untabify and add attributes

M	ChangeLog
M	include/ns.h
M	nsd/str.c

commit 3156c582a1e1f9b3c93dae5cc248bf7b3ba57074
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-08-04

    Finish log localization by removing usage of the global nsconf.log structure

M	ChangeLog
M	nsd/log.c
M	nsd/nsd.h

commit bb38f783adc4288467d204fa2d5b63ba485669c4
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-08-04

    Tcl API changed back for nondefault functions to check number of arguments

M	nsd/tclset.c

commit 7cc61f0b41f20632752c7cf73529f4dded0c00d0
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-08-04

    Add Ns_SetGetValue|Ns_SetIGetValue wrappers which handle defaults

M	ChangeLog
M	include/ns.h
M	nsd/set.c
M	nsd/tclset.c

commit e0017019ae65e272b9b97dfdd83aca21c80e7aaa
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-08-04

    Use efficient table lookups to convert from severity strings to severity levels and back
    
    Localize global log configuration into log.c.
    
    * tests/ns_log.test: Add some simple tests for the ns_log and
    ns_logctl commands.
    
    * tests/all.tcl: tcltest does not actually get confused by log
    messages...

M	ChangeLog
M	nsd/log.c
M	nsd/nsconf.c
M	nsd/nsconf.h
M	nsd/nsd.h
M	tests/all.tcl
A	tests/ns_log.test

commit bb8a22e3bca8548525bb01eff0c594f04e4b9876
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-08-04

    Add config value wrappers which handle defaults and in the case of integer values, range checking

M	ChangeLog
M	include/ns.h
M	nsd/config.c
M	nsd/nsd.h

commit 7b2ae32c40807e5c814ed46fa4c851582fd9e233
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-08-02

    Log a warning when no drivers are configured to listen (bug #1231853)
    
    Driver errors during startup continue to be a non-fatal error.

M	ChangeLog
M	nsd/driver.c

commit cdd611997cc3b8c40dd3efb0e0986065a39d015b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-08-02

    Send panic messages to the server log; add some CONST declarations and GCC attributes
    
    Call Tcl Panic directly from fatal signal handler. Remove
    unneeded call to pthread_kill_other_threads_np.

M	ChangeLog
M	include/ns.h
M	nsd/log.c
M	nsd/unix.c

commit 58eef0706499dd7691181d6aafa5c82b7b0777e0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-08-02

    Untabify, reformat and add CONST declarations

M	ChangeLog
M	include/ns.h
M	nsd/dsprintf.c
M	nsd/dstring.c

commit f914a355050d09d8fa937f968abddc1d044f43d2
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-08-02

    Untabify, reformat and touch up comments

M	nsd/log.c

commit 511adc2af9a059b5bd897e564973fe5250e685a4
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-08-01

    Fix bug preventing sockcallbacks to be used
    
    NS_SOCK_ANY should be 0xff otherwise callback is removed from the queue.

M	ChangeLog
M	include/ns.h

commit dffa964f35e2b69a4f32e6b4dfc2f0490e6af720
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-08-01

    Add 'ns_conn responseversion' and Ns_ConnResponseVersion
    
    Add ns_conn responseversion to manually set response
    protocol and version to have full control about returned HTTP format.
    
    For C API 2 functions are added: Ns_ConnResponseVersion and
    Ns_ConnSetResponseVersion. Added responseVersion char* pointer to
    Conn structure. To enable response version tests ns_httptest needs
    to be changed to return response protocol/version.
    
    * nsd/adprequest.c:
    * tests/http_chunked.test:
    * tests/testserver/pages/http_chunked.adp: detects now whether client
    is HTTP/1.1 and therefore handles chunked encoding.

M	ChangeLog
M	include/ns.h
M	nsd/adprequest.c
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c
M	tests/http_chunked.test
M	tests/testserver/pages/http_chunked.adp

commit f7f89719339dd488af3746fb954a04a99994d9be
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-30

    Untabify and reformat some definitions; remove unused/unneeded NS_AOLSERVER_3_PLUS, NS_SHUTDOWN, NS_REGISTER_SERVER_TRACE

M	ChangeLog
M	include/ns.h

commit 207112c4866e189b42fef608ac07a13488afecb0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-30

    Fix use of ex-compat macro Ns_ConfigGet

M	ChangeLog
M	nslog/nslog.c

commit ad784f9ed7a7f2e583cc9a6611bed58c11b1644e
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-30

    Ensure callers of ns_realloc check the rerturn value; use ckalloc etc. macros consistently for debugging

M	ChangeLog
M	include/nsthread.h
M	nsthread/memory.c

commit cfdff616f98186a5384a214dd3e3e6aadb0ed4ed
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-30

    Remove a bunch of truly ancient compatibility macros and functions

M	ChangeLog
M	include/ns.h
M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/tclfile.c
M	nsd/tclthread.c
M	nsthread/Makefile
D	nsthread/compat.c

commit f6e64ea415cf886ed893bb3849b0e9a256a48cef
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-30

    Remove ns_markfordelete and roll into ns_ictl as ns_ictl markfordelete

M	ChangeLog
M	nsd/init.tcl
M	nsd/tclcmds.c
M	nsd/tclinit.c

commit 610509b131c0cf538104fec1f7e7da59d2836889
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-30

    Add Ns_TclLogErrorInfo and allow admin to configure which connection headers to log for Tcl errors (rfe #1241432)

M	ChangeLog
M	include/ns.h
M	nsd/nsd.h
M	nsd/server.c
M	nsd/tclinit.c
M	nsd/tclmisc.c

commit 6f62c4afea0129d68f655d4329548cfc861c2c48
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-30

    Allocate interps efficiently, max 1 per-thread per-server (rfe #1241351)

M	ChangeLog
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/tclinit.c

commit e1163224db0e47ea4f5556fe0e9e45da888e84fb
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-22

    Untabify and reformat; add CONST declarations

M	ChangeLog
M	include/ns.h
M	nsd/modload.c
M	nsd/nsd.h

commit 9d7df13e71f3f513890b7842260ccea26cd8de4b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-22

    Untabify and reformat; add CONST declarations

M	ChangeLog
M	include/ns.h
M	nsd/config.c
M	nsd/nsd.h

commit 445cf0e44ba6e823753eb684782c94bc41337511
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-21

    Cleanup chunk testing; add some more tests
    
    * tests/ns_adp_chunked.test:
    * tests/http_chunked.test: Rename tests which handle both Tcl and
      ADP.  Add some more tests which highlight a few bugs.
    
    * tests/testserver/pages/ns_adp_chunked.tcl:
    * tests/testserver/pages/http_chunked.adp: Rename file.  Handle
      streaming and non-streaming situations, and actually write out the
      data in two goes.  Add a workaround for a bug in the ns_conn
      chunked switch: detect whether client is HTTP/1.1 and therefore
      handles chunked encoding.  This needs to disappear altogether.
    
    * tests/testserver/pages/ns_tcl_chunked.tcl: Incorporate code
      directly into test file using ns_register_proc.

M	ChangeLog
A	tests/http_chunked.test
D	tests/ns_adp_chunked.test
A	tests/testserver/pages/http_chunked.adp
D	tests/testserver/pages/ns_adp_chunked.adp
D	tests/testserver/pages/ns_tcl_chunked.tcl

commit fd98d8e88e093d2161f39534c8bc350141d77416
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-20

    Add gdbruntest target to run a naviserver command shell under gdb

M	ChangeLog
M	Makefile

commit db345f7fbbd1ce30822b4b57ddcb248c2207d811
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-07-13

    Updated NEWS with latest features and changes

M	ChangeLog
M	NEWS

commit 17a4f99556a0ca3d5484102ceb84c86ab29fc567
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-07-12

    Spool large uploaded content to temp file; 'maxsize' config controls threshold

M	ChangeLog
M	include/ns.h
M	nsd/driver.c
M	nsd/nsd.h

commit d0f747b5f73c4d86db0053749f8e84412b9ff063
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-12

    Fix confusion around the default adp request handler and ns_register_adp; add the missing proc callback info
    
    ns_info requestprocs now gets things right. ns_register_adp will
    also now register the default adp request handler if you don't
    specify an optional file to map.

M	ChangeLog
M	nsd/adprequest.c
M	nsd/nsd.h
M	nsd/proc.c
M	nsd/server.c
M	nsd/tclrequest.c

commit 22fbed39b118659a5399ef4325e9bf284ade213c
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-12

    Consolidate Tcl time functions and object type into one place

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
M	nsd/tclmisc.c
M	nsd/tclobj.c
A	nsd/tcltime.c

commit d846152dfc4f60fab9d5910ccc3efc9c23fe0feb
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-12

    Add generalised interp tracing mechanism which replaces Ns_TclInitInterps
    
    * include/ns.h:
    * nsd/nsd.h:
    * nsd/nsmain.c:
    * nsd/queue.c:
    * nsd/tclcmds.c:
    * nsd/proc.c:
    * nsd/tclinit.c: Add generalised interp tracing mechanism which
    replaces Ns_TclInitInterps, Ns_TclRegisterDeferred
    etc. Restructured code for clarity.
    
    * nsd/tclset.c:
    * nsd/tclshare.c:
    * nsd/tclthread.c:
    * nsd/adprequest.c: s/NsGetInterp/NsGetInterpData/g
    
    * nsd/Makefile:
    * nsd/connio.c:
    * nsd/tclatclose.c: Moved at-close traces into tclinit.c.
    
    * nsd/tclmisc.c: Move Ns_TclPrintfResult into misc.
    
    * nsdb/db.h:
    * nsdb/nsdb.h:
    * nslog/nslog.c:
    * nsperm/nsperm.c: Remove usage of deprecated functions.

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
M	nsd/adprequest.c
M	nsd/connio.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/proc.c
M	nsd/queue.c
D	nsd/tclatclose.c
M	nsd/tclcmds.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/tclset.c
M	nsd/tclshare.c
M	nsd/tclthread.c
M	nsdb/db.h
M	nsdb/dbtcl.c
M	nsdb/nsdb.c
M	nslog/nslog.c
M	nsperm/nsperm.c

commit 95f1f2e651159f5fba58d2212d3c48235f5e9379
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-07-12

    Add tests for chunked encoding from adp files

M	ChangeLog
M	tests/ns_adp_chunked.test
A	tests/testserver/pages/ns_tcl_chunked.tcl

commit f0a871f4281f99069ddb64eed1f0c5b0f509574f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-07-12

    Refactor chunked support to use Ns_ConnClose to send last zero chunk
    
    This makes chunked support universal and can be used in ADP as well.

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/connio.c
M	nsd/return.c
A	tests/ns_adp_chunked.test
A	tests/servers/server1/pages/ns_adp_chunked.adp
A	tests/testserver/pages/ns_adp_chunked.adp

commit bfd19eece83fc4031b2758f64a85419f4ac21208
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-07-10

    Support chunked output encoding
    
    Added support for chunked encoding using conn flag NS_CONN_CHUNKED.
    
    Once set, output routines (Ns_ConnReturnOpenFd|File|Channel and
    Ns_ReturnData) will perform chunked encoding automatically instead of
    raw data output.
    
    From Tcl, ns_conn chunked command is available and if called with
    third parameter 0 or 1 can set/unset conn flag.

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/connio.c
M	nsd/fastpath.c
M	nsd/return.c

commit 1efc249316dd8fb6e353357c6fdfd7938beedbbe
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-07-08

    Small bufgfix for non-mmap mode

M	ChangeLog
M	include/ns.h
M	nsd/connio.c
M	nsd/fastpath.c
M	tests/test.nscfg

commit dd5a5048717a8d5e571f282c5530752dbae5c68d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-07-08

    Use iovec buffers from stack, size is not that big and memory fragmentation will cost more

M	ChangeLog
M	nsd/fastpath.c
M	tests/http_byteranges.test

commit 63da4e4d2567fe419e5910d2b7179ecc67d4838a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-07-08

    Implement full byte-range support, including if-range and multiple-ranges

M	ChangeLog
M	nsd/fastpath.c
M	nsd/nsd.h
M	tests/http_byteranges.test

commit d78295fb12e01a36944dd37c7371d9ae0c4bd727
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-07

    Moved call to Tcl_FinalizeThread to end of TLS cleanup to better catch any cases of Tcl being used outside expected interfaces

M	ChangeLog
M	nsd/tclinit.c
M	nsthread/tls.c

commit 1fe1f7b1145048848c18ae10e1b29d99624d404f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-07

    Alphabetize list of Tcl commands

M	ChangeLog
M	nsd/tclcmds.c

commit 5a1cd9d2ce6be4f020f2301b0cbafe93742bf25d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Clean up some string buffer usage

M	ChangeLog
M	nsd/return.c

commit 9a7861a40b55bfc6328be09e09f547102784f114
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Add backlog arg to Ns_SockListenUnix()

M	ChangeLog
M	include/ns.h
M	nsd/binder.c
M	nsd/driver.c

commit 71fa9c76d38b6f134dc6a78ccb04c6764da13b5f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Localize Windows ifdefs as much as possible

M	ChangeLog
M	nsd/binder.c
M	nsd/driver.c

commit 5d6168fa2ada0f153e3c8958f1da3606aed5c310
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Cleanup config defaults handling; some per-server limits made per-driver

M	ChangeLog
M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsconf.c
M	nsd/nsconf.h
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c
M	nsd/server.c

commit 7ca07b692b0818979efb175000a151e26c8eb3cb
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Add back preliminary support for HTTP range requests

M	ChangeLog
M	NEWS
M	nsd/fastpath.c
M	tests/http_byteranges.test

commit be8a50b69ed035dbd1db09905391c5aef13845b8
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Update version to 4.99.1 and regenerate configure script

M	ChangeLog
M	configure
M	configure.in

commit 12dd3b233fdb8adc40c3e97c9e85966d7775c49f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Tag naviserver-4.99.0

M	.hgtags

commit 3d45035b1b55080bee998b321194e47be20981d6
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    TAG naviserver-4.99.0-release

M	ChangeLog

commit d729d09148011c32d533193115b64b212d24d3d8
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Add DOAP file to list of files to be included in release tarball

M	ChangeLog
M	Makefile

commit 91ee15ae0ea0c7e6ee029c4f69da7ab9210b0d50
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Temporarily remove in-progress support for HTTP Range requests

M	ChangeLog
M	nsd/fastpath.c
M	tests/http_byteranges.test

commit 027877f084e4fd55e013cb720b548c21ebaeab7b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Mention new Ns_ConnPrintfHeaders() function

M	ChangeLog
M	NEWS

commit 62a469a8b9e07a6565e2f3c5701dca2b9bc40c0d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Add release date and remove reference to byte ranges

M	ChangeLog
M	NEWS

commit 38f7598013c6b2a6d0f3407e4007499cbc674762
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Microsoft's feeble compiler can't handle macro varargs, new usage is: NS_GNUC_NONNULL((x, y, z))

M	ChangeLog
M	include/nscheck.h

commit 751569d5a31f1dc3ccfe148ebec8819e0d5deab0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-06

    Add license and category information to DOAP file and fix default namespace so it validates

M	ChangeLog
M	naviserver.rdf

commit 0989dbf7cb7131f1061224b330ebbdca988c53db
Author: Bernd Eidenschink <eidenschink@web.de>
Date:   2005-07-03

    Added a Description-of-a-Project (DOAP) file for NaviServer in XML/RDF notation

A	naviserver.rdf

commit 4f8b946388e85e3dfc89620801bbdc0bd73a27c1
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-07-01

    No longer check whether the response headers have already been sent for Tcl commands
    
    The check was broken and not useful.

M	ChangeLog
M	nsd/cookies.c

commit e1ac4d9a45a8791839436b6abb7d47f3d2a42934
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-30

    (ns_startcontent): fix crash bug when no connection (bug #1230179)

M	ChangeLog
M	nsd/conn.c

commit fe98f7cd0ce58867d1d04cb3b0da12ab10727ea7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-30

    Support multiple ranges

M	ChangeLog
M	nsd/fastpath.c

commit 45374c4d278906b168422fbf7ff1698a953f083f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-30

    Fix failing byte-range tests

M	ChangeLog
M	nsd/fastpath.c

commit 5ca0bec0af78c439368888873ec03f1a2df03219
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-29

    Use the 'knownBug' test constraint to disable multiple-range tests
    
    Use the 'knownBug' test constraint to disable multiple-range tests
    so that they are counted in the 'Skipped' column of the test
    results and are not forgottena about.
    
    Added a new, temporary test for multiple ranges to ensure that
    multiple-range requests are ignored, not half fulfilled.
    
    Re-added test 2.3 which tests multiple, overlapping ranges (non
    canonical in RFC speak); disabled as a 'knownBug'.
    
    Reverted tests 3.1 and 3.2 which check syntactically invalid
    requests are ignored by the server.  An end byte before the
    start byte is never going to work and so is a syntactic error, not
    an unsatisfiable request.
    
    Renamed tests byteranges- from http-.

M	ChangeLog
M	tests/http_byteranges.test

commit 8502059edf13e12e1e57437a8bf9791293be0ca5
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-29

    Disable multiple ranges test, this can be added in the future

M	ChangeLog
M	nsd/fastpath.c
M	tests/http_byteranges.test

commit 00ba7d055b6afd385ee37da91ec1ed8c8c03bea2
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-29

    Add missing ChangeLog entries

M	ChangeLog
M	NEWS
M	include/ns.h
M	nsd/fastpath.c
M	nsd/return.c
M	tests/http_byteranges.test

commit 26a49966d95f5432cb8f6a538ee0c010424b4510
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-29

    Test HTTP byte ranges

M	ChangeLog
A	tests/http_byteranges.test

commit 463fd0540f2cf24c32de889dfabe00c44e778dc7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-28

    (Ns_ConnVSetHeaders): prtinf-style set-headers; support HTTP Range requests

M	ChangeLog
M	include/ns.h
M	nsd/fastpath.c
M	nsd/return.c

commit be9fd133be76b1fbfd1cf283fcfd68c81a6af18b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-27

    Define __GNUC_PREREQ to false if not using GCC compiler
    
    This will automatically disable all GCC-related optimizations.

M	ChangeLog
M	include/nscheck.h

commit ada51b1201596a271b201ac6a3f01b4d29fd849d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-27

    Remove unneeded Ns_ConnReturnPath(), use existing Ns_ConnReturnFile()

M	nsd/return.c

commit eb740108dc79429a142d80fbb497001fd4e10213
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-27

    Improved clarity of code handling nsconf.home path rewritten for the Windows platform

M	nsd/nsmain.c

commit 5c79242cb5ae45a49833d6b323a2e78f7cda8b62
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-27

    Remove ns_failservice, use SIGINT instead; remove experimental ReportException
    
    Removed NsTclFailServiceObjCmd() and tied the processing to the NS_SIGINT
    signal as sent by the -restart option of the "ns_shutdown" command, hence
    avoiding different ways to force server restarts on different platforms.
    
    Removed experimental ReportException() call since it does
    not really seem to prevent the default handling in Windows where
    a Window pops up and the user has to confirm (such behaviour
    prevents the service control manager to restart the service).

M	nsd/nswin32.c
M	nsd/tclcmds.c

commit 0825d3e80aafdb9fcd16458a8a83bbe03197fb27
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-27

    ifdef-ed NsTclFailServiceObjCmd with WIN32 to allow nsd to be compiled on Unix again

M	ChangeLog
M	nsd/tclcmds.c

commit 113f5e7fa23b539b36b582f5b10dda8f9bc5e75f
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Introduced naviserver projects for Visual Studios 6 & 7

A	win32/naviserver.dsw
A	win32/naviserver.sln

commit f0086e5092c55c150b7a1b0f8791710fd01cabfa
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Add missing ChangeLog entries

M	ChangeLog

commit 55d87a186f3039bfd85de0e844aa6e12415d5292
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Removed superfluous CRs at end of lines

M	win32/cgitest/main.c

commit a5d61e2dfb14f173a949c8e3a856850eaaab77d9
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Add missing NS_EXPORTs so that the Windows DLL can get loaded

M	nsthread/compat.c

commit 3b73bec95efc013f061d328ff540f5192779aef4
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Added the ns_failservice command which affects Windows only (see also changes in nswin32.c)

M	nsd/tclcmds.c

commit 88a71ec69304ff7313cbe4bf9270d10c07f132b0
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Add Ns_ConnReturnPath to open a file and send its contents via the connection

M	nsd/return.c

commit 129db8e3cec8d51b7eefcd7454663e14d80b2da3
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Fake nsd-as-a-service failure on Windows in order for the Service Control Manager to restart it automatically

M	nsd/nswin32.c

commit 1f0b1b4b879c614a5605814ab0eef7d2de9036ef
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Corrected normalizing the home path on Windows

M	nsd/nsmain.c

commit 6622777b607e8e5501e4424e9c2ab16f6db3bc6c
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Added missing header for Windows

M	nsd/dns.c

commit 889c21878d1523b348577a96eac89245bf6f0171
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Excluded Unix calls from Windows code since some of the structs needed to compile them are missing in Windows

M	nsd/binder.c
M	nsd/driver.c

commit 75c79b9eaa3923c65c4d6ecee5b606832547c655
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    VC for Windows cannot handle GNU preprocessor directives and macros (fixed)

M	include/nscheck.h

commit 43d3d486d42bf7755542c48a47befc75a0e684a0
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Changed projects to compile for, and link with, mutithreading and debug-enabled libs
    
    (MTd instead of MDd)

M	win32/main/main.dsp
M	win32/nscgi/nscgi.dsp
M	win32/nscp/nscp.dsp
M	win32/nsd/nsd.dsp
M	win32/nsdb/nsdb.dsp
M	win32/nslog/nslog.dsp
M	win32/nsperm/nsperm.dsp
M	win32/nssock/nssock.dsp
M	win32/nsthread/nsthread.dsp

commit ca29456a53bf175d138d5b87f44360a981ca4d86
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Added Visual Studio 7 project for Windows

A	win32/main/main.vcproj
A	win32/nscgi/nscgi.vcproj
A	win32/nscp/nscp.vcproj
A	win32/nsd/nsd.vcproj
A	win32/nsdb/nsdb.vcproj
A	win32/nslog/nslog.vcproj
A	win32/nsperm/nsperm.vcproj
A	win32/nssock/nssock.vcproj
A	win32/nsthread/nsthread.vcproj

commit 5a441784b56ed9d9630b4fabf097edfeb9079f2f
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-24

    Changed banner from AOL to Mozilla Public License

M	nsd/tclset.c

commit 6bc65ef8cdefb8619cabdcefabc8a2ce0d2648d5
Author: Ibrahim Tannir <itannir@archiware.com>
Date:   2005-06-23

    Changed AOLserver to Mozilla wording in the license header

M	nsd/set.c

commit 03c5a9c56ef34ce5887c8be1cc39069b10da84f4
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-19

    Fix bad return code for Ns_ConnReadLine

M	ChangeLog
M	nsd/connio.c

commit dc3085368663d38e8ba85a53477edaf6d360367d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-19

    Add maxline parameter for checking request line size (default 4k)

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h
M	sample-config.tcl

commit b540634b18f89d0a40d1945103d247a1ec9b5439
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-18

    Use Tcl style tests and remove old harness

M	ChangeLog
D	tests/harness.tcl
M	tests/ns_urlencode.test

commit ae1ccff3bfa1ebcc1ecd440808ebd6abe225ebf7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-17

    Add maxinput and bufsize parameters for nsssock section of sample-config.tcl

M	ChangeLog
M	sample-config.tcl

commit 071dd976787eb50cb762108e4f39bcd6f4805d3d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-16

    Reformatted, untabified and adjusted to match style code

M	nsd/driver.c
M	nsd/server.c

commit 39b8db306cf440b96f1c27ef20f5a36d338b7739
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-16

    Remove the "maxpost" configuration option (rfe #1222107)

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/server.c

commit b6e75030744a655c9fb533347e7fd17c1f3bd340
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-15

    Add missing listen call to Ns_SockListenUnix function

M	ChangeLog
M	nsd/binder.c

commit d46934987e7f95e8fcb61346b7038a1ec820ecff
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-14

    Reformat to NaviServer coding style (no functional changes)

M	ChangeLog
M	nsd/adpeval.c

commit 0d7d0dc31df8736caa971b8e8b4ffdec77b04cca
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-13

    Added (untested) implementation of NsMemMap() and NsMemUmap()

M	ChangeLog
M	nsd/nswin32.c

commit 5cb49a14708c531393d0401c446aba119fc05235
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-13

    (Ns_CompressGzip): add missing const qualifier when --without-zlib used

M	ChangeLog
M	nsd/compress.c

commit 130ed455c6e98f0d34ff66ac13239848db302b8b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-13

    Fix compiler warnings: signed/unsigned confusion, uninitialsed variables

M	ChangeLog
M	include/ns.h
M	nscp/nscp.c
M	nsd/adpparse.c
M	nsd/compress.c
M	nsd/listen.c
M	nsd/sock.c
M	nsd/tclimg.c
M	nsd/tclmisc.c
M	nsd/tclresp.c
M	nsd/uuencode.c
M	tests/tclresp.test

commit d21f07b53a439dfe66941d40824f0b4ea67df9ed
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-13

    Simplify code and clarify comment

M	ChangeLog
M	nsd/tclobjv.c

commit 0fbf55bb8b482471b97cc2ece8ce94a0891a2c91
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-13

    Don't use deprecated functions

M	ChangeLog
M	nscgi/nscgi.c

commit 3ba08c67dfbcd45d2db13208dfcaaeb138f2c28c
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-13

    Add Ns_StrIsHost and use it to check host header for virt server path construction
    
    * nsd/str.c: Add new function Ns_StrIsHost.
    
    * include/ns.h:
    * nsd/nsd.h:
    * nsd/driver.c: Save the protocol separate from the location in
    the driver structure and ensure the location always begins with a
    "protocol://" string.
    
    * nsd/server.c:
    * nsd/conn.c:
    * nsd/pathname.c: Simplify code by using protocol direct from
    driver structure and checking Host header with Ns_StrIsHost.

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/pathname.c
M	nsd/server.c
M	nsd/str.c

commit 02a3d1bb0c4aea83dbbefa7acb38863a7a22aa72
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-13

    Remove unused static function SockSetBlocking

M	ChangeLog
M	nsd/tclsock.c

commit 84ac4804235340fa63a4936353299262ac1a84b2
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-12

    Silence "dereferencing type-punned pointer will break strict-aliasing rules" types of warnings

M	ChangeLog
M	nsd/conn.c
M	nsd/info.c
M	nsd/log.c
M	nsd/queue.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsthread/nsthreadtest.c

commit c510eddce1e47a899182bd7c3fe1334bdb8504ec
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-11

    Got rid of another compiler warning

M	ChangeLog
M	nsd/return.c

commit 61f78f1a2f2cbb71ce94dda9ede1881894f80ffb
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-11

    Add and use new attribute NS_GNUC_SENTINEL; say NULL rather than 0 when talking about null pointers
    
    * include/nscheck: Add new attribute NS_GNUC_SENTINEL which
    ensures that a NULL is passed as the last arg to a varargs
    function.  Also, make sure that the format arg in a printf-like
    function is non-NULL.
    
    * include/ns.h: Markup up with NS_GNUC_SENTINEL.
    
    * nsd/urlspace.c:
    * nsd/nslog.c: Say NULL rather than 0 when talking about null pointers.

M	ChangeLog
M	include/ns.h
M	include/nscheck.h
M	nsd/urlspace.c
M	nslog/nslog.c

commit d577f2bc53e169530ecdded6a382a527ac49e856
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-11

    Added wrappers for mem-mapping files in a platform-neutral way
    
    The implementation maps read or write and files are mapped as
    shared. The unix part is implemented. The Windows is still no-op.

M	ChangeLog
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/nswin32.c
M	nsd/unix.c

commit 56fce3c3a0581db09c7f2d598e9df811f49ace78
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-11

    First pass: untabified and formatted so that it can be read by normal humans; no functional changes

M	nsd/nsd.h

commit fa3d5f0f7ac6f15ccbfa5cacf643eb29a130f089
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-11

    First pass: reformatted and untabified

M	nsd/fastpath.c

commit 4224eae8dd82441424fdace5ee492618d2d29811
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-11

    Fixed various log calls with wrong number or wrong types of arguments

M	ChangeLog
M	nsd/driver.c
M	nsd/exec.c
M	nsd/nsmain.c

commit bf8ad835050cc769b9821cb578b60fc300a37a5d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-10

    Rename config.h nsconfig.h to prevent clashes wth module/library config.h files; rebuild configure

M	ChangeLog
M	configure
M	configure.in
R098	include/config.h.in	include/nsconfig.h.in
M	include/nsthread.h

commit f6e294caa5b4c84855defbf8df4d6b25306d1c78
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-10

    Use CONST declarations to silence compiler

M	ChangeLog
M	include/ns.h
M	include/nsthread.h
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/pathname.c
M	nsd/rollfile.c
M	nsd/server.c
M	nsd/set.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclsock.c
M	nslog/nslog.c
M	nsthread/mutex.c

commit c4d9215d2094bbde9e69c4d9a6b84150a15947ae
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-10

    Add a variety of NS_GNUC_* annotations

M	ChangeLog
M	include/ns.h
M	include/nsthread.h

commit 743899c14aae0beef34db54ad122d79a58c3ed0b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-10

    Use NS_RCSD() macro to quieten compiler

M	ChangeLog
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/adprequest.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/cache.c
M	nsd/callbacks.c
M	nsd/cls.c
M	nsd/compress.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/cookies.c
M	nsd/crypt.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/dsprintf.c
M	nsd/dstring.c
M	nsd/encoding.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/filter.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/index.c
M	nsd/info.c
M	nsd/init.c
M	nsd/lisp.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/main.c
M	nsd/mimetypes.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/nsmain.c
M	nsd/nsthread.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/pidfile.c
M	nsd/proc.c
M	nsd/queue.c
M	nsd/quotehtml.c
M	nsd/random.c
M	nsd/request.c
M	nsd/return.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/server.c
M	nsd/set.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/str.c
M	nsd/tclatclose.c
M	nsd/tclcallbacks.c
M	nsd/tclcmds.c
M	nsd/tclconf.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclset.c
M	nsd/tclshare.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/unix.c
M	nsd/url.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsd/uuencode.c
M	nsdb/dbdrv.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsdb/dbutil.c
M	nsdb/nsdb.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nssock/nssock.c
M	nsthread/compat.c
M	nsthread/cslock.c
M	nsthread/error.c
M	nsthread/fork.c
M	nsthread/master.c
M	nsthread/memory.c
M	nsthread/mutex.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	nsthread/reentrant.c
M	nsthread/rwlock.c
M	nsthread/sema.c
M	nsthread/signal.c
M	nsthread/thread.c
M	nsthread/time.c
M	nsthread/tls.c
M	nsthread/winthread.c

commit 05b98e97d3af950bbd238888a6c6d6328e4b6ea7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-10

    Use Ns_PathIsAbsolute for determining valid pathname

M	ChangeLog
M	nsd/binder.c
M	nsd/driver.c

commit 4c3af597c238b95b000be710ed615abf8091644a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-10

    Remove ns_returnbinary; add -binary flag to ns_return

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclresp.c
M	tests/tclresp.test

commit 804845a6c7fb53f669264919cdbb22b82410fadf
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-10

    Attempt to unify usage and call-conventions on various Ns_SockListenXXX and Ns_SockBindXXX
    
    Also, parts not needed for windows build (pre-binding) are ifdef'ed out.
    
    Still open: handling of Unix-domain sockets on Windows. It might compile
    but will definitely not work because of the address parsing issues
    (windows files do not begin with slash).

M	ChangeLog
M	nsd/binder.c

commit 1a05941c7e2ca25e56efa42810e83f990471852b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-10

    Ns_SockBindUdp(), Ns_SockBindRaw() and Ns_SockBindUnix() are now exported from binder.c

M	include/ns.h

commit 0bde506982d98cb9296dbd35e167d0be575773a0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-10

    NsInitBinder is also done for Windows as for Unix

M	nsd/init.c

commit 236a345110fabfdfdfaead159390cb25e15ac9a2
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-10

    Make Ns_SockListenUnix use prebound sockets

M	ChangeLog
M	include/ns.h
M	nsd/binder.c

commit 90aa29d6487a3dc1ff7b7876c36659ec18bbe058
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-10

    Update tests to deal with ns_respond -binary flag

M	ChangeLog
M	tests/tclresp.test

commit ba414bf734ad60715902a81d64410acd51504053
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-10

    First pass: reformatted and untabified

M	nsd/binder.c

commit 7fc20d75d129edd1b516f66827b43a91c0141b3c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-10

    Add missing ChangeLog entries

M	ChangeLog

commit 82e0b1d7777649e560c34febce3c20e90186b9fe
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-10

    Add latest news; remove news which belongs to other modules

M	ChangeLog
M	NEWS

commit 9fb742b5df6890b6d231e6d02f62110d49089e4e
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-10

    Add NsRestoreSignals as no-op for symmetry with Unix; replaced GNU poll implementation

M	nsd/nswin32.c

commit 3313447df694cbeafaed9c1cb9224f52cd151418
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-10

    Enable Tcl CONST checking; add support for extra GCC checks (rfe #1215725)

M	ChangeLog
M	include/Makefile.global.in
A	include/nscheck.h
M	include/nsthread.h

commit 80514ea107202b7a8fdca1f9ff907b2e74804a92
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-10

    Cosmetic changes (reformatted function comments, untabified).

M	nsd/nswin32.c

commit 57f52cc7614a2e1422da8510d5b4634bd4a33631
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-10

    Cosmetic cleanup (reformat some function comments, untabified)

M	nsd/unix.c

commit 93c4062e850f6260627d5ff31c4c8041d6b29966
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-06-10

    Silence some compiler warnings

M	nsd/tclxkeylist.c

commit 17a277f600fef6637bf3768f7e42046739c188e9
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-10

    TCL_DEFS not needed now that autoheader used; call TEA_TIME_HANDLER for time defs; rebuild configure

M	ChangeLog
M	configure
M	configure.in
M	include/Makefile.global.in
M	include/config.h.in

commit fb5248be4947b4cab45fdc19ab17d25b62aea449
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-09

    Add missing TCL_DEFS in the global makefile

M	ChangeLog
M	include/Makefile.global.in

commit 02b36ab05f79d78d3ea837ecca8427a14dd92228
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-09

    Add example of virtual hosting to sample-config.tcl

M	ChangeLog
M	sample-config.tcl

commit e5982526728ddbb9cc57a620f078fcee07b0146c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-08

    Add -binary flag to ns_respond to return binary data without encoding conversion

M	ChangeLog
M	include/ns.h
M	nsd/tclobjv.c
M	nsd/tclresp.c

commit 135ba8775bcdc256bd6e63f6651c95ffee69172c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-08

    Add ns_returnbinary which returns binary data without conversion/encoding

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclresp.c

commit 5b3914a36cd34eae49e01852f51f7ff331a05a49
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-06-08

    Add new modules section into NEWS

M	NEWS

commit 2a3e937020c5c1b25060b22669a3a840cf9b5650
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-08

    Make sure derived files don't end up in the tarball

M	ChangeLog
M	Makefile

commit cbffd679eff479e607f1b442c74e4ce6172c002b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-08

    Add some missing RFE numbers to ChangeLog entries

M	ChangeLog
M	NEWS

commit 1ecae38520fd27914fe52c9d1863618a10f4344b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-08

    Add latest NEWS

M	ChangeLog
M	Makefile
A	NEWS

commit 14ff1571f252ba6719d9d8dab3a803343348d419
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-04

    Add 'dist' Makefile target; rebuild configure

M	ChangeLog
M	Makefile
M	configure
M	configure.in
M	include/Makefile.global.in

commit 0c6ecd82ce7d937ad3cf7b133c60a50011f2e67d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-04

    Move definition of version information from main header into configure script; rebuild configure

M	ChangeLog
M	configure
M	configure.in
M	include/config.h.in
M	include/ns.h

commit 1781c58b2a9cc9d32254e002e8bbe104fc18da65
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-04

    Also remove include/config.h on distclean

M	ChangeLog
M	Makefile

commit 4f4b8763c7a26c4ff2a698d71489dd26b9bda7bd
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-04

    Update configure.in to use an autoheader generated config.h.in; rebuild configure

M	ChangeLog
M	configure
M	configure.in
M	include/Makefile.global.in
A	include/config.h.in
M	include/nsthread.h

commit 1dbd15629d1eec3b11a1a5c00afde39bffe764aa
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-06-04

    Update to revision 1.64 of tcl.m4 from Tcl cvs; rebuild configure

M	ChangeLog
M	configure
M	tcl.m4

commit 8951ccd8f60756f261ab71d80813737f33edcc67
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-05-21

    (NsStartDrivers): fix coredump when bindaddr not set (i.e. it is NULL)

M	ChangeLog
M	nsd/driver.c

commit 60eef1fa2eded8ff1aff5c03077ddf010589d5b6
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-05-20

    Support HTTP over udp/unix sockets; remove obsolete driver functions

M	ChangeLog
M	include/ns.h
M	nsd/driver.c

commit b1668f892f95bb13505259d554bae755536bf0de
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-05-16

    Include tc.m4 macros and convert to Tcl TEA build system
    
    Add messages to all autoconf feature tests.  Remove unneeded
    feature tests.  Rebuild configure script using autoconf 2.59.

M	ChangeLog
M	aclocal.m4
M	configure
M	configure.in
M	include/Makefile.global.in
M	include/Makefile.module.in
A	tcl.m4

commit 2c1e225337946dc4da914d91972c3889ef874fc9
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-05-16

    Remove redundant Ns_InfoLabel(); use Ns_InfoTag() instead

M	ChangeLog
M	include/ns.h
M	nscp/nscp.c
M	nsd/info.c
M	nsd/nsd.h
M	nsd/nsmain.c

commit 524601f1e506c570fb5852ec7ce15b0937f02ad7
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-05-16

    Bump version to 4.99.0 alpha

M	ChangeLog
M	include/ns.h

commit 1e83a13c6732729436ffa13bf5469a1fcc24932b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-05-16

    Silence some compiler warnings

M	ChangeLog
M	include/ns.h
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/conn.c
M	nsd/driver.c
M	nsd/info.c
M	nsd/sock.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclset.c
M	nsd/urlopen.c
M	nsthread/nsthreadtest.c

commit bab5164008f72a97af227758dbbfcaefa8a49657
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-05-15

    Hide global symbols which shouldn't be exported

M	ChangeLog
M	nsd/tcljob.c
M	nsd/tclobjv.c
M	nsd/tclxkeylist.c
M	nsd/unix.c

commit ffe943a9c96aa00ba0c4f72e2ef8ea4504ebff6a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-05-15

    Add new "checkexports" target which prints out a list of global symbols which shouldn't be

M	ChangeLog
M	Makefile

commit 6322162a3d360688785ed33af211bfc5d5a14cc0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-05-14

    Move nsdb module's Tcl file into module directory and add to module shared Tcl install target

M	ChangeLog
M	nsdb/Makefile
R100	tcl/nsdb.tcl	nsdb/util.tcl

commit 75f58eaba7b06cbe4e012b0b05f6c382c64fd056
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-05-14

    Use new TCL variable to install shared Tcl files

M	ChangeLog
M	nsperm/Makefile

commit 3bdb8b3d4e4a329685e77a9738a4c34ada416685
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-05-14

    Add new MODNAME and TCL Makefile variables which modules can use to specify a list of shared tcl files to install

M	ChangeLog
M	include/Makefile.module.in

commit cb34718f1552eb7df22264c49f6bbfa71807809e
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-05-14

    (_ns_sourcemodule): module's shared tcl directory was incorrectly set to private directory

M	ChangeLog
M	nsd/init.tcl

commit 3235a7238eb68a69e723b756d3b17580fc472538
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-05-11

    Add URLDECODE_RELAXED so we can decode '+' to ' ' for compatibility with (broken) AOLserver urlencoder
    
    Disabled by default.

M	ChangeLog
M	nsd/urlencode.c

commit 0b0237b57a4ed34463173c7d62946828c4796bcd
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-05-04

    Conditionally define u_int32_t and u_int8_t for Darwin builds
    
    Some earlier versions (6.x) have those already defined.

M	ChangeLog
M	nsd/tclmisc.c

commit 45c16b991be9490f84e18ef37b65e7f1293d263c
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-05-04

    Modify poll() compatibility wrapper to work on Darwin 10.2 and less
    
    Also, heavily reformatted to be easily readable.

M	ChangeLog
M	nsd/unix.c

commit 48509b7062cbafaae7b9bbda363b590d9ec86818
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-30

    Don't assign chroot directory as default server name; simplify option parsing error messages

M	ChangeLog
M	nsd/nsmain.c

commit 7d31daed64c2ef3cc2decb25a01304d440e0ae1d
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-30

    Add missing ChangeLog entry

M	ChangeLog

commit 8e4da7058768b1c978c5e15cda7a6623448f0d97
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-04-27

    (ns_uudecode): return data as Tcl binary, not string

M	ChangeLog
M	nsd/tclmisc.c

commit dab9633f8a8b67f4f7f6d55db530f3e443d41c2f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Move nsdb public header file into module directory

M	nsdb/Makefile
R100	include/nsdb.h	nsdb/nsdb.h

commit 69e92ea6301d4a56065dbec02dbed153449e0724
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Move stray headers into external modules

M	ChangeLog
D	include/nsextmsg.h
D	include/nspd.h

commit 33ed3e2687ef4b2feeee022d2b3c2f9058af8c53
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Add new module variable LIBHDRS which is the list of headers which should be installed for other modules to link against (e.g. nsdb.h)

M	ChangeLog
M	Makefile
M	include/Makefile.global.in
M	include/Makefile.module.in

commit 15caa3fb9ab7fec9212145f3c189ab568e59220a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Reindent code for consistency prior to making changes

M	ChangeLog
M	include/Makefile.global.in
M	include/Makefile.module.in

commit f07ed2998e7a825d24c085859551b494ec0d9f12
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Add missing file for gzip compression tests

M	ChangeLog
A	tests/testserver/pages/ns_adp_compress.adp

commit 19f2dd779143ca7ced76ceedb6fd42ca82681656
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Add supporting procs for virtual hosting tests

M	ChangeLog
A	tests/testserver/modules/vhost.tcl

commit ab5c569338e3f8096393f36cc46bdd4ab0a4aab1
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Cleanup and reformat code; clarify comments

M	ChangeLog
M	nsd/tclresp.c

commit c8c60da4cedf17ee5efcfd989059d83d20af8bd0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Convert to new nstest_http command and use separate virtual hosts for tests

M	tests/ns_conn_host.test
M	tests/ns_pagepath.test
M	tests/ns_serverpath.test

commit dfd22cf64d9894d657c68e1ce0a1bfd1c2e7b5b0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Convert to new nstest_http command for testing http responses

M	tests/http.test
M	tests/ns_adp_compress.test
M	tests/tclresp.test

commit 73d34d0719e2fb789c1dd91b1f333e5cc0f0d1a2
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Create separate virtual servers for virtual host tests and custom serverroot and conn host tests

M	tests/test.nscfg

commit 7114bb8c61a4408b12e71526e83eada7f4ce8aab
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Add missing 10bytes file for tclresp.test

A	tests/testserver/pages/10bytes

commit aefdb05c245f16a0623cb93a2514f96df93dcad0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-27

    Fix test suite module naming clash
    
    Rename http.tcl testhttp.tcl so that it doesn't override the standard
    tcl/http.tcl file.  Command now correctly only sets default headers once
    so that e.g. the Host header can be overridden.  Retrieve host and port to
    connect to from config file.

D	tests/testserver/modules/http.tcl
A	tests/testserver/modules/testhttp.tcl

commit 12b3b9af13d59cb57944f7cf9ae8b5f2b4c0c36f
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-04-26

    Add support for caching tcl bytecode if ns_cache module is loaded

M	ChangeLog
M	tcl/file.tcl

commit e67155f017e37d336a1032264cc240517cd90727
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-21

    Fixed non-mt-safe usage of timegm() call

M	ChangeLog
M	nsd/httptime.c

commit b189f9c2bd3013eaed1e8eef2975cf2e4cd96501
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-18

    Removed the "ns_conn flush". The trick is done with "ns_headers" cmd

M	ChangeLog
M	nsd/conn.c

commit d65192f938a718c71fc8f1278a8034d038a29055
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-18

    Remove support for connid parameter to tcl response commands (rfe #1156107)

M	ChangeLog
M	Makefile
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclresp.c
A	tests/tclresp.test

commit 04ff9151841f89ed716817e49ae4d6a51d403cf1
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-18

    (Ns_ConnLocationAppend): prevent truncation of content already in dstring when location is appended

M	ChangeLog
M	nsd/conn.c
M	tests/ns_conn_host.test

commit 9833acdbffd0a02199a57019a6bd89005d5ad16e
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-18

    Add helper command nstest_http for test suite; new config parameter ns/parameters/tcllibrary
    
    Tcl shared library can now be set to an arbitrary path.

M	ChangeLog
M	nsd/nsconf.c
M	tests/test.nscfg
A	tests/testserver/modules/http.tcl

commit fb0338a89af7f1e3c3d7a4249cb459b6f7a98b1a
Author: Bernd Eidenschink <b.eidenschink@kinetiqa.de>
Date:   2005-04-17

    Add nsv tests

M	ChangeLog
A	tests/ns_nsv.test

commit c2bf7955c64a2b28381bcb7c01585e09e7c4c6bf
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-17

    ns_conn status <value> will now return the previous status before setting the new status as it did before

M	ChangeLog
M	nsd/conn.c

commit 4abb15e04832822d634fbf469f5078a39b0880d6
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-16

    Untabify, re-ident and cleanup (make it looks more decent than it was)

M	nsd/conn.c

commit 0183c6f7078e1472ea2cb4ea8b5f12b2c40d6b26
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-16

    Add "ns_conn flush" (rfe #1184271); improve "ns_conn status" argument checking

M	ChangeLog
M	nsd/conn.c

commit 50e7fb109dcc3ac6cd7d969ab45e5bf9ebcb8c6d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-16

    Removed extra colon in variable declaration which caused older gcc compilers to break

M	ChangeLog
M	nsd/nsmain.c

commit 3cd832d0da0570eeab31348bb6e03f15471f11be
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-12

    Add callbacks for virtual server support (rfe #1159471)
    
    * include/ns.h:
    * nsd/nsd.h:
    * nsd/info.c:
    * nsd/proc.c:
    * nsd/return.c:
    * nsd/server.c:
    * nsd/fastpath.c:
    * nsd/pathname.c: New concept: server root. Callback can be
    registered to create the server root, defaults to statically
    assigned 'serverroot' from config, or host-based if enabled.
    Many virtual hosting options added. (RFE #1159471)
    
    * nsd/conn.c: Add callback to generate current location. If none
    registered, uses host-header and falls back to driver's location.
    Add new Ns_ConnAppendLocation() as preferred method of access,
    deprecated Ns_ConnLocation().
    
    * nsd/tclcmds.c: Add vhost related Tcl commands: ns_serverpath
    ns_pagepath ns_hashpath ns_serverrootproc ns_locationproc.
    
    * ns_pagepath.test:
    * ns_conn_host.test:
    * ns_serverpath.test:
    * ns_hashpath.test:
    * tests/test.nscfg: Add tests for vhost related commands. More
    location tests needed...

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/fastpath.c
M	nsd/info.c
M	nsd/nsd.h
M	nsd/pathname.c
M	nsd/proc.c
M	nsd/return.c
M	nsd/server.c
M	nsd/tclcmds.c
A	tests/ns_conn_host.test
A	tests/ns_hashpath.test
A	tests/ns_pagepath.test
A	tests/ns_serverpath.test
M	tests/test.nscfg

commit ea05a1df0d37df44bb1a2a5296a50143ef70687a
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-12

    Add proc info for NsFastGet; cleanup source code formatting

M	ChangeLog
M	nsd/proc.c

commit 989e065d246ff01ee1963133ad12dd03a71ce6ac
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-12

    Add missing tests for urlencode fix

M	ChangeLog
A	tests/ns_urlencode.test

commit 27c723896b58c80be647506a90754741db61c8fe
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-09

    Re-enable test for corrupted literal table

M	ChangeLog
M	tests/ns_parseargs.test

commit d0edf7a00f079615fe5a51f20db1547ecb943e68
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-09

    More cleanup in arguments parsing (cosmetic nature)

M	ChangeLog
M	nsd/nsmain.c

commit 6e9bb5eb3eb32c01f84a58bfef8010d933a8cb03
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-09

    Cleanup command help text and parsing of args between Win/unix

M	nsd/nsmain.c

commit 63f74e124e9ef60eea6fca9f7159ff6b13deaf84
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-09

    Do not wholesale invalidate string rep of the object at SetXXFromAny
    
    Doing this seem to corrupt the interp literal table.

M	ChangeLog
M	nsd/tclobjv.c

commit 1ac69a2e7b729d391260e9dbe2266b6670d8aa74
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-09

    (Ns_TclResetObjType): fix broken pointer deref

M	nsd/tclobj.c

commit 6812951bce310e0673427280bf740fd34ea03de7
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-09

    (GetAddr): fix infinite loop bug when calling gethostbyname_r

M	ChangeLog
M	nsd/dns.c

commit 5c30a3aa88cfc029b9dbe19e78368453893d3e87
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-04-08

    Add non-gnu implementation of poll() for compatibility (Darwin 8.0 aka macOS 10.3)

M	ChangeLog
M	nsd/nsd.h
M	nsd/unix.c

commit 0585da4c363e7664f3e42f8d724ea1100f8053e5
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-04-04

    Fix make test: arguments now processed until first non dash parameter

M	ChangeLog
M	nsd/nsmain.c

commit 3dabecf05318aff5896f8bcf07766b38dac6231a
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-04-04

    Remove imported getopt.c; parse command line manually

M	ChangeLog
D	nsd/getopt.c
M	nsd/nsmain.c

commit 27410eb7433a0897be621dad34e6841eb81e7c72
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-04-03

    Add -c command line option to run server in 'shell' mode; add test suite
    
    * nsd/nsd.h:
    * nsd/driver.c:
    * nsd/tclinit.c:
    * nsd/nsmain.c: Add -c command line option which causes the server
    to start in command mode, reading commands from stdin and
    executing them like a tclsh.
    
    * Makefile:
    * tests/test.nscfg:
    * tests/all.tcl: Add new Makefile targets test, runtest and gdb
    which start the server in command mode.  Modify the test runner
    and add a test server config file.
    
    * tests/http.test:
    * tests/ns_addrbyhost.test:
    * tests/ns_adp_compress.test:
    * tests/ns_hostbyaddr.test:
    * tests/ns_hrefs.test:
    * tests/ns_parseargs.test: Update tests to use tlctest syntax and
    features.

M	ChangeLog
M	Makefile
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/tclinit.c
M	tests/all.tcl
M	tests/http.test
M	tests/ns_addrbyhost.test
M	tests/ns_adp_compress.test
M	tests/ns_hostbyaddr.test
M	tests/ns_hrefs.test
M	tests/ns_parseargs.test
A	tests/test.nscfg

commit 1451b9bf0eacf165ab98f696621ca85bdff9aa03
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-04-02

    Add ns_base64encode, ns_base64decode as synonyms for ns_uuencode, ns_uudecode

M	ChangeLog
M	nsd/tclcmds.c

commit 4d5d5690034aff854e9ff3004359ac6870f9f3ee
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-04-02

    (ns_uuencode, ns_uudecode): handle buffer > 40 chars; wrap lines at 60 chars, parse wrapped lines

M	ChangeLog
M	nsd/tclmisc.c
M	nsd/uuencode.c

commit d89c45e0d296e05fb0784c7cd32bff19992fd1ef
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-03-28

    Add ns_info filters, traces, requestprocs using new Tcl callback interface (rfe #1161597)
    
    New commands show information about registered filters/procs same
    way as ns_info scheduled does.

M	ChangeLog
M	nsd/filter.c
M	nsd/info.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/urlspace.c

commit 960125b587d86e29ab278c6f2d812e9e9652b8e7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-03-27

    (Ns_RegisterFilterObj): fix bug with uninitialized 'when' flags

M	ChangeLog
M	nsd/tclrequest.c

commit 8f368226d99aeaccec98a13989dace901cb4d457
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-03-26

    Remove support for old AOLserver connId parameter in request procs
    
    * include/ns.h:
    * nsd/nsd.h:
    * nsd/proc.c:
    * nsd/tclrequest.c: Convert to new callback and parse proc APIs.
    Remove support for old connId parameter.
    
    * tcl/file.tcl:
    * tcl/util.tcl: Remove support for old connId parameter.

M	ChangeLog
M	include/ns.h
M	nsd/nsd.h
M	nsd/proc.c
M	nsd/tclrequest.c
M	tcl/file.tcl
M	tcl/util.tcl

commit 22a196efc2559a67cce21f7f5f47d8806c0303ee
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-03-26

    Add utility routines for calling Tcl code from C callbacks; use new API in scheduler
    
    * include/ns.h:
    * nsd/nsd.h:
    * nsd/Makefile:
    * nsd/tclcallbacks.c: Add routines to support calling Tcl code
    from C for callback events.
    
    * nsd/proc.c:
    * nsd/tclcmds.c:
    * nsd/tclsched.c: Update to use new callback and parse proc APIs.

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
M	nsd/nsd.h
M	nsd/proc.c
A	nsd/tclcallbacks.c
M	nsd/tclcmds.c
M	nsd/tclsched.c

commit b9dc74e584fe4cf87b9e3b428935a71474cf1b8b
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-03-26

    Add cookie routines and commands (rfe #1145957)

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
A	nsd/cookies.c
M	nsd/tclcmds.c

commit 996ca10c819e16f6822307518f7338b02d9d0dd9
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-03-26

    (Ns_ParseObjv): simplify code, fixing an option counting bug; add ns_parseargs; add more parse callbacks; add Ns_TclPrintfResult
    
    * include/ns.h:
    * nsd/nsd.h:
    * nsd/tclobjv.c:
    * nsd/tclcmds.c:
    * tests/ns_parseargs.test: Change the signature of Ns_ObjvProc()s
    to return either TCL_OK, TCL_ERROR or TCL_BREAK.  Fixes a bug
    where options were being double-counted as args.  Also simplified
    the Ns_ObjvProc interface by passing the Ns_ObjvSpec directly.
    
    Added a new Tcl command: ns_parseargs specification args.  It
    parses options, args and handles defaults.
    
    * nsd/tclobj.c: Added some wrapper procs for handling Tcl obj
    types.
    
    * nsd/tclinit.c: Added Ns_TclPrintfResult() as a convenience for
    writing ints into a formatted string result.

M	ChangeLog
M	include/ns.h
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclinit.c
M	nsd/tclobj.c
M	nsd/tclobjv.c
A	tests/ns_parseargs.test

commit 33d23bb0209189088b6aa0b48a2faafd8335f425
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-03-24

    Add missing pubic Ns_SockBindUdp declaration

M	ChangeLog
M	include/ns.h

commit e5929ca2785f438437f708387ed3d83f644c69b4
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-03-22

    Ensure that socket driver's DriverClose callback gets executed when the socket is released
    
    This was causing a memory leak for HTTPS connections with nsopenssl
    when a Keep-Alive HTTP request timed out.

M	ChangeLog
M	nsd/driver.c

commit d60e562523911522a7e3f350714ad54d6d6aae91
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-03-18

    Remove AOLpress code (rfe #1165562)

M	ChangeLog
M	nsd/nsd.h
M	nsd/return.c
M	nsd/server.c
M	tcl/fastpath.tcl

commit 386aa8913dd8d41bf78187c317aa059a3f430e44
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-03-18

    (NsTclWriteContentObjCmd): check reqPtr->avail instead of conn->contentLength

M	nsd/conn.c

commit d8c1fcc34649be84423895a42e24887268799eea
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-03-17

    Add [ns_conncptofp ?-bytes toCopy? channel] (rfe #1156899)

M	ChangeLog
M	nsd/conn.c

commit c3f6f02837c01ac9af858c28aced3353d95cf927
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-03-17

    Add ns_conn channel (rfe #1156141)

M	ChangeLog
M	nsd/conn.c

commit 88fdce90706288570a8179142094d80550fa8ec8
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-03-17

    Add watchdog implementation (rfe #1156875)

M	ChangeLog
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/unix.c

commit 6723cbc2ede736d89597cd2ed30527c5037c1589
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-03-13

    Remove modules nspd and nsext (now in modules repository)

M	ChangeLog
M	Makefile

commit 3017cd81d3beb1198867956b2757dcae714b63dd
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-03-08

    (LogTrace): use lock for extendeded headers; remove call to sleep(1) in ns_accesslog

M	ChangeLog
M	nslog/nslog.c

commit 74f7fb1960dd9f57b5480e66f047856baa50303c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-03-08

    (Ns_ConnSetResponseStatus): return void

M	ChangeLog
M	include/ns.h
M	nsd/conn.c

commit 0d687e39b963bdf810e3a4c8dd46c7ce88900ea4
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-03-07

    Fix segfault in handling of 'rollfmt' parameter

M	ChangeLog
M	nslog/nslog.c

commit 89b7e0fb3985bb85a66fe052c1e40f9863848d05
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-03-06

    Add ns_sha1 command

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclmisc.c

commit d9f078fba77e935a5a4782e687be576b609f341a
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-03-06

    Add objectified interface to TclX keyed lists, string interface backwards compatible

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclxkeylist.c

commit 0acdcda294c9f9e43042809e51a972f218c8dc1d
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-03-05

    (Ns_ConnSetResponseStatus): new routine to set status code, ns_conn status ?status? added

M	ChangeLog
M	doc/Ns_Conn.3
M	include/ns.h
M	nsd/conn.c
M	nslog/nslog.c

commit 8e755dab970b17ac2f674fc39e3ce63abdaec5c0
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-03-04

    (Ns_ParseObjv): support boolean options which take no argument, truth is determined by presence of the option

M	ChangeLog
M	nsd/tclobjv.c

commit 852f77337feebb988d045bb77ede157c6a23deac
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-03-01

    (ns_accesslog): can change logging parameters at runtime

M	ChangeLog
M	nslog/nslog.c

commit 659c000dc13dc0f98fe80b42fbb29222e0f0480f
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-02-28

    (Ns_ParseObjv): short circuit option processing when "--" found; accurately describe optional arguments as optional in error messages

M	ChangeLog
M	nsd/tclobjv.c

commit 762b6b1220e9243572de95b0245a56b1225a9259
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-02-28

    Decode + and other characters in URL paths correctly (bug #1145277)

M	ChangeLog
M	include/ns.h
M	nsd/form.c
M	nsd/request.c
M	nsd/urlencode.c

commit 5b4fff86530b39ed823fd686be00f9c56cd9f8aa
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-02-28

    XML mime types changed to application/xml from text/xml (bug #1145927)
    
    Add a handful of new mime mappings.

M	ChangeLog
M	nsd/mimetypes.c

commit 8295914ccfdbef2d7ceae73939f49e1d1508d7b6
Author: Stephen Deasey <sdeasey@gmail.com>
Date:   2005-02-26

    (Ns_ParseObjv): new command option/arg parsing routines for C code

M	ChangeLog
M	include/ns.h
M	nsd/Makefile
A	nsd/tclobjv.c

commit 6923dee7233428722502ba6dd0e253524237b7ac
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-02-26

    Allow server to run as root if '-u root' given explicitly
    
    Allows server to be started as uid == 0
    if both of the following are true:
    
    - the caller process is running as root (getuid() == 0)
    - "-u root" or "-u 0" was given on the command line
    
    Also, improved and tightented verification of passed user
    and/or group information.

M	ChangeLog
M	nsd/nsmain.c

commit 583fc721492eb6f154247a9e02699ffaa6574ec9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-02-26

    Add Ns_GetNameForUid(), Ns_GetNameForGid()

M	include/ns.h
M	nsd/unix.c

commit b38ad99cc964b9fa0e525cbc3267612bfa42748e
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-02-24

    (ns_info): report NaviServer as NSD_NAME; add missing Ns_SockListen* defs

M	ChangeLog
M	include/ns.h
M	nsd/binder.c
M	nsd/nsd.h

commit 9b70c0d0b3ab3dc7345e2743b69cb5f0b0bcc9d7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-02-22

    (ns_atstartup): new command runs callbacks after server fully initialized

M	ChangeLog
M	doc/ns_at.n
M	nsd/tclcmds.c
M	nsd/tclsched.c

commit 23c11faae9e6e6f5027dd4764f556fc377450fb7
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-02-17

    Add missing ChangeLog entries

M	ChangeLog

commit 896fe0c84c79aa6f25394d069974d6f075070c4f
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-02-17

    (NsTclChanObjCmd): fix crash when moving channel between threads using Tcl 8.4+

M	ChangeLog
M	nsd/tclfile.c

commit 3540b02524beb9a0107d56b696d813b0bd193dcc
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-02-16

    Specify MPL licence in headers; add cc to ns_sendmail; ns_getform returns "" when no conn
    
    License terms in the headers are changed to Mozilla.
    
    sendmail proc extended to support cc as argument and possibly ignore
    error on receiving QUIT response, some mail servers just drop the
    connection and then sendmail generate error.
    
    ns_getform checks for connection and if no connection returns empty
    instead of generate error, to be used safely in schedule scripts when
    same code runs on the Web frontend and backend.

M	Makefile
M	configure.in
M	include/Makefile.build
M	include/Makefile.global.in
M	include/Makefile.module.in
M	include/ns.h
M	include/nsdb.h
M	include/nsextmsg.h
M	include/nspd.h
M	include/nsthread.h
M	sample-config.tcl
M	tcl/charsets.tcl
M	tcl/compat.tcl
M	tcl/debug.tcl
M	tcl/fastpath.tcl
M	tcl/file.tcl
M	tcl/form.tcl
M	tcl/http.tcl
M	tcl/init.tcl
D	tcl/modlog.tcl
M	tcl/nsdb.tcl
M	tcl/sendmail.tcl
M	tcl/util.tcl

commit d9a704356a64355021b9a0a5e511d3d7ba65f3fa
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-02-16

    Initialize logging system earlier to fix crash bug when hostname not found

M	nsd/init.c

commit e5b320d7cc5f0c8aec5f83ab51f76f2c1f591e3c
Author: Vlad Seryakov <vlad@crystalballinc.com>
Date:   2005-02-16

    Binder supports TCP/UDP/ICMP/UNIX; new Ns_SockListen* routines; ns_sockopen -localhost, -localport
    
    Binder support for different protocols added, supported TCP/UDP/ICMP/UNIX
    protocols.
    
    Added Ns_SockListenUdp,Ns_SockListenRaw,Ns_SockListenUnix functions.
    
    Backported sockopen command from 4.1 tree with -localhost/-localport
    options.
    
    db select will reuse exception which driver set otherwise will set
    standard error about wrong query.

M	configure
M	include/Makefile.global.in
M	include/Makefile.module.in
M	nsd/binder.c
M	nsd/tclsock.c
M	nsdb/dbdrv.c

commit d4bee631d7b4f800e5d6986ac19481768a19971d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2005-02-16

    Initial revision

M	ChangeLog
M	Makefile
M	README
D	index.html
D	ini2tcl.tcl
D	nscgi/nscgi.html
D	nscp/nscp.html
M	nsd/binder.c
M	nsd/conn.c
M	nsd/form.c
D	nsd/nsd.html
M	nsd/tclinit.c
M	nsd/tclset.c
D	nsext/Makefile
D	nsext/msg.c
D	nsext/nsext.c
D	nsext/nsext.html
D	nslog/nslog.html
D	nspd/Makefile
D	nspd/listen.c
D	nspd/log.c
D	nspd/main.c
D	nspd/nspd.html
D	nspd/pd.h
D	nsperm/nsperm.html
M	nssock/nssock.c
D	nssock/nssock.html
D	nsssl/Makefile
D	nsssl/certfile-sample.pem
D	nsssl/keyfile-sample.pem
D	nsssl/keygen.tcl
D	nsssl/nsssl.c
D	nsssl/nsssl.html
D	nsssl/ssl.c
D	nsssl/ssl.h
D	nsssl/ssltcl.c
D	nsssl/ssltcl.h
D	nsssl/t_stdlib.c
D	nsssl/x509.c
D	nsssl/x509.h
M	sample-config.tcl
D	tcl2ini.tcl
D	tests/README-tests.txt
D	tests/adp/test1.adp
D	tests/adp/test2.adp
D	tests/adp/test3.adp
D	tests/adp/test4.adp
D	tests/adp/test4.inc
D	tests/adp/test5.adp
D	tests/adp/test5a.adp
D	tests/adp/test6.adp
D	tests/adp/test7.adp
D	tests/adp/test7b.adp
D	tests/adp/test7c.adp
D	tests/adp/test8.adp
D	tests/adp/test8a.adp
D	tests/adp/test8b.adp
D	tests/adp/test9.adp
D	tests/adp/test9.inc
R100	tests/new/all.tcl	tests/all.tcl
D	tests/api/ns_conn.adp
D	tests/api/ns_job.adp
D	tests/api/ns_localtime.adp
D	tests/cdev/test1.adp
D	tests/dbase/test1.adp
R100	tests/new/harness.tcl	tests/harness.tcl
R100	tests/new/http-test-config.tcl	tests/http-test-config.tcl
R100	tests/new/http.test	tests/http.test
D	tests/index.adp
R100	tests/new/ns_addrbyhost.test	tests/ns_addrbyhost.test
R100	tests/new/ns_adp_compress.test	tests/ns_adp_compress.test
R100	tests/new/ns_hostbyaddr.test	tests/ns_hostbyaddr.test
R100	tests/new/ns_hrefs.test	tests/ns_hrefs.test
D	tests/nstelemetry.adp
D	tests/sec/test1.adp
R100	tests/new/servers/server1/pages/ns_adp_compress.adp	tests/servers/server1/pages/ns_adp_compress.adp
D	tests/tcl/test1.tcl
D	tests/tcl/test1a.tcl
D	tests/tcl/test1b.tcl
D	tests/tests.html

commit 29cc53f5eb1600eb4f2f0fc100a01830c142d152
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2005-01-18

    Tag aolserver-4.0.10

M	.hgtags

commit 437d80f46b0e624a947e74601ef3b950be6a75ff
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2005-01-18

    Add missing prototype for Ns_CompressGzip
    
    BUMP: 4.0.10

M	ChangeLog
M	include/ns.h

commit c48574f2ad4c4c59076cb2a947e2685a38273cfa
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2005-01-12

    Support on-the-fly gzip compression of ADP page responses
    
    Based on HTTP request's Accept-Encoding header and
    ns_adp_compress control mechanism.

M	ChangeLog
M	nsd/adpcmds.c
M	nsd/adprequest.c
M	nsd/compress.c
M	nsd/nsd.h
M	nsd/server.c
M	nsd/tclcmds.c
M	tests/new/http-test-config.tcl
A	tests/new/ns_adp_compress.test
A	tests/new/servers/server1/pages/ns_adp_compress.adp

commit 938b9ff7167da5b41e1768cd5c2d5df5fd4765ce
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-12-06

    Implement Ns_GetAllAddrByHost() and [ns_addrbyhost -all] (RFE #999452)
    
    Backport from HEAD for 4.0.10.

M	include/ns.h
M	nsd/dns.c
M	nsd/tclsock.c

commit d0a5c1e29b9493ad663be0f38e473317550995f0
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-12-06

    Backport tests from HEAD

M	tests/new/all.tcl
M	tests/new/harness.tcl
A	tests/new/http-test-config.tcl
A	tests/new/http.test
A	tests/new/ns_addrbyhost.test
A	tests/new/ns_hostbyaddr.test
M	tests/new/ns_hrefs.test
D	tests/new/test-ns_addrbyhost.adp
D	tests/new/test-ns_hostbyaddr.adp
D	tests/new/test-ns_hrefs.adp

commit 8a48a3a57483a9a60a63be420c266e454dff96b9
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-12-01

    Provide NS_VERSION_NUM to make conditionalized testing of version at build time easy

M	ChangeLog
M	include/ns.h

commit a37f4cd8c7ee150b836596223b211431c2199422
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-22

    BUMP: 4.0.10a

M	ChangeLog
M	include/ns.h

commit bfe6835cd48c3b69a20b8be60135b3ca9f6d0c49
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-22

    Tag aolserver-4.0.9

M	.hgtags

commit 5fae827c40355d5d12e3a1c375aa83fad8d24074
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-22

    BUMP: 4.0.9

M	ChangeLog
M	include/ns.h

commit 9915579da2f01622bdc115837a10244cb2630516
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-20

    (ns_schedule_*): fix segfault in option parsing (bug #1068836)
    
    Backport from HEAD.

M	ChangeLog
M	nsd/tclsched.c

commit 237038ff02d22c6b57e5b84a812255cb60669da3
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-20

    Detect if libgcc is built shared and add -lgcc_s to LIBS
    
    Without it, the nsd binary will fail to link because of
    unresolved symbols __umoddi3 and __udivdi3 in nsd/dsprintf.c.

M	ChangeLog
M	configure
M	configure.in

commit 1fbda15116be44d6491ea04bad286463f8623ca0
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-20

    Adding -lz to LIBS is now redundant

M	ChangeLog
M	nsd/Makefile

commit bdaa175b7a5a721f6b91e4382e1f27687f8b1bbe
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-20

    Include <inttypes.h> on OS X, Solaris 10 etc. to get C99 "uint32_t" and other types
    
    Backport from HEAD.

M	ChangeLog
M	include/nsthread.h

commit 4abccda36c9f78b898233794e1679414cc4248a8
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-20

    Add --with-zlib configure option (on by default) and add ifdef's to nsd/compress.c
    
    Backport from HEAD.

M	ChangeLog
M	configure
M	configure.in
M	include/Makefile.global.in
M	nsd/compress.c

commit 7c78492a77875cc61b7cfb22cbed7f67f4ecb496
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-19

    Add new Ns_Compress() function to gzip data using Zlib
    
    Backport from HEAD.

M	include/ns.h
M	nsd/Makefile
A	nsd/compress.c

commit afc7b02879a4eb3fe7b8628aa99f52aca296c6ef
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-17

    Don't send Content-Length if streaming is on
    
    Backport from HEAD.

M	ChangeLog
M	nsd/adprequest.c

commit e7572ae3e45de9154ca68d7b079761692083e3ab
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-15

    Raise fd limit above FD_SETSIZE if specified, logging a warning
    
    AOLserver will now allow setting the fd limit (via "ulimit -Hn", etc.)
    and only log a warning if it exceeds FD_SETSIZE. Do this at your own
    risk, as things which still use select(), i.e., Tcl, are likely to
    break.
    
    Backported from HEAD.

M	ChangeLog
M	nsd/nsmain.c

commit 0f61d20c3ecab066231903cc87021a49378865f6
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-15

    Use AOLSERVER not @prefix@ for module build
    
    Using @prefix@ means you must install to the path specified by --prefix
    otherwise you can't use the install for building extra modules.
    
    Backport from HEAD.

M	include/Makefile.module.in

commit 07a44ee5016df96d804160d130721f5da9083d03
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-11-06

    (SockCallbackThread): dereferencing cbPtr->nextPtr is dangerous since cbPtr could have been freed

M	ChangeLog
M	nsd/sockcallback.c

commit aa67e767d608e9754889443ed69fc8c02c9958c6
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-30

    BUMP: 4.0.9b

M	ChangeLog
M	include/ns.h

commit af2538acd05102dbcadf5a48bba968f22566be3b
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-30

    Implement Ns_SockCancelCallbackEx() to cancel actions in the SockCallbackThread (bug #1037196)
    
    Backported from HEAD for 4.0.9.

M	include/ns.h
M	nsd/sockcallback.c
M	nsd/tclhttp.c

commit 2de76993b9808702cc48581e9a2778af2d90897c
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-29

    (ns_http): fix hang when 'cancel' fails to run (bug #1037196)
    
    Fix a thread hang issue when ns_http fails but HttpCancel() never
    executes because poll() returns revent == POLLPRI.
    
    Backported from HEAD for 4.0.9.

M	ChangeLog
M	include/ns.h
M	nsd/sockcallback.c
M	nsd/tclhttp.c

commit 243d98feb6d132905c9d5e51d5d7fe2bd32f36e0
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-24

    Win32 supports the get{addr,name}info() API, so use it
    
    Backported from HEAD for 4.0.9.

M	ChangeLog
M	include/nsthread.h

commit 1e30c07ad29e613a3426f6be6baf1867506943d9
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-24

    Fix memory leak introduced on platforms w/ getaddrinfo (bug #1033575)
    
    Backport from HEAD for 4.0.9.

M	ChangeLog
M	nsd/dns.c

commit 504a653093718647dd9c4647a5bfe62f4cebf2b5
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-22

    get{addr,name}info on Solaris 9 is in -lsocket
    
    Backported from HEAD.

M	ChangeLog
M	configure
M	configure.in

commit ed4a021b24b335c0f958f609987860eb1a89e7e6
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-22

    Use compiler from Tcl build unless explicitly overridden during AOLserver build
    
    Backported from HEAD for 4.0.9.

M	ChangeLog
M	configure
M	configure.in

commit f7f24101f576d94bac75afd49b0716d7d5720f7d
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-22

    Regenerated configure script

M	configure

commit c2a531ceb349013b54054cbf9fbec9b1218d5839
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-22

    Make detection of gethostby{addr,name}_r more robust (bug #1032231)
    
    Backported from HEAD for 4.0.9.

M	ChangeLog
M	aclocal.m4

commit 8e15de07fc44525bcc461893fc0befe965ca4318
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-21

    Set the dumpable flag on Linux to get a core file after uid/gid is changed (bug #1031599)
    
    Backported from HEAD for 4.0.9a.

M	ChangeLog
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/unix.c

commit 891065410528edfc80b8000a00d823ecc9efe828
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-17

    Ns_ConnSend() now bubbles up the error from NsSockSend() on first send (bug #1029512)
    
    This is what the C API documentation says.
    
    Backported from HEAD for 4.0.9a.

M	ChangeLog
M	nsd/connio.c

commit 4e4ca7c39aacf72e6d437ff6c0710599e7f1cb6f
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-17

    Fix driver shutdown: don't initialize 'stop' to true (bug #1029918)
    
    "stopped" already initialized to 1, which means NsWaitDriversShutdown()
    will never timeout even when it should, which means trigPipe always gets
    closed immediately which causes DriverThread to Ns_Fatal() on line 848.

M	ChangeLog
M	nsd/driver.c

commit 1767cd6b1287938b1e6fa1ee780c975eb32dc668
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-08

    Updated nslog module documentation (bug #466236)
    
    Backported from HEAD.

M	ChangeLog
M	nslog/nslog.html

commit 9ab2543782d7486e0baa1434f115f5e6d1b9a1e8
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-08

    Add datatype for config options to doc
    
    Backported from HEAD.

M	nscgi/nscgi.html

commit ba9e3e5507200fe48900178c6ddcaf48697657fb
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-07

    BUMP: 4.0.9a

M	ChangeLog
M	include/ns.h

commit 4bef115249dab88b979a2857aac356ae5fd5561c
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-07

    Tag aolserver-4.0.8

M	.hgtags

commit 9c6e7fb64dc71c5d9337ce347ab593c6e81a9ac5
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-07

    BUMP: 4.0.8

M	ChangeLog
M	include/ns.h

commit 058a4a0dbd87c6d0e8a3cbd7a51b1e839e35e73f
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-07

    README: updated for 4.0.8

M	README

commit 5b97e9b24b3ba8259cc272617c50b9f43ffa1302
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-09-03

    Updated nscgi module documentation for 4.0 (bug #465907)
    
    Backported from HEAD.

M	ChangeLog
M	nscgi/nscgi.html

commit 1b5603e34c02349a11b2c52db507179978b64578
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-25

    queue.c: if reqPtr is NULL, close the connection too

M	ChangeLog
M	nsd/queue.c

commit ad4c8dbca80227bf6397dd7aeca376cd5281d85c
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-25

    (SockRead): eat stray LF as well as CR/LF pairs after headers
    
    Previous code to eat leading blanks assumed CR/LF, but some clients
    only send LF.  Code has been cleaned up and corrected to handle
    this properly.

M	nsd/driver.c

commit 480d737ce4a6728ca44fa6e5d5b3339be8c58090
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-20

    Implement automated tests that can be run from a stand-alone tclsh
    
    New Makefile target added called "test" which runs the tests.

M	ChangeLog
M	Makefile
A	tests/new/all.tcl
A	tests/new/harness.tcl
A	tests/new/ns_hrefs.test
A	tests/new/test-ns_addrbyhost.adp
A	tests/new/test-ns_hostbyaddr.adp
A	tests/new/test-ns_hrefs.adp

commit 71c3de2aa1b7b5c24cb63685160b610ce96bbba5
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-18

    (_ns_dirlist): add missing slash to directory URLs and redirect (bug #935907)
    
    Backported from HEAD.

M	ChangeLog
M	tcl/fastpath.tcl

commit 560841b2c13a70d25cc33d92c472d14b1a217dcb
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-17

    Minor change to eliminate Win32 compile-time warning (bug #696806)
    
    Backported from HEAD.

M	ChangeLog
M	nsd/fastpath.c

commit 0adff7be818f06d81df4a3cdd4a48fff30d41320
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-14

    Solaris 7 uses gethostbyaddr_r and the autoconf and GetHost versions didn't work
    
    Backported from HEAD.

M	ChangeLog
M	aclocal.m4
M	configure
M	nsd/dns.c

commit 0bb2532ee8215396a9e001ca65b8ad7686c503d8
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-14

    Thread-safe host/name lookup (bug #1008721)
    
    gethostbyaddr() and gethostbyname() are not thread-safe. Use the new
    getaddrinfo() and getnameinfo() API where available, otherwise use
    gethostbyaddr_r() and gethostbyname_r() if available. Otherwise,
    continue to use the non-safe versions but emit a warning at
    configure time. Fixes SF Bug #1008721.
    
    Backported from HEAD.

M	ChangeLog
M	aclocal.m4
M	configure
M	configure.in
M	nsd/dns.c

commit db1c053035b8b7d95d37a4edcdcd914f61080df5
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-13

    Change Win32 .dsp files to reflect change in Tcl from "tcl84td.lib" to "tcl84tg.lib" (bug #996342)
    
    Backported from HEAD.

M	ChangeLog
M	win32/nscgi/nscgi.dsp
M	win32/nscp/nscp.dsp
M	win32/nsd/nsd.dsp
M	win32/nsdb/nsdb.dsp
M	win32/nslog/nslog.dsp
M	win32/nsperm/nsperm.dsp
M	win32/nssock/nssock.dsp
M	win32/nsthread/nsthread.dsp
M	win32/threadtest/threadtest.dsp

commit bd2ec42ff4eb4d447b29d4ae7e5394abe2fecc38
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-13

    ns_hrefs is now more robust -- fixes SF Bug #995078
    
    Backported from HEAD.

M	ChangeLog
M	nsd/tclmisc.c

commit 2e856da58ccaf71c696e1bdd83d1c19b96a18908
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-11

    nsconf.address defaults to 0.0.0.0, fixing crash bug #994072
    
    Backported from HEAD.

M	ChangeLog
M	nsd/nsconf.c

commit 47abb40171927d57324a5b7386352e6f409742a2
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-11

    Fix crash bug when virtual servers are configured but "hostname" parameter didn't match any virtual servers
    
    Fixed by introducing new "defaultserver" parameter in the
    comm. config that must refer to one of the virtual servers
    being defined.
    
    Backported from HEAD.

M	ChangeLog
M	nsd/driver.c

commit c75d00f81aefda1373f97f12dde33077ddea5b50
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-08-11

    Add "defaultserver" parameter in sample config
    
    Backported from HEAD.

M	sample-config.tcl

commit 4b3a7ba7384acb969eb1d6c0a85ed59cdb2eb4c1
Author: Rob Crittenden <rcrittenden0569@aol.com>
Date:   2004-08-05

    Add -servicetime option to ns_http wait so you can capture how long the request took

M	ChangeLog
M	nsd/tclhttp.c

commit 7c2f8370146f06502c26f3115558a7be60558a67
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-29

    BUMP: 4.0.8a

M	ChangeLog
M	include/ns.h

commit 87591a0f218c8eb76a2872aaab10d3b742cba869
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-29

    Clean up configure.in; regenerate configure w/ autoconf2.13; clear CCRPATH/LDRPATH if CCRFLAGS/LDRFLAGS are empty (bug #640754)
    
    Backported from HEAD.

M	configure
M	configure.in

commit 579c154513b5c5393c8e94b9f126187eb847b4fc
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-19

    Tag aolserver-4.0.7

M	.hgtags

commit 2c7cce7bf531746266739eb929b5f589d50c501c
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-19

    BUMP: 4.0.7

M	ChangeLog
M	include/ns.h

commit 0f8279388bd0f288abf47b98cb315b53bfe089ea
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-19

    (Ns_ConnReturnUnauthorized): add WWW-Authenticate header for templated 401 pages (bug #674033)
    
    Backported from HEAD.

M	ChangeLog
M	nsd/return.c

commit 7ba5ab3050dff4b02df118a17dfbe19ad3c1a66a
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-19

    (Ns_InitInfo): initialize conf structures before Ns_Log is used (bug #868362)
    
    Ns_GetAddrByHost() reports errors via Ns_Log(), so calls to it should be
    done after Ns_Log has been initialized, otherwise very unhelpful error
    messages are produced. In particular, this happens when the server is
    started and the hostname as returned by gethostname() cannot be
    resolved, because the network interface is down AND no entry exists in
    /etc/hosts. Closes SF Bug #868362.
    
    Backported from HEAD.

M	ChangeLog
M	nsd/init.c
M	nsd/nsconf.c
M	nsd/nsd.h

commit 094ff302602f35e0c55a668121e6aa110d2efd35
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-16

    Fix crash bug freeing static storage on bad request

M	ChangeLog
M	nsd/driver.c

commit 7fc5513828f13df089c78bcf3f05ebbafeda1228
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-16

    BUMP: 4.0.7a

M	ChangeLog
M	include/ns.h

commit abbbd2ce2464f2c929288c4f1a9c7890e5b8c25e
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-16

    Tag aolserver-4.0.6

M	.hgtags

commit 4341645be865b7e9f1418c8724dc004aa8dca5c3
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-16

    BUMP: 4.0.6

M	ChangeLog
M	include/ns.h

commit bb2965ba0d3c391ef2c663ae2f13ec9127a610a2
Author: Tim Suh <suhti@aol.com>
Date:   2004-07-15

    Enable keep-alive for more response codes: 201, 207, 300

M	ChangeLog
M	nsd/return.c

commit abc5b46194574ba2c48a231f92147afed05fb9e6
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-14

    Host header mandatory for HTTP/1.1 (bug #787728); map default server (bug #812036)
    
    Change to make HTTP request "Host:" header mandatory for HTTP/1.1
    connections by returning 400 Bad Request response. Closes SF Bug
    #787728.
    
    Also, changed virtual server code to use the "hostname"
    param from the "ns/module/nssock" section to map the default
    virtual server based on the value (hostname) from the
    "ns/module/nssock/servers" section, when the "Host:" header is
    either not specified (HTTP/1.0) or is not found in the virtual
    server table. Closes SF Bug #812036.
    
    Backport from HEAD, but not straight patch due to difference
    in conn/request handling in 4.0 vs. 4.1.

M	ChangeLog
M	nsd/driver.c
M	nsd/op.c

commit 5649bf11daf66548ffb126b7cf6ef5e7fe7747e3
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-13

    (LogTrace): check for conn->headers == NULL, segfault (bug #990439)
    
    Backported from HEAD.

M	ChangeLog
M	nslog/nslog.c

commit e68d5fe82834c77700c065d8ee1ec78f369a6cbf
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-13

    Define ENOTSUP for benefit of OpenBSD 3.5 (bug #985076)
    
    Backported from HEAD.

M	ChangeLog
M	include/nsthread.h

commit b9edb0c5126a9e1cfcbaf03fa0dbeb294f46b788
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-02

    (Ns_GetMimeType): return correct mime-type when dir has . but filename doesn't (bug #739049)
    
    Backported from HEAD.

M	ChangeLog
M	nsd/mimetypes.c

commit 790a31073be5e638397a71d865f8959b9bf1cbd0
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-02

    (ns_respond): enable override Last-Modified header when -heades and -file given, bug #879076
    
    Backport from HEAD, for 4.0.6.

M	ChangeLog
M	nsd/fastpath.c
M	nsd/return.c

commit caedafaab9e8cf8336fd413c04b271170e5e18bc
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-02

    Lots of refactoring of ns_respond code to remove duplication.
    
    Backport from HEAD.

M	nsd/tclresp.c

commit 96ec7f1b3590bd8fa04513727270305b5dc2c47b
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-02

    Fix bug #833940: ns_eval chokes on comments
    
    ns_eval of script containing comments (i.e., lines starting with "#")
    cause an error because $args is a list, which gets evaluated differently
    than a plain string script.
    
    Backported from HEAD.

M	ChangeLog
M	nsd/init.tcl

commit 70f4f27e4bdbd7c3be94d667617750e7fa8e710e
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-01

    Fix supplementry groups when -u specified, closes bug #425401
    
    Ensure that supplementary groups from /etc/group are set if -u username
    is specified, or dropped if a uid is specified so that the nsd doesn't
    run with root's supplementary groups.
    
    Backport from HEAD.

M	ChangeLog
M	nsd/nsd.h
M	nsd/nsmain.c

commit 4b85d541cfc5a04d33afb198c591c9e108a56593
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-01

    Trivial - eliminate compiler warning for nsd/nsmain.c

M	nsd/nsd.h

commit e8cd32831a7e385355ad08b7b3ba139efb8dd9e0
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-07-01

    Include full function name in Tcl_Panic call within Ns_TclSet
    
    (Backport from HEAD.)

M	nsthread/tls.c

commit cb512d7973b36f88b4f85eef9086bf398632b889
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-06-30

    Fix synchronous signals under LinuxThreads, possible fix for Bug #982955
    
    Backported from HEAD for 4.0.6.

M	nsd/unix.c

commit 1a98e4618ee979e0e8fd202380c44da4449a76f8
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-06-30

    Fix build on alpha removing extra INT64 typedef, closes bug #896962
    
    (Backport from HEAD.)

M	include/ns.h

commit 3cd785f1a4ac43775ba8d6b8ea7b4f12981b9889
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-06-23

    Ns_ConnSetRequiredHeaders now requires length < 0 for no Content-Length header
    
    (Backport from HEAD.)

M	nscgi/nscgi.c

commit 1c01a88f12aebdda2e613986169ade90c327e590
Author: Rob Crittenden <rcrittenden0569@aol.com>
Date:   2004-06-23

    Make ns_log use a custom logger as well as Ns_Log
    
    Moved the custom logger code from Ns_Log into Log so that Ns_Fatal
    also works properly.

M	ChangeLog
M	nsd/log.c

commit 66bfc5b10ce014a02b0d30b2483050783251a72c
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-06-15

    Fix bug #971016 -- unflushed headers with zero-length file and mmap
    
    unnecessary test for data != NULL actually caused part of bug #971016
    when fastpath.cache=false and fastpath.mmap=true and the file requested
    is zero bytes, mmap() returns 0 which gets passed along as data == NULL,
    causing ReturnCharData() to not flush the queued headers.  removing the
    if is safe as Ns_WriteConn will simply flush any queued data

M	ChangeLog
M	nsd/return.c

commit b5315e9021e3fca09e8e6180aa12ea1aa3464a2c
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-06-15

    Fix bug #971016 -- flush headers with zero-length file and disabled cache
    
    If nsend == 0, we would never call Ns_WriteConn to flush the queued
    headers.  This could happen when we're sending zero bytes of data as a
    response.  This fixes bug #971016 in the case where fastpath.cache=false
    and fastpath.mmap=false and a zero byte file is requested.

M	nsd/connio.c

commit 0b72eb8485be0a9890230ec735a63b598c328789
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-06-14

    Fix Content-Length header for content of zero bytes (bug #971016)

M	ChangeLog
M	nsd/return.c

commit 1b5887433f8423c8c039151680124eb262932e9c
Author: Rob Crittenden <rcrittenden0569@aol.com>
Date:   2004-06-03

    Become AOLserver 4.0.5

M	include/ns.h

commit 7e3d582e8a0499002c753f098a1daf6ca7aa0b69
Author: Rob Crittenden <rcrittenden0569@aol.com>
Date:   2004-06-03

    Don't try to trim empty strings

M	ChangeLog
M	nsd/str.c

commit c1742fad56ff53d3741e6abc6c63370dce65ec8d
Author: Rob Crittenden <rcrittenden0569@aol.com>
Date:   2004-06-03

    Allow HTTP/1.0 Connection: keep-alive for all methods
    
    Add new bool config option, keepaliveallmethods, to enable this.
    By default this is false (disabled).

M	nsd/driver.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/return.c

commit 346a2a51eb094ff879d6672bd863d0bf06dead5b
Author: Rob Crittenden <rcrittenden0569@aol.com>
Date:   2004-06-03

    Provide override functions for Ns_Log and LogFlush
    
    Gives the user more control over how server logging works.

M	include/ns.h
M	nsd/log.c

commit d4bc8d0bd10483f7f5cc11e6a35712a036835391
Author: Rob Crittenden <rcrittenden0569@aol.com>
Date:   2004-06-03

    Tag aolserver-4.0.5

M	.hgtags

commit 667549af3c16f7037141409c2d5ea3fa7d8ecffc
Author: Rob Crittenden <rcrittenden0569@aol.com>
Date:   2004-06-03

    Remove include/Makefile.module on make distclean

M	Makefile

commit 5f8925bda0e3f41fbe619907b614e1ddea27b399
Author: Mark Page <mpagenva@aol.com>
Date:   2004-03-26

    Tag aolserver-4.0.3

M	.hgtags

commit c10d3c14247cd3780388ad21bf4ddfdfc7758494
Author: Mark Page <mpagenva@aol.com>
Date:   2004-03-26

    Add configurable error logging which cause the driver to drop an incoming connection
    
    Logging goes to the server log.  Following new bool config params
    are added to the socket driver's section (e.g., nssock, etc):
    
      readtimeoutlogging
      serverrejectlogging
      sockerrorlogging
      sockshuterrorlogging

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h
M	sample-config.tcl

commit 518c55e64321504374f2c6a25f0549a965fdff13
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-02-27

    Bump version to 4.0.3 (bug #906011)

M	ChangeLog
M	include/ns.h

commit d010b528b6fee50ce735988598c247164e4fb208
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-02-26

    uid_t is supposed to be unsigned, but apparently isn't on OSX, apparently

M	ChangeLog
M	nsd/unix.c

commit 68adb9bf72d739ad2a09f267c30190d7cc03a5d7
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-02-19

    Fix ns_db gethandle -timeout so that when timeout < 0 it blocks forever
    
    Timeout == 0 is poll and timeout > 0 times out after
    timeout seconds.

M	ChangeLog
M	nsdb/dbinit.c
M	nsdb/dbtcl.c

commit 68fae1e5d2dfd1e9f68e24c51387bf15116d5446
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2004-02-18

    Restore old nsperm functionality as it was in 3.x (bug #899364)

M	ChangeLog
M	nsperm/nsperm.c

commit 0dd75d66a71e64a9725ce342be2b5c59c170181b
Author: Mark Page <mpagenva@aol.com>
Date:   2003-11-23

    Tag aolserver-4.0.2

M	.hgtags

commit c62ff60112f9e3af7a18a23f718afdd327250a98
Author: Mark Page <mpagenva@aol.com>
Date:   2003-11-23

    (ns_http): allow methods other than get, put, post; create directories on http put
    
    * nsd/tclhttp.c: remove validity check on method param to ns_http
      queue, since methods in addition to put and post can be valid.
    
    * tcl/fastpath.tcl: make configuable:
      a) logging to serverlog fastpath update requests (some configs
         may be fine with the logging to the access log which can
         be easily obtained).
      b) automatic backfill of implied directory tree on put.

M	ChangeLog
M	nsd/tclhttp.c
M	tcl/fastpath.tcl

commit 2b75e9f86fa8ff030144ffa18b1736c1ff7b7924
Author: Pramod Khincha <pkhincha@aol.com>
Date:   2003-11-20

    Tag aolserver-4.0.1

M	.hgtags

commit 85494176918bf0326128c881a82a1d80e674975f
Author: Pramod Khincha <pkhincha@aol.com>
Date:   2003-11-20

    Fixed ns_shutdown problem of hanging

M	ChangeLog
M	nsd/driver.c

commit 485405b36e3f26bbdf75654b01a9abc3ab36838c
Author: Pramod Khincha <pkhincha@aol.com>
Date:   2003-11-20

    Potential DoS attack fixes; limit the # of bytes on request using maxinput parameter

M	ChangeLog
M	nsd/driver.c
M	nsd/nsd.h

commit 5ac9c157466dd317039ffc761a41b94c66f5b5ab
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-11-16

    Fixed order of driver shutdown wait

M	ChangeLog
M	nsd/nsmain.c

commit b7b6e8af297b406325eb8c6d4b79216701ff3da1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-11-16

    Add missing ChangeLog entries, mostly pre-queue

M	ChangeLog

commit 8869162a9da08ac05bf43021057c17bf9f8feee0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-11-16

    Added new async option to socket driver

M	nssock/nssock.c

commit 15f5d2adba61a617fcc12950a1c73fd59b3c1a67
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-11-16

    Removed unused static functions

M	nsd/tclset.c
M	nsd/tclsock.c

commit a7095010c1cd394478492e955d1a69f7a3ae5b48
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-11-16

    Added general interp tracing API

M	nsd/tclinit.c

commit 32227dea26dc4f9a3d6a4a9bc04a4f3bd838c11e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-11-16

    Removed Conn pre-alloc and maxconns option

M	nsd/server.c

commit 063dc93487723296bbc1e5744d8c2d9bec355575
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-11-16

    Fixed order of init calls

M	nsd/init.c

commit 9b1bfe94682abdb06fadfbd3bd587e15e1e0986b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-11-16

    Restructured mostly to support pre-queue API

M	nsd/driver.c

commit 0cfdb6689283474bfee3ef650b6eae933d79c4bf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-11-16

    Moved I/O buffers to Conn from Sock

M	nsd/conn.c
M	nsd/connio.c
M	nsd/form.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c

commit 7d4ee6760124a6cdf016814472c4ef43656c6ac5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-11-16

    Named binder mutex

M	nsd/binder.c
M	nsd/dns.c

commit 2b558a1bcdcc317a1f66f58948cb021c6e570901
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-11-16

    Updated version, added some defs and functions

M	include/ns.h

commit 931907cea1e73293b8b11ce69667968186227425
Author: Pramod Khincha <pkhincha@aol.com>
Date:   2003-11-03

    Tag aolserver-4.0.0

M	.hgtags

commit 71590087f6bfc9af5259b18b7af56ad2b7206984
Author: Pramod Khincha <pkhincha@aol.com>
Date:   2003-11-03

    Call NsWaitDriversShutdown; remove unnecessary mutex init

M	ChangeLog
M	nsd/nsmain.c
M	nsd/urlspace.c

commit ab3d43964213614919af3d1cce42efc9ee68b24f
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-11-03

    Remove various asserts -- they are not needed in release version

M	nsd/tcljob.c

commit bfa69be8860efda685c41cebfaaa8faa988b6181
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-11-01

    Fix broken argument signature for ns_sourceproc
    
    It causes headaches when called as registered proc.

M	ChangeLog
M	tcl/file.tcl

commit 8f8d1b7422b9c9098816cf151fd0dc050ea2ffb1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-10-28

    Fixed typo in usage text of ns_atclose

M	ChangeLog
M	nsd/tclatclose.c

commit afc355d1a11053fb8f51525a397dcb57a88602c6
Author: Mark Page <mpagenva@aol.com>
Date:   2003-10-21

    Make ns_job use Ns_Time

M	ChangeLog
M	doc/ns_job.n
M	nsd/tcljob.c
M	nsd/tclobj.c
M	tests/api/ns_job.adp

commit 1208d34d205ddfa4332cf544fa347e393ceb0f3a
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-10-21

    Typo in ns_job docs

M	doc/ns_job.n

commit 931b09c4f05cf62b0d9503b12c792c1e04b85305
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-10-21

    Removing lazyproc code from 4.0 to enable it to be declared GM
    
    Solution is being refined and may be provided in later release
    or in add-on module.

M	ChangeLog
M	nsd/init.tcl

commit ec04a6044a2b2b81466742ad3530408098879a79
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-10-17

    Fix bug with -timeout option for ns_job wait and waitany
    
    I was passing relative time instead of absolute time and this caused
    pthread_cond_timedwait to return "EINVAL".

M	nsd/tcljob.c

commit 39c57bdeeb1b37da16e227170d8e8b6037f3ebc1
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-10-14

    Fix bug where JobThread was accessing a deleted queue

M	ChangeLog
M	nsd/tcljob.c

commit 6eab2ba9f86b0dbb3563746f92a178e7734a177a
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-10-09

    Fix a bug with -timeout option of ns_job waitany

M	nsd/tcljob.c

commit efe64860f61334f78225e661fb48127f662fa0f4
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-10-09

    Fix syntax error in check for null proc; tag aolserver_v4_r0_beta_18

M	ChangeLog
M	nsd/init.tcl

commit 8ddd397488c9c5fdbfc4a789dff1f8660c268a09
Author: Mark Page <mpagenva@aol.com>
Date:   2003-10-08

    Tracking change to ns_job joblist return
    
    Tag aolserver_v4_r0_beta_17

M	ChangeLog
M	nsd/init.tcl

commit ab0d280639e69c8ebcdae86c7e8f754c92cfdc3a
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-10-08

    ns_job: start-time becomes epoch seconds; lowercase array names and return values

M	doc/ns_job.n
M	nsd/tcljob.c
M	tests/api/ns_job.adp

commit 7dce179406205a27cd58f7438a9f6da32d8add96
Author: Mark Page <mpagenva@aol.com>
Date:   2003-10-07

    Tag aolserver_v4_r0_beta_16

M	ChangeLog

commit e0d289b6da643a074828b7754b7c0d39a680c7b9
Author: Mark Page <mpagenva@aol.com>
Date:   2003-10-07

    Add ns_eval async completion
    
    The early 4.0 ns_eval had been waiting for the completion of
    integrating script changes into the server's init script.
    
    This change adds the ability to return without waiting for the
    init script integration completion (as the default). A new switch
    modifies this behavior to force it to wait for the completion of
    init script integration.
    
    Added another switch to request a report of ns_eval backlog.

M	ChangeLog
M	nsd/init.tcl

commit 6f8fe0c17c4363b5c0e5eb6973e4928d21bd9926
Author: Mark Page <mpagenva@aol.com>
Date:   2003-10-07

    (LogError): limit amount of script text added to error info
    
    Keeps from flowing adp script texts of unlimited length into
    the server log.

M	ChangeLog
M	nsd/adpeval.c

commit b3b5c8df7765c8163384e21c785ef1a730f5d7fd
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-10-06

    Protect against infinite loop in lazyproc processing when null command is attempted

M	ChangeLog
M	nsd/init.tcl

commit 37fe356af1185f0c4a569f699c04f2bab45c664e
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-10-01

    (_ns_lzproc_load): handle namesapced commands
    
    When loading a command from the global namespace while executing
    from a different namespace, the test in _ns_lzproc_load using the
    'info proc' was failing. However, it succeeds as expected when
    using 'info command'

M	ChangeLog
M	nsd/init.tcl

commit 8aa54395272b383c029500a2a0e7eaf5d92b068d
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-25

    Define snprintf _snprintf on win32

M	include/ns.h

commit e02ff3fe73f64e1964b6218e2823d228abcc8cca
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-24

    Replace ctime_r with ns_ctime: fixes win32 compile problem: bug #811802

M	nsd/tcljob.c

commit 5cd3b495aa615c4fe3f35d402eb2704f6d5c6908
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-23

    Fix deadlock in ns_job code; don't ignore maxthreads option

M	nsd/tcljob.c

commit 661bc8ce3553724b30af4ca13c04290d6f2ad0e1
Author: Mark Page <mpagenva@aol.com>
Date:   2003-09-23

    Tag aolserver_v4_r0_beta_15; add missing ChangeLog entries

M	ChangeLog

commit 6bb64464289e2d04cfdfbf5ef8e6d537f263c229
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-22

    (getNextJob): cleanup list handling

M	nsd/tcljob.c

commit ada24ec4969b4e83d62546d0e57f4c06dee8b01d
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-22

    Minor updates to ns_job docs

M	doc/ns_job.n

commit 6a5c8c0b1323cf694d0572380a7868fa6876b639
Author: Mark Page <mpagenva@aol.com>
Date:   2003-09-19

    Fix ns_adp_include to direct its results to the current output buffer

M	ChangeLog
M	nsd/adpeval.c
M	nsd/adprequest.c

commit e42dfb795c59e454f89d06e5ec89619c28faf7ba
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-19

    Add new APIs threadlist, delete, and genid to docs

M	doc/ns_job.n
M	tests/api/ns_job.adp

commit 6f82ad2ed8c271d55a7052bf266b29738addf638
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-19

    Job pools now global; queues created at runtime; add 'delete' and 'threadlist' sub-commands

M	nsd/tcljob.c

commit 4f2fd77ec821e43c17b166824df94910b0ee1420
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-16

    Updated ns_job tests to latest API additions

M	tests/api/ns_job.adp

commit 3b3c65ce1fa4b2f2328c8e656c8ff75e5fd078bc
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-16

    Add ns_job genID command; add description field to queue; return job's start time

M	nsd/tcljob.c

commit 34588c77be7a237728f9f5d0ddc6e4bad1a7ce31
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-16

    ns_job unit test

A	tests/api/ns_job.adp

commit 05cd26b8842c817ee0fe80ec5b20cb6217678195
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-16

    Fix locking problem with "ns_job wait"; return ID not script result
    
    Fixed the "ns_job jobs" API so that it returns the Job's ID rather
    than Job's results.
    
    Changed "?detached?" to "-detached".
    
    Fixed a problem with thread name by adding a queue "next" thread id.
    
    Moved the job creation outside the queue lock.
    
    Added a separate field for the script.
    
    Added Job Start/End time.
    
    Added timed wait.

M	nsd/tcljob.c

commit bb94f55731126b5b4b30652ed617a55f9acdf436
Author: Mark Page <mpagenva@aol.com>
Date:   2003-09-12

    Tag aolserver_v4_r0_beta_14

M	ChangeLog

commit a832afc40ad3f65497a44fe817ddc736547f9708
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-11

    Minor cleanup to ns_job docs

M	doc/ns_job.n
M	nsd/tcljob.c

commit c26fec8ab52682c6babdd9ef2898540e1a9c0f55
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-11

    Add job_list and queue_list to man page

M	doc/ns_job.n
M	nsd/tcljob.c

commit 46b2c69b6e94adac0bd1aed9bb171c6799648409
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-09-11

    Add 'lazyproc' functionality
    
    Optional configuration allows us to avoid putting all proc
    definitions in the init script for every interpreter. By
    wrapping the tcl 'unknown' command, we initialize procs the
    first time they are referenced.

M	ChangeLog
M	nsd/init.tcl

commit a0d51964afa97a0533059a53b44c92626730d81e
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-05

    Fix typo in error message of ns_job command

M	nsd/tcljob.c

commit 5b25676f00129e4b1c80a58af06d2ff5a6511812
Author: Paul Moosman <pwmoosman@aol.com>
Date:   2003-09-05

    Fill out man page for ns_job

M	doc/ns_job.n

commit def3373085a814c074a17e1deae3bc731e91dc30
Author: Mark Page <mpagenva@aol.com>
Date:   2003-09-04

    Tag aolserver_v4_r0_beta_13

M	ChangeLog

commit c95516c7c2087501389c8ffc30e55cdecb94a9e7
Author: Mark Page <mpagenva@aol.com>
Date:   2003-09-03

    (NsTclICtlObjCmd): Fix intermittent core dump during oncleanup processing
    
    The error is in the Tcl_Obj for the script passed into ns_ictl
    on* callbacks was being saved and passed to the callbacks
    (this Tcl_Obj was then being shared among Interps, which is
    not allowed). Now, extract a copy of the script string, and
    pass that to the callbacks.

M	ChangeLog
M	nsd/tclinit.c

commit 02355d439d2d5751504310ab42954c5a837f1083
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-08-27

    Do not log error for ns_adp_break

M	ChangeLog
M	nsd/adprequest.c

commit f60eb7c97e951b0151d55a187e71f7460ace7075
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-08-26

    Fix 'oncleanup' and add 'ondelete' option for ns_ictl

M	ChangeLog
M	nsd/tclinit.c

commit f96e24a5da7c7b5fba9bf8fd95e6f4e910ed04ed
Author: Mark Page <mpagenva@aol.com>
Date:   2003-08-26

    Tag aolserver_v4_r0_beta_12

M	ChangeLog

commit b4b75f687e49b161f54b55c1bc4c5b6aea807bb2
Author: Mark Page <mpagenva@aol.com>
Date:   2003-08-25

    Fix for HEAD requests

M	ChangeLog
M	nsd/adprequest.c
M	nsd/return.c

commit 6f1c39fc5858bba7ed20198269769274b0645f98
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-08-21

    Correctly detach/attach Tcl channels from and to Tcl interp

M	ChangeLog
M	nsd/tclfile.c

commit 8a4936c7cfe5e832f522c2ad1fe62b0ea4d8a7a9
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-08-19

    Add more WebDAV status codes: 102, 422, 424, 425; further formatting tweaks

M	nsd/return.c

commit 48bec6d2d7091895f3e3f3c58eacebd827e4ca8a
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-08-19

    Formatting tweaks to ChangeLog

M	ChangeLog

commit 33e85cb575cb8da07e4114c966f676a0d1c2369f
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-08-19

    Fixed camel-case issues in status code description

M	nsd/return.c

commit 7d016263efeabdc71d802356d047db084adf3c16
Author: Rahul Bhargava <rahul032213@aol.com>
Date:   2003-08-19

    Add support for Transfer Encoding Chunked
    
    This allows nsd to send the Http 1.1 headers with transfer chunk
    encoding. Upper modules still have to do the job of generating
    the correct chunks etc.
    
    In future we can move this down into connio.c

M	ChangeLog
M	nsd/return.c

commit 729f4428baeff07209b9f7efdf51fad704b1e020
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-08-19

    Add HTTP status codes 100, 101, 203, 207, 300, 307, 402, 416, 417, 423, 507
    
    RFC 2616 (Hypertext Transfer Protocol -- HTTP/1.1)
    RFC 2518 (HTTP Extensions for Distributed Authoring -- WEBDAV)

M	ChangeLog
M	nsd/return.c

commit d4a4c672b7ce30971e8dc11c438ce2ad48f4b0d3
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-08-12

    Do not log ns_adp_abort or ns_adp_break as errors

M	ChangeLog
M	nsd/adprequest.c

commit 8646c04c1c7b4b54522a4f81186d1bb8827aeb19
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-08-08

    Tag aolserver_v4_r0_beta_11

M	ChangeLog

commit 33fb6c8c5b20aad4c46281daf8cf847d6b0fdcc9
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-08-08

    Add support for XHTML MIME Type (RFE: 563417)

M	ChangeLog
M	nsd/mimetypes.c
M	sample-config.tcl

commit 2f72f300f99d88470c19c647f9fbf8d2fe2dc0df
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-08-06

    Fix ns_set split argument checking (bug 757849)

M	ChangeLog
M	nsd/tclset.c

commit 03a20cf334a95489204bad46d7c81f71df5ee533
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-08-06

    Fix formatting of usecs on logreqtime

M	nslog/nslog.c

commit 84491deae8a8ac34edafb87b1c2abe149fef4ce5
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-08-05

    Log request execution time in access log
    
    Merged in feature from 3.5 branch (with simpler implementation).

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nslog/nslog.c
M	sample-config.tcl

commit 4455211e206d415a4e596e8ff83c271d94e6f4eb
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-07-18

    Add optional mutex around interp initialization via new config parm 'tclinitlock'
    
    Useful on servers with large init scripts and many threads to
    avoid malloc lock contention which occurs while Tcl evaluates
    the init script and populates its memory pool.

M	ChangeLog
M	nsd/nsconf.c
M	nsd/nsconf.h
M	nsd/nsd.h
M	nsd/tclinit.c

commit ea1ee296e26685476e647e27dcc9227b4d3f27ea
Author: Mark Page <mpagenva@aol.com>
Date:   2003-07-18

    AdpEval needs to check outputPtr before use

M	ChangeLog
M	nsd/adpeval.c

commit 02f296fb8ddce5fcefa50a5a5b3d64c895a13db1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-07-12

    The "X-Forwarded-For" header existence is examined when logging the remote user
    
    Thus improving logs when users come from proxy servers
    and/or load balancers.

M	ChangeLog
M	nslog/nslog.c

commit cc86773655f24d1a3c6ecd3eb74a581f9c87d60b
Author: Mark Page <mpagenva@aol.com>
Date:   2003-07-10

    Tag aolserver_v4_r0_beta_9

M	ChangeLog

commit 328055b5fdca07ccd9a539d779761ff1476489bd
Author: Mark Page <mpagenva@aol.com>
Date:   2003-07-01

    Protect against deadlock with nested ns_eval calls

M	ChangeLog
M	nsd/init.tcl

commit 86d13c3c275bcb95c5fe092f3a54f0ba7e6fb320
Author: Mark Page <mpagenva@aol.com>
Date:   2003-06-26

    Fix problem where ns_adp_include was not propagating errors

M	ChangeLog
M	nsd/adpeval.c

commit 9b6e378e6cf5442f5add3ffb94c5f0ba710e6999
Author: Mark Page <mpagenva@aol.com>
Date:   2003-06-25

    (_ns_getscript): don't save the special env variable in the init script

M	ChangeLog
M	nsd/init.tcl

commit ccd837ad94bc55842fb0146476ac798c13cd017a
Author: Mark Page <mpagenva@aol.com>
Date:   2003-06-25

    Serialize the non-init usages of ns_eval

M	ChangeLog
M	nsd/init.tcl

commit 0834939a61d688478da9060b522e22411694107e
Author: Mark Page <mpagenva@aol.com>
Date:   2003-06-18

    Fix typo in Ns_ThreadCreate that was causing it to ignore the stacksize param

M	ChangeLog
M	nsthread/thread.c

commit 37bd611bf5d6db306b3c3e6e1765951b88335991
Author: Mark Page <mpagenva@aol.com>
Date:   2003-06-18

    Fix problem with ns_eval where it was bleeding unintended changes to the global interp state

M	ChangeLog
M	nsd/init.tcl

commit 286ea8a0e6b53940addcc712d32a139ba1d5d147
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-06-06

    Fixed bug #749801: connsperthread

M	ChangeLog
M	nsd/queue.c

commit 18c77a0c4bdb7d1a3c02748af1953414e3ae28b8
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-06-03

    ALIBOBJS now set to LIBOBJS since it simplifies static/dynamic linking

M	nspd/Makefile

commit 7a57c28f32f652486b656e7207c4df56d1325065
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-06-03

    Fixed to build static server images for Darwin platform

M	include/Makefile.global.in

commit 197e31a31cbb57119e03f421460426c059344237
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-06-02

    Just leave some paths/flags for both static/dynamic builds since they don't hurt

M	include/Makefile.global.in

commit 0a7bf7365ab704d0773a17688e3272fcf4f191a9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-06-02

    Minor tweaks for seamless dynamic/static linking

M	include/Makefile.global.in
M	include/Makefile.module.in

commit acdc155b5621ad19dee8ac9de25f08ff744afbf0
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-06-02

    Allows static linking of nsd executable in addition to dynamic

M	ChangeLog
M	nsd/info.c
M	nsd/nsmain.c

commit 2056217c7ddb72e3573e7cfe0bfbb1d8983f8c2d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-06-02

    Added --disable-shared option and STATIC_BUILD variable
    
    This is mainly for being able to check with purify memtool.

M	configure
M	configure.in
M	include/Makefile.module.in
M	nsthread/nsthreadtest.c

commit c29df0f1c729a624145442a26ebe1c73127cdf4d
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-06-02

    Replaced call to Tcl_DeleteInterp with the proper call to Ns_TclDestroyInterp

M	nsd/config.c

commit 99951282a0833144082d57b2be6021c64dbac262
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-05-31

    Added Ns_CacheTryLock as in RFE #725704

M	ChangeLog
M	doc/Ns_Cache.3
M	include/ns.h
M	nsd/cache.c

commit 94662c8c93d33ed0bd243f1056d086310e3f7bfd
Author: Mark Page <mpagenva@aol.com>
Date:   2003-05-30

    Fix to 'ns_thread begindetached' to allow it to create detached threads

M	ChangeLog
M	nsd/tclthread.c

commit d51af779a2f9a1517990a3df7c6e4bac3791b9e9
Author: Mark Page <mpagenva@aol.com>
Date:   2003-05-28

    Tag aolserver_v4_r0_beta_8

M	ChangeLog

commit 74f63491185d25b4eed95a15024956e94a59fb9d
Author: Mark Page <mpagenva@aol.com>
Date:   2003-05-28

    Fix to ns_querygetall to suppress null sublists

M	ChangeLog
M	tcl/form.tcl

commit 447a6f99d8f55f74e4ea5b7818991142f46f54c8
Author: Mark Page <mpagenva@aol.com>
Date:   2003-05-28

    Use binary channel to read img; eliminate double error string; correct compiler warning

M	ChangeLog
M	nsd/tclimg.c

commit 75ddfc24bde8c513feae4c1a09ded17fb9806000
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-05-24

    Workaround undefined Tcl_GetMemoryInfo(); call Tcl_FinalizeThread() from DeleteInterps()
    
    Added workaround for Tcl_GetMemoryInfo() which is not
    defined in Tcl if somebody undefines USE_THREAD_ALLOC.
    Generally, this call should be avoided altogether.
    
    Added call to Tcl_FinalizeThread() in the DeleteInterps()
    to properly finalize Tcl data on thread exit, thus closing
    the re-appearing memory leak from V3.3 nsd.

M	ChangeLog
M	nsd/info.c
M	nsd/tclinit.c

commit de1824691b56f341c7a43680ef96c6dd281894e4
Author: Mark Page <mpagenva@aol.com>
Date:   2003-05-21

    Log warnings on bad calls to Ns_TclGetConn and Ns_TclInterpServer

M	ChangeLog
M	nsd/tclinit.c

commit 55ef18cf0cbd20d7a3e5c3da2e6d0829f6f91f2f
Author: Mark Page <mpagenva@aol.com>
Date:   2003-05-21

    Tag aolserver_v4_r0_beta_7

M	ChangeLog

commit a676c342949707a5b58d85886674022ea78ac64b
Author: Mark Page <mpagenva@aol.com>
Date:   2003-05-21

    Error checking calls to ns_adp funcs

M	ChangeLog
M	nsd/adpcmds.c

commit 4da92a20e2205864ebc9c7131d2402eb6a246969
Author: Mark Page <mpagenva@aol.com>
Date:   2003-05-20

    Additional error check on gif reads

M	ChangeLog
M	nsd/tclimg.c

commit eb6631a62d326153882ffea386d08cce4db91c99
Author: Mark Page <mpagenva@aol.com>
Date:   2003-05-20

    Suppress byte-code compile for init scripts, fix fmr ref

M	ChangeLog
M	nsd/tclinit.c
M	nsd/tclthread.c

commit f5468651dd044deb8cd0f7dbc2666c3b3a4e88d1
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-05-16

    Fixed hash table initialization in IncrCount to TCL_ONE_WORD_KEYS instead of TCL_STRING_KEYS

M	ChangeLog
M	nsdb/dbinit.c

commit 8f6c3bc359f0f0ba9daa420a4aba520ad3ec6ae2
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-05-14

    Fixed compatibility to the 3.x ns_event command
    
    Fixed NsTclCondObjCmd to be compatible to the 3.x pendant in
    way it threats the optional timeout argument. The 3.x reverted
    to indefinite (i.e. non-timewait) condvar waits when the
    optional "timeout" argument was given as zero.
    
    The 4.x version just exited with NS_TIMEOUT (= 0) in such
    cases breaking Tcl scripts written for 3.x.
    
    The corrective measure is to check the passed timeout value
    and if == 0, revert to non-timewait condition waits as the
    3.x does (did).

M	ChangeLog
M	nsd/tclthread.c

commit caa8c5979c679b2b4eca49cd82de3c7408c1315f
Author: Mark Page <mpagenva@aol.com>
Date:   2003-05-13

    Tag aolserver_v4_r0_beta_6

M	ChangeLog

commit 3c6386e7bea041d276c0e9db586e7557582cfce0
Author: Mark Page <mpagenva@aol.com>
Date:   2003-05-12

    More ctrs get urlencoded, including +

M	ChangeLog
M	nsd/urlencode.c

commit b9c66c296faf6e2bb90c626367604d3201aa964f
Author: Mark Page <mpagenva@aol.com>
Date:   2003-04-25

    Fix nsv_array exists to return true for empty nsvs

M	ChangeLog
M	nsd/tclvar.c

commit e1c0ae4179157e12667780f856273b6d00554948
Author: Mark Page <mpagenva@aol.com>
Date:   2003-04-24

    Return error status to client on pre-auth error return

M	ChangeLog
M	nsd/queue.c

commit e94a677dcdcbc842c2abe2ac1724e3549e270730
Author: Mark Page <mpagenva@aol.com>
Date:   2003-04-23

    Suppress trailing space on log message

M	ChangeLog
M	nsd/log.c

commit 0e1f754d39cc8182d4a9168643e2995d3f3a2c21
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-04-22

    Fix bug causing first two args to "ns_log" to be improperly concatenated

M	ChangeLog
M	nsd/log.c

commit 39903ed37a3749448c60ca8dd4dddf914f2cb11c
Author: Mark Page <mpagenva@aol.com>
Date:   2003-04-16

    Fixed parsing of explicit module init symbol

M	ChangeLog
M	nsd/modload.c

commit e4924a5bb9bafefc01be20e53ea229fd0e439b00
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-04-10

    Updated .TH to "4.0 AOLserver"

M	doc/Ns_Adp.3
M	doc/Ns_Alloc.3
M	doc/Ns_Auth.3
M	doc/Ns_Cache.3
M	doc/Ns_Cond.3
M	doc/Ns_Config.3
M	doc/Ns_ConnCopy.3
M	doc/Ns_ConnDriver.3
M	doc/Ns_ConnRead.3
M	doc/Ns_ConnRequest.3
M	doc/Ns_ConnReturn.3
M	doc/Ns_ConnSend.3
M	doc/Ns_CritSec.3
M	doc/Ns_DString.3
M	doc/Ns_Db.3
M	doc/Ns_DbDriver.3
M	doc/Ns_DbPool.3
M	doc/Ns_DbSp.3
M	doc/Ns_DbUtil.3
M	doc/Ns_Encrypt.3
M	doc/Ns_Exec.3
M	doc/Ns_ExtDb.3
M	doc/Ns_Fd.3
M	doc/Ns_Fetch.3
M	doc/Ns_Filter.3
M	doc/Ns_HttpTime.3
M	doc/Ns_Htuu.3
M	doc/Ns_Index.3
M	doc/Ns_InetAddr.3
M	doc/Ns_Info.3
M	doc/Ns_IntPrint.3
M	doc/Ns_List.3
M	doc/Ns_Location.3
M	doc/Ns_Log.3
M	doc/Ns_Master.3
M	doc/Ns_Mime.3
M	doc/Ns_Module.3
M	doc/Ns_Mutex.3
M	doc/Ns_Nsd.3
M	doc/Ns_Pathname.3
M	doc/Ns_Pool.3
M	doc/Ns_ProcInfo.3
M	doc/Ns_QuoteHtml.3
M	doc/Ns_RWLock.3
M	doc/Ns_Rand.3
M	doc/Ns_Reentrant.3
M	doc/Ns_Register.3
M	doc/Ns_Request.3
M	doc/Ns_RollFile.3
M	doc/Ns_Sched.3
M	doc/Ns_Sema.3
M	doc/Ns_ServerSpecific.3
M	doc/Ns_Set.3
M	doc/Ns_Signal.3
M	doc/Ns_SockCallback.3
M	doc/Ns_SockErrno.3
M	doc/Ns_SockIO.3
M	doc/Ns_String.3
M	doc/Ns_TclDbGetHandle.3
M	doc/Ns_TclFile.3
M	doc/Ns_TclInit.3
M	doc/Ns_TclRegister.3
M	doc/Ns_TclSet.3
M	doc/Ns_TclThread.3
M	doc/Ns_Thread.3
M	doc/Ns_Thread2.3
M	doc/Ns_ThreadAlloc.3
M	doc/Ns_Time.3
M	doc/Ns_Tls.3
M	doc/Ns_Uid.3
M	doc/Ns_Url.3
M	doc/Ns_UrlEncode.3
M	doc/Ns_UrlSpecific.3
M	doc/Ns_UrlToFile.3
M	doc/ns_addr.n
M	doc/ns_adp.n
M	doc/ns_at.n
M	doc/ns_cache.n
M	doc/ns_checkurl.n
M	doc/ns_config.n
M	doc/ns_conn.n
M	doc/ns_crash.n
M	doc/ns_crypt.n
M	doc/ns_db.n
M	doc/ns_env.n
M	doc/ns_eval.n
M	doc/ns_file.n
M	doc/ns_filter.n
M	doc/ns_getchannels.n
M	doc/ns_geturl.n
M	doc/ns_html.n
M	doc/ns_img.n
M	doc/ns_kill.n
M	doc/ns_library.n
M	doc/ns_markfordelete.n
M	doc/ns_module.n
M	doc/ns_modulepath.n
M	doc/ns_parseheader.n
M	doc/ns_parsequery.n
M	doc/ns_purgefiles.n
M	doc/ns_rand.n
M	doc/ns_requestauthorize.n
M	doc/ns_rollfile.n
M	doc/ns_share.n
M	doc/ns_shutdown.n
M	doc/ns_sleep.n
M	doc/ns_sock.n
M	doc/ns_sync.n
M	doc/ns_tmp.n
M	doc/ns_uuencode.n
M	doc/ns_writefp.n

commit 4277bebe7fbc87f11a9ec2b1fe82aa3a59541e18
Author: Mark Page <mpagenva@aol.com>
Date:   2003-04-10

    Add ChangeLog entry for AOLserver_v4_r0_beta_5 tag

M	ChangeLog

commit 102d08275832335fdbceeb6f0086e63be5cee856
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-04-10

    Synch documentation from aolserver_v35_bp; newer docs were not over-written

M	doc/Ns_Adp.3
M	doc/Ns_Alloc.3
M	doc/Ns_Auth.3
M	doc/Ns_Cache.3
M	doc/Ns_Cond.3
M	doc/Ns_Config.3
M	doc/Ns_ConnCopy.3
M	doc/Ns_ConnDriver.3
M	doc/Ns_ConnRead.3
M	doc/Ns_ConnRequest.3
M	doc/Ns_ConnReturn.3
M	doc/Ns_ConnSend.3
M	doc/Ns_CritSec.3
M	doc/Ns_DString.3
M	doc/Ns_Db.3
M	doc/Ns_DbDriver.3
M	doc/Ns_DbPool.3
M	doc/Ns_DbSp.3
M	doc/Ns_DbUtil.3
M	doc/Ns_Encrypt.3
M	doc/Ns_Exec.3
M	doc/Ns_ExtDb.3
M	doc/Ns_Fd.3
M	doc/Ns_Fetch.3
M	doc/Ns_Filter.3
M	doc/Ns_HttpTime.3
M	doc/Ns_Htuu.3
M	doc/Ns_Index.3
M	doc/Ns_InetAddr.3
M	doc/Ns_Info.3
M	doc/Ns_IntPrint.3
M	doc/Ns_List.3
M	doc/Ns_Location.3
M	doc/Ns_Log.3
M	doc/Ns_Master.3
M	doc/Ns_Mime.3
M	doc/Ns_Module.3
M	doc/Ns_Mutex.3
M	doc/Ns_Nsd.3
M	doc/Ns_Pathname.3
M	doc/Ns_Pool.3
M	doc/Ns_ProcInfo.3
M	doc/Ns_QuoteHtml.3
M	doc/Ns_RWLock.3
M	doc/Ns_Rand.3
M	doc/Ns_Reentrant.3
M	doc/Ns_Register.3
M	doc/Ns_Request.3
M	doc/Ns_RollFile.3
M	doc/Ns_Sched.3
M	doc/Ns_Sema.3
M	doc/Ns_ServerSpecific.3
M	doc/Ns_Set.3
M	doc/Ns_Signal.3
M	doc/Ns_SockCallback.3
M	doc/Ns_SockErrno.3
M	doc/Ns_SockIO.3
M	doc/Ns_String.3
M	doc/Ns_TclDbGetHandle.3
M	doc/Ns_TclFile.3
M	doc/Ns_TclInit.3
M	doc/Ns_TclRegister.3
M	doc/Ns_TclSet.3
M	doc/Ns_TclThread.3
M	doc/Ns_Thread.3
M	doc/Ns_Thread2.3
M	doc/Ns_ThreadAlloc.3
M	doc/Ns_Time.3
M	doc/Ns_Tls.3
M	doc/Ns_Uid.3
M	doc/Ns_Url.3
M	doc/Ns_UrlEncode.3
M	doc/Ns_UrlSpecific.3
M	doc/Ns_UrlToFile.3
M	doc/ns_addr.n
M	doc/ns_adp.n
M	doc/ns_at.n
M	doc/ns_cache.n
M	doc/ns_checkurl.n
M	doc/ns_config.n
M	doc/ns_conn.n
M	doc/ns_crash.n
M	doc/ns_crypt.n
M	doc/ns_db.n
M	doc/ns_env.n
M	doc/ns_eval.n
M	doc/ns_file.n
M	doc/ns_filter.n
M	doc/ns_getchannels.n
M	doc/ns_html.n
M	doc/ns_httptime.n
M	doc/ns_img.n
M	doc/ns_info.n
M	doc/ns_kill.n
M	doc/ns_library.n
M	doc/ns_log.n
M	doc/ns_logroll.n
M	doc/ns_markfordelete.n
M	doc/ns_module.n
M	doc/ns_modulepath.n
M	doc/ns_normalizepath.n
M	doc/ns_parseheader.n
M	doc/ns_parsequery.n
M	doc/ns_proc.n
M	doc/ns_purgefiles.n
M	doc/ns_rand.n
M	doc/ns_requestauthorize.n
M	doc/ns_return.n
M	doc/ns_rollfile.n
M	doc/ns_sched.n
M	doc/ns_set.n
M	doc/ns_share.n
M	doc/ns_shutdown.n
M	doc/ns_sleep.n
M	doc/ns_sock.n
M	doc/ns_sync.n
M	doc/ns_thread.n
M	doc/ns_time.n
M	doc/ns_tmp.n
M	doc/ns_url2file.n
M	doc/ns_urlencode.n
M	doc/ns_uuencode.n
M	doc/ns_writefp.n

commit 29b6c21c11d8faf9cc4cf901524e02d10042aaf5
Author: Mark Page <mpagenva@aol.com>
Date:   2003-04-10

    Fix 'rename' when sourcing Tcl library files

M	nsd/init.tcl

commit 465bec6555db04c96467fe0d9d9757581978c84b
Author: Mark Page <mpagenva@aol.com>
Date:   2003-04-07

    Cleanup and consolidate use of conf.started flag

M	nsd/nsmain.c
M	nsd/tclthread.c

commit 2030bd66f2f0ade72148e8cd61fd6723d9f00713
Author: Mark Page <mpagenva@aol.com>
Date:   2003-04-07

    Sync tclthread startup with server start

M	ChangeLog
M	nsd/tclthread.c

commit 4529043a6d1efce5cc6fbcb2b3d344a8cfd34c3d
Author: Mark Page <mpagenva@aol.com>
Date:   2003-04-04

    Moved interp trace functionality into ns_ictl

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclinit.c

commit 3e9b8f7fae073573154afbdecd0d1322bb373fae
Author: Mark Page <mpagenva@aol.com>
Date:   2003-04-03

    Define ns_register_interptrace

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclinit.c

commit af4a8ccf35885229e7c98377ddad6c18b5e0fd47
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2003-04-01

    Improved Ns_DriverInit changes made earlier per Jim's input

M	nsd/driver.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit 7abdd55a0c20ee513e4df8560a38186452b4898f
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2003-03-31

    Modified Ns_DriverInit to take new Ns_DriverInitData structure
    
    Instead of passing all args as parameters to Ns_DriverInit, a
    comm module must now create an Ns_DriverInitData structure and
    populate it with appropriate values (see include/ns.h) and pass
    that in the call to Ns_DriverInit. The Ns_DriverInitData
    structure is versioned so that we can extend it later without
    affecting other modules.

M	ChangeLog
M	include/ns.h
M	nsd/driver.c
M	nssock/nssock.c
M	nsssl/nsssl.c

commit c1a6c20d2efe655c6491c144e35159f1a7792667
Author: Mark Page <mpagenva@aol.com>
Date:   2003-03-28

    Fix to tclhttp.c, uninitialized var hdrs

M	ChangeLog
M	nsd/tclhttp.c

commit 93ce0b07bc75c0a4ac19729af492ce0e3d6d35e7
Author: Mark Page <mpagenva@aol.com>
Date:   2003-03-21

    beta4 tag

M	ChangeLog

commit 8ceb4a87902c58260c8bf34e7e41197ec725ea87
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-03-19

    Add missing ChangeLog entry about aolserver_v4_r0_beta_3 tag

M	ChangeLog

commit acb0c9b5edb12cf60754e4a8de765b491e1faf48
Author: Mark Page <mpagenva@aol.com>
Date:   2003-03-19

    Add method arg to ns_http queue api to allow sending POST as well as GET
    
    Also fixed some minor formatting.

M	ChangeLog
M	nsd/tclhttp.c

commit 121471671a8c380c8cef1ecc62b1940a9894e3a8
Author: Mark Page <mpagenva@aol.com>
Date:   2003-03-19

    Change back to ns_socketpair for local proxies

M	ChangeLog
M	nsext/nsext.c

commit b16bd3bfd5e832620a771b4bf8f1b99e2a4c94fe
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-03-19

    Added fallback for loading shared libs in addition to bundles for Darwin

M	ChangeLog
M	nsd/modload.c

commit 50e30354534886b8c74ecae6ef5132e1b27745ec
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-03-19

    Added Ns_GetVersion similar to Tcl_GetVersion and set of supporting macros

M	include/ns.h
M	nsd/config.c

commit 049bf3fbbc2f67a61d3c1762e8914692cef41a0b
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-03-13

    Bugfix for #703061

M	include/ns.h

commit 0eb3822b9a1049b44d25607d27ecbc2d8a46f583
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2003-03-11

    Set SERVER_NAME correctly for cgi programs

M	ChangeLog
M	nscgi/nscgi.c

commit 6d8c18424a0befbf781e078da9f9a61b15272e71
Author: Mark Page <mpagenva@aol.com>
Date:   2003-03-10

    Additional change to control loop for sched thread shutdown of event threads

M	nsd/sched.c

commit 9697ad0c2ef435351d2ef96fec3de9dc1b238339
Author: Mark Page <mpagenva@aol.com>
Date:   2003-03-10

    Fix problem with shutting down Sched's event threads on shutdown

M	ChangeLog
M	nsd/sched.c

commit 161865b699a3fe224ae2219315ce9e26dd11d3e8
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-03-07

    Remove unused variables; fix warnings about non-initialized vars; CONST-ified according to Tcl 8.4+ rules
    
    bin/init.tcl: _ns_getscript forces import of
    namespaced commands
    
    tcl/init.tcl: sets auto_path to start with
    our private library first
    
    include/Makefile.global.in: allows for building
    with Solaris 2.6 and later

M	ChangeLog
M	include/Makefile.global.in
M	include/ns.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/binder.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/connio.c
M	nsd/dns.c
M	nsd/driver.c
M	nsd/dstring.c
M	nsd/encoding.c
M	nsd/fastpath.c
M	nsd/index.c
M	nsd/info.c
M	nsd/init.tcl
M	nsd/lisp.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/nsmain.c
M	nsd/pidfile.c
M	nsd/queue.c
M	nsd/request.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/tclatclose.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclshare.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsd/tclxkeylist.c
M	nsd/urlencode.c
M	nsd/urlspace.c
M	nsdb/dbinit.c
M	nsdb/dbtcl.c
M	nsext/nsext.c
M	nslog/nslog.c
M	nspd/log.c
M	nspd/main.c
M	nsperm/nsperm.c
M	nsthread/mutex.c
M	nsthread/nsthreadtest.c
M	nsthread/pthread.c
M	tcl/init.tcl

commit 2930e67995faf48b708e3447cc7c713a6f21c3f9
Author: Mark Page <mpagenva@aol.com>
Date:   2003-03-06

    Define Variable length array component of InterpPage as 1 rather than 0 to avoid some picky compiler's complaints

M	ChangeLog
M	nsd/adpeval.c

commit cd054b7fa3e2f10ab5bb63c790d72682194e7d9b
Author: Mark Page <mpagenva@aol.com>
Date:   2003-03-06

    Add additional i18n example parameters

M	sample-config.tcl

commit 70328a2340e3717484a98f28de32f2d585fa8948
Author: Mark Page <mpagenva@aol.com>
Date:   2003-03-06

    Added Tcl I18N support functions from OACS, with some changes to work within 4.0

M	ChangeLog
M	include/ns.h
M	nsd/adprequest.c
M	nsd/conn.c
M	nsd/encoding.c
M	nsd/form.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c
M	nsd/urlencode.c
A	tcl/charsets.tcl
M	tcl/form.tcl

commit ffb7260a600f17b225bf79a83deded1a46d90c1d
Author: Mark Page <mpagenva@aol.com>
Date:   2003-03-05

    Correctly handle Tcl errors thrown from within an ADP script block

M	ChangeLog
M	nsd/adpeval.c

commit ceb75de71974c80ee131faae833c0cc419592662
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-03-05

    (_ns_getscript): handle commands imported from other namespaces

M	ChangeLog
M	nsd/init.tcl

commit dc55c52fd0278d20946b3f7bf17cfef41a5906bd
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-03-05

    Add missing ChangeLog entry for nscgi fix

M	ChangeLog

commit 110ca1f45bbf181c768057cf3e9825ca8285538d
Author: Mark Page <mpagenva@aol.com>
Date:   2003-03-05

    Add optional switches to ns_adp_parse: -cwd <path>, -savedresult <varname>
    
    savedresult supports usages which require the adp script's result separate
    from the output buffer (which is the func result).
    
    cwd supports prespecifying the initial cwd that the script will be
    executed from.

M	ChangeLog
M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/nsd.h

commit 8c5671697b90337d15e299e9c377e3f9861c1b6f
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-03-03

    Pass SCRIPT_NAME as an environment variable to the CGI script

M	ChangeLog
M	nscgi/nscgi.c

commit c93ddcad529c2280f172dd577f6310ecb843a465
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-02-25

    Fixed bug in ns_jegsize for images that included a DHT
    
    Removed AppendDims command which has been replaced with
    AppendObjDims.

M	ChangeLog
M	nsd/tclimg.c

commit 4a09dd55dffc3bdf4d1b0ba598c59819b1d058fc
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-02-25

    (_ns_dirlist): fix bug adding extra slash to directory links

M	ChangeLog
M	tcl/fastpath.tcl

commit e6a84d9279dd773229c4e2dd74da3d3b4185d17c
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-02-25

    Added fast path config example and comments

M	sample-config.tcl

commit edcdfe0e86ab43a4a7eadab5020cdc959ff787be
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-02-25

    Add logging of errorInfo and errorCode globals to _ns_sourcefile

M	ChangeLog
M	nsd/init.tcl

commit 79a0d8f9989a93b4a0f454f16a378c8efd1720be
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-02-07

    Tag aolserver_v4_r0_beta_2

M	ChangeLog

commit 61351a6b5522d940c00d01b9b11adca76f9df3a6
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-02-07

    Fix rest of cc defaults to gcc

M	configure

commit 2ab4b14fa9da55ec42cdbd36971a770bafecd811
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-02-07

    Apply patch 669230 for bugs 669217/669844: fix stripping of e-mail addressees so that headers still have the pretty address name

M	tcl/sendmail.tcl

commit a41a6a78b9192e283ff2f8a2ca0c3b03ab94ec8b
Author: Jamie Rasmussen <jrasmuss@mle.ie>
Date:   2003-02-07

    Fix incorrect win32 thread patch

M	nsthread/winthread.c

commit 3aa11df2bb117a7bec1ee4f9fad7c9703a57af97
Author: Mark Page <mpagenva@aol.com>
Date:   2003-02-07

    Fix bug #674033: status code for 'Bad Request' is 400 not 401

M	ChangeLog
M	nsd/return.c

commit ff1e0140356d54eb992dd1825b968945dae1154a
Author: Jamie Rasmussen <jrasmuss@mle.ie>
Date:   2003-02-06

    Fix crash on tclsh close: don't create suspended threads

M	ChangeLog
M	nsthread/winthread.c

commit 7e0eb2f2ffd912e795a187105653c6735f1c4ddf
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-02-05

    Fix LocalProxy so that Ns_CloseOnExec is called after the file descriptors are open

M	ChangeLog
M	nsext/nsext.c

commit 02a87ab353c62896419855b15f8b6ab64e971475
Author: Jamie Rasmussen <jrasmuss@mle.ie>
Date:   2003-02-04

    Bring back Win32 build files

M	ChangeLog
A	win32/aolserver.dsw
A	win32/cgitest/cgitest.dsp
A	win32/cgitest/main.c
A	win32/group/grpall.dsp
A	win32/group/grpcore.dsp
A	win32/group/grpopenacs.dsp
A	win32/main/main.dsp
A	win32/nscgi/nscgi.dsp
A	win32/nscp/nscp.dsp
A	win32/nsd/nsd.dsp
A	win32/nsdb/nsdb.dsp
A	win32/nslog/nslog.dsp
A	win32/nsperm/nsperm.dsp
A	win32/nssock/nssock.dsp
A	win32/nsthread/nsthread.dsp
A	win32/test/nsd.tcl
A	win32/test/servers/test/pages/cgitest.bat
A	win32/test/servers/test/pages/index.adp
A	win32/threadtest/threadtest.dsp

commit 1568dbe8547528008d4f1d26985e28c7d53b72f9
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-02-04

    Fixed arg checking in NsTclStrftimeObjCmd which implements ns_fmttime

M	ChangeLog
M	nsd/tclmisc.c

commit e833742fb9d4c8dc7d61556d125e9e8c647e53bb
Author: Jamie Rasmussen <jrasmuss@mle.ie>
Date:   2003-02-04

    Changes for Win32 support

M	nscp/nscp.c
M	nsd/adpeval.c
M	nsd/driver.c
M	nsd/encoding.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/info.c
M	nsd/init.c
M	nsd/listen.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/request.c
M	nsd/server.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclsock.c
M	nsd/tclxkeylist.c
M	nsd/urlencode.c
M	nsd/urlopen.c
M	nssock/nssock.c

commit 5d5503df1663313ce18f2599481ae5d97c9e3cb7
Author: Jamie Rasmussen <jrasmuss@mle.ie>
Date:   2003-02-04

    getopt.c imported for Win32 support

A	nsd/getopt.c
A	nsd/getopt.h
A	nsd/nswin32.c

commit c021729da0d2f36c5d9d8ff8d2b0ab2d1b5c87f9
Author: Jamie Rasmussen <jrasmuss@mle.ie>
Date:   2003-02-04

    Added Win32 support

M	include/ns.h
M	nscgi/nscgi.c

commit fff824dc18d0fdd2de56c12659e89845a6cf3fcc
Author: Jamie Rasmussen <jrasmuss@mle.ie>
Date:   2003-02-04

    Use _WIN32 instead of WIN32

M	include/nsthread.h

commit 13049ba8ba5d929688056b977d8d291e52a7714c
Author: Jamie Rasmussen <jrasmuss@mle.ie>
Date:   2003-02-03

    Minor comment cleanup

M	ChangeLog
M	nsd/auth.c
M	nsd/conn.c
M	nsd/server.c
M	nsd/tclmisc.c
M	nsd/urlencode.c
M	nsthread/pthread.c
M	nsthread/winthread.c
M	tcl/http.tcl

commit 86f2d69370cc65235ca6902fe9fe5a870c50a9f5
Author: Jamie Rasmussen <jrasmuss@mle.ie>
Date:   2003-02-03

    Fix bug #632265: some mail servers fail when presented with a HELO with a space

M	tcl/sendmail.tcl

commit a1f53abb9c570fcacda366eabc250186c178fcce
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-02-01

    Delete empty documentation

D	tcl/tcl.html

commit e5187cb82ad6d067fffd4b0b87273bab70599ee9
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-02-01

    Added configuration example for web stats

M	ChangeLog
M	sample-config.tcl

commit ca0204500a160e1449e49fb8e54ce7a1269dd26e
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-02-01

    Fixed href bug with index.adp page; changed 'directory' parameter to 'url'

M	tcl/stats.tcl

commit 4c305028ca30d9a6a3e7648bdd4d1127759e13da
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-02-01

    Web based stats interface

A	tcl/stats.tcl

commit 077e82d74d19aa11b794778235f8ff8aa46701a0
Author: Mark Page <mpagenva@aol.com>
Date:   2003-01-31

    Add in I18N capabilities derived from the OACS I18N design
    
    This set of changes is just those which are supported within the
    nsd C-code.

M	ChangeLog
M	include/ns.h
M	nsd/conn.c
M	nsd/connio.c
M	nsd/encoding.c
M	nsd/form.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c
M	nsd/tclcmds.c
M	nsd/tclresp.c
M	nsd/urlencode.c
M	sample-config.tcl

commit 6b894941427cf2837caeafae51c54163ae1a2f2e
Author: Peter Jansson <petej@clickvision.com>
Date:   2003-01-29

    Since I/O system was fixed elsewhere, the previous rev was no longer necessary

M	nsd/return.c

commit 147ca6672b66f285387d4dcc71c862eaef6280e6
Author: Peter Jansson <petej@clickvision.com>
Date:   2003-01-29

    In Ns_ConnReturnData, always write the queued data
    
    If the queued data is only written if SKIPBODY is not set, then HEAD
    requests generate no data, not even the headers.

M	nsd/return.c

commit 9cb5152eb95e4802b87c3ce3fe44acb8e63f55b1
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-29

    Changed path for configuration parameters to be ns/server/<server>/fastpath
    
    This change is needed  to support a corresponding change
    in nsd/server.c.

M	ChangeLog
M	tcl/fastpath.tcl

commit 02968eda55fd35a65b4c5cf39a692f9a8883e6c4
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-28

    Interp is now marked for delete only in the case of a TCL_ERROR

M	ChangeLog
M	nsd/init.tcl

commit dd83b4e754f3bb2da196ab547390a5cc64fb92d1
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-27

    Made changes to ns_eval suggested by Jeff Hobbs to address bug #675506

M	nsd/init.tcl

commit f74125862aa50bfb6782de5e5458088c33dc58d7
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-01-24

    Make the default compiler for the configure script gcc

M	ChangeLog
M	configure

commit bdd2332f79e34c48c3ae6d67bd7414931cac97a1
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-01-24

    Add support for purify

M	README
M	include/Makefile.global.in

commit 8556890a2f391cacb27cf281f9c13ad7e9729430
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-01-24

    No longer invalidate strings of adp script chunk objs
    
    Was causing problems with error messages. Bummer, waste of memory.

M	nsd/adpeval.c

commit bfafa00ce5e87ad847be65bcf8e4b11649b07101
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-01-23

    First 4.0 beta tag

M	ChangeLog

commit c1ba8f87f19d62e45af0e5d1937a5c1705301e01
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-23

    Reinitialize ::errorCode and ::errorInfo and end of variable cleanup
    
    The default Tcl unknown command expects them to exist. This fixes
    a bug where they were both being unset at the end of a connection
    during variable cleanup.

M	nsd/init.tcl

commit 4a6d30452811c454b09887b80dee8879918c3026
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-20

    Added ns_job queues command

M	nsd/tcljob.c

commit c47852415f34735a08df7a8b091ab387552a12c4
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-19

    Updated password creation instructions to be a little clearer

M	sample-config.tcl

commit 91ec6824d10bc13b540c34e3449c52b996ff30ea
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-19

    Added new section for control port configuration

M	ChangeLog
M	sample-config.tcl

commit 07ae2c5a6ddb405219c2410881ceff855f9e9007
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-19

    Control port logging now defaults to off

M	ChangeLog
M	nscp/nscp.c

commit d161805015bfc5526761edadbbd035f1e474af3f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-01-18

    Brought forward nsthread library from 3.5

M	ChangeLog
M	include/nsthread.h
M	nsthread/Makefile
D	nsthread/cond.c
M	nsthread/error.c
M	nsthread/memory.c
M	nsthread/mutex.c
M	nsthread/nsthreadtest.c
A	nsthread/pthread.c
M	nsthread/reentrant.c
M	nsthread/thread.c
M	nsthread/thread.h
M	nsthread/time.c
M	nsthread/tls.c
A	nsthread/winthread.c

commit 38ff97718cbbb307351f44b64c84a48757c6b434
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-01-18

    Remove string commands

M	ChangeLog
M	nsd/auth.c
M	nsd/conn.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/info.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/random.c
M	nsd/tclcmds.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/urlencode.c
M	nsd/urlopen.c

commit 9d74f42bbd95e817bbb600129da338292e01efbd
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2003-01-18

    Fix handling of servPtr and location between the Sock, Driver, and Conn structures for Host header based connections

M	ChangeLog
M	nsd/conn.c
M	nsd/connio.c
M	nsd/driver.c
M	nsd/init.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c
M	nsd/server.c
M	nsd/tclinit.c

commit 75936aa8a28b4ec9f7510bbaa75fb5c9a4478ed9
Author: Zoran Vasiljevic <zv@archiware.com>
Date:   2003-01-18

    Enable "package require" in initializing interp; fix ns_eval return/error value
    
    * added _ns_getpackages to enable "package require".
    
    * fixed various issues in ns_getscript related to
      loading Tcl modules which define namespaced alternatives
      of standard Tcl commands.
    
    * fixed ns_eval to return value/error and made compatible
      with standard Tcl "eval" and AOLserver "ns_eval" from 3.x.
    
    * made the entire file little more readable.

M	ChangeLog
M	nsd/init.tcl

commit 8cc42f7f583e40acb7705affae35d91a890306fc
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-17

    Moved user from thread name to log notice; more log notice format changes

M	nscp/nscp.c

commit 06d8bc898e16435a30188008945ef311ff8126ba
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-17

    Cleaned up command logging notices to be more consistent:
    
    Notice: nscp:<num> <script>
    Notice: nscp:<num> done

M	nscp/nscp.c

commit 91820cd74d760b3d5620277d1b3f5c46be68d3d5
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-17

    Removed curly braces preventing ns_ictcl from being evaluated correctly

M	nsd/init.tcl

commit 757774584f345052c3be9f067993ec9234d6c0d7
Author: Mark Page <mpagenva@aol.com>
Date:   2003-01-17

    (SockRead): null-terminate the content at the specified content-length
    
    This fixes a problem when some browsers add extra CRLF
    characters beyond the specified content-length on a POST.
    (See this by using IE to POST data).

M	ChangeLog
M	nsd/driver.c

commit c482197985455bba62915e09809387b667ceafe0
Author: Elizabeth Thomas <eathomas93@aol.com>
Date:   2003-01-16

    Fix WordEndsInSemi so that ns_striphtml correctly handles ampersands that are not followed by a space or semicolon

M	ChangeLog
M	nsd/tclmisc.c

commit 3d4c16e34eb0f866ea8c033b0c04df79d153e29d
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-15

    Fix to provide backwards compatibility for ns_adp_argv command with argv's which point to NULL data

M	nsd/adpcmds.c

commit ceff2354328e7fd54ccba374da3fb88fa8e95090
Author: Nathan Folkman <nathan.folkman@gmail.com>
Date:   2003-01-14

    Updated ns_logctl get and ns_logctl flush to set count to 0

M	nsd/log.c

commit b7691b0094367b1249ab641f3dc4397e8e9c1825
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-12-14

    ns_sleep now uses Tcl_Sleep instead of select()

M	nsd/tclmisc.c

commit 9fae4b69f12a7187e8c117105e9a9bf329de5758
Author: Jeremy Collins <jcollins@phpsource.net>
Date:   2002-11-06

    Fixed namespace bug

M	ChangeLog
M	nsd/init.tcl

commit e0e0560add0b875840afbab5251211ef623a796f
Author: Jeremy Collins <jcollins@phpsource.net>
Date:   2002-11-06

    Changed ParseAtts to make it compatible with how parsing works in 3.x

M	ChangeLog
M	nsd/adpparse.c

commit 843885017f3a979e5f34a06f0c333c559cb2ee91
Author: Jeremy Collins <jcollins@phpsource.net>
Date:   2002-11-06

    Make ns_set idelkey|delkey actually delete the key

M	ChangeLog
M	nsd/tclset.c

commit 894e53ce713be814b4c2f6040a8851adf2518998
Author: Jeremy Collins <jcollins@phpsource.net>
Date:   2002-11-06

    (Parse): handle registered tags inside of html tags e.g. <td bgcolor='<tag n='v'>'>

M	ChangeLog
M	nsd/adpparse.c

commit 770b6126f76817d56edc9a585b37a9f31b358da8
Author: Dan Bradley <danb@aol.net>
Date:   2002-11-05

    Initial documentation

M	doc/ns_geturl.n
M	doc/ns_guesstype.n
M	doc/ns_headers.n

commit cbc496704655423d0d4f7e92f6b875ec59e3144d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-11-03

    Fixed bug with non-server specific cache names

M	ChangeLog
M	nsd/fastpath.c

commit d2aa95e08eab5d3ac72411efdb5cc56c0dcc55b5
Author: Jeremy Collins <jcollins@phpsource.net>
Date:   2002-11-02

    (ParseAtts): parse ADP attribute values with spaces

M	ChangeLog
M	nsd/adpparse.c

commit 257661c28397771a910c2f67a58b251032a91a08
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Add missing ChangeLog entries

M	ChangeLog

commit 8c7b89b304f3dd6caeddb06718c5056548dd57e9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Added examples for connection thread pools and Host header virtual servers

M	sample-config.tcl

commit 93c223d39d84e84156773dbeb238b3b72397faa8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Changed "ns_conn files" command to return names of file upload widgets
    
    Moved access to other meta data to new fileoffset, filelength, and
    fileheaders subcommands. Also, removed the ns_conn string command
    instead of updating.

M	nsd/conn.c

commit f97277d0e35767c5c202b3687397e4fbf99dfc92
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Updat to use new ns_conn fileoffset, filelength, and fileheaders for file uploads

M	tcl/form.tcl

commit 0f4545b811fadd1f23796fe61b8a57a3e2ff57f1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Removed NsTclConnCmd and NsTclServerCmd string commands

M	nsd/tclcmds.c

commit 3215ad06f20eeb11cdad47e096bc8a4e5c056bcf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Support for configuring multiple named thread pools for virtual servers

M	nsd/server.c

commit 371779b8b9d069a2688ad96397bff7baa72915c9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Implement multiple named thread pools for virtual servers and Host header based virtual servers
    
    The ns_server command now takes an optional pool parameter to
    get connection data by thread pool.

M	nsd/queue.c

commit 351b8e5072b299711da380dbb25613957876399f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Add call to load non-virtual server modules (listed in config ns/modules section)

M	nsd/nsmain.c

commit de324530f85850d8b84ff4ea9379c322d772b950
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Add FormFile and ConnPool structures; remove thread pool struct from NsServer

M	nsd/nsd.h

commit fe1f53b4254270144b088110c38bf75f714638b6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Fixed crash bug with NULL server

M	nsd/info.c

commit 9b6747ff6d6d71a7bb4ff413622fe41ca0fbd964
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    File upload headers, offsets, and lengths now saved to be accessible via ns_conn options

M	nsd/form.c

commit c493a26abed1dc3c0ab9d5cdba00bcadd6f41c44
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Added Host header based virtual server support

M	nsd/driver.c

commit 87efe998a2068669aada3ff508c7464530ad70d4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Use /bin/sh to invoke mkLinks

M	doc/install-doc

commit d7fe4e68a742107a5e43f00439be9b832d648258
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-30

    Uses /bin/sh to invoke install-doc

M	Makefile

commit 328f4918c228ff2fafc5d21b6da2b51af846474b
Author: Jeremy Collins <jcollins@phpsource.net>
Date:   2002-10-25

    Bug: [ns_conn isconnected] was returning 0 when there is a connection and 1 when there is not

M	nsd/conn.c

commit 4f8a78f11442f8bc0a56651b0ae29cb9895a662f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Set server started state to 0 at start of Ns_Main; move Tcl object init to tclinit.c

M	nsd/nsmain.c

commit 1a0668eacfda060ca0f67a2199cd3e8dd842807a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Fix bug handling binary upload files; add ns_getformfile proc and some notes on usage

M	tcl/form.tcl

commit a76c54c110ea7cafa183c31dd2f40596bb4521af
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Added new Tcl object type to handle the various thread objects

M	nsd/tclthread.c

commit 66025e047b03aae9a950f4e1e72af93907321da8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Updated to work without a server

M	nsd/tclsock.c

commit 819c0035c54824be656e3c844f4251aebba4b0cc
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Updated to work outside a server for ordinary, non-shared sets

M	nsd/tclset.c

commit 2cc55c94ccd8e5537253cea8af91b32716c2eb6d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Minor cleanups

M	nsd/tclobj.c

commit d87b5be40883ae0374d72dd6c4d8eb45da4a26f0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Updated interp create/init to support use of libnsd.so in tclsh's

M	nsd/tclinit.c

commit 96e56eb45dc6f8a306b714db3a7368118bcecd70
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Move many commands from per-server to generic, e.g., ns_set

M	nsd/tclcmds.c

commit 05b732fda7e4985a1d9e0a2f1545fcf8dc75b468
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Threaded events now processed by a thread pool

M	nsd/sched.c

commit d420d2219644043a4983d5f26eafb31c734c96ea
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Remove ns_job related info from NsServer structure
    
    The ns_job command now works with named queues.

M	nsd/nsd.h
M	nsd/server.c
M	nsd/tcljob.c

commit 9d0433a2317bb604bb14f3c4236768cae04e7dd8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Server mark started and with objcmds by default for benefit of libnsd.so shells

M	nsd/nsconf.c

commit f214e3d8adf9878fce4e5e38354db458bdc07398
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Format thread ids as unsigned long

M	nsd/log.c

commit 0a85e6d99f48ae1076f19cc3db29dd376e1909c1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Fix bug handling binary uploaded files; ns_conn files now returns mimetype

M	nsd/form.c

commit f8c9487df0fe52fb0055062fc7e9ce8921b92eac
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Switched ns_conn copy to use Tcl_Write

M	nsd/conn.c

commit 22dec69dac913b4966739e184eaaad5c90ea832d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Added Ns_TclInit and Nsd_Init

M	include/ns.h

commit e94ad689f3bbee21926f2ae118b26ec97c2f7da2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Added man page install and .PHONY targets

M	Makefile
M	include/Makefile.module.in

commit 9060dbcaee7c7bbe477dd6ab96ac97ca69f76933
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Add missing ChangeLog entries

M	ChangeLog

commit 2b55e4238c29483440d0b89d333fabc992138fdf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    Single ns_adp_include proc moved to nsd/init.tcl

D	tcl/adp.tcl

commit 0520f98e5d42110b23daff64bdca84d9d9a04655
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-15

    New install/crosslink script

A	doc/install-doc

commit 991f6b1fed0dbb7916c95ac9f8e80ca1db06ce5c
Author: Mark Page <mpagenva@aol.com>
Date:   2002-10-10

    Include user's login name in any logging by augmenting the thread name with the login name
    
    Provide configurable logging of all control port commands.
    Be more accepting of telnet echo ack commands (within
    limits), to get past problem when no-echo is enabled.

M	nscp/nscp.c

commit 728b11c4567fd556c864edb0640f5da35bffe859
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-07

    Removed redundant LD/CCRFLAG from LSLIB

M	configure
M	configure.in

commit c4e522b16be8f833cfb64fa075621d63e645203e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-04

    Fixed bug #618010: initialize 'tries' to 0 when reading ADP file

M	nsd/adpeval.c

commit 1fe8c7c7005ba1ff6b7b40ca6fcdf420a4c07a64
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-03

    Fixed install bugs

M	nsssl/Makefile

commit 713e6f12a691a2a3ef711d756765e234593bb7db
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-03

    Switched from prefix to AOLSERVER for install directory

M	Makefile

commit 9ce5d12fa7e6357ef16d8fa96690c9f85b60998c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-03

    Added missing Ns_TclInitModule

M	include/ns.h

commit 5db7f3293ea57e4448125af2bec905528f2e7d71
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-03

    Switched to ckalloc/ckfree for minor benefit of debug alloc build

M	nsthread/memory.c

commit 1e967795f35a82a3c0460bc4e17b06302bc6d9d9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-03

    Switched to struct iovec from Ns_Buf which is no longer defined

M	nsssl/nsssl.c

commit 8b76f3c59db3a7507d57423a7154ec495b76b405
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-03

    Missed one rpath thing

M	configure
M	configure.in
M	nsssl/Makefile

commit 261dc51191a51d98b309061b4925078764100f48
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-10-03

    Updated config/make to support setting CFLAGS and RPATHS in modules makefiles

M	configure
M	configure.in
M	include/Makefile.global.in
M	include/Makefile.module.in

commit 643e9f2367995c5dd9e6d1397b501d6a0045d64b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Silenced some compiler warnings

M	nsd/conn.c
M	nsd/dns.c
M	nsd/fastpath.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/server.c
M	nsd/tclthread.c

commit aedb70d38ae046f7609f98e4be75e38bc3e272e3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Fixed bug not defining/using _NSGetEnviron correctly

M	nsd/tclenv.c

commit d9f2cbe88a6a9838df6ca10b39826591cfc6c12d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Added new empty man pages

A	doc/Ns_Adp.3
A	doc/Ns_Alloc.3
A	doc/Ns_Auth.3
A	doc/Ns_Cache.3
A	doc/Ns_Cls.3
A	doc/Ns_Cond.3
A	doc/Ns_Config.3
A	doc/Ns_Conn.3
A	doc/Ns_ConnCopy.3
A	doc/Ns_ConnDriver.3
A	doc/Ns_ConnHeaders.3
A	doc/Ns_ConnRead.3
A	doc/Ns_ConnRequest.3
A	doc/Ns_ConnReturn.3
A	doc/Ns_ConnSend.3
A	doc/Ns_ConnWrite.3
A	doc/Ns_CritSec.3
A	doc/Ns_DString.3
A	doc/Ns_Db.3
A	doc/Ns_DbDriver.3
A	doc/Ns_DbPool.3
A	doc/Ns_DbSp.3
A	doc/Ns_DbUtil.3
A	doc/Ns_Driver.3
A	doc/Ns_Encoding.3
A	doc/Ns_Encrypt.3
A	doc/Ns_Env.3
A	doc/Ns_Exec.3
A	doc/Ns_ExtDb.3
A	doc/Ns_Fd.3
A	doc/Ns_Fetch.3
A	doc/Ns_Filter.3
A	doc/Ns_HttpTime.3
A	doc/Ns_Htuu.3
A	doc/Ns_Index.3
A	doc/Ns_InetAddr.3
A	doc/Ns_Info.3
A	doc/Ns_IntPrint.3
A	doc/Ns_List.3
A	doc/Ns_Location.3
A	doc/Ns_Log.3
A	doc/Ns_Master.3
A	doc/Ns_Mime.3
A	doc/Ns_Module.3
A	doc/Ns_Mutex.3
A	doc/Ns_Nsd.3
A	doc/Ns_Pathname.3
A	doc/Ns_Pool.3
A	doc/Ns_ProcInfo.3
A	doc/Ns_QuoteHtml.3
A	doc/Ns_RWLock.3
A	doc/Ns_Rand.3
A	doc/Ns_Reentrant.3
A	doc/Ns_Register.3
A	doc/Ns_Request.3
A	doc/Ns_RollFile.3
A	doc/Ns_Sched.3
A	doc/Ns_Sema.3
A	doc/Ns_ServerSpecific.3
A	doc/Ns_Set.3
A	doc/Ns_Signal.3
A	doc/Ns_Sock.3
A	doc/Ns_SockCallback.3
A	doc/Ns_SockErrno.3
A	doc/Ns_SockIO.3
A	doc/Ns_String.3
A	doc/Ns_TclConn.3
A	doc/Ns_TclDbGetHandle.3
A	doc/Ns_TclFile.3
A	doc/Ns_TclInit.3
A	doc/Ns_TclInterp.3
A	doc/Ns_TclRegister.3
A	doc/Ns_TclSet.3
A	doc/Ns_TclThread.3
A	doc/Ns_TclTimeObj.3
A	doc/Ns_TempFile.3
A	doc/Ns_Thread.3
A	doc/Ns_Thread2.3
A	doc/Ns_ThreadAlloc.3
A	doc/Ns_Time.3
A	doc/Ns_Tls.3
A	doc/Ns_Uid.3
A	doc/Ns_Url.3
A	doc/Ns_UrlEncode.3
A	doc/Ns_UrlSpecific.3
A	doc/Ns_UrlToFile.3
A	doc/man.macros
A	doc/mkLinks
A	doc/ns_addr.n
A	doc/ns_adp.n
A	doc/ns_at.n
A	doc/ns_cache.n
A	doc/ns_chan.n
A	doc/ns_checkurl.n
A	doc/ns_config.n
A	doc/ns_conn.n
A	doc/ns_crash.n
A	doc/ns_crypt.n
A	doc/ns_db.n
A	doc/ns_env.n
A	doc/ns_eval.n
A	doc/ns_file.n
A	doc/ns_filter.n
A	doc/ns_getchannels.n
A	doc/ns_geturl.n
A	doc/ns_guesstype.n
A	doc/ns_headers.n
A	doc/ns_html.n
A	doc/ns_http.n
A	doc/ns_httptime.n
A	doc/ns_img.n
A	doc/ns_info.n
A	doc/ns_init.n
A	doc/ns_job.n
A	doc/ns_kill.n
A	doc/ns_library.n
A	doc/ns_log.n
A	doc/ns_logroll.n
A	doc/ns_markfordelete.n
A	doc/ns_module.n
A	doc/ns_modulepath.n
A	doc/ns_normalizepath.n
A	doc/ns_parseheader.n
A	doc/ns_parsequery.n
A	doc/ns_proc.n
A	doc/ns_purgefiles.n
A	doc/ns_rand.n
A	doc/ns_requestauthorize.n
A	doc/ns_return.n
A	doc/ns_rollfile.n
A	doc/ns_sched.n
A	doc/ns_set.n
A	doc/ns_share.n
A	doc/ns_shutdown.n
A	doc/ns_sleep.n
A	doc/ns_sock.n
A	doc/ns_sync.n
A	doc/ns_thread.n
A	doc/ns_time.n
A	doc/ns_tmp.n
A	doc/ns_url2file.n
A	doc/ns_urlencode.n
A	doc/ns_uuencode.n
A	doc/ns_writefp.n
A	doc/nsd.1

commit 5c50686002ffe7cf33bcb8eb4eeee8af7ead3c18
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Updated README and other files to match AOLserver 3.x

D	INSTALL
M	README
D	doc/config.txt
D	doc/default-home.html
D	doc/faq.html
D	doc/install.html
D	doc/tcl-changes.txt
D	doc/tuning.html
R100	doc/license.txt	license.terms

commit b66966978509211b3af2e8c4308341c28107a8a9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Add missing ChangeLog entries

M	ChangeLog

commit 2f1dbc6d21960933a601d479e558dad740f40d99
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented AOLserver 3.x Ns_TclThread and Ns_TclDetachedThread

M	nsd/tclthread.c

commit 72243ada7aba0f45ddfed11339e7d2febdf2b5f9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implement more missing AOLserver 3.x routines; ns_ictl addmodule/getmodules
    
    Implemented AOLserver 3.x Ns_TclRegisterAtCreate/Cleanup/Delete,
    Ns_TclInitModule, Ns_TclLogErrorRequest, and Ns_TclDestroyInterp.
    Also, added "addmodule" and "getmodules" options to ns_ictl to
    facilitate Tcl module init including with static modules.

M	nsd/tclinit.c

commit 80c5af86f82ec5469b6d32cb9d51acf721876ed2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Renamed Ns_GetEnvironment Ns_CopyEnviron and GetEnviron Ns_GetEnviron, now an exported function

M	nsd/tclenv.c

commit 4924401bbb78dc547124a2c0992a41d3eba548bc
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Add NsGetInitServer to support various 3.x init procs; support static server inits
    
    Added NsGetInitServer to support various AOLserver 3.x initialization
    procs which did not pass the virtual server (e.g., Ns_RegisterReturn).
    Also added support for static server init procs.

M	nsd/server.c

commit f1ab791e214742abbe815f48cf0dd76d05bee2d7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented AOLserver 3.x Ns_RegisterReturn

M	nsd/return.c

commit c28d945a3cd9a0935f5044a8da68addd6a63b7f2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Add NsInitQueue to support AOLserver 3.x Ns_GetConn; implemented AOLserver 3.x Ns_QueueConn stub (returns NS_ERROR)

M	nsd/queue.c

commit a2a3d317fae2ed93241dbc29836cf3489ae4a1f6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented AOLserver 3.x Ns_StopServer and added support for static server init procs

M	nsd/nsmain.c

commit 130bf9383f42a64fc429a8b3a3ce7adb5f4be23f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Added defs for Tcl traces, server init procs, and Tcl module list

M	nsd/nsd.h

commit 9872d9d3f1f3fcc34cc4adee5f6796c56f2c0402
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented AOLserver 3.x Ns_RegisterModule and Ns_GetSymbol

M	nsd/modload.c

commit ca33d3245a2d7a312318e0e596e9cebd44bd2bd3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Restored AOLserver 3.x Ns_Main which allows optional static module init

M	nsd/main.c

commit 090a3e41fd9b5d3c4a249f92dc7e44c600cf2b56
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented AOLserver 3.x Ns_LogTime2

M	nsd/log.c

commit bf3f2b4e013a46b43fe147d8bcd8ef4ebc35b4be
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Uses new "ns_ictl modules" instead of iterating over config section which would miss static modules (if any)

M	nsd/init.tcl

commit 7949864570c5463316c2ab641058ec96601cc442
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Added NsInitQueue

M	nsd/init.c

commit da9cba8eaeebc164df902fd5feb34189463a15f9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented AOLserver 3.x Ns_RegisterCleanup

M	nsd/filter.c

commit b4668165b48b10ed3358ec6cc0dacead79fa3d23
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Removed strange USE_PROCTHREAD stuff and use Ns_CopyEnviron instead of Ns_GetEnvironment

M	nsd/exec.c

commit 05c34549c95364c304c0c7ecd11e99026be5568c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented AOLserver 3.x Ns_DStringPop/Push (no actual dstring cache, just direct alloc/free now)

M	nsd/dstring.c

commit 7c076c10a717c62069912a7fe58f7e879631d761
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented for AOLserver 3.x stub Ns_RegisterDriver and Ns_GetDrivercontext (always return NULL)

M	nsd/driver.c

commit 33d79ab7357fd4130220689af1673d16e5fc36a9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented AOLserver 3.x Ns_ConnInit, Ns_ConnFlushContent, and Ns_ConnGets

M	nsd/connio.c

commit 989ce9edc7a87ab9353e8391d6cbc291079729cc
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented AOLserver 3.x Ns_SetConnLocationProc

M	nsd/conn.c

commit 7439c352a7ff7e07ba62bd9cc0928b9d1899115f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented AOLserver 3.x Ns_AuthorizeUser (no known uses)

M	nsd/auth.c

commit 768d350a56774ef57e66128b8b1cfb2e37976cd9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Implemented AOLserver 3.x stub Ns_AdpRegisterParser (always returns NS_ERROR)

M	nsd/adpparse.c

commit 5edbe085fc0efb514867442bd2f61b3b1e7da4f5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Restored various AOLserver 3.x defs and set patch level to 4.0
    
    Also, renamed Ns_GetEnvironment to Ns_CopyEnviron.

M	include/ns.h
M	nscgi/nscgi.c

commit d0ab5ef9cad0c91ec504b2a28bff85ab45ecd963
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Removed weird USE_PROCTHREAD for Linux

M	configure
M	configure.in

commit 33dfb4c8b4deebd6f3a7893d011ef7b250595afa
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-28

    Fixed bug installing the install-sh script (wasn't executable)

M	Makefile

commit 3e84409ce0b5bbc534a13ba7203057aeb170a2af
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-21

    Fixed bug return non-static char buffer

M	nsd/nsconf.c

commit d6ec76e50c60eaa6d42e0eb63ac1ff0c9d985ad3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-21

    Added Ns_FreeConnInterp to go with Ns_GetConnInterp

M	include/ns.h
M	nsd/nsd.h
M	nsd/queue.c

commit df09af4d44ca65b3898dfea09fbdccc3486da82e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-21

    Returned the dup-high behavior for new sockets

M	nsd/sock.c

commit 7cda96e038246a28aeb8bdfb4a7a24cf93ecb304
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-21

    Added all dependency for install

M	Makefile

commit 298cbd515bb2531932d16293f245e4c9af1bca55
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-21

    Restructure interp alloc/dealloc and init/cleanup to expose all cleanup and state maintenance with new Tcl command ns_ictl

M	nsd/init.tcl
M	nsd/tclcmds.c
M	nsd/tclinit.c

commit d1e6cb833ad4a021f2ebaf0e98ea60b974b98742
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-21

    ADP cache names now unique to interp, not thread

M	nsd/adpeval.c

commit b68af88161cdf6d0eba29f9b66a74cf002bfcc94
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-21

    Fixed bug of not passing TCL_SHLIB_CFLAGS

M	include/Makefile.global.in

commit a2ea9ce739b2ff06ac2ed19cf7b4946f06588600
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-21

    New Makefile.module template to set install directory during config

A	include/Makefile.module.in

commit b09b7436a4d7322d364f77b972e017705b00d243
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-21

    Support --enable-symbols; use the Tcl install-sh install script; and new Makefile.build
    
    Better separates aolserver build from user module build using
    installed directories.

M	Makefile
M	configure
M	configure.in
A	include/Makefile.build
M	include/Makefile.global.in
D	include/Makefile.module
A	install-sh
M	nscgi/Makefile
M	nscp/Makefile
M	nsd/Makefile
M	nsdb/Makefile
M	nsext/Makefile
M	nslog/Makefile
M	nspd/Makefile
M	nsperm/Makefile
M	nssock/Makefile
M	nsssl/Makefile
M	nsthread/Makefile

commit fb5af3b57fd89c2e4c667db8133f78ea124035c7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-19

    Bug fix for Solaris /usr/lib/lwp rpath

M	configure
M	configure.in
M	include/Makefile.global.in

commit af705635f23865288bfcc9859175dff652fc2ee5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-19

    More make/configure updates

M	Makefile
M	configure
M	configure.in
M	include/Makefile.global.in

commit f3745ba26e4ac91db7d3568a0ac290958944e3ce
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-19

    Cleaned up formatting

M	nsd/exec.c

commit 3e8325b8c39cbe79d3fd0f205ab630057f13a6a9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-19

    Updated configure to correctly set TCL_SHLIB_LD

M	configure
M	configure.in
M	include/Makefile.global.in

commit f7f06b0435b519820b018e3cffb4a865c56d076a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-16

    Created a special test for USE_DUPHIGH and eliminated need for platform-specific USE_DLSYMPREFIX

M	configure
M	configure.in
M	include/Makefile.global.in

commit 1cfdef18af4e6aecc16e4b83ccf3ed7e9f9c2bd9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-16

    Eliminated compile-time check for prepending underscore to symbols
    
    Now works like Tcl and simply tries without and with if necessary
    on all platforms.

M	nsd/modload.c

commit 2748f72dc32e176921823026d58c414a440fa527
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-16

    Added configure tests for fork1, module loading, and random number generation

M	configure
M	configure.in
M	include/Makefile.global.in

commit 5e637062e7083aa3321ca5feaf14dda25ca72e36
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-16

    Updated to use configure HAVE_DRAND48 and HAVE_RANDOM test results

M	nsd/random.c

commit 31ccff8b0fa7c93be4a545d57feb7fad46b0e6a2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-16

    Moved poll() code from ../nsthread/osxcompat.c compiled via HAVE_POLL configure test

M	nsd/nsd.h
M	nsd/unix.c

commit 816040a4182a1ebff7aeb2235dbe3e2d3129a5e4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-16

    Removed Mac 10.1 hacks, moving the remaining poll() code to ../nsd/unix.c
    
    AOLserver now requires 10.2.

M	nsthread/Makefile
D	nsthread/osxcompat.c
D	nsthread/osxcompat.h
M	nsthread/thread.h

commit d2677d7a885ba177b04bfdecee24a08bd6ab5eed
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    Fixed autconf build bugs with OS/X

M	configure
M	configure.in
M	include/Makefile.global.in
M	nsd/httptime.c
M	nsd/tclenv.c
M	nsthread/osxcompat.c

commit e26885efc9bd04a2c848c44792d8d4ab7a02ed57
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    Add missing ChangeLog entries

M	ChangeLog

commit b6ffacc50ef29e561db120ff05962774ae1564b5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    Build hacks for Solaris

M	include/Makefile.global.in

commit 3c3af994cd39d90c887444c678eeb00644bbf5d3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    Added install mkdir's for bin and lib directories

M	Makefile

commit d7fe3f6817e0d1735ddcd576a0b0746093cfd1ca
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    Now created from Makefile.global.in by configure

D	include/Makefile.global

commit f548678d4eed91bdd69533d7af16cc340faa08d5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    Removed Tcl build targets

M	Makefile

commit dab6c5c5d7dde4e440bc431a8df0e032e9ca8437
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    Added simple instructions for new autoconf based build

A	INSTALL

commit c2683e09671f01ab402e070390e6d8aaffe29e30
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    Updated use of LIBEXT and RPATH's

M	include/Makefile.module

commit 23accf297d6353766c3ce7891912c85b190d89a3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    New files for simple autoconf style config based on Tcl configuration

A	aclocal.m4
A	configure
A	configure.in
A	include/Makefile.global.in

commit 45d7a287a3bc8892b4a194baf7e7420901bd8b61
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    Switch to Tcl config HAVE_TM_GMTOFF from old manual NO_TIMEZONE

M	nsd/log.c

commit a2142a598b2c766e538c8cceaedf29ebe2735bcb
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    Added routine to return environment vector to isolate access to **environ or NsGetEnviron on OS/X

M	nsd/tclenv.c

commit 195ac2b292ac2c41b093350a93e596e276114a98
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-09-11

    Eliminated the compile time system scope code, instead just ignore any unsupported error result from pthread_attr_setscope at runtime

M	nsthread/thread.c

commit b8c045ea47ec30974a82eeb19d74448cfd9bb001
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-26

    Connection I/O times now maintained with Ns_Time microsecond resolution

M	ChangeLog
M	nsd/conn.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c

commit 9d7faeb0126b3768373487137a0efdb1015a3eea
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-26

    Ns_DiffTime now returns -1, 0, or 1 if t1 is before, equal, or after to

M	include/nsthread.h
M	nsthread/time.c

commit 9b7c659cf33f2c1bcc52de089672910caeff12be
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-25

    Add missing ChangeLog entries

M	ChangeLog

commit 9a804300065ff44ff2837a14eb99d88de4638c0b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-25

    Further simplified Tcl init at startup and interp allocation

M	nsd/config.c
M	nsd/init.tcl
M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclinit.c

commit 11024c715482ba3aeeb8a335813674a4f6b87a97
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-25

    Moved Ns_TclRegisterDeferred from tclatclose, removed NsTclEval in favor of Tcl_EvalEx, and added ns_init command

M	nsd/tclinit.c

commit d99bebf3fd5291dbcfb166315be01b517cbff47c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-25

    Added ns_init command

M	nsd/tclcmds.c

commit f1ccf16693eaf470647b09cff6e1860b871f3030
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-25

    Moved private struct definitions out of nsd.h

M	nsd/nsd.h
M	nsd/server.c
M	nsd/tcljob.c
M	nsd/tclvar.c

commit db83a0aa855fbf854934d4941b3a43bcfd69d34b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-25

    Removed undocumented and complicated log buffering feature

M	nsd/log.c
M	nsd/nsconf.c
M	nsd/nsconf.h

commit a94dbe18e9b5e521975657b0b795357905934131
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-25

    Use of Tcl_EvalEx instead of NsTclEval

M	nsd/tclsock.c

commit 6769675283cccd8bf7f622c630cdcdf3937d52fc
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-25

    Moved Filter and Trace struct definitions from nsd.h

M	nsd/filter.c

commit 82f8c108667d0edb603f5cd4bb863bb69ba9e4c0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-25

    Use Tcl_EvalEx instead of NsTclEval which no longer requires the temporary null bytes during direct adp evaluation..

M	nsd/adpeval.c

commit c2fb8b13a2478ee6e2c5d01365407c8f5a06a179
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-25

    Moved Ns_TclRegisterDeferred to tclinit.c and definition of AtClose struct from nsd.h

M	nsd/tclatclose.c

commit aad520634346f4f071d37e3c5c4a6c889bab6cd0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-25

    Code cleanup, e.g., removed old references to Tcl 7.6

M	nsd/tclshare.c

commit f6bed78f97ee5477ea71ccc830f82918c2b4a905
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-10

    Added NEED_OSXCOMPAT (on by default) for Mac OS/X 10.1 compat routines now in 10.2

M	include/Makefile.global
M	nsthread/osxcompat.c
M	nsthread/osxcompat.h

commit 7e0001022867b93132a0fd463cd0ab1e3bee0fa3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-10

    Updated to Tcl 8.4b2 and added -DNO_CONST for now

M	include/Makefile.global

commit 98d6ca8dc9baea33f636067f98febe17dbd5b38a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-10

    Updated some const's to CONST

M	include/ns.h

commit aaec3c9385b5d9793c2b181af020b93ac131c932
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-10

    Changes various const's to CONST's (more to do)

M	nsd/dsprintf.c
M	nsd/tclatclose.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c

commit e80f5f42d6f7aced8016a96c0e1ba11486153faf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-10

    Fixed multi-line string literal

M	nsd/tclresp.c

commit 5dd962c6354ef06c6d34eda4414e777910355b86
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-10

    Fix for bug #587394

M	nsd/tclrequest.c

commit c280ae00cfe11deef9f1ac2211049c50f7581ca0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-08-10

    Added NsInitRequests and proper locking for proxy requests

M	nsd/init.c
M	nsd/nsd.h
M	nsd/op.c
M	nsd/server.c

commit 7fad82e3b03fd3becbdb0447afdfc0d50186c4c5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-23

    Proper fix for bug #584941

M	nsd/conn.c

commit 1533e6622dda7cdbd8ef60bb347576060027ec2e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-23

    Fix for bug #584941: crash when no connection

M	nsd/conn.c

commit e6acd5ce37a33231fab2c19e0f29bf663bae8760
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-15

    Latest notes for past week plus a retro note for 12/5/2001 on ns_thread

M	ChangeLog

commit 41961a54a545e592a0ec85ac07423fe28350b505
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-15

    Fixed NsClosePreBindbinder type (should be NsClosePreBound)

M	nsd/nsmain.c

commit 4742f4a34c3fe2ffca62b0fa636712400a385268
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-15

    Formatted LIBOBJ list

M	nsd/Makefile

commit a84c1ddc681a6d2757bb7512aafe75b85665f977
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-15

    Cleaned up comments riddled with various lies

M	nsd/nsmain.c

commit 210f6f429973fdba57f1fd5889ba5cc8428e2e6c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-15

    Renamed NsStopBinder NsClosePreBound to better reflect what it actually does now

M	nsd/binder.c
M	nsd/nsd.h

commit 644df84fd9a3752bfa760b3919f0c35afe1cfd48
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-15

    Switched to more object-correct Tcl_ObjSetVar2

M	nsd/adpcmds.c
M	nsd/urlopen.c

commit 9e4cb0373348f3998a6d5e0f468f48251ba4bc73
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-15

    ns_sleep command now understands microsecond resolution timespecs from ns_time

M	nsd/tclmisc.c

commit 749949c2e4346d7cc7537f8874a148945af9ac53
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-15

    Added ns_logctl object command to buffer log messages generated by a thread
    
    This should allow dumping log messages at the end of an ADP
    page, for example.  Also, removed the ns_log string command.

M	nsd/log.c
M	nsd/tclcmds.c

commit 765386519f88eff776f64f33cdb8185471861281
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-15

    Add ns/parameters "logusec" config option to add microsecond times to log entries
    
    (off by default)

M	nsd/nsconf.c
M	nsd/nsconf.h
M	nsd/nsd.h

commit 857fcf51533a65e4ceee28ae3393453182ad8df0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-15

    Added microsecond resolution to ns_sockselect via ns_time-based times

M	nsd/tclsock.c

commit 9ba7377b1531fc925888dc00bb36285f80825eb9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-08

    Add missing ChangeLog entries for upcoming beta4 release

M	ChangeLog

commit 4d0a1658a78ae12bc488489ed35fc88ebf96a180
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-08

    Updated for beta 4 release to coincide with Tcl beta 1 release

M	Makefile
M	include/Makefile.global
M	include/ns.h

commit 4db3a12fab17675d384d01de10fb342f0eede3d4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-08

    Removed string commands, added NsTclVarObjCmd

M	nsd/tclvar.c

commit 50864580a87fc30ecfc5424eb8785d71365bbc93
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-08

    Added NsTclSetObjCmd

M	nsd/tclset.c

commit e9e0e766b9b66005bf09bfb1360b22751da3e15c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-08

    Modified Ns_Time type code to more efficiently maintain int/long based times without microseconds

M	nsd/tclobj.c

commit cce06fe5bd3eb1aed760c7c1416c360d26c275f3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-08

    Added seconds, microseconds, and make ns_time options; removed TZ env setting code from TmObjCmd

M	nsd/tclmisc.c

commit a0787d5bd572cd5b5a0222ae940c657f55d9dd11
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-08

    Updated with latest object commands

M	nsd/tclcmds.c

commit 74231df2efee6265813b70feeb68ff5322f6d1bf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-08

    Removed NsTclAtCloseObjCmd for now

M	nsd/tclatclose.c

commit d22433245a0d462943664737af72a8ad01567fc7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-08

    Fixed ns_modulepath

M	nsd/pathname.c

commit 19fe2614532a725077238c5657fa65759dafa5c9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-08

    Cleaned up new object commands

M	nsd/conn.c
M	nsd/info.c
M	nsd/nsmain.c
M	nsd/queue.c
M	nsd/random.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclthread.c

commit 5aeb1a7ac3645cd586865a1da02b15db3ff93956
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-08

    Minor cleanups

M	nsd/auth.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/urlencode.c

commit 5b61361ebc8d0a00a9c0e2dd333fdbefecd1adde
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-06

    Sorted option list for NsTclInfoObjCmd

M	nsd/info.c

commit dd45e55b3d0a28c8d35108a842eee1d7ea9e30c2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-06

    Added NsTclServerObjCmd

M	nsd/queue.c
M	nsd/tclcmds.c

commit 3b00c7a77248ef8e21867315d7ef8e88fa64f4da
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-06

    Updated with new ADP and ns_info object commands

M	nsd/tclcmds.c

commit 4767743e1bcdb33f4ebac8d87972a78fd8c3020b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-06

    Added NsTclInfoObjCmd

M	nsd/info.c

commit 36cd81de28e55d6414c0df3eccef5e120c99050c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-06

    Updated ADP commands to be object based

M	nsd/adpcmds.c

commit 37d407d1bbf0014d3a214cb9e26906d26a08b762
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-06

    Made NsAdpSource, NsAdpInclude, and NsAdpEval object based
    
    Side effect is "ns_adp_argv 0" now returns text of ns_adp_eval
    object instead of just "<inlined-script>".

M	nsd/adpeval.c

commit a26e57346944c5af49343f1fab11201fae859190
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-06

    Updated for new Tcl_Obj-based NsAdpInclude

M	nsd/adprequest.c

commit 81b6635ef6e65398b4d8229384a4e70bce2220ab
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-06

    Update the NsInterp struct and NsAdpSource, NsAdpInclude, NsAdpEval routines to maintain Tcl_Obj instead of string args

M	nsd/nsd.h

commit cb4264db9411881a6b519ad6bc11304cb2a484fc
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-07-06

    Updated NsTclMutexObjCmd to use Tcl_GetIndexFromObj

M	nsd/tclthread.c

commit 44e1858b5f8d5b83774b03f9945119d67ae283d9
Author: uid24488 <uid24488@users.sf.net>
Date:   2002-07-06

    Fixed unused variable warning

M	nsd/httptime.c

commit 5caba09cf748d468dd86c815cde25c6fe3da5332
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2002-06-25

    Reimplemented nsv as object commands

M	ChangeLog
M	nsd/tclcmds.c
M	nsd/tclvar.c

commit b8e4922693d207b1ac0ac56193d46a6da88aa0a6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-19

    Thread and cache related commands no longer require a server
    
    This exposes them in the config interp.

M	ChangeLog
M	nsd/tclcmds.c

commit 3a01673f1139515c599532ced0505da80914f0f4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-19

    Tcl threads can now be created without a server

M	nsd/tclthread.c

commit f6230a59c8a6ada2e2c5e7dd1acc8748d93404c8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-19

    NsGetServer handles NULL server

M	nsd/server.c

commit b0c98e2014892f4f1116f4fc82a96292d6c7a61d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-19

    Uses new Ns_TclCreateInterp for the config interp

M	nsd/config.c

commit 69cf28adb8fd63743717050a4a0be60c995c83be
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-19

    Added Ns_TclCreateInterp()

M	include/ns.h
M	nsd/tclinit.c

commit 813a09125ddb80cbc5cfccbd4e23211ecc07b563
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-17

    Remove conditional code to work around ETIME bug on Solaris
    
    This should no longer occur now that we're using process private
    objects once again.  The use of process shared objects surfaced
    this bug in Solaris 7 and below.

M	nsthread/cond.c

commit ca1e36d77ee6ed37e0718de22a9875757d25042d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-17

    Remove the HAVE_ETIME_BUG and USE_PTHREAD_PSHARED compile flags on Solaris and fixed /usr/lib/lwp RPATH directory
    
    In general, these changes assumes AOLserver is compiled/run on
    Solaris 8 or above for best performance.

M	include/Makefile.global

commit a4a0022379e483ae8d95e32fd74718b89b37508a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-14

    Silence compiler warnings

M	nsd/tclfile.c
M	nsd/tclresp.c

commit eebd7be05491c8acdf55ab005b2a55ce19bfa522
Author: Jeremy Collins <jcollins@phpsource.net>
Date:   2002-06-13

    Cleaned up the way the result was getting set on tcl errors

M	ChangeLog
M	nsd/auth.c
M	nsd/conn.c
M	nsd/form.c
M	nsd/log.c
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/random.c
M	nsd/tclatclose.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclmisc.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/urlopen.c

commit 70ca6e002dd428abe1a0e91503c301becf1279b6
Author: Jeremy Collins <jcollins@phpsource.net>
Date:   2002-06-13

    Reimplemented "ns_conn" as an obj based command
    
    In the process I also modified NsTclConnObjCmd to use
    Tcl_GetIndexFromObj.  This should improve performance as
    well as the readability of the code.

M	ChangeLog
M	nsd/conn.c
M	nsd/tclcmds.c

commit 5ea3d0f730a530d8ad30f7067eb1a737faf765bc
Author: Jeremy Collins <jcollins@phpsource.net>
Date:   2002-06-13

    Convert many commands to Tcl_Obj format

M	nsd/auth.c
M	nsd/conn.c
M	nsd/form.c
M	nsd/httptime.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/nsmain.c
M	nsd/pathname.c
M	nsd/random.c
M	nsd/tclatclose.c
M	nsd/tclcmds.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclinit.c
M	nsd/tclmisc.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclsock.c
M	nsd/tclthread.c
M	nsd/urlencode.c
M	nsd/urlopen.c

commit b867b800c14075c71e33d88b17e32fb77bb9a570
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-13

    Add [ns/parameter]objcmds bool to turn new object commands on or off
    
    (on by default)

M	nsd/nsconf.c
M	nsd/nsd.h

commit 316b46ca7009ef173d12a266103a166db464b6fd
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-12

    Added target for building aolserver only

M	Makefile

commit f59db015b63678ad3d1f43a2b51b94b35a60d940
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-12

    Removed old invalid config options

M	sample-config.tcl

commit 08391e76aa795d5072caa28b36d9ce348645ad2a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-12

    Add missing ChangeLog entries; cleanup format of old entries

M	ChangeLog

commit 3976b9c2f324cd35398da91e12655608db84cacb
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-12

    Added nsthreadtest program to exercise the thread interface

M	nsthread/Makefile
A	nsthread/nsthreadtest.c

commit 1c06801e5e4100c6c624b0e2277705f007d4a343
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-12

    Rename Ns_MutexEnum, Ns_ThreadEnum, and Ns_ThreadEnumProc to avoid conflict with AOLserver 3.x defs

M	include/nsthread.h
M	nsd/info.c
M	nsthread/thread.c

commit e4dfd0dc3666a1304a11c8260e6ceed045afb28c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-12

    Use NsMutexInitNext() to set underlying mutex name

M	nsthread/cslock.c
M	nsthread/mutex.c
M	nsthread/rwlock.c
M	nsthread/sema.c
M	nsthread/thread.h

commit 881907cc38270083e3e63dfe2ec00b246b36fe58
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-11

    Fixed build bug with RANLIB var

M	include/Makefile.global

commit ad1ec03d39206f0d403af9f0bd2642d82031e869
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-11

    Removed some unused vars

M	nsd/exec.c

commit 9593a8e68fff01f0fa1d3a0520b7156f1cb72334
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-11

    Removed debug printf

M	nsthread/thread.c

commit 0b374e388723b921ec8c3465e5e0faca85f4e47e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-10

    Core initialization is now via the NsdInit dynamic library init routines which calls other inits throughout the core..

M	ChangeLog
M	nsd/Makefile
M	nsd/binder.c
M	nsd/cache.c
M	nsd/config.c
M	nsd/encoding.c
M	nsd/exec.c
M	nsd/info.c
A	nsd/init.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/mimetypes.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/proc.c
M	nsd/sched.c
M	nsd/server.c
M	nsd/tclinit.c
M	nsd/urlspace.c

commit 2aa5abbb51444b6dcd9fcf13623dbe43f18248e6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-10

    Restore nsthread as a default link library; add support for dynamic library init routines via the LIBINIT variable

M	include/Makefile.global

commit 7cfd115e2cad235c5f8ce9ebaf14fb418939d6a8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-10

    Moved thread API from nsd back into nsthread library

M	Makefile
A	nsthread/Makefile
R099	nsd/compat.c	nsthread/compat.c
R099	nsd/cond.c	nsthread/cond.c
R099	nsd/cslock.c	nsthread/cslock.c
R095	nsd/error.c	nsthread/error.c
R099	nsd/fork.c	nsthread/fork.c
R099	nsd/master.c	nsthread/master.c
R099	nsd/memory.c	nsthread/memory.c
R099	nsd/mutex.c	nsthread/mutex.c
R098	nsd/osxcompat.c	nsthread/osxcompat.c
R097	nsd/osxcompat.h	nsthread/osxcompat.h
R099	nsd/reentrant.c	nsthread/reentrant.c
R099	nsd/rwlock.c	nsthread/rwlock.c
R099	nsd/sema.c	nsthread/sema.c
R099	nsd/signal.c	nsthread/signal.c
R090	nsd/thread.c	nsthread/thread.c
A	nsthread/thread.h
R099	nsd/time.c	nsthread/time.c
R099	nsd/tls.c	nsthread/tls.c

commit ab35498119afdd50f3a092105176acc97cee5e5d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-10

    Move tcl.h include to nsthread.h; remove Ns_CheckStack; add Ns_ThreadEnum and Ns_MutexEnum

M	include/ns.h
M	include/nsthread.h

commit 1cd9ac7ac12905ebacac40282d5e636834e6f9d7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-08

    All new notes of Tcl and AOLserver

M	doc/tcl-changes.txt

commit c1a63d0b09f5f0a2a3f74a484b3c3313147541c4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-08

    Routines no longer required for Tcl, moved remainder into nsd

M	ChangeLog
D	nsosx/Makefile
D	nsosx/README
D	nsosx/nsosx.c
D	nsosx/nsosx.h

commit 75e62ff1f16f8be9f75ec642252231569267f228
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-08

    Moved OS/X compat functions into nsd

M	nsd/Makefile
M	nsd/nsd.h
A	nsd/osxcompat.c
A	nsd/osxcompat.h

commit 19438a89e4797f004cf09127650ec82d9e985bd0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-08

    Add missing ChangeLog entries

M	ChangeLog

commit 206b90ae641a79bf6a6c4d3edd71caa065711d1e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-08

    Minor updates to silence compiler warnings, mostly around the const char changes in 8.4

M	include/nsthread.h
M	nscgi/nscgi.c
M	nsd/conn.c
M	nsd/memory.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclobj.c
M	nsd/tclrequest.c
M	nsd/tclvar.c
M	nsdb/dbtcl.c

commit 9ee28bb6f5e738e7f534e4a25a32bd0985e027c3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-08

    Now uses Makefile.module for dynamic library and program

M	nsd/Makefile

commit 805b1496ed776d4b21ee8b5ba241f889babf7b78
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-08

    Added -Wall for Apple and INCDIR for Makefile.module depend

M	include/Makefile.global

commit 0375f5e6eb0a77e5ec4e5aa8c01d83afb2cccdf5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-08

    Added support for building programs along with dynamic libraries and/or modules
    
    Also, objects depend on ns.h and nsthread.h by default.

M	include/Makefile.module

commit b2a6163d07d41d87b6a116c6e850bc0849050ac4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-08

    Set patch level to 4.0b3

M	include/ns.h

commit 6af7ccbdef4da54df5757d70f7f9d3b6649ae725
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-06

    Fixed typo

M	nsosx/README

commit d0850abf5bbeeba82aeefcce9cd094c6c7a8a185
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-06

    Removed unused function ExtFreeElement()

M	nsext/nsext.c

commit 5bac8b2c46eb0826cf4fb5b94d668ccb70c29058
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-06

    Change notes for 6/5/2002

M	ChangeLog

commit e14178c4315ab6c280067cf805687f92a8e3708b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-06

    Silenced various minor compiler warnings

M	nsd/adpparse.c
M	nsd/config.c
M	nsd/nsd.h
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/tclobj.c

commit dfb41b47a1b8e95ed85da1b53af05c56c609b22c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-06

    Switch to rwlock for registered tags to allow change after startup

M	nsd/server.c

commit e2f052db7f72388fa8d759d6eab0b53b43acf4c7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-06

    Fix parsing bug; allow registered tags to change after startup; support new ns_adp_safeeval, ns_adp_registerproc

M	nsd/adpparse.c
M	nsd/tclcmds.c

commit 277d66040c6f9f6b2d07f8734ff769f5e49715b6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-06

    Add ns_adp_safeeval which only allows execution of registered tags
    
    In this mode, script blocks i.e.  <% ... %>, are ignored.

M	nsd/adpcmds.c
M	nsd/adpeval.c

commit 9bc8c65666b967d00ffedf492afda52a6a5d1167
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-06

    Added instructions for building on OS/X

A	nsosx/README

commit 70f48d5df80de8f9f1fea70ee4aec9ccd5ce4dcf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-05

    Moved Apple specific compat code needed for Tcl and AOLserver into a single object file

M	nsd/nsd.h
M	nsd/unix.c
A	nsosx/Makefile
A	nsosx/nsosx.c
A	nsosx/nsosx.h

commit 9a1aec5cab6c45461da4c82281af9599c2963706
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-05

    Moved Apple specific undef to nsd.h

M	nsd/fastpath.c

commit 513f2ce5124fde8a758edead38eee654ae349d1e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-05

    Broke out public functions in libnsdb.so with simple stub nsdb.so module

M	nsdb/Makefile
M	nsdb/dbinit.c
A	nsdb/nsdb.c

commit b16d83227a4e626099906832560a7d2eeaa6bcf1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-05

    Moved Ns_Ext API from ../nspd to libnsext.so

M	nsext/Makefile
R100	nspd/msg.c	nsext/msg.c
M	nspd/Makefile

commit 9954d15382dfe3ad99fc87831190119e8d7bfa9f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-05

    Add support for building a dynamic library of public functions to go with the module
    
    e.g., libnsdb.dylib with nsdbo.so

M	include/Makefile.module

commit 3a00b494f2a7391fbcb0bca76a95795374d2c328
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-06-05

    Added tclmemdbg variable in Makefile.global to enable building with TCL_MEM_DEBUG flag

M	Makefile
M	include/Makefile.global

commit 9665beefb3536c0a135f0914f7e2fa8d04e60ec5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-16

    Removed some unused variables

M	nscgi/nscgi.c
M	nsd/adpeval.c
M	nsd/connio.c
M	nsd/modload.c
M	nsd/pathname.c
M	nsd/return.c
M	nsd/tclrequest.c
M	nsd/tclresp.c
M	nsd/tclvar.c
M	nsd/thread.c
M	nsd/unix.c
M	nsext/nsext.c

commit 579162732a5064e4abd97c1e5cb827dcb538180a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-16

    Added -Wall to build flags

M	include/Makefile.global

commit 37d23ca96fa600173ae609791b8019d4b347a633
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-16

    Updates for building with unmodified Tcl 8.4 sources

M	ChangeLog
M	Makefile

commit 8c9dca8041278953bab5e497c3dffaf2b42252df
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-16

    Removed the hacked 8.3.4 sources because 8.4 requires no modifications for AOLserver

D	tcl8.3.4/ChangeLog
D	tcl8.3.4/README
D	tcl8.3.4/changes
D	tcl8.3.4/compat/README
D	tcl8.3.4/compat/dirent.h
D	tcl8.3.4/compat/dirent2.h
D	tcl8.3.4/compat/dlfcn.h
D	tcl8.3.4/compat/fixstrtod.c
D	tcl8.3.4/compat/float.h
D	tcl8.3.4/compat/gettod.c
D	tcl8.3.4/compat/license.terms
D	tcl8.3.4/compat/limits.h
D	tcl8.3.4/compat/memcmp.c
D	tcl8.3.4/compat/opendir.c
D	tcl8.3.4/compat/stdlib.h
D	tcl8.3.4/compat/strftime.c
D	tcl8.3.4/compat/string.h
D	tcl8.3.4/compat/strncasecmp.c
D	tcl8.3.4/compat/strstr.c
D	tcl8.3.4/compat/strtod.c
D	tcl8.3.4/compat/strtol.c
D	tcl8.3.4/compat/strtoul.c
D	tcl8.3.4/compat/tclErrno.h
D	tcl8.3.4/compat/tmpnam.c
D	tcl8.3.4/compat/unistd.h
D	tcl8.3.4/compat/waitpid.c
D	tcl8.3.4/doc/Access.3
D	tcl8.3.4/doc/AddErrInfo.3
D	tcl8.3.4/doc/Alloc.3
D	tcl8.3.4/doc/AllowExc.3
D	tcl8.3.4/doc/AppInit.3
D	tcl8.3.4/doc/AssocData.3
D	tcl8.3.4/doc/Async.3
D	tcl8.3.4/doc/BackgdErr.3
D	tcl8.3.4/doc/Backslash.3
D	tcl8.3.4/doc/BoolObj.3
D	tcl8.3.4/doc/ByteArrObj.3
D	tcl8.3.4/doc/CallDel.3
D	tcl8.3.4/doc/ChnlStack.3
D	tcl8.3.4/doc/CmdCmplt.3
D	tcl8.3.4/doc/Concat.3
D	tcl8.3.4/doc/CrtChannel.3
D	tcl8.3.4/doc/CrtChnlHdlr.3
D	tcl8.3.4/doc/CrtCloseHdlr.3
D	tcl8.3.4/doc/CrtCommand.3
D	tcl8.3.4/doc/CrtFileHdlr.3
D	tcl8.3.4/doc/CrtInterp.3
D	tcl8.3.4/doc/CrtMathFnc.3
D	tcl8.3.4/doc/CrtObjCmd.3
D	tcl8.3.4/doc/CrtSlave.3
D	tcl8.3.4/doc/CrtTimerHdlr.3
D	tcl8.3.4/doc/CrtTrace.3
D	tcl8.3.4/doc/DString.3
D	tcl8.3.4/doc/DetachPids.3
D	tcl8.3.4/doc/DoOneEvent.3
D	tcl8.3.4/doc/DoWhenIdle.3
D	tcl8.3.4/doc/DoubleObj.3
D	tcl8.3.4/doc/DumpActiveMemory.3
D	tcl8.3.4/doc/Encoding.3
D	tcl8.3.4/doc/Eval.3
D	tcl8.3.4/doc/Exit.3
D	tcl8.3.4/doc/ExprLong.3
D	tcl8.3.4/doc/ExprLongObj.3
D	tcl8.3.4/doc/FindExec.3
D	tcl8.3.4/doc/GetCwd.3
D	tcl8.3.4/doc/GetHostName.3
D	tcl8.3.4/doc/GetIndex.3
D	tcl8.3.4/doc/GetInt.3
D	tcl8.3.4/doc/GetOpnFl.3
D	tcl8.3.4/doc/GetStdChan.3
D	tcl8.3.4/doc/GetVersion.3
D	tcl8.3.4/doc/Hash.3
D	tcl8.3.4/doc/Init.3
D	tcl8.3.4/doc/InitStubs.3
D	tcl8.3.4/doc/IntObj.3
D	tcl8.3.4/doc/Interp.3
D	tcl8.3.4/doc/LinkVar.3
D	tcl8.3.4/doc/ListObj.3
D	tcl8.3.4/doc/Notifier.3
D	tcl8.3.4/doc/Object.3
D	tcl8.3.4/doc/ObjectType.3
D	tcl8.3.4/doc/OpenFileChnl.3
D	tcl8.3.4/doc/OpenTcp.3
D	tcl8.3.4/doc/ParseCmd.3
D	tcl8.3.4/doc/PkgRequire.3
D	tcl8.3.4/doc/Preserve.3
D	tcl8.3.4/doc/PrintDbl.3
D	tcl8.3.4/doc/RecEvalObj.3
D	tcl8.3.4/doc/RecordEval.3
D	tcl8.3.4/doc/RegExp.3
D	tcl8.3.4/doc/SaveResult.3
D	tcl8.3.4/doc/SetErrno.3
D	tcl8.3.4/doc/SetRecLmt.3
D	tcl8.3.4/doc/SetResult.3
D	tcl8.3.4/doc/SetVar.3
D	tcl8.3.4/doc/Sleep.3
D	tcl8.3.4/doc/SourceRCFile.3
D	tcl8.3.4/doc/SplitList.3
D	tcl8.3.4/doc/SplitPath.3
D	tcl8.3.4/doc/StaticPkg.3
D	tcl8.3.4/doc/StrMatch.3
D	tcl8.3.4/doc/StringObj.3
D	tcl8.3.4/doc/TCL_MEM_DEBUG.3
D	tcl8.3.4/doc/Tcl.n
D	tcl8.3.4/doc/Tcl_Main.3
D	tcl8.3.4/doc/Thread.3
D	tcl8.3.4/doc/ToUpper.3
D	tcl8.3.4/doc/TraceVar.3
D	tcl8.3.4/doc/Translate.3
D	tcl8.3.4/doc/UpVar.3
D	tcl8.3.4/doc/Utf.3
D	tcl8.3.4/doc/WrongNumArgs.3
D	tcl8.3.4/doc/after.n
D	tcl8.3.4/doc/append.n
D	tcl8.3.4/doc/array.n
D	tcl8.3.4/doc/bgerror.n
D	tcl8.3.4/doc/binary.n
D	tcl8.3.4/doc/break.n
D	tcl8.3.4/doc/case.n
D	tcl8.3.4/doc/catch.n
D	tcl8.3.4/doc/cd.n
D	tcl8.3.4/doc/clock.n
D	tcl8.3.4/doc/close.n
D	tcl8.3.4/doc/concat.n
D	tcl8.3.4/doc/continue.n
D	tcl8.3.4/doc/dde.n
D	tcl8.3.4/doc/encoding.n
D	tcl8.3.4/doc/eof.n
D	tcl8.3.4/doc/error.n
D	tcl8.3.4/doc/eval.n
D	tcl8.3.4/doc/exec.n
D	tcl8.3.4/doc/exit.n
D	tcl8.3.4/doc/expr.n
D	tcl8.3.4/doc/fblocked.n
D	tcl8.3.4/doc/fconfigure.n
D	tcl8.3.4/doc/fcopy.n
D	tcl8.3.4/doc/file.n
D	tcl8.3.4/doc/fileevent.n
D	tcl8.3.4/doc/filename.n
D	tcl8.3.4/doc/flush.n
D	tcl8.3.4/doc/for.n
D	tcl8.3.4/doc/foreach.n
D	tcl8.3.4/doc/format.n
D	tcl8.3.4/doc/gets.n
D	tcl8.3.4/doc/glob.n
D	tcl8.3.4/doc/global.n
D	tcl8.3.4/doc/history.n
D	tcl8.3.4/doc/http.n
D	tcl8.3.4/doc/if.n
D	tcl8.3.4/doc/incr.n
D	tcl8.3.4/doc/info.n
D	tcl8.3.4/doc/interp.n
D	tcl8.3.4/doc/join.n
D	tcl8.3.4/doc/lappend.n
D	tcl8.3.4/doc/library.n
D	tcl8.3.4/doc/license.terms
D	tcl8.3.4/doc/lindex.n
D	tcl8.3.4/doc/linsert.n
D	tcl8.3.4/doc/list.n
D	tcl8.3.4/doc/llength.n
D	tcl8.3.4/doc/load.n
D	tcl8.3.4/doc/lrange.n
D	tcl8.3.4/doc/lreplace.n
D	tcl8.3.4/doc/lsearch.n
D	tcl8.3.4/doc/lsort.n
D	tcl8.3.4/doc/man.macros
D	tcl8.3.4/doc/memory.n
D	tcl8.3.4/doc/msgcat.n
D	tcl8.3.4/doc/namespace.n
D	tcl8.3.4/doc/open.n
D	tcl8.3.4/doc/package.n
D	tcl8.3.4/doc/packagens.n
D	tcl8.3.4/doc/pid.n
D	tcl8.3.4/doc/pkgMkIndex.n
D	tcl8.3.4/doc/proc.n
D	tcl8.3.4/doc/puts.n
D	tcl8.3.4/doc/pwd.n
D	tcl8.3.4/doc/re_syntax.n
D	tcl8.3.4/doc/read.n
D	tcl8.3.4/doc/regexp.n
D	tcl8.3.4/doc/registry.n
D	tcl8.3.4/doc/regsub.n
D	tcl8.3.4/doc/rename.n
D	tcl8.3.4/doc/resource.n
D	tcl8.3.4/doc/return.n
D	tcl8.3.4/doc/safe.n
D	tcl8.3.4/doc/scan.n
D	tcl8.3.4/doc/seek.n
D	tcl8.3.4/doc/set.n
D	tcl8.3.4/doc/socket.n
D	tcl8.3.4/doc/source.n
D	tcl8.3.4/doc/split.n
D	tcl8.3.4/doc/string.n
D	tcl8.3.4/doc/subst.n
D	tcl8.3.4/doc/switch.n
D	tcl8.3.4/doc/tclsh.1
D	tcl8.3.4/doc/tcltest.n
D	tcl8.3.4/doc/tclvars.n
D	tcl8.3.4/doc/tell.n
D	tcl8.3.4/doc/time.n
D	tcl8.3.4/doc/trace.n
D	tcl8.3.4/doc/unknown.n
D	tcl8.3.4/doc/unset.n
D	tcl8.3.4/doc/update.n
D	tcl8.3.4/doc/uplevel.n
D	tcl8.3.4/doc/upvar.n
D	tcl8.3.4/doc/variable.n
D	tcl8.3.4/doc/vwait.n
D	tcl8.3.4/doc/while.n
D	tcl8.3.4/generic/README
D	tcl8.3.4/generic/regc_color.c
D	tcl8.3.4/generic/regc_cvec.c
D	tcl8.3.4/generic/regc_lex.c
D	tcl8.3.4/generic/regc_locale.c
D	tcl8.3.4/generic/regc_nfa.c
D	tcl8.3.4/generic/regcomp.c
D	tcl8.3.4/generic/regcustom.h
D	tcl8.3.4/generic/rege_dfa.c
D	tcl8.3.4/generic/regerror.c
D	tcl8.3.4/generic/regerrs.h
D	tcl8.3.4/generic/regex.h
D	tcl8.3.4/generic/regexec.c
D	tcl8.3.4/generic/regfree.c
D	tcl8.3.4/generic/regfronts.c
D	tcl8.3.4/generic/regguts.h
D	tcl8.3.4/generic/tcl.decls
D	tcl8.3.4/generic/tcl.h
D	tcl8.3.4/generic/tclAlloc.c
D	tcl8.3.4/generic/tclAlloc.c.orig
D	tcl8.3.4/generic/tclAsync.c
D	tcl8.3.4/generic/tclBasic.c
D	tcl8.3.4/generic/tclBinary.c
D	tcl8.3.4/generic/tclCkalloc.c
D	tcl8.3.4/generic/tclClock.c
D	tcl8.3.4/generic/tclCmdAH.c
D	tcl8.3.4/generic/tclCmdIL.c
D	tcl8.3.4/generic/tclCmdMZ.c
D	tcl8.3.4/generic/tclCompCmds.c
D	tcl8.3.4/generic/tclCompExpr.c
D	tcl8.3.4/generic/tclCompile.c
D	tcl8.3.4/generic/tclCompile.h
D	tcl8.3.4/generic/tclDate.c
D	tcl8.3.4/generic/tclDecls.h
D	tcl8.3.4/generic/tclEncoding.c
D	tcl8.3.4/generic/tclEnv.c
D	tcl8.3.4/generic/tclEvent.c
D	tcl8.3.4/generic/tclExecute.c
D	tcl8.3.4/generic/tclFCmd.c
D	tcl8.3.4/generic/tclFileName.c
D	tcl8.3.4/generic/tclGet.c
D	tcl8.3.4/generic/tclGetDate.y
D	tcl8.3.4/generic/tclHash.c
D	tcl8.3.4/generic/tclHistory.c
D	tcl8.3.4/generic/tclIO.c
D	tcl8.3.4/generic/tclIO.h
D	tcl8.3.4/generic/tclIOCmd.c
D	tcl8.3.4/generic/tclIOGT.c
D	tcl8.3.4/generic/tclIOSock.c
D	tcl8.3.4/generic/tclIOUtil.c
D	tcl8.3.4/generic/tclIndexObj.c
D	tcl8.3.4/generic/tclInitScript.h
D	tcl8.3.4/generic/tclInt.decls
D	tcl8.3.4/generic/tclInt.h
D	tcl8.3.4/generic/tclInt.h.orig
D	tcl8.3.4/generic/tclIntDecls.h
D	tcl8.3.4/generic/tclIntPlatDecls.h
D	tcl8.3.4/generic/tclInterp.c
D	tcl8.3.4/generic/tclLink.c
D	tcl8.3.4/generic/tclListObj.c
D	tcl8.3.4/generic/tclLiteral.c
D	tcl8.3.4/generic/tclLoad.c
D	tcl8.3.4/generic/tclLoadNone.c
D	tcl8.3.4/generic/tclMain.c
D	tcl8.3.4/generic/tclMath.h
D	tcl8.3.4/generic/tclNamesp.c
D	tcl8.3.4/generic/tclNotify.c
D	tcl8.3.4/generic/tclObj.c
D	tcl8.3.4/generic/tclObj.c.orig
D	tcl8.3.4/generic/tclPanic.c
D	tcl8.3.4/generic/tclParse.c
D	tcl8.3.4/generic/tclParseExpr.c
D	tcl8.3.4/generic/tclPipe.c
D	tcl8.3.4/generic/tclPkg.c
D	tcl8.3.4/generic/tclPlatDecls.h
D	tcl8.3.4/generic/tclPort.h
D	tcl8.3.4/generic/tclPosixStr.c
D	tcl8.3.4/generic/tclPreserve.c
D	tcl8.3.4/generic/tclProc.c
D	tcl8.3.4/generic/tclRegexp.c
D	tcl8.3.4/generic/tclRegexp.h
D	tcl8.3.4/generic/tclResolve.c
D	tcl8.3.4/generic/tclResult.c
D	tcl8.3.4/generic/tclScan.c
D	tcl8.3.4/generic/tclStringObj.c
D	tcl8.3.4/generic/tclStubInit.c
D	tcl8.3.4/generic/tclStubInit.c.orig
D	tcl8.3.4/generic/tclStubLib.c
D	tcl8.3.4/generic/tclTest.c
D	tcl8.3.4/generic/tclTestObj.c
D	tcl8.3.4/generic/tclTestProcBodyObj.c
D	tcl8.3.4/generic/tclThread.c
D	tcl8.3.4/generic/tclThreadTest.c
D	tcl8.3.4/generic/tclTimer.c
D	tcl8.3.4/generic/tclUniData.c
D	tcl8.3.4/generic/tclUtf.c
D	tcl8.3.4/generic/tclUtil.c
D	tcl8.3.4/generic/tclVar.c
D	tcl8.3.4/library/auto.tcl
D	tcl8.3.4/library/dde1.1/pkgIndex.tcl
D	tcl8.3.4/library/encoding/ascii.enc
D	tcl8.3.4/library/encoding/big5.enc
D	tcl8.3.4/library/encoding/cp1250.enc
D	tcl8.3.4/library/encoding/cp1251.enc
D	tcl8.3.4/library/encoding/cp1252.enc
D	tcl8.3.4/library/encoding/cp1253.enc
D	tcl8.3.4/library/encoding/cp1254.enc
D	tcl8.3.4/library/encoding/cp1255.enc
D	tcl8.3.4/library/encoding/cp1256.enc
D	tcl8.3.4/library/encoding/cp1257.enc
D	tcl8.3.4/library/encoding/cp1258.enc
D	tcl8.3.4/library/encoding/cp437.enc
D	tcl8.3.4/library/encoding/cp737.enc
D	tcl8.3.4/library/encoding/cp775.enc
D	tcl8.3.4/library/encoding/cp850.enc
D	tcl8.3.4/library/encoding/cp852.enc
D	tcl8.3.4/library/encoding/cp855.enc
D	tcl8.3.4/library/encoding/cp857.enc
D	tcl8.3.4/library/encoding/cp860.enc
D	tcl8.3.4/library/encoding/cp861.enc
D	tcl8.3.4/library/encoding/cp862.enc
D	tcl8.3.4/library/encoding/cp863.enc
D	tcl8.3.4/library/encoding/cp864.enc
D	tcl8.3.4/library/encoding/cp865.enc
D	tcl8.3.4/library/encoding/cp866.enc
D	tcl8.3.4/library/encoding/cp869.enc
D	tcl8.3.4/library/encoding/cp874.enc
D	tcl8.3.4/library/encoding/cp932.enc
D	tcl8.3.4/library/encoding/cp936.enc
D	tcl8.3.4/library/encoding/cp949.enc
D	tcl8.3.4/library/encoding/cp950.enc
D	tcl8.3.4/library/encoding/dingbats.enc
D	tcl8.3.4/library/encoding/ebcdic.enc
D	tcl8.3.4/library/encoding/euc-cn.enc
D	tcl8.3.4/library/encoding/euc-jp.enc
D	tcl8.3.4/library/encoding/euc-kr.enc
D	tcl8.3.4/library/encoding/gb12345.enc
D	tcl8.3.4/library/encoding/gb1988.enc
D	tcl8.3.4/library/encoding/gb2312.enc
D	tcl8.3.4/library/encoding/iso2022-jp.enc
D	tcl8.3.4/library/encoding/iso2022-kr.enc
D	tcl8.3.4/library/encoding/iso2022.enc
D	tcl8.3.4/library/encoding/iso8859-1.enc
D	tcl8.3.4/library/encoding/iso8859-10.enc
D	tcl8.3.4/library/encoding/iso8859-13.enc
D	tcl8.3.4/library/encoding/iso8859-14.enc
D	tcl8.3.4/library/encoding/iso8859-15.enc
D	tcl8.3.4/library/encoding/iso8859-16.enc
D	tcl8.3.4/library/encoding/iso8859-2.enc
D	tcl8.3.4/library/encoding/iso8859-3.enc
D	tcl8.3.4/library/encoding/iso8859-4.enc
D	tcl8.3.4/library/encoding/iso8859-5.enc
D	tcl8.3.4/library/encoding/iso8859-6.enc
D	tcl8.3.4/library/encoding/iso8859-7.enc
D	tcl8.3.4/library/encoding/iso8859-8.enc
D	tcl8.3.4/library/encoding/iso8859-9.enc
D	tcl8.3.4/library/encoding/jis0201.enc
D	tcl8.3.4/library/encoding/jis0208.enc
D	tcl8.3.4/library/encoding/jis0212.enc
D	tcl8.3.4/library/encoding/koi8-r.enc
D	tcl8.3.4/library/encoding/koi8-u.enc
D	tcl8.3.4/library/encoding/ksc5601.enc
D	tcl8.3.4/library/encoding/macCentEuro.enc
D	tcl8.3.4/library/encoding/macCroatian.enc
D	tcl8.3.4/library/encoding/macCyrillic.enc
D	tcl8.3.4/library/encoding/macDingbats.enc
D	tcl8.3.4/library/encoding/macGreek.enc
D	tcl8.3.4/library/encoding/macIceland.enc
D	tcl8.3.4/library/encoding/macJapan.enc
D	tcl8.3.4/library/encoding/macRoman.enc
D	tcl8.3.4/library/encoding/macRomania.enc
D	tcl8.3.4/library/encoding/macThai.enc
D	tcl8.3.4/library/encoding/macTurkish.enc
D	tcl8.3.4/library/encoding/macUkraine.enc
D	tcl8.3.4/library/encoding/shiftjis.enc
D	tcl8.3.4/library/encoding/symbol.enc
D	tcl8.3.4/library/encoding/tis-620.enc
D	tcl8.3.4/library/history.tcl
D	tcl8.3.4/library/http/http.tcl
D	tcl8.3.4/library/http/pkgIndex.tcl
D	tcl8.3.4/library/http1.0/http.tcl
D	tcl8.3.4/library/http1.0/pkgIndex.tcl
D	tcl8.3.4/library/init.tcl
D	tcl8.3.4/library/ldAout.tcl
D	tcl8.3.4/library/license.terms
D	tcl8.3.4/library/msgcat/msgcat.tcl
D	tcl8.3.4/library/msgcat/pkgIndex.tcl
D	tcl8.3.4/library/opt/optparse.tcl
D	tcl8.3.4/library/opt/pkgIndex.tcl
D	tcl8.3.4/library/package.tcl
D	tcl8.3.4/library/parray.tcl
D	tcl8.3.4/library/reg1.0/pkgIndex.tcl
D	tcl8.3.4/library/safe.tcl
D	tcl8.3.4/library/tclIndex
D	tcl8.3.4/library/tcltest1.0/pkgIndex.tcl
D	tcl8.3.4/library/tcltest1.0/tcltest.tcl
D	tcl8.3.4/library/word.tcl
D	tcl8.3.4/license.terms
D	tcl8.3.4/mac/AppleScript.html
D	tcl8.3.4/mac/Background.doc
D	tcl8.3.4/mac/MW_TclAppleScriptHeader.h
D	tcl8.3.4/mac/MW_TclAppleScriptHeader.pch
D	tcl8.3.4/mac/MW_TclBuildLibHeader.h
D	tcl8.3.4/mac/MW_TclBuildLibHeader.pch
D	tcl8.3.4/mac/MW_TclHeader.h
D	tcl8.3.4/mac/MW_TclHeader.pch
D	tcl8.3.4/mac/MW_TclHeaderCommon.h
D	tcl8.3.4/mac/MW_TclStaticHeader.h
D	tcl8.3.4/mac/MW_TclStaticHeader.pch
D	tcl8.3.4/mac/MW_TclTestHeader.h
D	tcl8.3.4/mac/MW_TclTestHeader.pch
D	tcl8.3.4/mac/README
D	tcl8.3.4/mac/bugs.doc
D	tcl8.3.4/mac/libmoto.doc
D	tcl8.3.4/mac/license.terms
D	tcl8.3.4/mac/morefiles.doc
D	tcl8.3.4/mac/porting.notes
D	tcl8.3.4/mac/tclMac.h
D	tcl8.3.4/mac/tclMacAETE.r
D	tcl8.3.4/mac/tclMacAlloc.c
D	tcl8.3.4/mac/tclMacAppInit.c
D	tcl8.3.4/mac/tclMacApplication.r
D	tcl8.3.4/mac/tclMacBOAAppInit.c
D	tcl8.3.4/mac/tclMacBOAMain.c
D	tcl8.3.4/mac/tclMacChan.c
D	tcl8.3.4/mac/tclMacCommonPch.h
D	tcl8.3.4/mac/tclMacDNR.c
D	tcl8.3.4/mac/tclMacEnv.c
D	tcl8.3.4/mac/tclMacExit.c
D	tcl8.3.4/mac/tclMacFCmd.c
D	tcl8.3.4/mac/tclMacFile.c
D	tcl8.3.4/mac/tclMacInit.c
D	tcl8.3.4/mac/tclMacInt.h
D	tcl8.3.4/mac/tclMacInterupt.c
D	tcl8.3.4/mac/tclMacLibrary.c
D	tcl8.3.4/mac/tclMacLibrary.r
D	tcl8.3.4/mac/tclMacLoad.c
D	tcl8.3.4/mac/tclMacMath.h
D	tcl8.3.4/mac/tclMacNotify.c
D	tcl8.3.4/mac/tclmacOSA.c
D	tcl8.3.4/mac/tclmacOSA.r
D	tcl8.3.4/mac/tclMacPanic.c
D	tcl8.3.4/mac/tclMacPort.h
D	tcl8.3.4/mac/tclMacProjects.sea.hqx
D	tcl8.3.4/mac/tclMacResource.c
D	tcl8.3.4/mac/tclMacResource.r
D	tcl8.3.4/mac/tclMacSock.c
D	tcl8.3.4/mac/tclMacTclCode.r
D	tcl8.3.4/mac/tclMacTest.c
D	tcl8.3.4/mac/tclMacThrd.c
D	tcl8.3.4/mac/tclMacThrd.h
D	tcl8.3.4/mac/tclMacTime.c
D	tcl8.3.4/mac/tclMacUnix.c
D	tcl8.3.4/mac/tclMacUtil.c
D	tcl8.3.4/tests/README
D	tcl8.3.4/tests/all.tcl
D	tcl8.3.4/tests/append.test
D	tcl8.3.4/tests/assocd.test
D	tcl8.3.4/tests/async.test
D	tcl8.3.4/tests/autoMkindex.tcl
D	tcl8.3.4/tests/autoMkindex.test
D	tcl8.3.4/tests/basic.test
D	tcl8.3.4/tests/binary.test
D	tcl8.3.4/tests/case.test
D	tcl8.3.4/tests/clock.test
D	tcl8.3.4/tests/cmdAH.test
D	tcl8.3.4/tests/cmdIL.test
D	tcl8.3.4/tests/cmdInfo.test
D	tcl8.3.4/tests/cmdMZ.test
D	tcl8.3.4/tests/compExpr-old.test
D	tcl8.3.4/tests/compExpr.test
D	tcl8.3.4/tests/compile.test
D	tcl8.3.4/tests/concat.test
D	tcl8.3.4/tests/dcall.test
D	tcl8.3.4/tests/dstring.test
D	tcl8.3.4/tests/encoding.test
D	tcl8.3.4/tests/env.test
D	tcl8.3.4/tests/error.test
D	tcl8.3.4/tests/eval.test
D	tcl8.3.4/tests/event.test
D	tcl8.3.4/tests/exec.test
D	tcl8.3.4/tests/execute.test
D	tcl8.3.4/tests/expr-old.test
D	tcl8.3.4/tests/expr.test
D	tcl8.3.4/tests/fCmd.test
D	tcl8.3.4/tests/fileName.test
D	tcl8.3.4/tests/for-old.test
D	tcl8.3.4/tests/for.test
D	tcl8.3.4/tests/foreach.test
D	tcl8.3.4/tests/format.test
D	tcl8.3.4/tests/get.test
D	tcl8.3.4/tests/history.test
D	tcl8.3.4/tests/http.test
D	tcl8.3.4/tests/httpd
D	tcl8.3.4/tests/httpold.test
D	tcl8.3.4/tests/if-old.test
D	tcl8.3.4/tests/if.test
D	tcl8.3.4/tests/incr-old.test
D	tcl8.3.4/tests/incr.test
D	tcl8.3.4/tests/indexObj.test
D	tcl8.3.4/tests/info.test
D	tcl8.3.4/tests/init.test
D	tcl8.3.4/tests/interp.test
D	tcl8.3.4/tests/io.test
D	tcl8.3.4/tests/ioCmd.test
D	tcl8.3.4/tests/ioUtil.test
D	tcl8.3.4/tests/iogt.test
D	tcl8.3.4/tests/join.test
D	tcl8.3.4/tests/license.terms
D	tcl8.3.4/tests/lindex.test
D	tcl8.3.4/tests/link.test
D	tcl8.3.4/tests/linsert.test
D	tcl8.3.4/tests/list.test
D	tcl8.3.4/tests/listObj.test
D	tcl8.3.4/tests/llength.test
D	tcl8.3.4/tests/load.test
D	tcl8.3.4/tests/lrange.test
D	tcl8.3.4/tests/lreplace.test
D	tcl8.3.4/tests/lsearch.test
D	tcl8.3.4/tests/macFCmd.test
D	tcl8.3.4/tests/misc.test
D	tcl8.3.4/tests/msgcat.test
D	tcl8.3.4/tests/namespace-old.test
D	tcl8.3.4/tests/namespace.test
D	tcl8.3.4/tests/obj.test
D	tcl8.3.4/tests/opt.test
D	tcl8.3.4/tests/osa.test
D	tcl8.3.4/tests/package.test
D	tcl8.3.4/tests/parse.test
D	tcl8.3.4/tests/parseExpr.test
D	tcl8.3.4/tests/parseOld.test
D	tcl8.3.4/tests/pid.test
D	tcl8.3.4/tests/pkg.test
D	tcl8.3.4/tests/pkg/circ1.tcl
D	tcl8.3.4/tests/pkg/circ2.tcl
D	tcl8.3.4/tests/pkg/circ3.tcl
D	tcl8.3.4/tests/pkg/global.tcl
D	tcl8.3.4/tests/pkg/import.tcl
D	tcl8.3.4/tests/pkg/license.terms
D	tcl8.3.4/tests/pkg/magicchar.tcl
D	tcl8.3.4/tests/pkg/magicchar2.tcl
D	tcl8.3.4/tests/pkg/pkg1.tcl
D	tcl8.3.4/tests/pkg/pkg2_a.tcl
D	tcl8.3.4/tests/pkg/pkg2_b.tcl
D	tcl8.3.4/tests/pkg/pkg3.tcl
D	tcl8.3.4/tests/pkg/pkg4.tcl
D	tcl8.3.4/tests/pkg/pkg5.tcl
D	tcl8.3.4/tests/pkg/pkga.tcl
D	tcl8.3.4/tests/pkg/samename.tcl
D	tcl8.3.4/tests/pkg/simple.tcl
D	tcl8.3.4/tests/pkg/spacename.tcl
D	tcl8.3.4/tests/pkg/std.tcl
D	tcl8.3.4/tests/pkgMkIndex.test
D	tcl8.3.4/tests/platform.test
D	tcl8.3.4/tests/proc-old.test
D	tcl8.3.4/tests/proc.test
D	tcl8.3.4/tests/pwd.test
D	tcl8.3.4/tests/reg.test
D	tcl8.3.4/tests/regexp.test
D	tcl8.3.4/tests/registry.test
D	tcl8.3.4/tests/remote.tcl
D	tcl8.3.4/tests/rename.test
D	tcl8.3.4/tests/resource.test
D	tcl8.3.4/tests/result.test
D	tcl8.3.4/tests/safe.test
D	tcl8.3.4/tests/scan.test
D	tcl8.3.4/tests/security.test
D	tcl8.3.4/tests/set-old.test
D	tcl8.3.4/tests/set.test
D	tcl8.3.4/tests/socket.test
D	tcl8.3.4/tests/source.test
D	tcl8.3.4/tests/split.test
D	tcl8.3.4/tests/stack.test
D	tcl8.3.4/tests/string.test
D	tcl8.3.4/tests/stringObj.test
D	tcl8.3.4/tests/subst.test
D	tcl8.3.4/tests/switch.test
D	tcl8.3.4/tests/tcltest.test
D	tcl8.3.4/tests/thread.test
D	tcl8.3.4/tests/timer.test
D	tcl8.3.4/tests/trace.test
D	tcl8.3.4/tests/unixFCmd.test
D	tcl8.3.4/tests/unixFile.test
D	tcl8.3.4/tests/unixInit.test
D	tcl8.3.4/tests/unixNotfy.test
D	tcl8.3.4/tests/unknown.test
D	tcl8.3.4/tests/uplevel.test
D	tcl8.3.4/tests/upvar.test
D	tcl8.3.4/tests/utf.test
D	tcl8.3.4/tests/util.test
D	tcl8.3.4/tests/var.test
D	tcl8.3.4/tests/while-old.test
D	tcl8.3.4/tests/while.test
D	tcl8.3.4/tests/winConsole.test
D	tcl8.3.4/tests/winDde.test
D	tcl8.3.4/tests/winFCmd.test
D	tcl8.3.4/tests/winFile.test
D	tcl8.3.4/tests/winNotify.test
D	tcl8.3.4/tests/winPipe.test
D	tcl8.3.4/tests/winTime.test
D	tcl8.3.4/tools/Makefile.in
D	tcl8.3.4/tools/README
D	tcl8.3.4/tools/checkLibraryDoc.tcl
D	tcl8.3.4/tools/configure
D	tcl8.3.4/tools/configure.in
D	tcl8.3.4/tools/cvtEOL.tcl
D	tcl8.3.4/tools/genStubs.tcl
D	tcl8.3.4/tools/genWinImage.tcl
D	tcl8.3.4/tools/index.tcl
D	tcl8.3.4/tools/man2help.tcl
D	tcl8.3.4/tools/man2help2.tcl
D	tcl8.3.4/tools/man2html.tcl
D	tcl8.3.4/tools/man2html1.tcl
D	tcl8.3.4/tools/man2html2.tcl
D	tcl8.3.4/tools/man2tcl.c
D	tcl8.3.4/tools/regexpTestLib.tcl
D	tcl8.3.4/tools/tcl.hpj.in
D	tcl8.3.4/tools/tcl.wse.in
D	tcl8.3.4/tools/tclSplash.bmp
D	tcl8.3.4/tools/tcltk-man2html.tcl
D	tcl8.3.4/tools/uniClass.tcl
D	tcl8.3.4/tools/uniParse.tcl
D	tcl8.3.4/tools/white.bmp
D	tcl8.3.4/unix/Makefile.in
D	tcl8.3.4/unix/README
D	tcl8.3.4/unix/aclocal.m4
D	tcl8.3.4/unix/configure
D	tcl8.3.4/unix/configure.in
D	tcl8.3.4/unix/configure.orig
D	tcl8.3.4/unix/dltest/Makefile.in
D	tcl8.3.4/unix/dltest/README
D	tcl8.3.4/unix/dltest/configure
D	tcl8.3.4/unix/dltest/configure.in
D	tcl8.3.4/unix/dltest/pkga.c
D	tcl8.3.4/unix/dltest/pkgb.c
D	tcl8.3.4/unix/dltest/pkgc.c
D	tcl8.3.4/unix/dltest/pkgd.c
D	tcl8.3.4/unix/dltest/pkge.c
D	tcl8.3.4/unix/dltest/pkgf.c
D	tcl8.3.4/unix/install-sh
D	tcl8.3.4/unix/ldAix
D	tcl8.3.4/unix/mkLinks
D	tcl8.3.4/unix/tcl.m4
D	tcl8.3.4/unix/tcl.m4.orig
D	tcl8.3.4/unix/tcl.spec
D	tcl8.3.4/unix/tclAppInit.c
D	tcl8.3.4/unix/tclConfig.sh.in
D	tcl8.3.4/unix/tclLoadAix.c
D	tcl8.3.4/unix/tclLoadAout.c
D	tcl8.3.4/unix/tclLoadDl.c
D	tcl8.3.4/unix/tclLoadDld.c
D	tcl8.3.4/unix/tclLoadDyld.c
D	tcl8.3.4/unix/tclLoadDyld.c.orig
D	tcl8.3.4/unix/tclLoadNext.c
D	tcl8.3.4/unix/tclLoadOSF.c
D	tcl8.3.4/unix/tclLoadShl.c
D	tcl8.3.4/unix/tclMtherr.c
D	tcl8.3.4/unix/tclUnixChan.c
D	tcl8.3.4/unix/tclUnixEvent.c
D	tcl8.3.4/unix/tclUnixFCmd.c
D	tcl8.3.4/unix/tclUnixFile.c
D	tcl8.3.4/unix/tclUnixInit.c
D	tcl8.3.4/unix/tclUnixNotfy.c
D	tcl8.3.4/unix/tclUnixPipe.c
D	tcl8.3.4/unix/tclUnixPort.h
D	tcl8.3.4/unix/tclUnixPort.h.orig
D	tcl8.3.4/unix/tclUnixSock.c
D	tcl8.3.4/unix/tclUnixTest.c
D	tcl8.3.4/unix/tclUnixThrd.c
D	tcl8.3.4/unix/tclUnixThrd.c.orig
D	tcl8.3.4/unix/tclUnixThrd.h
D	tcl8.3.4/unix/tclUnixTime.c
D	tcl8.3.4/unix/tclXtNotify.c
D	tcl8.3.4/unix/tclXtTest.c
D	tcl8.3.4/win/Makefile.in
D	tcl8.3.4/win/README
D	tcl8.3.4/win/aclocal.m4
D	tcl8.3.4/win/cat.c
D	tcl8.3.4/win/configure
D	tcl8.3.4/win/configure.in
D	tcl8.3.4/win/license.terms
D	tcl8.3.4/win/makefile.vc
D	tcl8.3.4/win/mkd.bat
D	tcl8.3.4/win/rmd.bat
D	tcl8.3.4/win/stub16.c
D	tcl8.3.4/win/tcl.hpj.in
D	tcl8.3.4/win/tcl.m4
D	tcl8.3.4/win/tcl.rc
D	tcl8.3.4/win/tclAppInit.c
D	tcl8.3.4/win/tclConfig.sh.in
D	tcl8.3.4/win/tclWin32Dll.c
D	tcl8.3.4/win/tclWinChan.c
D	tcl8.3.4/win/tclWinConsole.c
D	tcl8.3.4/win/tclWinDde.c
D	tcl8.3.4/win/tclWinError.c
D	tcl8.3.4/win/tclWinFCmd.c
D	tcl8.3.4/win/tclWinFile.c
D	tcl8.3.4/win/tclWinInit.c
D	tcl8.3.4/win/tclWinInt.h
D	tcl8.3.4/win/tclWinLoad.c
D	tcl8.3.4/win/tclWinMtherr.c
D	tcl8.3.4/win/tclWinNotify.c
D	tcl8.3.4/win/tclWinPipe.c
D	tcl8.3.4/win/tclWinPort.h
D	tcl8.3.4/win/tclWinReg.c
D	tcl8.3.4/win/tclWinSerial.c
D	tcl8.3.4/win/tclWinSock.c
D	tcl8.3.4/win/tclWinTest.c
D	tcl8.3.4/win/tclWinThrd.c
D	tcl8.3.4/win/tclWinThrd.h
D	tcl8.3.4/win/tclWinTime.c
D	tcl8.3.4/win/tclsh.ico
D	tcl8.3.4/win/tclsh.rc

commit 005adc2d2461eb6845ff9205a4a95cb8e8b798fe
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-16

    Few build fixes; updated to build with Tcl 8.4 sources

M	include/Makefile.global

commit b7ab3c9ae0383a3af256c7b03bb52584c6d96d4a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-15

    Include new nsdb.h header and set mutex name

M	nsext/nsext.c

commit c8e4bd4e0fa1286c72c19b359863e98835557765
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-15

    Update mutex name; fix bug with printing null exec name on wait error; add loop to catch interrupted read()'s

M	nscgi/nscgi.c

commit 52f155f5be925824d1f0c2d095dbfe575450f2bf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-15

    Updated nslog mutex name to be virtual server specific

M	nslog/nslog.c

commit 9d781d7c5f19182a45e142064c2deec844cf0284
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-15

    Added support for a process manager thread to allow exec and wait from different threads on Linux

M	nsd/exec.c

commit e78ce17300ee6d8c73752e15641db594ab3cf53b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-15

    Fixed ADP bug referencing freed memory

M	nsd/adpeval.c

commit f720ecf4c4ebe016a682223e420511076d9c050a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-15

    Call Tcl_InitMemory to support compiling with Tcl debug allocator; fix interp cleanup crash bug

M	nsd/tclinit.c

commit 637d02fd6fd39d87bb5b5be42f6f5e9e0754eab5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-15

    Moved the database interface to the new nsdb module

M	Makefile
M	include/ns.h
A	include/nsdb.h
M	nsd/Makefile
M	nsd/init.tcl
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/proc.c
M	nsd/server.c
M	nsd/tclcmds.c
A	nsdb/Makefile
A	nsdb/db.h
R099	nsd/dbdrv.c	nsdb/dbdrv.c
R091	nsd/dbinit.c	nsdb/dbinit.c
R082	nsd/dbtcl.c	nsdb/dbtcl.c
R099	nsd/dbutil.c	nsdb/dbutil.c

commit c2186b4f6973fde5ad8e24ea68c74d5d206359d9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-05-15

    Cleaned up some mutex names

M	nsd/cache.c
M	nsd/callbacks.c
M	nsd/listen.c
M	nsd/nsconf.c
M	nsd/op.c
M	nsd/sched.c
M	nsd/sockcallback.c
M	nsd/urlspace.c

commit 6298ce749017324f0c822187d401430fab7f6092
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-03-03

    Force recompile of stamp.o on each link for updated ns_info build time

M	nsd/Makefile

commit 38e96c6ef014821036e5d8a7df0135146dbe19b1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-03-03

    Code integrated into unix.c and Tcl source

D	nsd/osx.c

commit ba8136e03e42699de8a283290afa7891c378dd34
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-03-03

    Make it easier to build unmodified Tcl from some other directory
    
    Eliminated tcl8.3.4/Makefile, moving rules to Makefile and
    include/Makefile.global.

M	Makefile
M	include/Makefile.global
D	tcl8.3.4/Makefile

commit b15a54e5cf2f09e326e574b3a7fd437616f57298
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-03-03

    Added HDRS rule and usage comments

M	include/Makefile.module

commit 7c7c51ca1b9fa2550fb49c9b02e8c603bdbb7305
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-28

    Fixed AR makefile variable for Solaris

M	include/Makefile.global

commit 4cacc48f28273a7e45189152e1612cdf7012400a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Simplified install steps a bit

M	ChangeLog
M	Makefile
A	ini2tcl.tcl
A	sample-config.tcl
A	tcl2ini.tcl

commit cfeecc357bd459118882b633accc410b8222bcdf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Moved tcl2ini to top level

D	nsmain/tcl2ini.tcl

commit 4c8670b04802d4db9085b76226a5a4d4e7ea4481
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Moved build of nsd main into ../nsd from ../nsmain

M	nsd/Makefile
R100	nsmain/init.tcl	nsd/init.tcl
R100	nsmain/main.c	nsd/main.c
D	nsmain/Makefile
D	nsmain/sample-config.tcl
D	nsmain/translate-ini

commit e6fc6a6f2ce577aa32f984a01d24f55ec98dbe25
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Better isolated the hacks for OS/X into nsd and tcl directly

D	compat/osx.c
D	compat/poll.h
M	nsd/nsd.h
M	nsd/unix.c
M	tcl8.3.4/unix/tclLoadDyld.c

commit 722f6f337d4383390123c73ba1249bb3bf3af071
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Yet more fixes for RPATH weirdness, this time for OSX

M	include/Makefile.global

commit e8f874400a6c344c4d570c22bbcf2fd6e2ff55b5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Hack to include the osx.c compat routines in the Tcl library

M	tcl8.3.4/unix/tclLoadDyld.c
A	tcl8.3.4/unix/tclLoadDyld.c.orig

commit ce8e3b0d297c73cbde2084f0320da1a026053764
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Code for missing functions on OSX including poll, sigwait, and others

A	compat/osx.c
A	compat/poll.h

commit 9f70bb1b4f1341a6aa6e3b2378cbf2642c73f015
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    No longer specifies -lnsd directly, now included in $(LIBS)

M	nsmain/Makefile

commit 23a52a1e7f5c821df127db154eab618f23acd611
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Modules now link against the various dynamic libraries

M	include/Makefile.module

commit 7d8b61be14e68682a6c039c2ecb21e26cdb4ae57
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Includes ../compat/poll.h on OSX among other minor updates

M	nsd/nsd.h

commit a3116887d2cf2a39c64ce94a195cb4972b4d2c52
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Reversed order of nsext and nspd because nsext now links against static libnspd.a library

M	Makefile

commit b2eb2c325ff7cc390346b97b2695914268f83ff9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Implements rules of ../include/Makefile.library which was removed

M	nsd/Makefile

commit ca2a0a4a60ae8a33595239ed9600c1b3b39c5447
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    nspd library is now a simple static library

M	nspd/Makefile

commit eeb6ff502c5a5c8aa39f5af8e77abcabaadb4cd7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Now links against static ../nspd/libnspd.a library

M	nsext/Makefile

commit d57d415804ea093c1646d13d7b952b992446267d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Moved to ../nspd/msg.c for libnspd.a library

D	nsext/nsextmsg.c

commit 8e5b5063b94d0bfa85e95e1b4c7c569fd44795ba
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Now better supports systems where dynamic library filenames do not end in .so
    
    e.g., OSX and HP, among other linker related updates.

M	include/Makefile.global

commit 0496e8a734eb11a0a644178661822a215cd50b2c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Moved functionality to nsd/Makefile directly, now the only makefile which creates a dynamic library

D	include/Makefile.library

commit 2df55c4cd8a9e648e449dc1626f387ef954d9fa8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Moved from ../nsext/nsextmsg.c

A	nspd/msg.c

commit 58448ab564aee34b9a90c1e89c2852c697119818
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Switched to ns_pipe for local proxy

M	nsext/nsext.c

commit d8f860184915eccc6c6c8d2f4a79d55e94a9194b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-24

    Undef of Tcl's panic to avoid conflict on OS/X

M	nsd/fastpath.c

commit 4c60bff96115b47e95fa5cde1c9820503fc8e514
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-16

    More RPATH struggles, this time with FreeBSD

M	include/Makefile.global

commit 8c465cb281257039984e49aad36f9ff8f716470d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-16

    (Ns_InfoPlatform): OS/X support

M	nsd/info.c

commit 8b221a6abd012ef23e62449dbfde594470dec08d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-16

    Cleaned up MakePath()

M	nsd/pathname.c

commit 4700a6db852632c331f8b8e142205e902483fc2a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-16

    OS/X support and dev/ino caching of loaded modules

M	nsd/modload.c

commit f45eedb3330eb472920eea1d33b737cc17eb35cd
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-16

    Added simple script to dump .tcl config files in old .ini format

A	nsmain/tcl2ini.tcl

commit b66f125ed9c91c0da2572d9aad6ca34a6fabe02a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-16

    More RPATH weirdness fixed

M	include/Makefile.global

commit 4c49fe03a3179740447f372719ad25a73c303f65
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-02-16

    Broke the Ns_RWLock and Ns_Cs code back out of the overly complex mutex code

M	nsd/Makefile
A	nsd/cslock.c
D	nsd/locks.c
M	nsd/master.c
A	nsd/mutex.c
A	nsd/rwlock.c

commit 712d59a029327cbc64bfb5688fe7611a5098a1c6
Author: Jeff Hobbs <jeffh@activestate.com>
Date:   2002-02-08

    Code cleanup to brace exprs and fix indentation

M	ChangeLog
M	nsmain/init.tcl
M	nsmain/sample-config.tcl
M	nsssl/keygen.tcl
M	tcl/debug.tcl
M	tcl/fastpath.tcl
M	tcl/file.tcl
M	tcl/form.tcl
M	tcl/http.tcl
M	tcl/nsdb.tcl
M	tcl/sendmail.tcl
M	tcl/util.tcl

commit d9aa7ce878b82c9a2e2d5ce738e01c48463fec04
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2002-01-14

    Fixed formatting bug for connections which don't read a valid request
    
    i.e., conn->request is NULL.

M	nslog/nslog.c

commit f0a1553aa5476644f005cfa77dd775ebb0235035
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2001-12-20

    Changed RFLAG to RPATH, and took out $(AOLSERVER)/lib
    
    $(LDSO) -o $(LIB) $(OBJS) $(LIBS) $(RFLAG) $(AOLSERVER)/lib
    
    now reads:
    
    $(LDSO) -o $(LIB) $(OBJS) $(LIBS) $(RPATH)
    
    which is what I think was intended. Still have the problem that
    $(AOLSERVER)/lib must already exist.

M	ChangeLog
M	include/Makefile.library

commit 25b94e6ac679e09d705f71e01d04822e064ceab5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-18

    New implementation of ADP parse/eval to minimize duplicate overhead of per-thread bytecode caches

M	nsd/adpeval.c
M	nsd/adpparse.c
M	nsd/nsd.h
M	nsd/server.c

commit 549e5ef86163a4e9aaed1065f0e092144bd0503b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-18

    Use of standard FileKey hash keys

M	nsd/fastpath.c

commit 669a77978278a22f6d45ab30af192a5dd90cc165
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-18

    Added ns_adp_stats command

M	nsd/tclcmds.c

commit 9c4065427baa0a88aff0b7c0baf22ae650db95c9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-18

    Used ref counts to avoid freeing a request structure in use

M	nsd/op.c

commit ce6412dc6687b5718bc1d0f1c61b943e69305a7f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-18

    Fixed possible crash bug with same-named caches

M	nsd/cache.c

commit 7936ea54076b61d7dbac61380cf1e8bb7653f7ef
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-11

    Add NS_MAJOR_VERSION, NS_MINOR_VERSION, NS_VERSION, NS_PATCH_LEVEL constants
    
    Modeled after Tcl.

M	include/ns.h
M	nsd/Makefile
M	nsd/info.c
M	nsd/nsd.h

commit 12d95cd1b9ba869e4b68a2e72215203091556492
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-11

    Minor makefile cleanup

M	include/Makefile.global

commit a545f1e182f261a7ec959a9d652f4a65d9b12502
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-11

    Added rpath to library link

M	include/Makefile.library

commit 4d843424c86573a44d48584887798513eab51654
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-08

    Fixed bug with wrong ns_thread info callback

M	nsd/proc.c

commit c8adcb198485f4a41261e8059ecfdc9574bbfae6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-08

    Fixed crash bug with ns_rwlock error message

M	nsd/tclthread.c

commit 7e140892525ae4670c73d8dea74aa429ff787f3c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-05

    Removed undocumented Ns_TclThread and Ns_TclDetachedThread

M	include/ns.h

commit 76d9cfcc7ddba84f90cd0899d1315930b141d110
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-05

    Removed direct access of interp->result

M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/cache.c
M	nsd/conn.c
M	nsd/dbtcl.c
M	nsd/httptime.c
M	nsd/info.c
M	nsd/log.c
M	nsd/nsmain.c
M	nsd/queue.c
M	nsd/random.c
M	nsd/tclconf.c
M	nsd/tclfile.c
M	nsd/tclinit.c
M	nsd/tcljob.c
M	nsd/tclmisc.c
M	nsd/tclrequest.c
M	nsd/tclset.c
M	nsd/tclsock.c
M	nsd/tclvar.c
M	nsd/urlopen.c

commit 325c754876b6307f4dfddf1e77823eb3c5b95f56
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-05

    Tcl threads now return string result as exit arg

M	nsd/nsd.h
M	nsd/tclsched.c
M	nsd/tclthread.c

commit 2d18be99ed29550a9aad46a5ee36e0f2e060e60f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-05

    Now stores clean names for sets, among other cleanups

M	nsd/config.c

commit a83efc1db7d20da40d6060f40563bcaa7a0a05d6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-05

    Moved from nsd

A	nsmain/translate-ini

commit 1038f6e22ee8568c682a885379431df013ce5b46
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-05

    Restored previous support for NSHOME build directory variable

M	Makefile
M	include/Makefile.global
M	include/Makefile.library
M	include/Makefile.module
M	nsd/Makefile

commit 5730745a632d8113065829a34974b01298d39296
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-05

    Moved to nsmain

D	nsd/init.tcl
D	nsd/main.c
D	nsd/sample-config.tcl
D	nsd/translate-ini

commit d9d1396675f04bc908b75993efb473de2aa8434e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-12-05

    Stub main and install files moved from nsd

A	nsmain/Makefile
A	nsmain/init.tcl
A	nsmain/main.c
A	nsmain/sample-config.tcl

commit 6169413ad5dfdb12d56f84476927bb91bc9a48cc
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-27

    Fixed crash bug when binding listen sockets after startup

M	nsd/binder.c

commit 6b5be73029d7314e1869c0b635bb9438593ce353
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-25

    Fix for bug #466398: urlencoding

M	nsd/urlencode.c

commit 8c8381652637a9bd7a604b6cba8c8252c42abd6c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-25

    Fix for 3.4 bug #448921: urlencoding

M	nsd/urlencode.c

commit 845a5025a99252cfe5ad2dfa632a27684c70045f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-25

    Fix for 3.4 bug #479667: handle double-quote in adp attributes

M	nsd/adpparse.c

commit 2acd3168dfc7335e9c370583330ed6134634aa24
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-25

    Fix for bug #434722: ns_adp_parse argument handling

M	nsd/adpcmds.c

commit e0a3d00e6961de40ca16c792cfb64bc20a362787
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-25

    (CheckId) Fix for bug #437324: return 0/1 not TCL_OK/TCL_ERROR

M	nsd/tclresp.c

commit 2456be37f13a8b10074a5639ecb4140eeacaa770
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-25

    (Ns_FetchUrl) Fix for bug # 444657: socket not closed on error

M	nsd/urlopen.c

commit b0af1787d99d3194313ddb37cb4def79efed91e6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-13

    Fixed confusion with module and tcl dir vars

M	nsperm/Makefile

commit 24bb35ba1a3e8f891300858fdd93bc37ea70fc0f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-13

    Fixed bug maintaining nfds

M	nsd/sockcallback.c

commit 64c08973c819390b96da026db2f4be322849e227
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-08

    Cleaned up and simplified build environment

M	Makefile
M	include/Makefile.global
M	include/Makefile.library
M	include/Makefile.module
D	include/tcl.h
D	include/tclDecls.h
M	nsd/Makefile
M	nsperm/Makefile
M	tcl8.3.4/Makefile

commit a2d6e8218b6b410e7827246139019790c7e692e9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-08

    Switch to pthread_once for initialization

M	tcl8.3.4/generic/tclAlloc.c

commit 126a3e48e8938a66bfdfed5f369bbb9f4319b0d2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-07

    Integrated into nsd

D	nsmain/Makefile
D	nsmain/main.c

commit 23dc06ddd48b70c20e22c0ec620c6ab1a5102ab3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-07

    Removed Win32 support

D	include/Makefile.win32

commit 100754235520f989f0a0c0c1fd55989aa8e9c680
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-06

    Fixed bug of not clearing poll revents

M	nsd/driver.c
M	nsd/sock.c
M	nsd/sockcallback.c

commit 033b48336482b85c0ce99674f65e9cdfbf46e0f3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-06

    Fixed crash bug caused by incorrect pre-defined constants nmove for 16k bucket (was 0, should be 1)

M	tcl8.3.4/generic/tclAlloc.c

commit e3767e039310cb122deabda9c2fed158e7f80059
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Add missing ChangeLog entries for 4.0b2 including removal of Win32

M	ChangeLog

commit ab2fecd01a98afe1f586a7a5886600fd282b64e6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed _POSIX_PTHREAD_SEMANTICS, now in tcl.m4

M	tcl8.3.4/Makefile

commit 9d50462607027263ba2186197309330d45ae1c6d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed win32 support

D	nsd/getopt.c
D	nsd/getopt.h
D	nsd/win32.c

commit 49b33c6c1cb164efc733420b9ddc95a2baf955ff
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed nsthread library, tcl8.3.3 distribution, and win32 build/test environment

M	tcl8.3.4/Makefile
D	thread/Makefile
D	thread/compat.c
D	thread/cond.c
D	thread/cs.c
D	thread/debug.c
D	thread/error.c
D	thread/fork.c
D	thread/memory.c
D	thread/mutex.c
D	thread/osthread.c
D	thread/pool.c
D	thread/pthread.cpp
D	thread/reentrant.c
D	thread/rwlock.c
D	thread/sema.c
D	thread/signal.c
D	thread/sproc.cpp
D	thread/test.c
D	thread/thread.c
D	thread/thread.h
D	thread/thread.html
D	thread/time.c
D	thread/tls.c
D	thread/win32.cpp
D	thread/windir.cpp
D	win32/README
D	win32/aolserver.dsw
D	win32/cgitest/cgitest.dsp
D	win32/cgitest/main.c
D	win32/main/Makefile
D	win32/main/main.dsp
D	win32/nscgi/Makefile
D	win32/nscgi/nscgi.dsp
D	win32/nscp/Makefile
D	win32/nscp/nscp.dsp
D	win32/nsd/Makefile
D	win32/nsd/nsd.dsp
D	win32/nslog/Makefile
D	win32/nslog/nslog.dsp
D	win32/nsodbc/nsodbc.dsp
D	win32/nsperm/Makefile
D	win32/nsperm/nsperm.dsp
D	win32/nssock/Makefile
D	win32/nssock/nssock.dsp
D	win32/nsssl/nsssl.dsp
D	win32/nstcl/Makefile
D	win32/nstcl/nstcl.dsp
D	win32/nsthread/Makefile
D	win32/nsthread/nsthread.dsp
D	win32/test/nsd.tcl
D	win32/test/servers/test/pages/cgitest.bat
D	win32/test/servers/test/pages/index.adp
D	win32/threadtest/threadtest.dsp
D	win32/win32.html

commit 47cf955fc63bf996f009019118cf89d6b43f2e74
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Replace standard inet_ntop not available on Solaris with simple sprintf

M	tcl8.3.4/unix/tclUnixThrd.c

commit a93c93332d51f2b1d46c6685237e382faa5a129b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Fix for proper FreeBSD and Solaris builds

M	tcl8.3.4/unix/configure
A	tcl8.3.4/unix/configure.orig
M	tcl8.3.4/unix/tcl.m4
A	tcl8.3.4/unix/tcl.m4.orig

commit 3170466a31539f58fae24d8adbad3af5fbdf2852
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Updated old Ns_UrlDecode macro

M	nscgi/nscgi.c

commit 5f883b2adbf43b3ef0f83f423e9a0fa437268d99
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Use basic POLLIN, POLLOUT, and POLLPRI instead of POLLRDNORM, POLLWRNORM, and POLLRDBAND

M	nsd/driver.c
M	nsd/nsd.h
M	nsd/sock.c
M	nsd/sockcallback.c

commit cd796a0fc4c166a8ffacf92e52f22c897530c284
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Bug fix - tls.c, not specific.c

M	nsd/Makefile

commit ff39a787fbc2499d8f2b711da1824810a677c0a7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Incorporated from the nsthread library

A	nsd/cond.c

commit 6593cdffb998ef7a324dfad242f6ac082e2d4748
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed nsthread library

M	Makefile

commit ebf89f866079da26eff3966df75ee369570fb89f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Remove Win32 support along with other cleanup

M	include/ns.h
M	include/nsthread.h

commit 4b5d1fcdeee71ee6caafca08ac478c711e5b5b09
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Updated to Tcl 8.3.4; removed various old compile defines no longer required

M	include/Makefile.global

commit edc60310c1a13305da35ce9a89e68b5a50b3e3f7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Files incorporated from the nsthreads library

A	nsd/compat.c
A	nsd/error.c
A	nsd/fork.c
A	nsd/locks.c
A	nsd/main.c
A	nsd/master.c
A	nsd/memory.c
A	nsd/osx.c
A	nsd/reentrant.c
A	nsd/sema.c
A	nsd/signal.c
A	nsd/thread.c
A	nsd/time.c
A	nsd/tls.c

commit 5353095a98d860b9a68e76eb8ae67613f4dd7260
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed Win32 support

M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/listen.c
M	nsext/nsext.c
M	nslog/nslog.c
M	nsperm/nsperm.c
M	nssock/nssock.c

commit 2dec773ad438d946468190f68089d7d6f9a450b3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Hack for compiling old Ns_Event support

M	nsd/tclthread.c

commit fce0b9adbd9d83eae7103ffb0ffa6b8ff1a81c85
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Moved tls data structures from the single NsTls structure to related code in log.c, tclinit.c, and dbinit.c

M	nsd/dbinit.c
M	nsd/log.c
M	nsd/tclinit.c
D	nsd/tls.c

commit e8cb972eae971ae096db8946b7e0d4c6751d3d56
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed support for the -k and -K server kill/restart code which wasn't entirely safe

M	nsd/pidfile.c
M	nsd/unix.c

commit d62b9e3324ffc349f36d8a58efe4a72dbba34f17
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Changed overly complicated Ns_MutexEnum, Ns_ThreadEnum, and Ns_PoolEnum calls to the simple NsLockInfo, NsThreadInfo and Tcl_GetMemoryInfo routines
    
    Basically, the simple API's are now possible because Tcl no
    longer depends on nsthreads which kept nsthreads from relying
    on Tcl.

M	nsd/info.c

commit fa563435f1ec51d4a7855b480a63a8a99842face
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Updated old function name Ns_UrlDecode to Ns_DecodeUrl

M	nsd/form.c

commit d6e40a8f2714c0c6c252a118d237b9f64accf389
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed Win32 support code; made the nonzero status checking code mandatory

M	nsd/exec.c

commit 350e3e1d44b2fee4f8eac996a497e15ec30e4207
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed the NsWaitSchedIdle code which wasn't exactly correct

M	nsd/sched.c

commit 90a1c8b6e9459f6c2460ae141e37ab17f1147646
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Switched from select() to poll(); removed the NsWaitSockIdle code which wasn't exactly correct

M	nsd/sockcallback.c

commit cb50c28d445870389e51f78ceb0aaa7a6b35b26f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed various Win32 support code and switched from select() to poll()

M	nsd/driver.c
M	nsd/sock.c

commit c50f5ac844213248c1645798092e86f0f80f7443
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Changed Ns_Buf structure to standard Unix struct iovec

M	nsd/connio.c

commit 53de2e8639231e680de237afc5cfcc2694fd9131
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Cleaned up sloppy use of old config macros and removed support for undocumented Ns_ServerInitProc callback

M	nsd/config.c
M	nsd/dbdrv.c
M	nsd/dbtcl.c
M	nsd/server.c
M	nsd/tclconf.c

commit 20002ae802324832075f6bf1709e961719bdafe2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Ns_CacheMalloc/Ns_CacheFree now simply call ns_malloc/ns_free

M	nsd/cache.c

commit a32386f5769e2d9d50e58240dd16ecedfd2dc930
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed support for Win32 which required pathname instead of dev/inode cache hash keys

M	nsd/adpeval.c
M	nsd/fastpath.c

commit 81d24a07b905f37644288c10ea19395706c2cadf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed Win32 startup code, the -k and -K flags, and the startup idle wait code
    
    Also, the -p and -z flags have no effect as the zippy allocator
    is now in Tcl and always on by default.

M	nsd/nsmain.c

commit caadc72e1d4322bceb4283201cc3156a2d8dba94
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed various Win32 support code

M	nsd/fd.c
M	nsd/modload.c
M	nsd/nsd.h
M	nsd/pathname.c
M	nsd/random.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclhttp.c
M	nsd/tclimg.c
M	nsd/tclsock.c
M	nsd/urlopen.c

commit e7f4849c016a57e627710277d9c0e79f2f065218
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed mutexmeter option (now always on), moved stacksize to nsconf structure from nsThreadStackSize variable, and removed the exec.checkexit and exec.vfork options

M	nsd/nsconf.c
M	nsd/nsconf.h

commit 9e0aea50566d5d43e067e7745a11e6e5daa2686e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Removed support for complex child binder process
    
    Binding privileged ports now require the -b or -B
    command line methods.

M	nsd/binder.c

commit 0ae3daade1dd8bdb235be8a4bc94188844b2adeb
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Integrated nsthread library and nsmain files

M	nsd/Makefile

commit fbd428d60509b3d88fde93c3cc505e874b3c27e2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-11-05

    Initial import of Tcl 8.3.4

A	tcl8.3.4/ChangeLog
A	tcl8.3.4/Makefile
A	tcl8.3.4/README
A	tcl8.3.4/changes
A	tcl8.3.4/compat/README
A	tcl8.3.4/compat/dirent.h
A	tcl8.3.4/compat/dirent2.h
A	tcl8.3.4/compat/dlfcn.h
A	tcl8.3.4/compat/fixstrtod.c
A	tcl8.3.4/compat/float.h
A	tcl8.3.4/compat/gettod.c
A	tcl8.3.4/compat/license.terms
A	tcl8.3.4/compat/limits.h
A	tcl8.3.4/compat/memcmp.c
A	tcl8.3.4/compat/opendir.c
A	tcl8.3.4/compat/stdlib.h
A	tcl8.3.4/compat/strftime.c
A	tcl8.3.4/compat/string.h
A	tcl8.3.4/compat/strncasecmp.c
A	tcl8.3.4/compat/strstr.c
A	tcl8.3.4/compat/strtod.c
A	tcl8.3.4/compat/strtol.c
A	tcl8.3.4/compat/strtoul.c
A	tcl8.3.4/compat/tclErrno.h
A	tcl8.3.4/compat/tmpnam.c
A	tcl8.3.4/compat/unistd.h
A	tcl8.3.4/compat/waitpid.c
A	tcl8.3.4/doc/Access.3
A	tcl8.3.4/doc/AddErrInfo.3
A	tcl8.3.4/doc/Alloc.3
A	tcl8.3.4/doc/AllowExc.3
A	tcl8.3.4/doc/AppInit.3
A	tcl8.3.4/doc/AssocData.3
A	tcl8.3.4/doc/Async.3
A	tcl8.3.4/doc/BackgdErr.3
A	tcl8.3.4/doc/Backslash.3
A	tcl8.3.4/doc/BoolObj.3
A	tcl8.3.4/doc/ByteArrObj.3
A	tcl8.3.4/doc/CallDel.3
A	tcl8.3.4/doc/ChnlStack.3
A	tcl8.3.4/doc/CmdCmplt.3
A	tcl8.3.4/doc/Concat.3
A	tcl8.3.4/doc/CrtChannel.3
A	tcl8.3.4/doc/CrtChnlHdlr.3
A	tcl8.3.4/doc/CrtCloseHdlr.3
A	tcl8.3.4/doc/CrtCommand.3
A	tcl8.3.4/doc/CrtFileHdlr.3
A	tcl8.3.4/doc/CrtInterp.3
A	tcl8.3.4/doc/CrtMathFnc.3
A	tcl8.3.4/doc/CrtObjCmd.3
A	tcl8.3.4/doc/CrtSlave.3
A	tcl8.3.4/doc/CrtTimerHdlr.3
A	tcl8.3.4/doc/CrtTrace.3
A	tcl8.3.4/doc/DString.3
A	tcl8.3.4/doc/DetachPids.3
A	tcl8.3.4/doc/DoOneEvent.3
A	tcl8.3.4/doc/DoWhenIdle.3
A	tcl8.3.4/doc/DoubleObj.3
A	tcl8.3.4/doc/DumpActiveMemory.3
A	tcl8.3.4/doc/Encoding.3
A	tcl8.3.4/doc/Eval.3
A	tcl8.3.4/doc/Exit.3
A	tcl8.3.4/doc/ExprLong.3
A	tcl8.3.4/doc/ExprLongObj.3
A	tcl8.3.4/doc/FindExec.3
A	tcl8.3.4/doc/GetCwd.3
A	tcl8.3.4/doc/GetHostName.3
A	tcl8.3.4/doc/GetIndex.3
A	tcl8.3.4/doc/GetInt.3
A	tcl8.3.4/doc/GetOpnFl.3
A	tcl8.3.4/doc/GetStdChan.3
A	tcl8.3.4/doc/GetVersion.3
A	tcl8.3.4/doc/Hash.3
A	tcl8.3.4/doc/Init.3
A	tcl8.3.4/doc/InitStubs.3
A	tcl8.3.4/doc/IntObj.3
A	tcl8.3.4/doc/Interp.3
A	tcl8.3.4/doc/LinkVar.3
A	tcl8.3.4/doc/ListObj.3
A	tcl8.3.4/doc/Notifier.3
A	tcl8.3.4/doc/Object.3
A	tcl8.3.4/doc/ObjectType.3
A	tcl8.3.4/doc/OpenFileChnl.3
A	tcl8.3.4/doc/OpenTcp.3
A	tcl8.3.4/doc/ParseCmd.3
A	tcl8.3.4/doc/PkgRequire.3
A	tcl8.3.4/doc/Preserve.3
A	tcl8.3.4/doc/PrintDbl.3
A	tcl8.3.4/doc/RecEvalObj.3
A	tcl8.3.4/doc/RecordEval.3
A	tcl8.3.4/doc/RegExp.3
A	tcl8.3.4/doc/SaveResult.3
A	tcl8.3.4/doc/SetErrno.3
A	tcl8.3.4/doc/SetRecLmt.3
A	tcl8.3.4/doc/SetResult.3
A	tcl8.3.4/doc/SetVar.3
A	tcl8.3.4/doc/Sleep.3
A	tcl8.3.4/doc/SourceRCFile.3
A	tcl8.3.4/doc/SplitList.3
A	tcl8.3.4/doc/SplitPath.3
A	tcl8.3.4/doc/StaticPkg.3
A	tcl8.3.4/doc/StrMatch.3
A	tcl8.3.4/doc/StringObj.3
A	tcl8.3.4/doc/TCL_MEM_DEBUG.3
A	tcl8.3.4/doc/Tcl.n
A	tcl8.3.4/doc/Tcl_Main.3
A	tcl8.3.4/doc/Thread.3
A	tcl8.3.4/doc/ToUpper.3
A	tcl8.3.4/doc/TraceVar.3
A	tcl8.3.4/doc/Translate.3
A	tcl8.3.4/doc/UpVar.3
A	tcl8.3.4/doc/Utf.3
A	tcl8.3.4/doc/WrongNumArgs.3
A	tcl8.3.4/doc/after.n
A	tcl8.3.4/doc/append.n
A	tcl8.3.4/doc/array.n
A	tcl8.3.4/doc/bgerror.n
A	tcl8.3.4/doc/binary.n
A	tcl8.3.4/doc/break.n
A	tcl8.3.4/doc/case.n
A	tcl8.3.4/doc/catch.n
A	tcl8.3.4/doc/cd.n
A	tcl8.3.4/doc/clock.n
A	tcl8.3.4/doc/close.n
A	tcl8.3.4/doc/concat.n
A	tcl8.3.4/doc/continue.n
A	tcl8.3.4/doc/dde.n
A	tcl8.3.4/doc/encoding.n
A	tcl8.3.4/doc/eof.n
A	tcl8.3.4/doc/error.n
A	tcl8.3.4/doc/eval.n
A	tcl8.3.4/doc/exec.n
A	tcl8.3.4/doc/exit.n
A	tcl8.3.4/doc/expr.n
A	tcl8.3.4/doc/fblocked.n
A	tcl8.3.4/doc/fconfigure.n
A	tcl8.3.4/doc/fcopy.n
A	tcl8.3.4/doc/file.n
A	tcl8.3.4/doc/fileevent.n
A	tcl8.3.4/doc/filename.n
A	tcl8.3.4/doc/flush.n
A	tcl8.3.4/doc/for.n
A	tcl8.3.4/doc/foreach.n
A	tcl8.3.4/doc/format.n
A	tcl8.3.4/doc/gets.n
A	tcl8.3.4/doc/glob.n
A	tcl8.3.4/doc/global.n
A	tcl8.3.4/doc/history.n
A	tcl8.3.4/doc/http.n
A	tcl8.3.4/doc/if.n
A	tcl8.3.4/doc/incr.n
A	tcl8.3.4/doc/info.n
A	tcl8.3.4/doc/interp.n
A	tcl8.3.4/doc/join.n
A	tcl8.3.4/doc/lappend.n
A	tcl8.3.4/doc/library.n
A	tcl8.3.4/doc/license.terms
A	tcl8.3.4/doc/lindex.n
A	tcl8.3.4/doc/linsert.n
A	tcl8.3.4/doc/list.n
A	tcl8.3.4/doc/llength.n
A	tcl8.3.4/doc/load.n
A	tcl8.3.4/doc/lrange.n
A	tcl8.3.4/doc/lreplace.n
A	tcl8.3.4/doc/lsearch.n
A	tcl8.3.4/doc/lsort.n
A	tcl8.3.4/doc/man.macros
A	tcl8.3.4/doc/memory.n
A	tcl8.3.4/doc/msgcat.n
A	tcl8.3.4/doc/namespace.n
A	tcl8.3.4/doc/open.n
A	tcl8.3.4/doc/package.n
A	tcl8.3.4/doc/packagens.n
A	tcl8.3.4/doc/pid.n
A	tcl8.3.4/doc/pkgMkIndex.n
A	tcl8.3.4/doc/proc.n
A	tcl8.3.4/doc/puts.n
A	tcl8.3.4/doc/pwd.n
A	tcl8.3.4/doc/re_syntax.n
A	tcl8.3.4/doc/read.n
A	tcl8.3.4/doc/regexp.n
A	tcl8.3.4/doc/registry.n
A	tcl8.3.4/doc/regsub.n
A	tcl8.3.4/doc/rename.n
A	tcl8.3.4/doc/resource.n
A	tcl8.3.4/doc/return.n
A	tcl8.3.4/doc/safe.n
A	tcl8.3.4/doc/scan.n
A	tcl8.3.4/doc/seek.n
A	tcl8.3.4/doc/set.n
A	tcl8.3.4/doc/socket.n
A	tcl8.3.4/doc/source.n
A	tcl8.3.4/doc/split.n
A	tcl8.3.4/doc/string.n
A	tcl8.3.4/doc/subst.n
A	tcl8.3.4/doc/switch.n
A	tcl8.3.4/doc/tclsh.1
A	tcl8.3.4/doc/tcltest.n
A	tcl8.3.4/doc/tclvars.n
A	tcl8.3.4/doc/tell.n
A	tcl8.3.4/doc/time.n
A	tcl8.3.4/doc/trace.n
A	tcl8.3.4/doc/unknown.n
A	tcl8.3.4/doc/unset.n
A	tcl8.3.4/doc/update.n
A	tcl8.3.4/doc/uplevel.n
A	tcl8.3.4/doc/upvar.n
A	tcl8.3.4/doc/variable.n
A	tcl8.3.4/doc/vwait.n
A	tcl8.3.4/doc/while.n
A	tcl8.3.4/generic/README
A	tcl8.3.4/generic/regc_color.c
A	tcl8.3.4/generic/regc_cvec.c
A	tcl8.3.4/generic/regc_lex.c
A	tcl8.3.4/generic/regc_locale.c
A	tcl8.3.4/generic/regc_nfa.c
A	tcl8.3.4/generic/regcomp.c
A	tcl8.3.4/generic/regcustom.h
A	tcl8.3.4/generic/rege_dfa.c
A	tcl8.3.4/generic/regerror.c
A	tcl8.3.4/generic/regerrs.h
A	tcl8.3.4/generic/regex.h
A	tcl8.3.4/generic/regexec.c
A	tcl8.3.4/generic/regfree.c
A	tcl8.3.4/generic/regfronts.c
A	tcl8.3.4/generic/regguts.h
A	tcl8.3.4/generic/tcl.decls
A	tcl8.3.4/generic/tcl.h
A	tcl8.3.4/generic/tclAlloc.c
A	tcl8.3.4/generic/tclAlloc.c.orig
A	tcl8.3.4/generic/tclAsync.c
A	tcl8.3.4/generic/tclBasic.c
A	tcl8.3.4/generic/tclBinary.c
A	tcl8.3.4/generic/tclCkalloc.c
A	tcl8.3.4/generic/tclClock.c
A	tcl8.3.4/generic/tclCmdAH.c
A	tcl8.3.4/generic/tclCmdIL.c
A	tcl8.3.4/generic/tclCmdMZ.c
A	tcl8.3.4/generic/tclCompCmds.c
A	tcl8.3.4/generic/tclCompExpr.c
A	tcl8.3.4/generic/tclCompile.c
A	tcl8.3.4/generic/tclCompile.h
A	tcl8.3.4/generic/tclDate.c
A	tcl8.3.4/generic/tclDecls.h
A	tcl8.3.4/generic/tclEncoding.c
A	tcl8.3.4/generic/tclEnv.c
A	tcl8.3.4/generic/tclEvent.c
A	tcl8.3.4/generic/tclExecute.c
A	tcl8.3.4/generic/tclFCmd.c
A	tcl8.3.4/generic/tclFileName.c
A	tcl8.3.4/generic/tclGet.c
A	tcl8.3.4/generic/tclGetDate.y
A	tcl8.3.4/generic/tclHash.c
A	tcl8.3.4/generic/tclHistory.c
A	tcl8.3.4/generic/tclIO.c
A	tcl8.3.4/generic/tclIO.h
A	tcl8.3.4/generic/tclIOCmd.c
A	tcl8.3.4/generic/tclIOGT.c
A	tcl8.3.4/generic/tclIOSock.c
A	tcl8.3.4/generic/tclIOUtil.c
A	tcl8.3.4/generic/tclIndexObj.c
A	tcl8.3.4/generic/tclInitScript.h
A	tcl8.3.4/generic/tclInt.decls
A	tcl8.3.4/generic/tclInt.h
A	tcl8.3.4/generic/tclInt.h.orig
A	tcl8.3.4/generic/tclIntDecls.h
A	tcl8.3.4/generic/tclIntPlatDecls.h
A	tcl8.3.4/generic/tclInterp.c
A	tcl8.3.4/generic/tclLink.c
A	tcl8.3.4/generic/tclListObj.c
A	tcl8.3.4/generic/tclLiteral.c
A	tcl8.3.4/generic/tclLoad.c
A	tcl8.3.4/generic/tclLoadNone.c
A	tcl8.3.4/generic/tclMain.c
A	tcl8.3.4/generic/tclMath.h
A	tcl8.3.4/generic/tclNamesp.c
A	tcl8.3.4/generic/tclNotify.c
A	tcl8.3.4/generic/tclObj.c
A	tcl8.3.4/generic/tclObj.c.orig
A	tcl8.3.4/generic/tclPanic.c
A	tcl8.3.4/generic/tclParse.c
A	tcl8.3.4/generic/tclParseExpr.c
A	tcl8.3.4/generic/tclPipe.c
A	tcl8.3.4/generic/tclPkg.c
A	tcl8.3.4/generic/tclPlatDecls.h
A	tcl8.3.4/generic/tclPort.h
A	tcl8.3.4/generic/tclPosixStr.c
A	tcl8.3.4/generic/tclPreserve.c
A	tcl8.3.4/generic/tclProc.c
A	tcl8.3.4/generic/tclRegexp.c
A	tcl8.3.4/generic/tclRegexp.h
A	tcl8.3.4/generic/tclResolve.c
A	tcl8.3.4/generic/tclResult.c
A	tcl8.3.4/generic/tclScan.c
A	tcl8.3.4/generic/tclStringObj.c
A	tcl8.3.4/generic/tclStubInit.c
A	tcl8.3.4/generic/tclStubInit.c.orig
A	tcl8.3.4/generic/tclStubLib.c
A	tcl8.3.4/generic/tclTest.c
A	tcl8.3.4/generic/tclTestObj.c
A	tcl8.3.4/generic/tclTestProcBodyObj.c
A	tcl8.3.4/generic/tclThread.c
A	tcl8.3.4/generic/tclThreadTest.c
A	tcl8.3.4/generic/tclTimer.c
A	tcl8.3.4/generic/tclUniData.c
A	tcl8.3.4/generic/tclUtf.c
A	tcl8.3.4/generic/tclUtil.c
A	tcl8.3.4/generic/tclVar.c
A	tcl8.3.4/library/auto.tcl
A	tcl8.3.4/library/dde1.1/pkgIndex.tcl
A	tcl8.3.4/library/encoding/ascii.enc
A	tcl8.3.4/library/encoding/big5.enc
A	tcl8.3.4/library/encoding/cp1250.enc
A	tcl8.3.4/library/encoding/cp1251.enc
A	tcl8.3.4/library/encoding/cp1252.enc
A	tcl8.3.4/library/encoding/cp1253.enc
A	tcl8.3.4/library/encoding/cp1254.enc
A	tcl8.3.4/library/encoding/cp1255.enc
A	tcl8.3.4/library/encoding/cp1256.enc
A	tcl8.3.4/library/encoding/cp1257.enc
A	tcl8.3.4/library/encoding/cp1258.enc
A	tcl8.3.4/library/encoding/cp437.enc
A	tcl8.3.4/library/encoding/cp737.enc
A	tcl8.3.4/library/encoding/cp775.enc
A	tcl8.3.4/library/encoding/cp850.enc
A	tcl8.3.4/library/encoding/cp852.enc
A	tcl8.3.4/library/encoding/cp855.enc
A	tcl8.3.4/library/encoding/cp857.enc
A	tcl8.3.4/library/encoding/cp860.enc
A	tcl8.3.4/library/encoding/cp861.enc
A	tcl8.3.4/library/encoding/cp862.enc
A	tcl8.3.4/library/encoding/cp863.enc
A	tcl8.3.4/library/encoding/cp864.enc
A	tcl8.3.4/library/encoding/cp865.enc
A	tcl8.3.4/library/encoding/cp866.enc
A	tcl8.3.4/library/encoding/cp869.enc
A	tcl8.3.4/library/encoding/cp874.enc
A	tcl8.3.4/library/encoding/cp932.enc
A	tcl8.3.4/library/encoding/cp936.enc
A	tcl8.3.4/library/encoding/cp949.enc
A	tcl8.3.4/library/encoding/cp950.enc
A	tcl8.3.4/library/encoding/dingbats.enc
A	tcl8.3.4/library/encoding/ebcdic.enc
A	tcl8.3.4/library/encoding/euc-cn.enc
A	tcl8.3.4/library/encoding/euc-jp.enc
A	tcl8.3.4/library/encoding/euc-kr.enc
A	tcl8.3.4/library/encoding/gb12345.enc
A	tcl8.3.4/library/encoding/gb1988.enc
A	tcl8.3.4/library/encoding/gb2312.enc
A	tcl8.3.4/library/encoding/iso2022-jp.enc
A	tcl8.3.4/library/encoding/iso2022-kr.enc
A	tcl8.3.4/library/encoding/iso2022.enc
A	tcl8.3.4/library/encoding/iso8859-1.enc
A	tcl8.3.4/library/encoding/iso8859-10.enc
A	tcl8.3.4/library/encoding/iso8859-13.enc
A	tcl8.3.4/library/encoding/iso8859-14.enc
A	tcl8.3.4/library/encoding/iso8859-15.enc
A	tcl8.3.4/library/encoding/iso8859-16.enc
A	tcl8.3.4/library/encoding/iso8859-2.enc
A	tcl8.3.4/library/encoding/iso8859-3.enc
A	tcl8.3.4/library/encoding/iso8859-4.enc
A	tcl8.3.4/library/encoding/iso8859-5.enc
A	tcl8.3.4/library/encoding/iso8859-6.enc
A	tcl8.3.4/library/encoding/iso8859-7.enc
A	tcl8.3.4/library/encoding/iso8859-8.enc
A	tcl8.3.4/library/encoding/iso8859-9.enc
A	tcl8.3.4/library/encoding/jis0201.enc
A	tcl8.3.4/library/encoding/jis0208.enc
A	tcl8.3.4/library/encoding/jis0212.enc
A	tcl8.3.4/library/encoding/koi8-r.enc
A	tcl8.3.4/library/encoding/koi8-u.enc
A	tcl8.3.4/library/encoding/ksc5601.enc
A	tcl8.3.4/library/encoding/macCentEuro.enc
A	tcl8.3.4/library/encoding/macCroatian.enc
A	tcl8.3.4/library/encoding/macCyrillic.enc
A	tcl8.3.4/library/encoding/macDingbats.enc
A	tcl8.3.4/library/encoding/macGreek.enc
A	tcl8.3.4/library/encoding/macIceland.enc
A	tcl8.3.4/library/encoding/macJapan.enc
A	tcl8.3.4/library/encoding/macRoman.enc
A	tcl8.3.4/library/encoding/macRomania.enc
A	tcl8.3.4/library/encoding/macThai.enc
A	tcl8.3.4/library/encoding/macTurkish.enc
A	tcl8.3.4/library/encoding/macUkraine.enc
A	tcl8.3.4/library/encoding/shiftjis.enc
A	tcl8.3.4/library/encoding/symbol.enc
A	tcl8.3.4/library/encoding/tis-620.enc
A	tcl8.3.4/library/history.tcl
A	tcl8.3.4/library/http/http.tcl
A	tcl8.3.4/library/http/pkgIndex.tcl
A	tcl8.3.4/library/http1.0/http.tcl
A	tcl8.3.4/library/http1.0/pkgIndex.tcl
A	tcl8.3.4/library/init.tcl
A	tcl8.3.4/library/ldAout.tcl
A	tcl8.3.4/library/license.terms
A	tcl8.3.4/library/msgcat/msgcat.tcl
A	tcl8.3.4/library/msgcat/pkgIndex.tcl
A	tcl8.3.4/library/opt/optparse.tcl
A	tcl8.3.4/library/opt/pkgIndex.tcl
A	tcl8.3.4/library/package.tcl
A	tcl8.3.4/library/parray.tcl
A	tcl8.3.4/library/reg1.0/pkgIndex.tcl
A	tcl8.3.4/library/safe.tcl
A	tcl8.3.4/library/tclIndex
A	tcl8.3.4/library/tcltest1.0/pkgIndex.tcl
A	tcl8.3.4/library/tcltest1.0/tcltest.tcl
A	tcl8.3.4/library/word.tcl
A	tcl8.3.4/license.terms
A	tcl8.3.4/mac/AppleScript.html
A	tcl8.3.4/mac/Background.doc
A	tcl8.3.4/mac/MW_TclAppleScriptHeader.h
A	tcl8.3.4/mac/MW_TclAppleScriptHeader.pch
A	tcl8.3.4/mac/MW_TclBuildLibHeader.h
A	tcl8.3.4/mac/MW_TclBuildLibHeader.pch
A	tcl8.3.4/mac/MW_TclHeader.h
A	tcl8.3.4/mac/MW_TclHeader.pch
A	tcl8.3.4/mac/MW_TclHeaderCommon.h
A	tcl8.3.4/mac/MW_TclStaticHeader.h
A	tcl8.3.4/mac/MW_TclStaticHeader.pch
A	tcl8.3.4/mac/MW_TclTestHeader.h
A	tcl8.3.4/mac/MW_TclTestHeader.pch
A	tcl8.3.4/mac/README
A	tcl8.3.4/mac/bugs.doc
A	tcl8.3.4/mac/libmoto.doc
A	tcl8.3.4/mac/license.terms
A	tcl8.3.4/mac/morefiles.doc
A	tcl8.3.4/mac/porting.notes
A	tcl8.3.4/mac/tclMac.h
A	tcl8.3.4/mac/tclMacAETE.r
A	tcl8.3.4/mac/tclMacAlloc.c
A	tcl8.3.4/mac/tclMacAppInit.c
A	tcl8.3.4/mac/tclMacApplication.r
A	tcl8.3.4/mac/tclMacBOAAppInit.c
A	tcl8.3.4/mac/tclMacBOAMain.c
A	tcl8.3.4/mac/tclMacChan.c
A	tcl8.3.4/mac/tclMacCommonPch.h
A	tcl8.3.4/mac/tclMacDNR.c
A	tcl8.3.4/mac/tclMacEnv.c
A	tcl8.3.4/mac/tclMacExit.c
A	tcl8.3.4/mac/tclMacFCmd.c
A	tcl8.3.4/mac/tclMacFile.c
A	tcl8.3.4/mac/tclMacInit.c
A	tcl8.3.4/mac/tclMacInt.h
A	tcl8.3.4/mac/tclMacInterupt.c
A	tcl8.3.4/mac/tclMacLibrary.c
A	tcl8.3.4/mac/tclMacLibrary.r
A	tcl8.3.4/mac/tclMacLoad.c
A	tcl8.3.4/mac/tclMacMath.h
A	tcl8.3.4/mac/tclMacNotify.c
A	tcl8.3.4/mac/tclmacOSA.c
A	tcl8.3.4/mac/tclmacOSA.r
A	tcl8.3.4/mac/tclMacPanic.c
A	tcl8.3.4/mac/tclMacPort.h
A	tcl8.3.4/mac/tclMacProjects.sea.hqx
A	tcl8.3.4/mac/tclMacResource.c
A	tcl8.3.4/mac/tclMacResource.r
A	tcl8.3.4/mac/tclMacSock.c
A	tcl8.3.4/mac/tclMacTclCode.r
A	tcl8.3.4/mac/tclMacTest.c
A	tcl8.3.4/mac/tclMacThrd.c
A	tcl8.3.4/mac/tclMacThrd.h
A	tcl8.3.4/mac/tclMacTime.c
A	tcl8.3.4/mac/tclMacUnix.c
A	tcl8.3.4/mac/tclMacUtil.c
A	tcl8.3.4/tests/README
A	tcl8.3.4/tests/all.tcl
A	tcl8.3.4/tests/append.test
A	tcl8.3.4/tests/assocd.test
A	tcl8.3.4/tests/async.test
A	tcl8.3.4/tests/autoMkindex.tcl
A	tcl8.3.4/tests/autoMkindex.test
A	tcl8.3.4/tests/basic.test
A	tcl8.3.4/tests/binary.test
A	tcl8.3.4/tests/case.test
A	tcl8.3.4/tests/clock.test
A	tcl8.3.4/tests/cmdAH.test
A	tcl8.3.4/tests/cmdIL.test
A	tcl8.3.4/tests/cmdInfo.test
A	tcl8.3.4/tests/cmdMZ.test
A	tcl8.3.4/tests/compExpr-old.test
A	tcl8.3.4/tests/compExpr.test
A	tcl8.3.4/tests/compile.test
A	tcl8.3.4/tests/concat.test
A	tcl8.3.4/tests/dcall.test
A	tcl8.3.4/tests/dstring.test
A	tcl8.3.4/tests/encoding.test
A	tcl8.3.4/tests/env.test
A	tcl8.3.4/tests/error.test
A	tcl8.3.4/tests/eval.test
A	tcl8.3.4/tests/event.test
A	tcl8.3.4/tests/exec.test
A	tcl8.3.4/tests/execute.test
A	tcl8.3.4/tests/expr-old.test
A	tcl8.3.4/tests/expr.test
A	tcl8.3.4/tests/fCmd.test
A	tcl8.3.4/tests/fileName.test
A	tcl8.3.4/tests/for-old.test
A	tcl8.3.4/tests/for.test
A	tcl8.3.4/tests/foreach.test
A	tcl8.3.4/tests/format.test
A	tcl8.3.4/tests/get.test
A	tcl8.3.4/tests/history.test
A	tcl8.3.4/tests/http.test
A	tcl8.3.4/tests/httpd
A	tcl8.3.4/tests/httpold.test
A	tcl8.3.4/tests/if-old.test
A	tcl8.3.4/tests/if.test
A	tcl8.3.4/tests/incr-old.test
A	tcl8.3.4/tests/incr.test
A	tcl8.3.4/tests/indexObj.test
A	tcl8.3.4/tests/info.test
A	tcl8.3.4/tests/init.test
A	tcl8.3.4/tests/interp.test
A	tcl8.3.4/tests/io.test
A	tcl8.3.4/tests/ioCmd.test
A	tcl8.3.4/tests/ioUtil.test
A	tcl8.3.4/tests/iogt.test
A	tcl8.3.4/tests/join.test
A	tcl8.3.4/tests/license.terms
A	tcl8.3.4/tests/lindex.test
A	tcl8.3.4/tests/link.test
A	tcl8.3.4/tests/linsert.test
A	tcl8.3.4/tests/list.test
A	tcl8.3.4/tests/listObj.test
A	tcl8.3.4/tests/llength.test
A	tcl8.3.4/tests/load.test
A	tcl8.3.4/tests/lrange.test
A	tcl8.3.4/tests/lreplace.test
A	tcl8.3.4/tests/lsearch.test
A	tcl8.3.4/tests/macFCmd.test
A	tcl8.3.4/tests/misc.test
A	tcl8.3.4/tests/msgcat.test
A	tcl8.3.4/tests/namespace-old.test
A	tcl8.3.4/tests/namespace.test
A	tcl8.3.4/tests/obj.test
A	tcl8.3.4/tests/opt.test
A	tcl8.3.4/tests/osa.test
A	tcl8.3.4/tests/package.test
A	tcl8.3.4/tests/parse.test
A	tcl8.3.4/tests/parseExpr.test
A	tcl8.3.4/tests/parseOld.test
A	tcl8.3.4/tests/pid.test
A	tcl8.3.4/tests/pkg.test
A	tcl8.3.4/tests/pkg/circ1.tcl
A	tcl8.3.4/tests/pkg/circ2.tcl
A	tcl8.3.4/tests/pkg/circ3.tcl
A	tcl8.3.4/tests/pkg/global.tcl
A	tcl8.3.4/tests/pkg/import.tcl
A	tcl8.3.4/tests/pkg/license.terms
A	tcl8.3.4/tests/pkg/magicchar.tcl
A	tcl8.3.4/tests/pkg/magicchar2.tcl
A	tcl8.3.4/tests/pkg/pkg1.tcl
A	tcl8.3.4/tests/pkg/pkg2_a.tcl
A	tcl8.3.4/tests/pkg/pkg2_b.tcl
A	tcl8.3.4/tests/pkg/pkg3.tcl
A	tcl8.3.4/tests/pkg/pkg4.tcl
A	tcl8.3.4/tests/pkg/pkg5.tcl
A	tcl8.3.4/tests/pkg/pkga.tcl
A	tcl8.3.4/tests/pkg/samename.tcl
A	tcl8.3.4/tests/pkg/simple.tcl
A	tcl8.3.4/tests/pkg/spacename.tcl
A	tcl8.3.4/tests/pkg/std.tcl
A	tcl8.3.4/tests/pkgMkIndex.test
A	tcl8.3.4/tests/platform.test
A	tcl8.3.4/tests/proc-old.test
A	tcl8.3.4/tests/proc.test
A	tcl8.3.4/tests/pwd.test
A	tcl8.3.4/tests/reg.test
A	tcl8.3.4/tests/regexp.test
A	tcl8.3.4/tests/registry.test
A	tcl8.3.4/tests/remote.tcl
A	tcl8.3.4/tests/rename.test
A	tcl8.3.4/tests/resource.test
A	tcl8.3.4/tests/result.test
A	tcl8.3.4/tests/safe.test
A	tcl8.3.4/tests/scan.test
A	tcl8.3.4/tests/security.test
A	tcl8.3.4/tests/set-old.test
A	tcl8.3.4/tests/set.test
A	tcl8.3.4/tests/socket.test
A	tcl8.3.4/tests/source.test
A	tcl8.3.4/tests/split.test
A	tcl8.3.4/tests/stack.test
A	tcl8.3.4/tests/string.test
A	tcl8.3.4/tests/stringObj.test
A	tcl8.3.4/tests/subst.test
A	tcl8.3.4/tests/switch.test
A	tcl8.3.4/tests/tcltest.test
A	tcl8.3.4/tests/thread.test
A	tcl8.3.4/tests/timer.test
A	tcl8.3.4/tests/trace.test
A	tcl8.3.4/tests/unixFCmd.test
A	tcl8.3.4/tests/unixFile.test
A	tcl8.3.4/tests/unixInit.test
A	tcl8.3.4/tests/unixNotfy.test
A	tcl8.3.4/tests/unknown.test
A	tcl8.3.4/tests/uplevel.test
A	tcl8.3.4/tests/upvar.test
A	tcl8.3.4/tests/utf.test
A	tcl8.3.4/tests/util.test
A	tcl8.3.4/tests/var.test
A	tcl8.3.4/tests/while-old.test
A	tcl8.3.4/tests/while.test
A	tcl8.3.4/tests/winConsole.test
A	tcl8.3.4/tests/winDde.test
A	tcl8.3.4/tests/winFCmd.test
A	tcl8.3.4/tests/winFile.test
A	tcl8.3.4/tests/winNotify.test
A	tcl8.3.4/tests/winPipe.test
A	tcl8.3.4/tests/winTime.test
A	tcl8.3.4/tools/Makefile.in
A	tcl8.3.4/tools/README
A	tcl8.3.4/tools/checkLibraryDoc.tcl
A	tcl8.3.4/tools/configure
A	tcl8.3.4/tools/configure.in
A	tcl8.3.4/tools/cvtEOL.tcl
A	tcl8.3.4/tools/genStubs.tcl
A	tcl8.3.4/tools/genWinImage.tcl
A	tcl8.3.4/tools/index.tcl
A	tcl8.3.4/tools/man2help.tcl
A	tcl8.3.4/tools/man2help2.tcl
A	tcl8.3.4/tools/man2html.tcl
A	tcl8.3.4/tools/man2html1.tcl
A	tcl8.3.4/tools/man2html2.tcl
A	tcl8.3.4/tools/man2tcl.c
A	tcl8.3.4/tools/regexpTestLib.tcl
A	tcl8.3.4/tools/tcl.hpj.in
A	tcl8.3.4/tools/tcl.wse.in
A	tcl8.3.4/tools/tclSplash.bmp
A	tcl8.3.4/tools/tcltk-man2html.tcl
A	tcl8.3.4/tools/uniClass.tcl
A	tcl8.3.4/tools/uniParse.tcl
A	tcl8.3.4/tools/white.bmp
A	tcl8.3.4/unix/Makefile.in
A	tcl8.3.4/unix/README
A	tcl8.3.4/unix/aclocal.m4
A	tcl8.3.4/unix/configure
A	tcl8.3.4/unix/configure.in
A	tcl8.3.4/unix/dltest/Makefile.in
A	tcl8.3.4/unix/dltest/README
A	tcl8.3.4/unix/dltest/configure
A	tcl8.3.4/unix/dltest/configure.in
A	tcl8.3.4/unix/dltest/pkga.c
A	tcl8.3.4/unix/dltest/pkgb.c
A	tcl8.3.4/unix/dltest/pkgc.c
A	tcl8.3.4/unix/dltest/pkgd.c
A	tcl8.3.4/unix/dltest/pkge.c
A	tcl8.3.4/unix/dltest/pkgf.c
A	tcl8.3.4/unix/install-sh
A	tcl8.3.4/unix/ldAix
A	tcl8.3.4/unix/mkLinks
A	tcl8.3.4/unix/tcl.m4
A	tcl8.3.4/unix/tcl.spec
A	tcl8.3.4/unix/tclAppInit.c
A	tcl8.3.4/unix/tclConfig.sh.in
A	tcl8.3.4/unix/tclLoadAix.c
A	tcl8.3.4/unix/tclLoadAout.c
A	tcl8.3.4/unix/tclLoadDl.c
A	tcl8.3.4/unix/tclLoadDld.c
A	tcl8.3.4/unix/tclLoadDyld.c
A	tcl8.3.4/unix/tclLoadNext.c
A	tcl8.3.4/unix/tclLoadOSF.c
A	tcl8.3.4/unix/tclLoadShl.c
A	tcl8.3.4/unix/tclMtherr.c
A	tcl8.3.4/unix/tclUnixChan.c
A	tcl8.3.4/unix/tclUnixEvent.c
A	tcl8.3.4/unix/tclUnixFCmd.c
A	tcl8.3.4/unix/tclUnixFile.c
A	tcl8.3.4/unix/tclUnixInit.c
A	tcl8.3.4/unix/tclUnixNotfy.c
A	tcl8.3.4/unix/tclUnixPipe.c
A	tcl8.3.4/unix/tclUnixPort.h
A	tcl8.3.4/unix/tclUnixPort.h.orig
A	tcl8.3.4/unix/tclUnixSock.c
A	tcl8.3.4/unix/tclUnixTest.c
A	tcl8.3.4/unix/tclUnixThrd.c
A	tcl8.3.4/unix/tclUnixThrd.c.orig
A	tcl8.3.4/unix/tclUnixThrd.h
A	tcl8.3.4/unix/tclUnixTime.c
A	tcl8.3.4/unix/tclXtNotify.c
A	tcl8.3.4/unix/tclXtTest.c
A	tcl8.3.4/win/Makefile.in
A	tcl8.3.4/win/README
A	tcl8.3.4/win/aclocal.m4
A	tcl8.3.4/win/cat.c
A	tcl8.3.4/win/configure
A	tcl8.3.4/win/configure.in
A	tcl8.3.4/win/license.terms
A	tcl8.3.4/win/makefile.vc
A	tcl8.3.4/win/mkd.bat
A	tcl8.3.4/win/rmd.bat
A	tcl8.3.4/win/stub16.c
A	tcl8.3.4/win/tcl.hpj.in
A	tcl8.3.4/win/tcl.m4
A	tcl8.3.4/win/tcl.rc
A	tcl8.3.4/win/tclAppInit.c
A	tcl8.3.4/win/tclConfig.sh.in
A	tcl8.3.4/win/tclWin32Dll.c
A	tcl8.3.4/win/tclWinChan.c
A	tcl8.3.4/win/tclWinConsole.c
A	tcl8.3.4/win/tclWinDde.c
A	tcl8.3.4/win/tclWinError.c
A	tcl8.3.4/win/tclWinFCmd.c
A	tcl8.3.4/win/tclWinFile.c
A	tcl8.3.4/win/tclWinInit.c
A	tcl8.3.4/win/tclWinInt.h
A	tcl8.3.4/win/tclWinLoad.c
A	tcl8.3.4/win/tclWinMtherr.c
A	tcl8.3.4/win/tclWinNotify.c
A	tcl8.3.4/win/tclWinPipe.c
A	tcl8.3.4/win/tclWinPort.h
A	tcl8.3.4/win/tclWinReg.c
A	tcl8.3.4/win/tclWinSerial.c
A	tcl8.3.4/win/tclWinSock.c
A	tcl8.3.4/win/tclWinTest.c
A	tcl8.3.4/win/tclWinThrd.c
A	tcl8.3.4/win/tclWinThrd.h
A	tcl8.3.4/win/tclWinTime.c
A	tcl8.3.4/win/tclsh.ico
A	tcl8.3.4/win/tclsh.rc

commit 03b018dfb02e8c62a57e4eaa23b06eb40ef26f76
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2001-08-30

    (ns_httppost) Accept content-type parameter
    
    Suggested by Rick Lansky.

M	ChangeLog
M	tcl/http.tcl

commit 62546347f2c638214dfc7204946cd9b57f142324
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2001-08-27

    Add ns_httppost, that is called with url, rqset, qsset and timeout
    
    The qsset is an ns_set with key/values that will be turned into
    user=scottg&pass=1234, for example, and passed as content in
    the POST.

M	ChangeLog
M	tcl/http.tcl

commit 171905ac01f40f6af06de9ea566ddf5d9242c45c
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2001-08-18

    Moved rqset to be the last arg passed to ns_httpget so it won't break existing code
    
    I should have done it that way in the first place.

M	ChangeLog
M	tcl/http.tcl

commit 08bf4561eb9fc21958207066f843693609ba2165
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2001-08-16

    Add the rqset param to ns_httpget so that cookies, for example, may be set

M	ChangeLog
M	tcl/http.tcl

commit 689620ed17e4d4e99a3683301d4e3b396ce5d954
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2001-07-17

    You can now 'ns_httpopen GET /index.html', http://hostname:port/ will be prepended

M	ChangeLog
M	tcl/http.tcl

commit 2523898a59f36ca301d52b5f4d3798e909f8db43
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2001-07-01

    Fixed ns_conn outputheaders as per bug #433676 submitted by Yon Derek (yond)

M	ChangeLog
M	nsd/conn.c
A	tests/api/ns_conn.adp

commit b13783e1a2fd5f385b019412c7441286dd6294e9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-06-26

    Remove 32 character cache name limit; update time-based caches to use microsecond resolution

M	nsd/cache.c

commit d089a795bd207c5549fde49145c53426d3c4fe9a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-06-26

    Fixed Ns_Cache bug which could result in an invalid entry pointer if two threads attempt to update same entry at once

M	nsd/adpeval.c

commit c6683fe954e131313974bb4e54452b40b6698350
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-06-26

    Renamed new logmaxbackup, logmaxbuffer, and logmaxlevel config options and fixed dns timeout setting bug

M	nsd/nsconf.c

commit 9ac4d691af363416ecd8e90ca12a4c749fb7351a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-31

    Silence compiler warning

M	thread/pthread.cpp

commit 391b1c481825daa11c7b6cb4bdabe4de9a0d99da
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-31

    Further simplifications of build system

M	include/Makefile.global

commit f77aca2c4173a6bca7f40475bce991394dfc6a7e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-31

    Thread fixes for HP-UX

M	thread/pthread.cpp
M	thread/test.c

commit bc392a419ca5db97ea700310a0e1419969d9eb96
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2001-05-30

    Corrected include directives to use the NSHOME variable

M	include/Makefile.library
M	include/Makefile.module

commit 64ad8afedb3b6496ddb7ab4acb782a02594ae271
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2001-05-30

    Small display change in output from HTML pre to xmp tags

M	tests/api/ns_localtime.adp

commit 9ac760fc9676547395557a65f868614057db056b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-30

    Updated RFLAG for test program

M	thread/Makefile

commit ce8b4e264a700b12faf2c68abbc8d4af977f5a0e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-30

    Moved RPATH out of LIBS and into specific makefiles

M	include/Makefile.global
M	nsmain/Makefile

commit e7605916e05b022fde8328f1b55f950dd199e0f3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-30

    Cleaned up make vars names, removed build directories from default RPATH

M	Makefile
M	include/Makefile.global
M	thread/Makefile

commit 59793e81a6189449a622274cdcad68c604e9c7e8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-28

    Updated LDSO flags

M	include/Makefile.global
M	include/ns.h

commit d325f3d0bb1150038d8115bec5c0ba78017005b3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-28

    Updated Irix build flags

M	include/Makefile.global

commit 345d5cc0eba9cbb17266d7db89c769ce8148f187
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-28

    Updated libnsd.so install target

M	Makefile
M	include/Makefile.global
M	nsd/Makefile

commit 7acc306030550f3bd464b450e60c53718a450b85
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-28

    Makefile for shared libraries, similar to modules

A	include/Makefile.library

commit 6ad49ff6eb77b52cc2017d3c54ef0fa954812e62
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-28

    Updated build to use shared libraries

M	Makefile
M	include/Makefile.global
M	include/Makefile.module
M	nscgi/Makefile
M	nscp/Makefile
M	nsd/Makefile
M	nsext/Makefile
M	nslog/Makefile
A	nsmain/Makefile
R100	nsd/main.c	nsmain/main.c
M	nspd/Makefile
M	nsperm/Makefile
M	nssock/Makefile
M	nsssl/Makefile
M	thread/Makefile

commit 386eaa4276b75fdeabb833b79b7837c1b7a83c7e
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2001-05-22

    Make Ns_ConnDriverContext return the actual conn-specific, module-specific context
    
    This is how it used to work in 3.x. For some reason this API call
    was changed to always return NULL, but nsopenssl and potentially
    other comm drivers need to get their conn-specific info back.

M	ChangeLog
M	nsd/conn.c

commit aacc439490b9570d9f03006e9fdc8f1f7e0b6e78
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-20

    Aded -DNO_LONGDBL for Irix

M	include/Makefile.global

commit 150de6bc315e5972ca39f5209a4c4bd0ff88b277
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-19

    Implement Ns_Time Tcl_Obj type used by ns_time command; seems faster

M	include/ns.h
M	nsd/Makefile
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/tclmisc.c
A	nsd/tclobj.c
M	win32/nsd/nsd.dsp

commit 957c9625794614e5c739a54a90b70aaa425863e3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-19

    (ns_http) switch to simple 1-second timeout for now

M	nsd/tclhttp.c

commit c91c2e247cbd02ca5a2dfe8020964ee7c3c55121
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-19

    Updated comment

M	nsd/tclshare.c

commit b75251c75fdd365c03d6c58f138b9c224207fca7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-18

    Fixed broken ns_time command, making it Tcl_Obj based as well

M	nsd/tclcmds.c
M	nsd/tclmisc.c

commit 9965de937bc7648d95bef282b702af8125853e99
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-10

    Switched to new Ns_DStringVPrintf from vsnprintf for Ns_ConnPrintfHeader

M	nsd/return.c

commit a77ab9fa1149838a74b788cf61a5e083c1dd15f4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-10

    Fixed compile bug

M	nsd/connio.c

commit 61133b92285656c69cc916d69069dfe6ede386b4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-10

    Made LONGDBL support optional, turned off by NO_LONGDBL define

M	nsd/dsprintf.c

commit d3569296c8de99a7357ae4ec66074f23160fe76c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-10

    Added option for using the ill-advised vfork, disabled by default

M	include/nsthread.h
M	nsd/exec.c
M	nsd/nsconf.c
M	nsd/nsconf.h
M	nsd/nsd.h
M	thread/fork.c

commit f2ab0e0b0535eafca8a91a496c89b8a8cd409256
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-10

    Fix compile warning

M	nsd/form.c

commit 59ad34504169862146a36ac666df1bdb8e29f3f9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-10

    Added Ns_SockConnect2() API's for local address/port binding

M	include/ns.h
M	nsd/sock.c

commit 5cf87a1b290a5221f10acd4a24a9c1de5f4d35fb
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-10

    Removed undocumented -q (quieter) option

M	nsd/nsmain.c

commit 783cb1a3b79b2d142665a8a08016dfdce2e42031
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-07

    Added check for NO__ENVIRON

M	nsd/tclenv.c

commit 816a44e393549d2d215d3d11351b68b4db140ccd
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-07

    Fixed crash bug with null input

M	nsd/driver.c

commit f7301a146c22a634e99f7cf8c423b9bd30780ab8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-07

    Added -DNO__ENVIRON where needed and cleaned up handling of CC options

M	include/Makefile.global

commit 4dbecea04fbcb2208139183cbbdd16fc197df2e3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-02

    Fix compile bugs with Tcl library and 64 bit

M	include/Makefile.global
M	include/ns.h

commit 4ef6b888e0412f905666ccdae4bc78ce09aa9d31
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-02

    Added log buffering, Notice suppression, arbitrary severity levels, and per-thread Ns_LogTime buffer caches

M	nsd/log.c
M	nsd/nsconf.c
M	nsd/nsconf.h
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/tls.c

commit 727827cc8ef4c608c058fcc62de2ef18f2d2012e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-02

    Implemented Ns_DStringVPrintf directly instead of through cheap vsnprintf

M	nsd/Makefile
A	nsd/dsprintf.c
M	nsd/dstring.c
M	win32/nsd/nsd.dsp

commit 113766669cfaf4861bd2becf343765b500d5b04f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-05-02

    Added Ns_DStringVPrintf, restored Dev log level, and cleaned up type defs for 64-bit ints

M	include/ns.h

commit 78c47079f658e871ca8e3fc228495ac12fb226b5
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2001-04-28

    Add mutex to (perhaps futilely) prevent env(TZ) from getting clobbered

M	nsd/tclmisc.c

commit eb2c3b1d1b32f83b7749d0d3329e5dffe7a8ae09
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-27

    Added back Ns_ConnReadLine and Ns_ConnReadHeaders for backwards compatibility

M	nsd/connio.c

commit 3a0ae2acf55f2ab415ed9b0261382ad1356108f4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-27

    Switched to gcc -shared link on Solaris by default

M	include/Makefile.global

commit 72da0000d1b4f38f96e17f2d3e08b793d1f5e12a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-26

    Switched to new Ns_ConnQueueHeaders() from Ns_ConnFlushHeaders() API

M	nscgi/nscgi.c

commit ce663e4c82e34e3e1a4c098ee72bcc32f7c1190f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-26

    Changed Ns_Buf definition to match Unix or NT directly

M	include/ns.h
M	include/nsthread.h
M	nsd/connio.c
M	nsssl/nsssl.c

commit d57c1ea4159f493058d944b704c790de2afffe5d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-26

    Added support for queueing content to be sent instead of sending
    immediately, used by Ns_ConnQueueContent().

M	nsd/adprequest.c
M	nsd/connio.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c
M	nsd/tclresp.c

commit 1d7083bfbe25327ba469319418669803b908ff6b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-26

    Moved responsibility for waiting into driver

M	nsd/driver.c
M	nssock/nssock.c

commit e380ceab6ad92cdb4ae36ede51d779841a7c9b20
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2001-04-26

    Implemented bug #418890: ns_localtime should accept timezone

M	ChangeLog
M	nsd/tclmisc.c
A	tests/api/ns_localtime.adp

commit 183241dc3b6e7e5a65208b14813a70ead9d18d7a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-25

    Enhanced ns_time to support high resolution Ns_Time's and updated ns_http to use them

M	nsd/nsd.h
M	nsd/tclhttp.c
M	nsd/tclmisc.c

commit e46ef68ee3b0cb18e8941abb32d7349a20303f75
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-25

    Moved ns_http requests to per-interp from per-server

M	nsd/server.c

commit 6bef57c552302a51b02f17063a9fe268b19d480a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-25

    Made ns_db cleanup and ns_set cleanup consistent with ns_http cleanup
    
    i.e., no additional and unnecessary cleanup at thread exit.

M	nsd/dbtcl.c
M	nsd/nsd.h
M	nsd/tclinit.c
M	nsd/tclset.c

commit 1ee0d5f3b240d962b58b5bc4a421ca0fb0dc904b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-25

    Add "ns_http cleanup"

M	nsd/init.tcl
M	nsd/tclhttp.c

commit 01b779d88491f35d12fd564e888d4f9e2dfcb333
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-25

    Removed "ns_http get" option - only async mode

M	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/server.c
M	nsd/tclhttp.c

commit 4ee5599984ca57584e41bc30db98519ce7fb300d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-25

    Fix incorrect RCSID usage in imported keyed-list code

M	nsd/tclvar.c
M	nsd/tclxkeylist.c

commit 04daf2f9c98548f2036cbb03dcf605176a795fb2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-25

    Add new ns_http command

M	nsd/Makefile
M	nsd/tclcmds.c
A	nsd/tclhttp.c
M	win32/nsd/nsd.dsp

commit f6aaf00693334ba41da5da804c9369a6c8760b1d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-24

    Fixed stupid crash bug in pthread Ns_CondDestroy

M	thread/pthread.cpp

commit 2d04c6aef3933a8775d9997d587dcb005394bd1d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-24

    Minor edits to fix compile bugs on DEC Unix

M	include/Makefile.global
M	nsd/tclenv.c
M	thread/pthread.cpp

commit 39947736bc1f53e90abdc2647945f18482d0a92e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-24

    Build fix: Tcl library copy bug

M	Makefile

commit 82b58334364ccecf30bec44fa8c215a8adfb9a66
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-24

    Updated to use Ns_Cs instead of Ns_CriticalSection stuff

M	nsssl/x509.c

commit 4c652fe11591a1cdf03d6eefc94875be177669ea
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-24

    Undef'ed Tcl's panic() on OS/X to avoid compile bug

M	nsd/fastpath.c

commit 679b21b01bd0792d352163892bf7060d18ac1355
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-24

    Added RANLIB

M	thread/Makefile

commit 78e3aeb5d534bc9f399d68fe4cbaf249798d091d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-24

    Updated link library settings for winsock2

M	win32/cgitest/cgitest.dsp
M	win32/main/main.dsp
M	win32/nscgi/nscgi.dsp
M	win32/nscp/nscp.dsp
M	win32/nsd/nsd.dsp
M	win32/nslog/nslog.dsp
M	win32/nsodbc/nsodbc.dsp
M	win32/nsperm/nsperm.dsp
M	win32/nssock/nssock.dsp
M	win32/nsssl/nsssl.dsp
M	win32/nstcl/nstcl.dsp
M	win32/nsthread/nsthread.dsp
M	win32/threadtest/threadtest.dsp

commit 540665564b57dd611048c6268c7b81a91a53803b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-24

    Removed unused variables

M	nsd/nsmain.c

commit 9c68c8c2ef34311e33aed7c565a7be6b637745c8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-24

    Remove old versions of Tcl

D	tcl7.6/Makefile
D	tcl7.6/README-aolserver.txt
D	tcl7.6/compat/README
D	tcl7.6/compat/dirent.h
D	tcl7.6/compat/dirent2.h
D	tcl7.6/compat/dlfcn.h
D	tcl7.6/compat/fixstrtod.c
D	tcl7.6/compat/float.h
D	tcl7.6/compat/getcwd.c
D	tcl7.6/compat/gettod.c
D	tcl7.6/compat/license.terms
D	tcl7.6/compat/limits.h
D	tcl7.6/compat/opendir.c
D	tcl7.6/compat/stdlib.h
D	tcl7.6/compat/strftime.c
D	tcl7.6/compat/string.h
D	tcl7.6/compat/strncasecmp.c
D	tcl7.6/compat/strstr.c
D	tcl7.6/compat/strtod.c
D	tcl7.6/compat/strtol.c
D	tcl7.6/compat/strtoul.c
D	tcl7.6/compat/tclErrno.h
D	tcl7.6/compat/tmpnam.c
D	tcl7.6/compat/unistd.h
D	tcl7.6/compat/waitpid.c
D	tcl7.6/generic/README
D	tcl7.6/generic/panic.c
D	tcl7.6/generic/regexp.c
D	tcl7.6/generic/tcl.h
D	tcl7.6/generic/tclAsync.c
D	tcl7.6/generic/tclBasic.c
D	tcl7.6/generic/tclCkalloc.c
D	tcl7.6/generic/tclClock.c
D	tcl7.6/generic/tclCmdAH.c
D	tcl7.6/generic/tclCmdIL.c
D	tcl7.6/generic/tclCmdMZ.c
D	tcl7.6/generic/tclDate.c
D	tcl7.6/generic/tclEnv.c
D	tcl7.6/generic/tclEvent.c
D	tcl7.6/generic/tclExpr.c
D	tcl7.6/generic/tclFCmd.c
D	tcl7.6/generic/tclFHandle.c
D	tcl7.6/generic/tclFileName.c
D	tcl7.6/generic/tclGet.c
D	tcl7.6/generic/tclGetDate.y
D	tcl7.6/generic/tclHash.c
D	tcl7.6/generic/tclHistory.c
D	tcl7.6/generic/tclIO.c
D	tcl7.6/generic/tclIOCmd.c
D	tcl7.6/generic/tclIOSock.c
D	tcl7.6/generic/tclIOUtil.c
D	tcl7.6/generic/tclInt.h
D	tcl7.6/generic/tclInterp.c
D	tcl7.6/generic/tclLink.c
D	tcl7.6/generic/tclLoad.c
D	tcl7.6/generic/tclLoadNone.c
D	tcl7.6/generic/tclMain.c
D	tcl7.6/generic/tclNotify.c
D	tcl7.6/generic/tclParse.c
D	tcl7.6/generic/tclPatch.h
D	tcl7.6/generic/tclPkg.c
D	tcl7.6/generic/tclPort.h
D	tcl7.6/generic/tclPosixStr.c
D	tcl7.6/generic/tclPreserve.c
D	tcl7.6/generic/tclProc.c
D	tcl7.6/generic/tclRegexp.h
D	tcl7.6/generic/tclTest.c
D	tcl7.6/generic/tclUtil.c
D	tcl7.6/generic/tclVar.c
D	tcl7.6/generic/tclVar.c-
D	tcl7.6/unix/Makefile.in
D	tcl7.6/unix/README
D	tcl7.6/unix/configure
D	tcl7.6/unix/configure.in
D	tcl7.6/unix/install-sh
D	tcl7.6/unix/ldAix
D	tcl7.6/unix/mkLinks
D	tcl7.6/unix/porting.notes
D	tcl7.6/unix/tclAppInit.c
D	tcl7.6/unix/tclConfig.sh.in
D	tcl7.6/unix/tclLoadAix.c
D	tcl7.6/unix/tclLoadAout.c
D	tcl7.6/unix/tclLoadDl.c
D	tcl7.6/unix/tclLoadDl2.c
D	tcl7.6/unix/tclLoadDld.c
D	tcl7.6/unix/tclLoadNext.c
D	tcl7.6/unix/tclLoadOSF.c
D	tcl7.6/unix/tclLoadShl.c
D	tcl7.6/unix/tclMtherr.c
D	tcl7.6/unix/tclUnixChan.c
D	tcl7.6/unix/tclUnixFCmd.c
D	tcl7.6/unix/tclUnixFile.c
D	tcl7.6/unix/tclUnixInit.c
D	tcl7.6/unix/tclUnixNotfy.c
D	tcl7.6/unix/tclUnixPipe.c
D	tcl7.6/unix/tclUnixPort.h
D	tcl7.6/unix/tclUnixSock.c
D	tcl7.6/unix/tclUnixTest.c
D	tcl7.6/unix/tclUnixTime.c

commit 605a1cde8330ee65563e5574f1f42708200c1492
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-24

    Win32 build fix: update nsssl dependencies

M	win32/nsssl/nsssl.dsp

commit c97d185ffcf3c033a09624084344fc4a15b0956b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-24

    Added buffered raw socket read code

M	nsssl/ssl.c
M	nsssl/ssl.h

commit 75e3afbd71735a0a27b195742ae708e3f38924e2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Fixed compile bugs in new integrated socket driver

M	nssock/nssock.c

commit 82fd8b0d7bf5a27fb008e91432fa20ab88cae1c0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Fixed compile bug: missing brace

M	nsd/fd.c

commit c53ba6c0de53783b9a14a62127a1f79cca3374ab
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Build fix: add nsssl as separate module

M	Makefile

commit 8ee266645f009065934e37bf66ed7498722e0e10
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Build fix: add connio.c, remove keepalive.c

M	nsd/Makefile

commit db79de895683059ed664c680b39676ae47de68c6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Use new Ns_Get/ReleaseTemp() API for temp fd management

M	nscgi/nscgi.c

commit 125d86324dc82f6e9a26d6482626ff23f154f36c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Win32 build fix: add nsssl as a dependency

M	win32/aolserver.dsw

commit b859acac5b6a78fac97db1faebae0791c653b3e8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Win32 build fix: add file copy post-builds for ssl

M	win32/main/main.dsp

commit 3b1598e6fe6f2fcec83cd5db6dd4fc139bfa5111
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Win32 build fix: update to winsock2, add connio.c, remove keepalive.c

M	win32/nsd/nsd.dsp

commit a833f11e42959dbe85bbab64584698239d7f10b6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Win32 build fix: separate out source for sock and ssl

M	win32/nssock/nssock.dsp
M	win32/nsssl/nsssl.dsp

commit c8f6c3bd7861f00ba719a9d49173cb8fcd2be210
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Updated to use new "ns_conn files" and "ns_conn copy" API's

M	tcl/form.tcl

commit ea651221cf9311cf1fd13325dca52e02e0d0fdef
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    New integrated socket driver implementation

M	include/ns.h
A	nsd/connio.c
M	nsd/driver.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/request.c
M	nsd/server.c

commit e7929c41284ecb260d86ae18bff5a33b877b661b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Removed KeepAlive init/stop

M	nsd/nsmain.c

commit b46332f2609d9526cc8fdf161838bb8a7e8d66ee
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Eliminated connPtr->keepAlive in favor of NS_CONN_KEEPALIVE flag bit

M	nsd/return.c

commit bf97349e3aad250fd0fdee8646192e0893cefdd6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Added code to save filename, offset, and length for multipart forms in connPtr->files dstring list

M	nsd/form.c

commit acc377bbfede9e6ab0cffa25c6fb80ef0f23fc80
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Moved I/O related API's to connio.c and added "ns_conn files" and "ns_conn copy" commands

M	nsd/conn.c

commit c60636f6ed0e4acbc492257e666e6c969686c850
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Eliminated needless flush content calls

M	nsd/op.c

commit 40129932f40cfc25a7efa45aa5ff194bf88d2e61
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Keepalive integrated into driver.c

D	nsd/keepalive.c

commit 9e6ad12bc14f5fa20e3b6e053d3d566d47f7ea03
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Fixed bug in unsigned compare of fd/sock on NT

M	nsd/keepalive.c

commit d7751b8cd4227ecb8bd815720f69d1fcecd50706
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Added Ns_GetTemp/Ns_ReleaseTemp API

M	nsd/fd.c

commit 348660d04dbd6ac8de76b093feb6d2e4cfdf969d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    New simple socket driver

M	nssock/Makefile
D	nssock/Makefile.sock
D	nssock/Makefile.ssl
D	nssock/certfile-sample.pem
D	nssock/keyfile-sample.pem
D	nssock/keygen.tcl
M	nssock/nssock.c
D	nssock/nsssl.c
D	nssock/nsssl.html
D	nssock/sock.cpp
D	nssock/ssl.c
D	nssock/ssl.h
D	nssock/ssltcl.c
D	nssock/ssltcl.h
D	nssock/t_stdlib.c
D	nssock/x509.c
D	nssock/x509.h

commit 219c72cc7a16bef9cd9d4ed83d21dd352a559099
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    New SSL socket driver

A	nsssl/Makefile
A	nsssl/certfile-sample.pem
A	nsssl/keyfile-sample.pem
A	nsssl/keygen.tcl
A	nsssl/nsssl.c
A	nsssl/nsssl.html
A	nsssl/ssl.c
A	nsssl/ssl.h
A	nsssl/ssltcl.c
A	nsssl/ssltcl.h
A	nsssl/t_stdlib.c
A	nsssl/x509.c
A	nsssl/x509.h

commit b02062e9b3abc3530c7db2b343b130436ee88f5e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-23

    Switched to Winsock2

M	include/nsthread.h
M	win32/nstcl/nstcl.dsp

commit 538a8842583cc8a54c2e268a146745b95ca725c2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-13

    Removed the odd ns_get_mulitpart_formdata command
    
    C code now handles small urlencoded or multipart form.
    TODO: Handle actual file widget data.

M	nsd/form.c
M	nsd/tclcmds.c

commit ec6ca9a3b180845138e0f76f33375900b832b19b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-13

    Updated to Tcl8.3.3

M	include/Makefile.global
M	win32/nstcl/Makefile
M	win32/nstcl/nstcl.dsp

commit 5a2d4d429823c3484d66048877a5155dc1d3ad57
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-13

    Renamed undocumented Ns_RegisterCleanup to Ns_RegisterConnCleanup for compatibility with 3.x

M	include/ns.h
M	nsd/filter.c

commit 0047c8ba636a9d4a1243e57c42fe5d666ebb85a7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-12

    Added tclrequest.obj, tclatclose.obj, removed tclop.obj

M	win32/nsd/Makefile
M	win32/nsd/nsd.dsp

commit 73d5bc311cbd34338c80ad37a136cbfa714284f1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-12

    Added support for ns_register_adp command to register ADP pages much like procs

M	nsd/Makefile
M	nsd/adpparse.c
M	nsd/adprequest.c
A	nsd/tclatclose.c
M	nsd/tclcmds.c
M	nsd/tclinit.c
R053	nsd/tclop.c	nsd/tclrequest.c

commit a9ebcec4e23bc963ffc6ca69b00c02c8bfdf1d7f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-12

    Removed unused LoadEncoding() function

M	nsd/encoding.c

commit f8bd62c9572bb73746f2ae7253de020eb0df26f5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-11

    Modified to strdup method and url args

M	nsd/filter.c

commit 33a93a498e0610b9280ef042ad133144ff0ede61
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-11

    Modified Ns_ConnCopyToDString to read directly into dstring, avoiding data copy and possible dstring resize

M	nsd/conn.c

commit 46f4fc38c8b47309bc1ac47f1ae74a7fb7a532bc
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-07

    Ns_GetFileEncoding() now uses the [ns/encoding] config section only
    
    Ns_GetCharsetEncoding() only needs to know about charset names which
    differ from Tcl encoding names (e.g., iso-8859-1).

M	nsd/encoding.c

commit e01a26004ef220b6f52dc613af57e29dc03a4c9a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-07

    Fix for bug #411805: add missing null terminator to buffer

M	nsd/dstring.c
M	nsd/return.c

commit 47190fe0e6fccab46f94132fcb62c9789b0187c9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Increased resolution of Ns_GetTime on Win32 and optimized diff and adj routines a bit

M	thread/time.c

commit 04191caf7cad760e9af63ff866d046b9fb33d412
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Fixed Unix compile bugs for nsthreads.c

D	thread/tcl8x.c

commit edbb70da411f1ec1c0336d68b5239e6c46bc8743
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Moved Tcl nsthreads support to Tcl generic source from nsthread library to resolve incorrect cleanup order of Tcl thread data blocks

M	thread/Makefile
M	win32/nstcl/nstcl.dsp
M	win32/nsthread/nsthread.dsp

commit b054a81c7bb0fc53a47a52af552f957244a7eaa4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Fixed crash bug with GetCharsetEncoding

M	nsd/encoding.c

commit b301d6561029352baa05c01914d99d8a69da52cf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Removed NsAdpSetCharset and now use Ns_ConnSet/GetEncoding API's for form input and output

M	nsd/adprequest.c

commit eddd7708129a6d0da9322edfb0c417307c66048b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Changed file reader to use encoding's as defined by Ns_GetFileEncoding
    
    i.e., based on the charset= parameter for the corresponding mimetype.

M	nsd/adpeval.c

commit 7bf0fc14159be0bd0061c80bdf58ad3744624b9f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Added cleanup of new input content buffer

M	nsd/queue.c

commit d1f8488c63395836616f9468b923428f5ed7a0f9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Added some comments

M	nsd/nsconf.c

commit 9682e99f3e31cd850ab444b9f05d8e44999dcf1b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Added charset=iso-8859-1 for text/html types

M	nsd/mimetypes.c

commit 2e096ff621575f3346f7f6602140265e90325a3a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Removed ns_adp_charset command

M	nsd/adpcmds.c
M	nsd/tclcmds.c

commit 4679d63509794f4ccc98d5d40cd4817bdfcfffec
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Added code to maintain input content buffer instead of dumping after parse into a form

M	nsd/conn.c
M	nsd/form.c

commit 50194fd7e408ebc4981898b6104f937575d3d56f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Added Ns_GetFile/Type/CharsetEncoding()

M	include/ns.h
M	nsd/encoding.c

commit 20a3bd7ef5095a9a3777a0648b87b75ee7cceb4c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Moved init proc definitions back to nsd.h

M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/server.c

commit 704b79165bec5c45c498c751327c3ae6cf447072
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Minor formatting edits

M	nsd/tclset.c

commit 5e629c6a7156f150e9ffc99690fad722db576be8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-04-02

    Added missing comment to job subsystem

M	nsd/tcljob.c

commit 953802e0bfb189621d1770b29de8ce72951bb135
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-28

    Updated to new result of Ns_GetEnvironment()

M	nscgi/nscgi.c

commit 265165842bda8423548e3f39f2018f87071bc540
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-28

    Added Ns_DStringAppendArgv(), used for Ns_GetEnvironment() and the process create code

M	include/ns.h
M	nsd/dstring.c
M	nsd/exec.c
M	nsd/tclenv.c

commit d519f142bc737d109cac7ff34f1ec1b997e8b6bd
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-28

    Minor compile bugs

M	nsd/exec.c
M	nsd/tclenv.c

commit 337bf79fa392a9be24b8234532923292e005b15c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-28

    Removed unused "Dev" Ns_Log level

M	nsd/log.c
M	nsd/nsconf.c
M	nsd/nsd.h

commit 0496051ec5b5f8a168d01f6d26a41a70d445a2a6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-28

    Moved some external definitions of init functions out of nsd.h

M	nsd/server.c

commit c8dae777b10d4a9e41fb6b1375c0efe3f3890d95
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-28

    Made argc, argv, and optind variables available in config script

M	nsd/config.c
M	nsd/nsmain.c

commit 11f7da7f74e457116fde6a50820cdad27410058a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-28

    Made the Ns_LocationProc virtual server specific

M	include/ns.h
M	nsd/conn.c

commit e2ca32946db652b27fcf24b971f1cb888c37351c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-27

    Added Ns_GetEnvironment used by CGI and nsd exec code to more safely copy the environ strings

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/exec.c
M	nsd/tclenv.c

commit 2c649576044cc9cb6d3c0d224b2cb9f55a836bc1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-27

    Added USE_SPROC check to optionally compile with pthreads on SGI

M	include/Makefile.global

commit a1e6428ff794f9bb4dae0b313ded291a7725b4d2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-27

    Temp fix for execve(..., envp) - need to fix in coordinated way with tclenv.c

M	nsd/exec.c

commit 80000a2798938a29fb85d6515a7d02acd8b97460
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-27

    Minor comment corrections

M	thread/sproc.cpp

commit 346ecc4077e7abb3ceaa64612953d80e304e5f00
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-27

    Move response buffer from per-interp adp context to stack of Ns_AdpRequest

M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/nsd.h

commit a42a83ebeb1b45e01964bbabd9d5eedc481b2503
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-27

    Removed ADP_OVERFLOW exception (handled in Tcl now)

M	nsd/adpcmds.c

commit 60d113793b8905b928e909a5f72398f28b4b3fd8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-27

    Use execve() all the time to avoid Solaris deadlock bug

M	nsd/exec.c

commit d08dbc2cf8b43e0de963d6eb9aa17aed587ecd8e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-27

    Implemented Ns_ConfigGetInt64() for Win32

M	include/ns.h
M	nsd/config.c

commit 160497015c3d25a1a0b3db66a975031855e061c9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-27

    Fixed startup bugs when running in service mode

M	nsd/nsmain.c
M	nsd/win32.c

commit 2d6d60832d394318a4cf1d7f96b98c1047a8ff9f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-27

    Removed old .ini format config file support

M	nsd/config.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/win32.c

commit 4cb839f9f9af78121c76756bd67ba200df9be9af
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-27

    Made crypt code reentrant, eliminating the lock

M	nsd/crypt.c

commit f6d1f0b0b78e25ff16953c42c52dba046bbec2b0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-26

    Increased the Ns_CheckStack() min to 2k and added NsTclCheckStackSpace() for benefit of TclpCheckStackSpace() on Unix

M	thread/tcl8x.c
M	thread/thread.c
M	thread/thread.h

commit 349e031ae9c23153ce7e4360ee3a86a86ff45842
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-26

    Updated NsInterp structure

M	nsd/nsd.h

commit 95a5676f506285b998fe2a60da1a23d607d0dcda
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-26

    Re-structed AdpFlush to ensure output encoding occurs in streaming or non-streaming mode
    
    Also, isolated and cleaned up the TclPro debugger eval code.

M	nsd/adpeval.c

commit b68fe37d0777f97a03eea5d205685ce1cf585339
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-26

    Removed the response and content dstrings from the conn, not ready for such use yet

M	nsd/adprequest.c
M	nsd/queue.c
M	nsd/return.c
M	nsd/server.c

commit 4b5b9692720a53db86394e1ab617e66e52ef85b9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-26

    Removed the weird Ns_DStringPop/Push interface

M	nsd/dstring.c
M	nsd/nsconf.c
M	nsd/tls.c

commit d601cac76ff25306551b503f14f6d705f92bb300
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-24

    Manage dstrings directly instead of relying on Pop/Push API

M	nscgi/nscgi.c

commit 491e80d750e15355ee1ccf6ba417d107859239c9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-23

    Fixed dstring buffer code to use Tcl_DStrings instead of hidden addr element of Ns_DStrings

M	nscgi/nscgi.c

commit ee370af422ce878382974b6799f0ad6351f345f8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-23

    Made Ns_DStrings macros for Tcl_DStrings

M	include/ns.h
M	nsd/dstring.c

commit 9acb0c96a63dbe58d205476e65247b69ea718659
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-23

    Fixed bug with ADP streaming mode

M	nsd/adprequest.c
M	nsd/return.c

commit a58857277ee8c32ccb09e971c1db9d888113164f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-23

    Removed adp.evalLevel no longer needed

M	nsd/adpeval.c
M	nsd/nsd.h

commit 617226ade00b649382080cff1299b50c2457b99d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-23

    Ensured Expires header, if configured on, is set even in ADP stream mode

M	nsd/adprequest.c

commit 5c3b96920d298ac61963f6e7e2c971a8b8655a6b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-23

    Added check to avoid sending headers twice

M	nsd/return.c

commit e3e99524b0761520ec962221b021057cdfd5cab3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-23

    Minor formatting change

M	nsd/encoding.c
M	nsd/tclimg.c

commit 45cde0029d88fd2386b6c80ffa5281e7db13b508
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-23

    Removed PutsCmd, replaced by PutsObjCmd (ns_adp_puts/ns_adp_append)

M	nsd/adpcmds.c
M	nsd/tclcmds.c

commit 28c2594e2a40dfea2dd3e9b72dea21221d22fae5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-23

    Moved ADP output to per-Conn content dstring instead of per-interp adp structures

M	nsd/adpcmds.c
M	nsd/adpeval.c
M	nsd/adprequest.c
M	nsd/conn.c
M	nsd/nsd.h
M	nsd/queue.c
M	nsd/return.c
M	nsd/server.c

commit 0666ac6e04a19450719babf1c0e7c9c3d96e3c17
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-23

    Added NS_CONN_READHDRS and NS_CONN_SENTHDRS flags

M	include/ns.h

commit b271b23e4bef24bbf1ea7c12903166152bce147e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-23

    Fixed bug with "unknown command" error msg

M	nsd/tcljob.c

commit 2e1bad83784f870be79bc56f98c7fb1c8f5045f8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-22

    Build fix: added uuencode.o, tclimg.o, form.o; removed httu.o

M	nsd/Makefile

commit 435738103ca999833042aff45b5d0a146eb520da
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-22

    Silenced compiler warning

M	nsd/uuencode.c

commit 0a3a167cf5de9e298e6d5410edf745cf033ccac3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-22

    Updated code comment

M	nsd/queue.c

commit 578391390fd2225188733ec68d87d75bdc880c0f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-22

    Win32 build fix: added form.c, tclimg.c, uuencode.c; removed htuu.c

M	win32/nsd/nsd.dsp

commit b1f8d499dd47ceaa3dd641135af9bfd6f4ba3c66
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-22

    Moved HTML form handling code to single file and cleaned up some functions

M	nsd/conn.c
A	nsd/form.c
M	nsd/tclresp.c

commit 7d4c1105d535e88333af435e5e548f53df443a66
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-22

    Moved image commands to separate file

A	nsd/tclimg.c
M	nsd/tclmisc.c

commit cc5de1354207b13e2ab2dc2720ba8be998f68755
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-22

    Rewrote the parser to avoid overrunning the input strings and first time initialization

D	nsd/htuu.c
A	nsd/uuencode.c

commit b42cb84b2beca2bf6c4e5a5f78102b57444e472c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-20

    Added code for case-insensitive charset names

M	nsd/encoding.c

commit 4a907b8ffb6ef03d3eae5003cb35e1074349c0c8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-20

    Switched to loading Tcl_Encoding's on the fly

M	nsd/encoding.c

commit 620d37c6253490f809145d0c65f16769debaf713
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-19

    Win32 build fix: add browse info support and encoding.c

M	win32/nsd/nsd.dsp
M	win32/nstcl/nstcl.dsp

commit c8d80f98e8eeba77b547ed4fae82aa54bc2d88b1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-19

    Added support for ADP output encoding based on content-type charset

M	include/ns.h
M	nsd/Makefile
M	nsd/adprequest.c
A	nsd/encoding.c
M	nsd/nsd.h

commit 99db00d890e52c58d88c70d0c50ddc60eaad3bba
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-19

    Switched to table drive algorithm for url-en/decoding

M	nsd/urlencode.c

commit 4cf0ab4aafe85c0d416bbaae4937f269b95840ba
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-19

    Added -l flag to set TCL_LIBRARY and call to NsInitEncodings

M	nsd/nsmain.c

commit c8b3973d416ed30db9bd5c5c5ebabcb1df4d707e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-19

    Added encoding to UTF based on file extension

M	nsd/adpparse.c

commit aedc61dc21651944274ad6994174445dd9363472
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-19

    Added NsTclAdpPutsObjCmd, NsTclAdpAppendObjCmd, and NsTclAdpCharSetCmd

M	nsd/adpcmds.c

commit 5b4be73c85ae78b7cce1652296a9fb2870fd586b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-19

    Added support for Tcl_Obj based commands

M	nsd/tclcmds.c

commit e16a69b4d2fee8376d17a2e089ae02d6c6271303
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-16

    Added support for reading files in alternate encodings, configured via file extension mappings in the ns/server/<server>/adp/encodings config section

M	nsd/adpeval.c
M	nsd/nsd.h
M	nsd/server.c

commit e619dc7d483fbdb0f63f15319994e392212dacb3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-16

    Added check for null itPtr before deferred cleanup procs

M	nsd/tclinit.c

commit da12e9f875e4ae238edff0a4e07aa873fbdb1b01
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-16

    Fixed no-login crash bug and switched to Tcl_RecordAndEval() for benefit of history mechanism (if enabled)

M	nscp/nscp.c

commit 0efcf3f30a1b0d9c8e00f996e0f88ec80f7e2cdd
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-16

    New ADP parser with registered tag support

M	nsd/adpparse.c
M	nsd/tclset.c

commit e4fa5fbb582e29ba4148a6528fdcb9a34124400d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-16

    ADP functions moved to separate,  more manageable files

D	nsd/adp.c

commit 544befde1bacd6c43b47ed57dc803d1913196ba1
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2001-03-15

    This makefile builds nsd8x.exe

A	win32/main/Makefile

commit dbebee676b2b9bc67436624691f3476dd5e3664b
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2001-03-15

    typedef __int64 INT64 for Win32

M	ChangeLog
M	include/ns.h

commit 9ef083c5f4f3d101c574814c6d614e8d98df3675
Author: Dossy Shiobara <dossy@panoptic.com>
Date:   2001-03-15

    Initial attempts at Makefiles suitable for NMAKE for building on Win32

M	ChangeLog
A	include/Makefile.win32
A	win32/nscgi/Makefile
A	win32/nscp/Makefile
A	win32/nsd/Makefile
A	win32/nslog/Makefile
A	win32/nsperm/Makefile
A	win32/nssock/Makefile
A	win32/nstcl/Makefile
A	win32/nsthread/Makefile

commit b6ac5c274304e5adcf7cb775415e245676d54ae6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Fixed master lock typos

M	thread/tcl8x.c

commit ea08ad6080690ce86ef592fc556d63146f0755cc
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Fixed bug with DB pool stale handle checking scheduled procs

M	nsd/dbinit.c
M	nsd/nsd.h
M	nsd/proc.c

commit 6a40ac4c1c80df4a81ef822593b3000cc2895be5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Switched DNS to # of entries based cache purging instead of time based

M	nsd/dns.c
M	nsd/nsconf.c

commit 3c8bfebbfb0f0fde403a837f6aa9f064ade9082c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Updated comments to reflect better handing of Tcl thread data blocks

M	thread/tcl8x.c

commit 15370d87c9e56f35bf973199408b11ac78d5af31
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    NT compile bug fixed

M	thread/tcl8x.c

commit bdede18b10d21a38be1ae5fe2f1ce11a3aaa182a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Remove unref'ed variable

M	nsd/tclsock.c

commit 183223db7fe08623c73aeba0c5aef27d0eba6575
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Memory leak fix for TLS bug #406708

M	thread/tcl8x.c

commit 779f4d57354d52e5f1b414278eaf4920ada73f82
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Fixed potential memory overwrite with long auth headers

M	nsd/queue.c

commit 446d028b7e38181e9ef2cfd258e9562ce2f0fa93
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Fixed memory leak with ns_db sp_getparams

M	nsd/dbtcl.c

commit 264abacc19e9d84e38b9245d2eefeaecf5567cd9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Cleaned up some elements of the NsInterp struct

M	nsd/dbtcl.c
M	nsd/nsd.h
M	nsd/server.c
M	nsd/tclinit.c
M	nsd/tclset.c

commit d4f6a570d2d61cb4b2894027d93f0e758a21e6f1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Added ns_chan cleanup call in ns_cleanup

M	nsd/init.tcl

commit 1533d7dbd79ef3caa5f0961de16fed56cbff5e86
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Remove ns_attach/ns_detach commands in favor of single ns_chan

M	nsd/tclcmds.c
M	nsd/tclfile.c

commit d00f4f70faa2f64b7a978dd1da45ee6eced6a3ed
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-14

    Attempt to use Tcl_Register/UnregisterChannel's instead of brute force ns_sockdup's

M	nsd/tclsock.c

commit 70cbf2fad9c20896f3925d434893c3da4c27d0d9
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-13

    Fixed stupid bug of not set initialized to 1

M	thread/reentrant.c

commit 733a8498bc67f935f09304be941f5b182d1ca4b8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-13

    Fixed silly bug in new "ns_set array" command

M	nsd/tclset.c

commit 2eafade26c32dfd08d217a6bdda6dbadfa588934
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-13

    Fixed silly ns_conn headers and ns_conn outputheaders bug

M	nsd/conn.c

commit 0a8da57bc800860314a47693f61cbcdcf18caf72
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-13

    Added the ns_job background script system

M	nsd/Makefile
M	nsd/nsd.h
M	nsd/server.c
M	nsd/tclcmds.c
A	nsd/tcljob.c
M	win32/nsd/nsd.dsp

commit 1a38d7cac836784bdc26de280e899972f9969817
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-13

    Added the ns_detach and ns_attach commands

M	nsd/tclfile.c

commit 5d07bafe0143878e41033322ed7a224c6111b570
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-13

    Updated missing ChangeLog entry for 4.0

M	ChangeLog
M	README

commit e84f04f7cdb30c6b62a97133edc3019034caff4f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-13

    Removed various assert()'s because, better or worse, we're not asserting things elsewhere

M	nsd/dbutil.c
M	nsd/lisp.c
M	nsd/mimetypes.c
M	nsd/url.c
M	nsd/urlspace.c

commit bcdf0a5e8c2c26d263a0f05802c593fc428da9c2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-13

    Added connection local storage (Ns_Cls) API much like thread local storage

M	include/ns.h
M	nsd/Makefile
A	nsd/cls.c
M	nsd/nsd.h
M	nsd/queue.c

commit 6851f111828abd76664335f1d3b9a29b49666c46
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2001-03-13

    Fix segfault when using -g <group> flag

M	ChangeLog
M	nsd/nsmain.c

commit fae9c0a9e8998a5b041df7b8f5c82d1e54bfba24
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Minor edits to fix compile probs

M	nsd/Makefile
M	nsperm/nsperm.c

commit 6b0866f8b18eb29597aab3e823452dd0f4517f23
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Removed Tcl 7.6

M	Makefile

commit 43886a095c1c0bd74ff1b16520091fdfa46bd038
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Functionality moved to nsd/init.tcl

D	tcl/namespace.tcl

commit dc014e94638f49dc701aad1065dc2c49188cd2aa
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    More new code for 4.0

A	tcl/adp.tcl
A	tcl/compat.tcl

commit 4c4b40393d926481c3eb70089b6b4003faf9aa70
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Updated to first 4.0 release

M	nsd/Makefile
A	nsd/adpcmds.c
A	nsd/adpeval.c
R079	nsd/adpfancy.c	nsd/adpparse.c
A	nsd/adprequest.c
M	nsd/auth.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/dbdrv.c
M	nsd/dbinit.c
M	nsd/dbtcl.c
R083	nsd/drv.c	nsd/driver.c
M	nsd/dstring.c
M	nsd/fastpath.c
M	nsd/filter.c
D	nsd/id.c
A	nsd/info.c
A	nsd/init.tcl
M	nsd/keepalive.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/op.c
M	nsd/pidfile.c
M	nsd/proc.c
R052	nsd/serv.c	nsd/queue.c
M	nsd/random.c
M	nsd/return.c
A	nsd/server.c
M	nsd/str.c
M	nsd/tclcmds.c
M	nsd/tclconf.c
M	nsd/tclfile.c
M	nsd/tclinit.c
D	nsd/tclinvoke.cpp
M	nsd/tclmisc.c
M	nsd/tclop.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclset.c
R084	nsd/tclnsshare.cpp	nsd/tclshare.c
M	nsd/tclsock.c
D	nsd/tclstats.c
D	nsd/tclstub76.c
D	nsd/tclstub8x.c
D	nsd/tclstubs.cpp
M	nsd/tclthread.c
M	nsd/tclvar.c
A	nsd/tls.c
M	nsd/unix.c
M	nsd/urlopen.c
M	nsd/urlspace.c
R098	nsd/nswin32.c	nsd/win32.c

commit 49af32d974f3c62828381e723d357cad4d99c4ca
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Import Tcl 8.3 source code

M	include/Makefile.global
M	include/ns.h
M	include/tcl.h
D	include/tcl76.h
D	include/tcl83.h

commit 6dbb795fe15eb880459dc4f7035713f4ae9d27b4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Win32 build: updated CFLAGS to include TCL_THREADS=1 everywhere

M	win32/cgitest/cgitest.dsp
M	win32/main/main.dsp
M	win32/nscgi/nscgi.dsp
M	win32/nscp/nscp.dsp
M	win32/nsd/nsd.dsp
M	win32/nslog/nslog.dsp
M	win32/nsodbc/nsodbc.dsp
M	win32/nsperm/nsperm.dsp
M	win32/nssock/nssock.dsp
M	win32/nsssl/nsssl.dsp
M	win32/nstcl/nstcl.dsp
M	win32/nsthread/nsthread.dsp
M	win32/threadtest/threadtest.dsp

commit 407753f7f8ec3df884407925a966e7f00b78378c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Made nsperm virtual server safe and generally simplified the code
    
    Use a reader/writer lock to avoid the skiplocks stuff and better
    reusing code.  However, the logic is likely broken now - needs to
    be checked.

M	nsperm/nsperm.c

commit dd85b55535e99004ab75f4d2f9cfce85b430940f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Made nscp virtual-server safe and no option for Ns_AuthorizeUser API which was removed in 4.0

M	nscp/nscp.c

commit f4a9fc4585ae625443d6b76ad88bca844ccb9047
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Made nscgi virtual-server safe

M	nscgi/nscgi.c

commit aa680164e26a5363619bd9928a704fe5e153b696
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Added rule (commented out) to build nsthread as shared library

M	thread/Makefile

commit bd8870bef12b607891fd4523bb3b6aa8b239b790
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Minor updates, assumes no more Tcl 7.6

M	thread/tcl8x.c

commit 9942767f4a1b9ee0d483e609f1873d544a8f23da
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Minor comment update

M	thread/tls.c

commit 4909ea7339a2a017153f8a0fce3b8226281417d4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Added more detail on fatal aborts

M	thread/pool.c

commit 9b6a70122e82949703a13ce061c13d04eaa808b2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-12

    Added "volatile" to one-time inits

M	thread/pthread.cpp
M	thread/reentrant.c

commit c6568f661e90ea455b644b7e270017ee6e9489ea
Author: Kriston Rehberg <kriston@aol.com>
Date:   2001-03-08

    Mention OpenNSD.org in docs

M	doc/default-home.html

commit 231b3f66036b534e20421427a6a13f6969a9f6e4
Author: Kriston Rehberg <kriston@aol.com>
Date:   2001-03-08

    Add missing ChangeLog entries

M	.hgtags
M	ChangeLog

commit 00c4a7a53f13bcd677582cdd7a4c9536d437822a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-03-08

    Added NsTclFinalizeThread() at end of Tcl TLS cleanup to finalize Tcl 8.x thread data

M	nsd/tclinit.c
M	nsd/tclstubs.cpp

commit d70911d4ae95a2f5e9b13ca9edba1d721ad5011c
Author: Kriston Rehberg <kriston@aol.com>
Date:   2001-01-31

    nsunix, nsvhr, and nsodbc moved to the Module Collection

M	ChangeLog
M	Makefile

commit e5da39102860ce356a56af0e9a10da83826abe2c
Author: Kriston Rehberg <kriston@aol.com>
Date:   2001-01-31

    Add missing ChangeLog entry

M	ChangeLog

commit bac75e260090e761cf552fcbbfb083bf3265782c
Author: Kriston Rehberg <kriston@aol.com>
Date:   2001-01-30

    Don't build with optimization for default install

M	include/Makefile.global

commit 1026ec4ad69e0fbb7a853faf39bfdc9436c1eda3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-18

    Win32: updated post-build copies to use .dll instead of .so

M	win32/main/main.dsp

commit ff2b70942b1cf6f205644e449dfac32e0769fd1d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-16

    Got rid of two more needless accesses of the nsServer global

M	nsd/tclmisc.c
M	nsd/urlopen.c

commit 6a2482d52b55f4b2feb23858507aa304a38945de
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-16

    Simplified signal trigger read by skipping the select

M	nsd/unix.c

commit a009e01726cb53a7fa99065c9f0b7d88095f5583
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-16

    Moved more commands to generic list

M	nsd/tclcmds.c

commit 61dbe1cf3b2b40ae9cee9abfa127d70fd2bdc8e7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-16

    Removed nsconf.nseval flag, ns_eval now always enabled

M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/tclinit.c

commit 4f76d9e93a95400877fbc260f960790a8b2a3b34
Author: Kriston Rehberg <kriston@aol.com>
Date:   2001-01-16

    Build nsunix and nsvhr again

M	Makefile

commit 82e6342f43a5ecf744bc1174b0933877b02d1049
Author: Kriston Rehberg <kriston@aol.com>
Date:   2001-01-16

    Add missing ChangeLog entry for nsServer cleanup

M	ChangeLog

commit f25b3e712acf836142a8877660f2805255587e1e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-16

    Removed some unused #define's

M	nsd/fastpath.c

commit 228bffadf6353ed018e4b379189fc601b05a5167
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-16

    Cleaned up sloppy use of the nsServer global

M	nsd/adp.c
M	nsd/adpfancy.c
M	nsd/conn.c
M	nsd/dbdrv.c
M	nsd/dbinit.c
M	nsd/drv.c
M	nsd/fastpath.c
M	nsd/filter.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/pidfile.c
M	nsd/return.c
M	nsd/serv.c
M	nsd/urlspace.c

commit d927aa8dfa29cd050995fe74f0c152bcc06408ba
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-16

    Switched to trigger-pipe based wakeup for signals

M	nsd/unix.c

commit 4f31746db5caf5846faa06b81faf59cc4b67b519
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-16

    Better isolated weird internal Tcl per-thread structures

M	nsd/dbtcl.c
M	nsd/nsd.h
M	nsd/tclinit.c
M	nsd/tclop.c
M	nsd/tclset.c

commit 4ef0acc420a60230b3ec67fc4dbb7ab8df3e034c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-15

    Cleaned up most of the remaining old function names
    
    (e.g., Ns_HeadersRequired -> Ns_ConnSetRequiredHeaders).

M	nsd/auth.c
M	nsd/conn.c
M	nsd/fastpath.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/request.c
M	nsd/return.c
M	nsd/serv.c
M	nsd/tclmisc.c
M	nsd/tclop.c
M	nsd/tclresp.c
M	nsd/urlencode.c
M	nsd/urlopen.c

commit d42261dc88180be4805ecfd24f529ccb39ed4311
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-12

    Added NsTclCreateGenericCmds, NsEnableDNSCache, and NsCacheKeysCmd
    
    Removed some simple init procs no longer required.

M	nsd/nsd.h

commit 77721089c4cddf2b520c0ca70e148c5b21d18ce6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-12

    Modified to call NsEnabledDNSCache if necessary

M	nsd/nsconf.c

commit 93a8203566b29566655729c1d1269298f3cefca0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-12

    Made the callback info and nsv interfaces more self initializing and removed needless init in urlopen.c

M	nsd/nsmain.c
M	nsd/proc.c
M	nsd/tclvar.c
M	nsd/urlopen.c

commit c4c7150a8e97cda93d711095674153a369d12540
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-12

    Move Ns_ConnReturnFile to fastpath.c so it can use same file cache as the FastGet request procedure
    
    This should provide benefits to users of the ns_returnfile Tcl command.

M	nsd/fastpath.c
M	nsd/return.c

commit 3c7cf97adfd8673b777208762355b0146ab55280
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-12

    Modified so DNS works fine before caching is configured and enabled
    
    This should be useful to the config interp.

M	nsd/dns.c

commit ae0834cc2a4e147d7e5a014f478eb65fa2f46e7f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-12

    Now creates the "generic" commands in tclcmds.c in the config interp

M	nsd/config.c

commit cd31d53e14b5750fc74f2a8263cfaa4ea4c78e5d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-12

    Split commands into "generic" and "server" lists.
    
    Added ns_cache_keys command and separated commands between "generic"
    and "server" lists.  Commands which require the context of a web server
    (e.g., ns_returnfile) are server, all others (e.g., ns_mkdir) are generic
    and now available to the config interp.

M	nsd/tclcmds.c

commit 969cd6e3c559adeee396a2257f43e5ebb3a81455
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-12

    Fix cache locking; extend ns_cache_flush; add new ns_cache_keys
    
    Ns_CreateCache: bug fix
      Added lock protection around cachesTable.
    
    Ns_CacheMalloc/Ns_CacheFree: modified
      Although of dubious value, uses (once again) the Ns_Pool API.
    
    ns_cache_flush: modified command
      - no args means flush full cache
      - with arg, cache must use string keys, returns 1/0 if flushed.
    
    ns_cache_keys: new command
      Returns keys in cache, perhaps matching pattern. Non-string keys
      are converted to nn.nn.nn unsigned int format for output.

M	nsd/cache.c

commit 0fe0d7f61635c8c9bea1fef0deae3055859aff46
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-10

    Added NO_VSNPRINTF for Ns_DStringPrintf, set on SGI for now

M	include/Makefile.global
M	nsd/dstring.c

commit 7a82b2853f5f787e0d2afc232b6ee586e6ca3814
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-10

    Added Ns_PoolBlockSize to return requested and used block size of a zippy allocated block
    
    Useful to sum up real memory usage.

M	thread/pool.c

commit 41753708c87f47154d134292d78d8e0a4685da5a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2001-01-10

    Added new, custom per-thread Tcl_Obj allocator

M	thread/tcl8x.c

commit 3ea0cc7ec8b5c7982034ed56d7b93c23f090ffc5
Author: Kriston Rehberg <kriston@aol.com>
Date:   2001-01-04

    ns_striphtml crashing-bug in nsd8x fixed

M	ChangeLog
M	nsd/tclmisc.c

commit 3bbe079d3460fa8657266f3dd33a34ecd969f833
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-12-19

    Updated mutex names

M	nscgi/nscgi.c
M	nsd/log.c
M	nsd/nswin32.c

commit 6a1fc226cc739473bbea1f9fb5787ccb841fd205
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-12-18

    For Ns_DStringPrintf, added _vsnprintf macro for Win32 and made the buffer size 2048, defined by NS_DSTRING_PRINTF_MAX

M	include/ns.h
M	nsd/dstring.c
M	nsd/nsd.h

commit ff9f5dbdd3e3e1aaa064df5c62f80e5cb229cd9f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-12-17

    Silenced a few compile warnings

M	nssock/sock.cpp

commit e84c2a6acea161ad280890a607c23d5aae2c9840
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-12-17

    Fixed some win32 code comment errors

M	thread/win32.cpp

commit dc5d5fd95164a409d7bd4517202621d043064c89
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-12-14

    Fix bugs #12765 (vsnprintf in Ns_DStringPrintf), #12764 (If-Modified-Since works w/keep-alive)
    
    Corrected typo _ns_ns_http_readable.

M	ChangeLog
M	nsd/dstring.c
M	nsd/nsd.h
M	nsd/return.c
M	tcl/http.tcl

commit bd33c15bfe8f3794e47c3569461bff33718eea02
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-12-13

    Build with architecture-specific optimizations; auto-detect arch for most platforms; auto-select compiler and Purify usage from command

M	ChangeLog
M	Makefile
M	include/Makefile.global

commit d8a6069711a54cca62c5944c49d442665c9443aa
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-12-13

    Makefile now installs correctly; tuning parameters added to sample config

M	ChangeLog
M	nsd/Makefile
M	nsd/sample-config.tcl
M	nssock/Makefile.ssl

commit 8a0ac8735ff146196e37902ca44601913cec5d5f
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-12-12

    Twiddled irix build rule

M	include/Makefile.global

commit 632f43d6ba53eccb93fe9aec3561ee6b9ce46e2a
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-12-12

    Quieten some compiler warnings

M	ChangeLog
M	nscp/nscp.c
M	nslog/nslog.c

commit e1dbab146c59e9e01cd755fd4ac526f2f51f5b81
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-12-12

    Fix some compile warning in SSL code and add missing return statements

M	nssock/ssl.c
M	nssock/ssltcl.c

commit e3ddeb264d17282bc2c2349217c7db72e3fb34f2
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-12-12

    Solaris build fix

M	include/Makefile.global

commit b2cfd0abd88eb910a50206cbab9e5ef37ad90be7
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-12-12

    Add latest missing ChangeLog entries

M	ChangeLog

commit 4f25a27b82ae1f8431e9fc596369749e18c5c9b1
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-12-12

    Config options cleaned up; usage message less glib
    
    SUNWspro dumped core on usage message due to nsconf.argv0
    quigglyness.

M	ChangeLog
M	include/Makefile.global
M	nsd/nsconf.h
M	nsd/nsmain.c

commit ff42c3fdf8034ff1bdfcb7a14191e9cf34c33da0
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-12-12

    Added Rainbow CryptoSwift support

M	nssock/Makefile.ssl
M	nssock/sock.cpp
M	nssock/ssl.c
M	nssock/ssl.h

commit e3aa4a356dc597f78812ec4a8c26eab83e93ebed
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-12-12

    Add support for leak checking with purify

M	include/Makefile.global
M	nsd/nsd.h

commit 9dd07520e7ece79e823db88be2e5f2a3571c8673
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-17

    Added Ns_PoolEnum to get at pool stats as with mutexes and threads, removing the old Ns_PoolStats API's and updating the "ns_info pools" command

M	include/nsthread.h
M	nsd/tclmisc.c
M	thread/pool.c
M	thread/test.c

commit 9e73a48d905792180971daabf3578a8daec46a47
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-17

    Ensured the conn thread name was set first

M	nsd/serv.c

commit 3d69289ed9db0eb5681012b3d19febbe6f052711
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-17

    Fixed multiple-load problems; added sndbuf, rcvbuf, sendwait, and recvwait options

M	nssock/sock.cpp

commit 28e7cf38f75237afc7cadd46a958a55904460cb2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-16

    Cleaned up code a bit to quiet compiler

M	thread/test.c

commit 27a62288ba41905f7d75951e660fba20c2ea6460
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-15

    Disable win32 final thread cleanup to prevent invoking code in unloaded libs
    
    Moved WinThread allocation to DllMain, eliminating GetWinThread function.
    Also, disabled thread cleanup for final thread to avoid any TLS
    cleanup callbacks attempting to invoke code in unloaded libraries like Tcl.

M	thread/win32.cpp

commit 3394a6be09a8e015dd58da165c18b6decdf46de6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-15

    Added Tcl_JoinThread for benefit of Tcl8.4

M	thread/tcl8x.c

commit fcb07e4a439b3e939c21b65264011073a34164f1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-14

    Changed thread enum to return Ns_Thread, not Ns_Thread pointer which didn't make much sense
    
    Updated "ns_info pools" command to reflect change.

M	include/nsthread.h
M	nsd/tclmisc.c
M	thread/test.c
M	thread/thread.c

commit 133ca4c01eecc3820d376838d970c5519a645008
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-13

    Remove unused vars

M	nsd/dstring.c

commit 24afa957a48b5075a2fea22642687f4a48611de7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-13

    Added more info for "ns_info pools"

M	nsd/tclmisc.c

commit b60ad3825641b53191ac554ef808e0b4be5dfcdb
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-10

    Fixed pool counters (must be signed, pools can consume memory) and added the nsMemNumBuckets exported variable to config pools

M	include/nsthread.h

commit 4438fcb1b315e5efea4aff7d7b08c78763346bcb
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-10

    Fixed bugs with Ns_ThreadEnum and pool counters

M	thread/pool.c
M	thread/thread.c

commit 7457b828fde157ef92fd709675aa465623f294fe
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-09

    Added nsd.h and nsconf.h dependencies

M	nsd/Makefile

commit 95372e8298b969c0df4d0e4a4247243ce49d1a1f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-09

    Changed SETOBJ macro to SetObj function which no longer sprintf's directly into interp->result

M	nsd/tclthread.c

commit d56fa87e7d46ca7f879e930f31d55fafd9dbc988
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-09

    Added "ns_info pools" command to dump memory pool stats

M	nsd/tclmisc.c

commit 3783d6ed58dfdc0c25040430d36993b361ad08a4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-09

    Added nsconf.quiet and nsconf.startuptimeout

M	nsd/nsconf.c
M	nsd/nsconf.h
M	nsd/nsd.h
M	nsd/tclinit.c

commit ca1900de78c1de9c38ffc35090da5f3a7e984a8e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-09

    Added code to wait for conn thread, sock callback, and sched idle at startup to help alleviate code start problems

M	nsd/nsmain.c
M	nsd/sched.c
M	nsd/serv.c
M	nsd/sockcallback.c

commit 286a85c9066b8ff6172d28033d8254be24838683
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-09

    Uses ns_realloc to grow strings and maintains dstring stack in the staticSpace instead of the *addr pointer for compatibility with Tcl dstrings

M	nsd/dstring.c

commit 35292d5542eb7cd4d622d3dbbf5696a24386a1ed
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-09

    Added Ns_PoolInfo struct

M	include/nsthread.h

commit 1e4f38c511fde28991b9be433ce783a09c7b2f99
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-09

    Update of the Ns_Pool API to support more stats gathering available via new Ns_PoolStats API

M	thread/pool.c
M	thread/test.c
M	thread/thread.c

commit 43e552e08662c5636ad537630f138fc0c9d17325
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-09

    Changed NsLock API's to return 1/0 instead of NS_OK/NS_TIMEOUT and more use of Ns_MasterLock to keep things simple

M	thread/mutex.c
M	thread/pthread.cpp
M	thread/sproc.cpp
M	thread/tls.c
M	thread/win32.cpp

commit 4dc370aa2795288a45895e0b2f1343b283c38c85
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-06

    Added Ns_PoolStats, nsMemPools

M	include/nsthread.h

commit 6aefc6a4c448efff7799c191299180ae24b451da
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-06

    Fixed flags for SGI pthread build

M	include/Makefile.global

commit 2a300c3c3c272cf8c923298b06c6bc1a84365281
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-06

    Added configurable backlog via Ns_SockListenEx

M	include/ns.h
M	nsd/binder.c
M	nsd/nswin32.c
M	nsd/sock.c
M	nssock/sock.cpp

commit 33d5407216db53d7f1bdef3c0032eacddc83a31f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-06

    Removed master.c and oldpools.c

M	win32/nsthread/nsthread.dsp

commit 1f3c7a917557e00d553748b36f1fd8b184789505
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-06

    Removed call to NsInitThread no longer needed

M	thread/win32.cpp

commit 0c8dda582a489cbfbac323882d787d4984cf02b1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-06

    Remove Thread->etime and NsPool API's

M	thread/thread.c
M	thread/thread.h

commit bf39902ecb112c382d933c1d5ec2bfaf7ea19bf6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-06

    Restructured the thread interfaces, moving the master lock to the platform interface code, integrating the zippy allocator with Ns_Pool/Ns_ThreadAlloc and use of a new simple direct allocator for all thread objects

M	include/nsthread.h
M	thread/Makefile
M	thread/cs.c
D	thread/master.c
M	thread/memory.c
M	thread/mutex.c
D	thread/oldpools.c
M	thread/pool.c
M	thread/pthread.cpp
M	thread/reentrant.c
M	thread/rwlock.c
M	thread/sema.c
M	thread/sproc.cpp
M	thread/tcl8x.c
M	thread/thread.c
M	thread/thread.h
M	thread/win32.cpp

commit 1009f5dabc5489786dc941d09bfb713a9326b18c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-03

    Fixed compile bugs for ssl

M	nssock/sock.cpp

commit 61287af09dabb04c176a420d7b382ba8fd6223a5
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-03

    Restructured socket module to wait in server busy situations instead of sending server busy message
    
    Also, moved the graceful close burden to the SockThread from
    the connection thread.

M	nssock/sock.cpp

commit 1c95569785446f5626b574e6173ad972496101c4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-11-03

    Added Ns_RegisterAtReady callbacks for indicating server no longer busy

M	include/ns.h
M	nsd/callbacks.c
M	nsd/nsd.h
M	nsd/serv.c

commit 15b6e54fc3a1cb8b65355dd31e7f72dda837c8ad
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-23

    Removed <mutex.h> for sgi which shouldn't have been there

M	thread/pool.c

commit 138462d92330cb0daeebfd8ecee43397a9a8386d
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-23

    Upped version to 3.3pre

M	nsd/nsd.h

commit 54beec30aeb65b2ee6ad67883e664fa19526a8d6
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-23

    Removed the sbrk() code for now, was crashing SGI (probably not thread safe)

M	thread/pool.c

commit 17e454dd0b87531bfc486e756b49e86cc4780403
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-23

    Use sbrk() on Unix instead of malloc to avoid any malloc overhead or contention

M	thread/pool.c

commit b6fecc95ceb8788198e314c50791b13eb9ea986f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-23

    Switched to rolling condition broadcast wakeup as in the sproc code

M	thread/win32.cpp

commit 0419efad6de11895f77e1adb1a84cbbc5b0c3e47
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-23

    Fixed some comment bugs, update thrPtr->tid after fork

M	thread/sproc.cpp

commit d877b708f83c287f59f4a16efce9bef1225735cf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-22

    Moved sprintf of default thread name from NsThreadMain to NsInitThread under protection of threads lock

M	thread/thread.c

commit f18d4592a7ffd2281338c7919648468a17a1990b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-22

    Switched order for LIBS and LIBNSTHREADS for test program

M	thread/Makefile

commit e477290f30328648ab95b745799a4b9f257a33d8
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-22

    Shuffled initialization to ensure command line args are read before calling any Ns API's, ensuring zippy malloc can be set if needed

M	nsd/nsmain.c

commit 146adfe180a7bb897aa0d50308cb798c8239668b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-22

    Better test for PTHREAD_TEST

M	thread/test.c

commit e2570bd501c3f36db3e54fce12eb95cbc648151c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-22

    Fixed undefined var bug for sproc

M	thread/test.c

commit d65e933ced97f30688b9c5ae1b1c9f3e6282c393
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-22

    Added some comments, a native pthread test, and a recursive stack checker

M	thread/test.c

commit 8e3657eeae606537d894389924f0c2598c33e4e0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-22

    Added code comment for NsInitThread

M	thread/thread.c

commit 708bc87547805de5e00b39ed0baaab595f9b2496
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-22

    Reduced the zippy allocator page size to 16k from 64k

M	thread/pool.c
M	thread/thread.h

commit 89256c595fbbd3687a1b2ffacf8ab51823ee8e17
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-22

    Fixed bug of not setting the tid correctly

M	thread/pthread.cpp

commit dad63a21e5500755a7d81f18763fa65e4b22a8da
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-20

    Added call the NsInitThread

M	thread/pthread.cpp
M	thread/sproc.cpp

commit 6975c26f63813ca34b130a9a7f24eb011f1c7001
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-20

    More fixes for new Thread context model

M	thread/thread.c
M	thread/thread.h
M	thread/win32.cpp

commit 5d5dd2e9588b2bfd05143559863f34dd735e54c7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-20

    Updated sproc.cpp code for new Thread management and removed the wait for thread startup which shouldn't be needed

M	thread/sproc.cpp
M	thread/thread.c

commit 42cdf11c2cf2d5cf6373f7831762a07019970276
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-20

    Added Ns_ThreadMemStats() to dump zippy malloc stats to open file

M	include/nsthread.h

commit dc48fe2f44c5822bb92f60b4bf296c7ae596082b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-20

    Switched to -lthread from -lpthread on Solaris for benefit of in-process JVM's

M	include/Makefile.global

commit 17e96168827dba8deb4efc053728b4e6d7bfece0
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-20

    Re-structured management of the Thread context to better support threads created without Ns_ThreadCreate (e.g., Java VM threads)

M	thread/Makefile
M	thread/pool.c
M	thread/pthread.cpp
M	thread/reentrant.c
M	thread/sproc.cpp
M	thread/test.c
M	thread/thread.c
M	thread/thread.h

commit 59b584e78725e9bb59ea32149543f085e0e901a1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-20

    Made ns_eval command disabled by default to avoid using SIGUSR2

M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/tclinit.c
M	nsd/unix.c

commit 68894204541cfafc07afe39304eedb46b2b871c2
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-20

    AOLserver 3.2 Released

M	.hgtags
M	ChangeLog

commit 1032a11d443e1551d0b724870f3c2fdd710dd3f2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-19

    Fixed service install code to allow long pathnames with spaces

M	nsd/nswin32.c

commit ab710286e3f350ca157ba3aa16504f7ff02e4dec
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-18

    Fixed win32 sleep() macro to multiply by 1000 instead of 100 (oops!)

M	include/nsthread.h

commit b0c88598f8dede6e32b9def09bda5c4ee719da5a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-18

    Overhauled the mutex and condition wakeup code to use the single event in the WinThread structure and switched to spinlocks for the Cond structure

M	thread/win32.cpp

commit 886d549aba71f5035c68337db88282f48ca641bf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-18

    Fixed bug in not converting from milliseconds to microseconds on Win32

M	thread/time.c

commit d492b144fb784f3be6e4a711d865751411cdeeea
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-18

    Add extra padding to hard-coded Server Busy message to defeat MSIE friendly error messages

M	ChangeLog
M	nssock/sock.cpp

commit dc525bc260e1c50cf14614c82db73bdc69691290
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    Ns_InfoTag and ns_info tag added (uses CVS Name); reported in help message

M	include/ns.h
M	index.html
M	nscp/nscp.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/tclmisc.c

commit 3f5adaf2f3996a9af03ab79aeb659ad6ae7f60b5
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    All configuration option defaults have been moved to nsconf.h as #defines
    
    also fixed a typo in nsmain.c's help message

M	ChangeLog
M	nsd/nsconf.c
A	nsd/nsconf.h
M	nsd/nsd.h
M	nsd/nsmain.c

commit 1147b7c5bb190bd4954607303526f101ab4af981
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    Tcl library for nsd8x is now installed into $(PREFIX)/lib/tcl8.3

M	ChangeLog
M	Makefile

commit 16deafc9e321607e8672bb831aa4d9961de18c22
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    (ns_httpopen): Host:port is now sent to remote host if != 80
    
    Suggested by Jerry Asher.

M	ChangeLog
M	nsd/nsd.h
M	tcl/http.tcl

commit 4c4706c5abfe1d4ee2b4544bd9bf187631359c32
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    (_ns_dirlist): Qute links to handle Win32 pathnames with spaces
    
    Thanks to Eric Klein.

M	tcl/fastpath.tcl

commit 281da3c2d05022121b098db7bb5c4b2f8e5514b0
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    (Ns_ConnReturnNotice): New options "errorminsize" to pad error messages to defeat MSIE friendly errors and "noticedetail" to return more detailed information on notice pages
    
    Fix suggested by ArsDigita.

M	nsd/nsconf.c
M	nsd/return.c

commit ff0efee5ffc8ee558edb9476e5d53271b3df407e
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    Input string to mktemp is copied, because mktemp edits the string in-place and that's generally a bad thing to do with argv's
    
    Contributed by ArsDigita.

M	ChangeLog
M	nsd/tclfile.c

commit 9c77418903e9194743898e9b77a717f9716eda34
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    New SuppressQuery and LogExtendedHeaders logging options
    
    LogExtendedHEaders option contributed by ArsDigita.

M	nslog/nslog.c

commit 5935e66d323474a5f539b4c72e7b2e08aec706f4
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    (ShareTraceProc): Fix race conditions if the shared value is a list
    
    Contributed by ArsDigita.

M	nsd/tclnsshare.cpp

commit f85782ecfb5e8a860255dfadef0f140823e506a5
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    CRLF now returned in ns_httpopen
    
    Contributed by ArsDigita.

M	ChangeLog
M	tcl/http.tcl

commit c359b6e3928fde29fcae69aa95ae8a265283dd7a
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    Nonsense case of lsorting a list with length <= 0 caused a memory leak

M	ChangeLog

commit 7eb66bfb64130868b54aae320e09689b5627e196
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    We now use the Arsdigita version of adpfancy

M	ChangeLog
M	nsd/adp.c
M	nsd/adpfancy.c

commit c33d5b05e31378b96b942f9d0187a6ee9879bced
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-17

    Initialize errorCode and errorInfo like tclsh does
    
    Patch from ArsDigita.

M	ChangeLog
M	tcl/init.tcl

commit c18383ab8c55870ad490d0d3b7f1dbda922275ad
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-16

    New nsv_names Tcl command lists names of nsv's in memory

M	nsd/nsd.h
M	nsd/tclcmds.c
M	nsd/tclvar.c

commit f1af66f4de5435ffb5ff031ffac66db40daf9739
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-16

    Fix build rules for libtcl76, libtcl8x, and libnsthread

M	nsd/Makefile

commit 3c8338e7c1964ac06838e8caaa6a12a4542dc3f7
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-16

    (Ns_Main): Took out little note about -k|-K being deprecated

M	ChangeLog
M	nsd/nsmain.c

commit ef486661c2dbf7fd6e5f3745daa9264ab8e2ea6d
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-16

    (Ns_Main): Had to move Ns_ThreadSetName below the stdin/stdout/stderr reassignment
    
    Fixes a fd problem with running nsd on Irix in "installed"
    or "daemon" mode that would prevent the server from starting up.
    
    Sigh.

M	ChangeLog
M	nsd/nsmain.c

commit 44da3f777cae026ca775fcb0d89976056c65b88b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-16

    Added a yield at end of Ns_QueueConn

M	nsd/serv.c

commit db3e1461c9a13a5d35fb6706332af00dfa0307f8
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-14

    (Ns_Main): gid of the specified user is set even if it's not specified
    
    (UsageError): -K and -k give a "deprecated" warning.
    (Ns_Main): -f gives a "deprecated" warning.
    
    (PreBind): Didn't really tell us if it was successful at
    pre-binding.  Helpful to know if you're wondering what
    happened to that port you wanted to pre-bind.
    
    (Binder): backlog variables (2) initialized to nsconf.backlog.

M	ChangeLog
M	nsd/binder.c
M	nsd/nsmain.c

commit c339bffbd81fc2533c8f72e3d8f34cd93b5a000a
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-13

    Made an attempt at standardizing the error codes and error page content

M	ChangeLog
M	nsd/return.c
M	nssock/sock.cpp

commit 7ed498ca6d9af66d83c7521e169a90b44bd513dd
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-13

    Add latest missing ChangeLog entries

M	ChangeLog

commit ad71826ca3485b3a000630939b313d7f1707e504
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Added/use ns_pipe which set's close-on-exec like ns_sockpair

M	include/ns.h
M	nscgi/nscgi.c
M	nsd/exec.c
M	nsd/nswin32.c
M	nsd/unix.c

commit 51035ccdf687fb2eb4423bc0e66e7c273da2b365
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Added lock for ns_stats command

M	nsd/tclstats.c

commit 9f727ead50e98c49c94f1f59e8f477947226229f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Fixed memory overwrite bug in stats and increased the default buffer value

M	nsd/nsconf.c
M	nsd/tclstats.c

commit 2b01d0b1482da7498dbde3d1aac3ed0993c862b1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Changed types to unsigned char for no-echo stuff

M	nscp/nscp.c

commit 9d9cc2932d29e4b3032f2c6d8290b419d77cfe29
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Removed nsssl dependency from win32 build

M	win32/aolserver.dsw

commit 8354bf2a6299346800c3b43665dd09dda89f406f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Win32 build updated to use new nssock.c and nsssl.c stubs

M	win32/nssock/nssock.dsp
M	win32/nsssl/nsssl.dsp

commit afc6593790a51eed7a2358ee93257ec9224c990e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Added tclxkeylist.c and stamp.c for win32 build

M	win32/nsd/nsd.dsp

commit c0107cf22aada78e11d268fd399daf5587e70d52
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Remove TclUnsupported0Cmd define

M	nsd/nsd.h

commit dcd54f1eba189531befbacc6b74d9fa09d63f9fd
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Fixed install and clean directives

M	nssock/Makefile
M	nssock/Makefile.ssl

commit 6e85c397876ed24992e8b9372c65d7ff2e1d8165
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Fixed Wakeup() error message and update child's sproc pid after fork

M	thread/sproc.cpp

commit d664666d042b084c070090f51664d5f115cb2fdb
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Switched to ns_fork

M	nsd/exec.c
M	tcl7.6/unix/tclUnixPipe.c

commit dc9eeb5ed5275cf9329201091f283a39eb3271e2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Use of ns_fork and Ns_GetAddrByHost instead of inlined duplicate code

M	nsd/nsmain.c

commit d589e9abaa3a52d4b020c77b63b9fb50949f5115
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Use of ns_fork and added messages for prebind

M	nsd/binder.c

commit de30c93c3fb5226b84955498d25f855de8b6c0fe
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Added back log message when generating seeds

M	nsd/random.c

commit 506d3e7b00fd80f6d64122b01616ce03522fbbc4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-13

    Moved ns_fork to the thread library

M	include/ns.h
M	include/nsthread.h
M	nsd/unix.c
M	thread/Makefile
A	thread/fork.c

commit b7e726012cc2e69340a107c94a7ac0328ac6f396
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-12

    Further simplified the SSL build weirdness

M	Makefile
M	nssock/Makefile

commit 8693a2834c2078fb38fa80ddc2ba1a3d3ed907ac
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-12

    Updated makefiles and added nsssl.c/nssock.c stubs to simplify build

M	nssock/Makefile
A	nssock/Makefile.sock
A	nssock/Makefile.ssl
A	nssock/nssock.c
A	nssock/nsssl.c
R099	nssock/sock.c	nssock/sock.cpp

commit a49df291e0115b81f9a0579914dde9638dec844a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-12

    Added keyed list C API's and used DCI inlined code to avoid changes from 7.6 to 8.x

M	include/ns.h
M	nsd/tclxkeylist.c

commit 3fd67cfd85914d138e9e05bb98f1c45239b1a41e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-12

    Fixed array overwrite with maxkeep=0 bug

M	nsd/keepalive.c

commit 66e31e79ea942d690b229daf374ce78491d3cc39
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-10

    Latest documentation; move to module directories; Tcl changes moved from tcl8.3.2 to doc/tcl-changes.txt

A	doc/faq.html
A	doc/install.html
D	doc/install.txt
D	doc/internals.txt
A	doc/tcl-changes.txt
D	doc/threads.txt
A	doc/tuning.html
M	index.html
A	nscp/nscp.html
R050	doc/nsv.txt	nsd/nsd.html
A	nsext/nsext.html
A	nslog/nslog.html
A	nspd/nspd.html
A	nsperm/nsperm.html
A	nssock/nssock.html
R084	nssock/nsssl.txt	nssock/nsssl.html
A	tcl/tcl.html
A	tests/tests.html
A	thread/thread.html
A	win32/win32.html

commit 0519d290682f4025836327a32295ead44a315098
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-10

    Update version to 3.2

M	nsd/nsd.h

commit 2028aacc2845a7f1a814a10fa8480e8b636bfdbe
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-10

    Module nscp log machine information upon login
    
    (Ns_InfoNameOfExecutable): new function just returns nsconf.nsd
    which is determined elsewhere.
    
    (Login): Tells you lots of harmless info about the machine once
    you log in.  Also, nscp does not run unless configuration is
    explicitly set

M	ChangeLog
M	include/ns.h
M	nscp/nscp.c
M	nsd/nsmain.c

commit 608309fea2148c51708982b0973786cc3191ccc3
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-09

    Add latest missing ChangeLog entries

M	ChangeLog

commit 1a1c1b9ffcb1aec08c1f25e49289a1191c995b19
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-09

    nsd.tcl is now sample-config.tcl; nsssl no longer installs sample key/cert files with dopey names

M	Makefile
R093	nsd/nsd.tcl	nsd/sample-config.tcl
M	nsd/translate-ini
M	nssock/Makefile
R100	nssock/certfile.pem	nssock/certfile-sample.pem
R100	nssock/keyfile.pem	nssock/keyfile-sample.pem

commit 491e0982c86f7b9417163be58624463f26bcba41
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-09

    Add default home page for new installations

A	doc/default-home.html

commit d6ed6279cead788536666e01a7e72341c6f4addc
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-09

    Add translate-ini script to translate from old-style ini files to new-style Tcl script

A	nsd/translate-ini

commit 765b610a1536d0f87a9a527030991e4b4a61f804
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-09

    Moved tests out of their hiding place... too many folks thought they didn't exist
    
    Moved nsd.tcl to nsd/
    Moved license and all docs to doc/
    index.html in this directory is starting point for developer docs
    index.html in doc directory is AOLserver pageroot (not sure where
    it really *should* go)
    
    scripts directory is to be removed

M	ChangeLog
A	README
D	README.txt
R100	LICENSE.txt	doc/license.txt
A	nsd/nsd.tcl
A	tests/README-tests.txt
A	tests/adp/test1.adp
A	tests/adp/test2.adp
A	tests/adp/test3.adp
A	tests/adp/test4.adp
A	tests/adp/test4.inc
A	tests/adp/test5.adp
A	tests/adp/test5a.adp
A	tests/adp/test6.adp
A	tests/adp/test7.adp
A	tests/adp/test7b.adp
A	tests/adp/test7c.adp
A	tests/adp/test8.adp
A	tests/adp/test8a.adp
A	tests/adp/test8b.adp
A	tests/adp/test9.adp
A	tests/adp/test9.inc
A	tests/cdev/test1.adp
A	tests/dbase/test1.adp
A	tests/index.adp
A	tests/nstelemetry.adp
A	tests/sec/test1.adp
A	tests/tcl/test1.tcl
A	tests/tcl/test1a.tcl
A	tests/tcl/test1b.tcl

commit 27e7b4d983a987d446506a825e5d91506167a671
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-09

    Re-added TclX keyl* commands that were in AOLserver 2.x

M	ChangeLog
M	nsd/Makefile
M	nsd/tclcmds.c
A	nsd/tclxkeylist.c

commit 242485a2c486c87da38cbf95442bd3496d34d56c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-07

    Switched to pthread_once to initialize the key initialization lock for benefit of HP10
    
    (This is probably overkill at this stage).

M	thread/pthread.cpp

commit 4e583332ee1d75313cf85b342463a45c2ca34fda
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-07

    Set thread name as first task in Ns_Main() for benefit of pre-bind Ns_Log and other early messages
    
    This generally initializes the thread interface which should be safe
    even if done as root (as opposed to creating threads as root which
    have confused Linux and SGI process-based threads).

M	nsd/binder.c
M	nsd/nsmain.c

commit 9d7cf992fa0286f196c673b26fae12a5f77d481a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-07

    Remove HAVE_BSDSETPGRP flag as we no longer call setpgrp anywhere

M	include/Makefile.global

commit 8155b43a2585fda9258ec60684bc788968bbd1ff
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-07

    Removed setpgrp(), the setsid() should suffice

M	nspd/main.c

commit 00b0c47483c503174138337190e08bb9e044af80
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-07

    Added NsInitBinder and -b and -B flags to allow pre-binding to ports as an alternative to the binder process method
    
    This is presently required for macOS as the binder process method
    won't work and looks like a smarter technique overall.

M	nsd/binder.c
M	nsd/nsd.h
M	nsd/nsmain.c

commit 37f97325a0cadf8280120fd74c4028e8ffe550ae
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-07

    Added nsConfQuiet flag to quiet down the startup messages with the -q flag

M	nsd/nsconf.c
M	nsd/tclinit.c

commit 591fed4298e3f2b778326d2b06c4e9fb5ea37b1f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-07

    New timestamp stub for link time builddate

A	nsd/stamp.c

commit e86044d9215ddb556adbf331e33332b2a798fa7f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-07

    Added link-time builddate timestamp and fixed dependencies for nsd76 and nsd8x to avoid recompile each time

M	nsd/Makefile

commit 2761af3bfcb6d9bcf46947d0230239b5b16e3111
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-07

    Fixed compile bug for platforms with BSD setpgrp

M	nspd/main.c

commit e48186daecf36b81886ca3d555b9e75100160b74
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-04

    Add developer documentation

A	index.html
A	nscgi/nscgi.html

commit ca730e9af27dd15b484975d8f6a990c3a4ab7f26
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-10-04

    Add latest missing entries to ChangeLog

M	ChangeLog

commit 8212909cfe043dd58eb16269a4478350a3269f22
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-03

    Stopped using pthread_once as it appears to require a lock

M	thread/pthread.cpp

commit 9a702bce32964293d4004b18c47e50c23b24838a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-03

    Remove cthread.cpp depend

M	thread/Makefile

commit a25e5199d71089aa5f1d5bcf40cb514c26c0e342
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-03

    Removed cthread errno API's, macOS now has thread-safe errno

M	nsd/sock.c

commit 8ba13be7602c56bce74d2dcaaa4bd0c5b604f0c1
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-03

    Updated to use HAVE_CMMSG and HAVE_BSDSETPGRP

M	nspd/main.c

commit cdb43990c3849e68cf25d1ee02da5c0136e3df71
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-03

    Check for MACOSX instead of __APPLE__ in preprocessor test

M	nsd/nsmain.c

commit 2dc208d137dce5b20358a0fa48c96b3da07a1989
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-03

    Update to version 3.11

M	nsd/nsd.h

commit e07b235595b8ded0941e36768f69995efd71e88d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-03

    Updates for macOS and use of HAVE_BSDSETPGRP

M	include/Makefile.global
M	include/nsthread.h

commit caf4dabea55ad11aa69d069175f2d85e83fed435
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-03

    Updates for macOS, now using pthreads

D	thread/cthread.cpp
M	thread/osthread.c
M	thread/pthread.cpp
M	thread/reentrant.c
M	thread/signal.c

commit 2601f706f8d256aab5c85369677dc6faa246e87f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-10-03

    Set close-on-exec on received fd from binder

M	nsd/binder.c

commit 720754ee6ef10d5acef110bdabe953a3896a50ed
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-09-29

    Removed setting bufsize to uninitialized value on ssl

M	nssock/sock.c

commit 0adbaeb88edda41f219694e6fdb924ecc1b376fa
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-29

    Add "Expires: now" header to nstelemetry.adp to ensure it gets run each time it's visitted

M	ChangeLog

commit a593d1c82fc38ba324ea0f4d18bc0998a1f9c453
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-29

    (AppendConn): Fix race condition with connPtr
    
    This may be a losing battle.  It appears to work on a busy Irix
    server, so I'm declaring victory for now.

M	ChangeLog
M	nsd/serv.c

commit 413a0d627bb950990451ef558c9b544ef96908f9
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-29

    Add missing ChangeLog entry about sock.c SockRead fix

M	ChangeLog

commit c2b74f1b9344e125883988e8278b8684932b958f
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-29

    (NsConnArgProc): Fix race condition when threads exit while [ns_info threads] is run; arg can be NULL
    
    Seen mostly by nstelemetry.adp.

M	ChangeLog
M	nsd/serv.c

commit c79549fae803044f286a4691c85ed7761225a7fc
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-09-25

    Fixed buffered read code in SockRead

M	nssock/sock.c

commit 410e3120a10c2124301dbfab544a113845c72438
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-07

    Build fixes for HP/UX 10.20 and 11

M	include/Makefile.global

commit 6e4605aefb44ed267a5214ad74902d53b3071f32
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-07

    Win32 installation keeps DLL's as DLL's now

M	win32/aolserver.dsw
M	win32/main/main.dsp

commit 55df4b3a7212778a5bb25123ba68651878f52cb3
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-06

    Renamed ReadFile and WriteFile to avoid Win32 naming conflicts

M	nssock/ssltcl.c

commit 595e476ee57ab0b841f028e7e4b44d0aff8adeed
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-06

    Build nsssl for win32

A	win32/nsssl/nsssl.dsp

commit 72c9e80f29bd06637d18aad315978cde640c579f
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-06

    Fix module installation using INSTSRVMOD variable

M	nssock/Makefile

commit 51add68ae545b74ce739b6622299f77cd5a36c4e
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-06

    Remove duplicate ChangeLog notes from documentation pages

D	doc/release.html

commit 6a27fbf15745f83960994f2ccb8befbe44dd290b
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-06

    The doc directory is not a web site anymore

D	doc/index.html

commit cd43f860c1ad90976ca13bb630171be0f359842b
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-06

    Move module docs into module directories

M	doc/index.html
D	doc/nsftp.txt
D	doc/nspostgres.txt
R074	doc/nsssl2.txt	nssock/nsssl.txt

commit 0068a61bd3d356170baa1b039ef2d289cd606667
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-06

    Add missing 3.1 changes to ChangeLog

M	ChangeLog

commit 46004e2a02942e466f921b6fc3ce38cd9e330645
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-06

    Make doumentation look like website http://aolserver.com/docs

M	doc/index.html

commit f732345c9687f9b1659b6099e2556dafce2ad19e
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-06

    Sample, fake keyfile and certfile are installed on new installations only

M	nssock/Makefile
A	nssock/certfile.pem
A	nssock/keyfile.pem

commit 690405aee640142c3708872ae4db8a2bc064d6ef
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-09-05

    Added missing break for unauthorized case in ConnRun

M	nsd/serv.c

commit b7bcfd97502ae6b10b96f7049365c677f24a5715
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-28

    Removed rcsid from header

M	thread/test.c
M	thread/thread.h

commit 39d398b796cfad9738ca335b476d06a448921e22
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-28

    Enabled password echo by default on all platforms - doesn't appear to be working yet

M	nscp/nscp.c

commit be44835f2e53620dec8c74e3ab74cb418687bec3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-28

    Made password echo option configurable, on by default on WIN32 and Linux, off otherwise

M	nscp/nscp.c

commit fd2ae3577d7ff6b47a573186698b1dfed2f1da25
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-28

    Made TCL data TLS slot self initializing

M	nsd/tclinit.c

commit 8d041c3dceb0dcd8f8cde6ef49f9281d52b81717
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-28

    Made ADP data TLS slot self-initializing

M	nsd/adp.c

commit 961802b9274f85164acfe88c722dffb2e703fd2d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-28

    Modified current per-thread handle count to use a single TLS slot instead of a slot per pool

M	nsd/dbinit.c

commit fb92540bf9dfab7d7ec5815e09b2c04ecc99b685
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-28

    Made current conn TLS self initializing, fixing ns_conn isconnected

M	nsd/conn.c
M	nsd/serv.c

commit 339426d870a22033b67e8a5e0e0a4ada11bbe587
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-26

    Fixed bug with ns_adp_parse ignoring given parser

M	nsd/adp.c

commit 0379b87e5bf3d683433ff521b0458392fefd4315
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-25

    Fixed bug of not restoring the given string to original state during chunky compile

M	nsd/adp.c

commit e4c49c4a3abb0d7a5b2c6115eb78a5d3e8717f4c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-25

    Added ns_adp_registertag command as documented

M	nsd/tclcmds.c

commit de9ef860bb608636c83763d207d62a7358258554
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-25

    Fixed some startup message formatting problems

M	nsd/nsmain.c

commit bdebeb2613f5828d410f3f9a305306f1b792555d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-25

    Added .png mime-type

M	nsd/mimetypes.c

commit 97763809e051b544fb3543e64dd50575cdb5c070
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-25

    Removed unreferenced variable in ns_adp_parse

M	nsd/adp.c

commit 77cc4d5ce7d1b53d878f572f1e03f8bf03519e5c
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-25

    Removed some less useful comments

M	nsd/adpfancy.c
M	nsd/auth.c
M	nsd/cache.c
M	nsd/dbutil.c
M	nsd/dstring.c
M	nsd/filter.c
M	nsd/index.c
M	nsd/lisp.c
M	nsd/mimetypes.c
M	nsd/nsthread.c
M	nsd/set.c
M	nsd/str.c
M	nsd/tclconf.c
M	nsd/tclfile.c
M	nsd/tclresp.c
M	nsd/url.c
M	nsd/urlencode.c
M	nsd/urlspace.c
M	thread/oldpools.c

commit a8369f50f65d5542516898921e5e6c024c6d8441
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-25

    Fixed crash bug in error message in ns_socknread

M	nsd/tclsock.c

commit ea10a28f2a4a4e374b2a1b892179c75ccd19f6a2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-25

    Fixed deadlock between Ns_DRand/Ns_GenSeeds

M	nsd/random.c

commit 4807c0e0a418b3b7d9b5e897911fc2a3c306cac2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-25

    Fixed crash bug with ns_adp_parse -parser

M	nsd/adp.c

commit 9067635c647a1fc7ec968fb79bb41fa64b5b1520
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-09-06

    Tag aolserver-3.1.0

M	.hgtags

commit fea34605aa8f4cd3a450ecb04c85743941b0ed53
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-21

    IAC handling disabled on Win32 because windows telnet is a joke

M	ChangeLog
M	nscp/nscp.c

commit acb95c00cf4dd7cabe1e43fa0aedb1fdf547cc7e
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-21

    Module nscp makes some attempt to recognize and handle telnet IAC codes
    
    This allows CTRL-C and CTRL-D to work from the client for people who
    get stuck and don't want to use CTRL-].  It's a very dirt-simple
    implementation of the telnet protocol so only standard Unix telnet is
    supported.  The win32 telnet client sends too many IAC's that I do
    not care to handle at this time, so they are just dropped with a
    warning sent to the server.log.
    
    (GetLine): password is no longer echoed back to the client.

M	ChangeLog
M	nscp/nscp.c

commit 6d9f921a70d8c18cdc75bffcc29f02b33e4c9a5d
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-21

    Corrected range-checker ChangeLog entry

M	ChangeLog

commit 8a9a6fe1d6ff4a2f1fc981d1130f6a2aed48faf1
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-20

    Remove nsexample module from aolserver distribution

D	nsexample/Makefile
D	nsexample/nsexample.c

commit f2cee59b618b6627c1905a85fe6e79c855bcbf86
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-20

    Optional modules nsftp, nspostgres, nssolid, nssybpd moved to top-level

M	ChangeLog
M	Makefile

commit b13d5fcda3524fb4740aeaa6bc25d6fc14a201fa
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-18

    Added namespace export to init script

M	tcl/namespace.tcl

commit 0183b473df0f7185df2168bca8beabd695686718
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-18

    ETIME bug work around: don't cause wakeup in Ns_CondWait and Ns_CondTimedWait instead of waiting again
    
    This is more conservative and should avoid problems some have had
    with threads missing wakeup.

M	thread/pthread.cpp

commit 97a3a94e26b8506a123a40b84d40983df8d06333
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-18

    Added dependency for osthread.o

M	thread/Makefile

commit 3720f77fb1f7fa454997cc2caa1f8cef7b92d85e
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-18

    Jim's 8/17 changes

M	ChangeLog

commit 570cbf3212ca77b7f1795619da168654da91e1b2
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-18

    Removed unused variables in GetCsvCmd

M	nsd/dbtcl.c

commit 1a32cd0f59300c58ef9c0ae5776cd72373d03321
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-18

    Fixed bug of not truncating output buffer when an error was thrown during an ns_adp_parse
    
    Fix suggested by Rob Mayoff.

M	nsd/adp.c

commit 5dfdc4b931e9ae757a142889f38875a286b1dadd
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-18

    Use a dstring to create the column list instead of incrementally setting the output variable with Tcl_SetVar
    
    This was necessary to avoid conflicting definitions of the needed
    TCL_ flags between 7.6 and 8.x.

M	nsd/dbtcl.c

commit 5c70015f374a8fb38804c8fbdfb8378127f77c8b
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-17

    Switched to blocking Tcl_WaitPid to avoid zombies as suggested by Rob Mayoff

M	ChangeLog
M	tcl7.6/unix/tclUnixPipe.c

commit d786cc71121af9b1607f96f22ed730dfce444d8f
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-17

    Jim's change to thread

M	ChangeLog

commit 17a46721c3b55f2f09a243ce37c1015aacb8798d
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-17

    Clarify server-busy log message

M	nssock/sock.c

commit 2e3e37d580dcd1b24a91131bfeadfe28a8c0438c
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-17

    (SockThread): Warning sent to log when Server Busy is returned

M	ChangeLog
M	nssock/sock.c

commit 8848898ec75777c74b68ed0e802ab85f139c4d41
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-17

    Sets thread stack size as on other platforms

M	thread/win32.cpp

commit 1858dd9ec1124ffc463670d627445417b1f99228
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-17

    NULL out thread arg at exit to avoid Ns_ThreadEnum checking arg info for possibly deallocated context as seen in ns_info threads
    
    Also, moved read of firstPtr in Ns_ThreadEnum inside lock.

M	thread/thread.c

commit 765eef033b141e07dbe14f2767a5e170505476db
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-17

    Modules that don't have required libraries are still cleaned
    
    These are nspostgres, nssock, nssolid, nsssl, and the nssybpd application.

M	nssock/Makefile

commit b68d05cae0085fe98b688d816f7279739dc0ca0a
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-17

    Fix install location of headers and libnsthread.a

M	Makefile
M	include/Makefile.global

commit d51137953e8e4f2eba29ab8e2517c8ac5c5e6a88
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-17

    Ns_Log and Ns_Fatal standardized and hopefully more helpful to both admins and developers

M	ChangeLog
M	nsd/Makefile
M	nsd/adp.c
M	nsd/adpfancy.c
M	nsd/binder.c
M	nsd/callbacks.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/dbdrv.c
M	nsd/dbinit.c
M	nsd/dbtcl.c
M	nsd/drv.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/keepalive.c
M	nsd/log.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/nsmain.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/pidfile.c
M	nsd/random.c
M	nsd/return.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/serv.c
M	nsd/sockcallback.c
M	nsd/tclinit.c
M	nsd/tclop.c
M	nsd/tclstats.c
M	nsd/unix.c
M	nsd/urlopen.c

commit 010c061bdf5fb55e574817a23b953ac08a7d9b7e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-17

    Added tclIOGT.c as required by tcl8.3.2

M	win32/nstcl/nstcl.dsp

commit b7d3b2db9206e815ed0d74b23e26708497d7541a
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-16

    Update version from 3.0.1 to 3.1

M	nsd/nsd.h

commit e729b3a8378044db26c90525b808f993ece6003d
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-16

    Remove Ns_CacheTimedGetValue which was an odd interface not used anywhere

M	include/ns.h
M	nsd/cache.c

commit fb35b3e777bd2efaa0c0b431c782a6ba21566196
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-15

    gmake install works darn near everywhere

M	nspd/Makefile
M	thread/Makefile

commit 412a20b4462c9dd1b84deae0c583808022fa6f0f
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-15

    Fixed the lib install dir; gmake clean works for optional modules; libnspd.a now installs correctly
    
    include/Makefile.global (INSTLOG): should have pointed to
    $(INST)/lib, not $(INST)/modules/lib.
    
    Makefile: nsunix resurrected.  All modules are built.  If a
    module is missing a library, it is not built, but it won't stop
    the AOLserver build process (no error is thrown).  The build will
    continue with the next module.
    
    nsftp: guesses if you have TCP_WRAPPERS available.

M	ChangeLog
M	include/Makefile.global
M	nspd/Makefile
M	nssock/Makefile
M	tcl7.6/Makefile
M	thread/Makefile

commit 93a0b53b3f36a04eba360d8cde3cc542bd464fc5
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-15

    Build path fix for nspd

M	include/Makefile.global

commit 7cb9419fab51b13ac761aa22985bb5b973290660
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-15

    Build system cleanups; Log notices should be standardized throughout the system
    
    nsext: Ten guesses why $(NSHOME)/include/nsextmsg.h was
    duplicated here.
    
    nssybpd: Hopefully, the log statements will be easier to
    understand by both admins and developers.  It's still messy since
    it uses syslog.  Makefile redone to use standard AOLserver rules.
    RPATH is used a little more intelligently.  Removed files that had
    no business living there.
    
    include/Makefile.global: Took stab at RPATH support on Solaris
    to perhaps remove the need for LD_LIBRARY_PATH on an
    intelligently-administered system.  New rule for libnspd.a.

M	ChangeLog
M	Makefile
M	include/Makefile.global
M	nscgi/Makefile
M	nscgi/nscgi.c
M	nscp/Makefile
M	nscp/nscp.c
M	nsext/Makefile
M	nsext/nsext.c
D	nsext/nsextmsg.h
M	nslog/Makefile
M	nslog/nslog.c
M	nspd/Makefile
M	nspd/log.c
M	nspd/main.c
M	nsperm/Makefile
M	nsperm/nsperm.c
M	nssock/Makefile
M	nssock/sock.c
M	nssock/ssl.c
M	nssock/ssltcl.c
M	nssock/x509.c

commit 3c1dd97d48275883f0e1316a560f4a19b6766055
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-15

    Irix o32 is now the default

M	include/Makefile.global

commit bb5453d36df7e4ae6446f0e8f9f1b6a885cff016
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-15

    Add missing ChangeLog entries

M	ChangeLog
M	Makefile
M	README.txt

commit a2db8ff028e33b0ecc2a293b97d23d6b68db790e
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-15

    A little tweak to the include statement at the bottom

M	nsexample/Makefile

commit ca1669ed80c4bb7acc67153483e9384053bca8bf
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-14

    Never used - removed as with tcl8.x

D	tcl7.6/unix/dltest/Makefile.in
D	tcl7.6/unix/dltest/README
D	tcl7.6/unix/dltest/configure
D	tcl7.6/unix/dltest/configure.in
D	tcl7.6/unix/dltest/pkga.c
D	tcl7.6/unix/dltest/pkgb.c
D	tcl7.6/unix/dltest/pkgc.c
D	tcl7.6/unix/dltest/pkgd.c
D	tcl7.6/unix/dltest/pkge.c
D	tcl7.6/unix/dltest/pkgf.c

commit ec73098c9072e3e4205fb423ff772f0c73618f0e
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-14

    Updated for tcl8.3.2

M	include/Makefile.global
M	include/tcl83.h
M	include/tclDecls.h
M	win32/nstcl/nstcl.dsp

commit ddb32748979c4accf39d6a854595931f5365ca37
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-14

    Added a simple 1-byte range check to -z allocator

M	thread/pool.c

commit dc85473544b96ef00b648e32107ec7278bb69177
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-11

    Fix Connection: close and end-of-line handling
    
    Always add "Connection: close" to the request line to satisfy HTTP
    1.1 RFC -- this would break MSIE in HTTP 1.1 mode.
    
    HTTP_EOL of "\r\n" used on all request lines for stupid web servers
    on the other end.
    
    Protocol "tcp" added as synonym of "http" for old-time Unix heads.
    
    Lots of folks lended a hand on this one -- Satyam Priyadarshy,
    Jerry Asher, Kriston Rehberg, and special thanks to Wanda G. at AOL
    for adding a CNAME in DNS so quickly.

M	ChangeLog

commit e237cbeacb27637547d5263c1819e65facfbd861
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-10

    First crack at 3.1 docs
    
    Title page extremely simplified.  SSL docs updated.  Release notes
    updated.  NSV docs corrected (thanks to Todd Levy <dcitodd@aol.com>).

M	ChangeLog
M	doc/index.html
M	doc/nsssl2.txt
M	doc/nsv.txt
M	doc/release.html
M	doc/threads.txt

commit a04e5f49d64acf8320c4c59046cb1e5fa43e9291
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-09

    Jim's changes collected into ChangeLog

M	ChangeLog

commit a4c87c843129eb9ca09b91e77192e2e491c68fb7
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-09

    keepalivetimeout 0 means keepalive is disabled

M	doc/config.txt

commit ece5dc0fc8d064898fefda9bab3d6ecc126ee01f
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-08

    Changed build file from nssock.c to sock.c

M	win32/nssock/nssock.dsp

commit 761d1f01afca622efcedef77767dfbf184bafab4
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-08

    Added a wrapper startup for Tcl_CreateThread for the benefit of Win32

M	thread/tcl8x.c

commit b5736c4a015600766d7819ed8e850ed6553b5f45
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-08

    Fixed bug with ns_info pid

M	nsd/tclmisc.c

commit 627112d8ac6128d43c7e1292c037336c109d6b2a
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-08

    Fix compile bug

M	thread/thread.c

commit d69e7baa9023e5895e41eb878e014354812e36a3
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-08

    Removed unneeded fileTable which could result in crashes when fd's where reused quickly

M	tcl7.6/generic/tclFHandle.c

commit 71bc4aad08f10fe435644b7f197377f80267adeb
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-08

    Added Ns_ThreadCreate2 in thread.c needed for upgrade to Tcl 8.3.1 in tcl8x.c

M	thread/tcl8x.c
M	thread/thread.c

commit c0bc0952054cfa47ae8edc33a85e55befd128f28
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-08

    Upgrade to Tcl 8.3.1

M	include/tcl.h
M	include/tcl83.h
M	include/tclDecls.h
M	win32/nstcl/nstcl.dsp

commit 2cadfb18041d53f78ff7a9c42b8a8fef04535973
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-08

    Added Ns_ThreadCreate2 with extra flags argument used by Tcl_CreateThread to create a detached thread

M	include/nsthread.h

commit 6b77139807ff48c9909d84f8606bbc84b8666dba
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-08

    Make gcc -shared -nostartfiles the default LDSO; upgrade to Tcl 8.3.1

M	include/Makefile.global

commit 65957dc063dd6a7ccc1036c29e31c4abe960a1ac
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-08

    Re-ordered shutdowns to ensure connection threads are stopped before other shutdowns begin (e.g., sched, sockcallback)

M	nsd/keepalive.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/sched.c
M	nsd/serv.c

commit f01a1b986196342904057251a588cd1185ab92c7
Author: Jim Davidson <jgdavidson@aol.com>
Date:   2000-08-08

    Removed severityRank array.

M	nsd/log.c

commit c7959a3eef82bfc99d1744e7826101312a3ae9cf
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2000-08-06

    Fixed line 443 - assignment was reversed, causing segmentation fault at run time

M	ChangeLog
M	nsd/log.c

commit e65e5e79263d3f6e291b657bc248d02929757f66
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2000-08-06

    Updated to work with BSAFE v4 and 5
    
    You'll need to specify the path to your BSAFE libraries and the BSAFE
    version in the nssock/Makefile before compiling. If you don't have
    BSAFE and want to compile without SSL at all, edit the top-level
    Makefile and take out all the "SSL=1" text.

M	ChangeLog
M	nssock/Makefile
M	nssock/t_stdlib.c

commit 927a1d977d46fafa1bc41e3c1a9665b31e6808b2
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-03

    Build process now more rule-oriented; Ns_ModLog removed; [ns_info pid] added
    
    The cleaning rules "distclean" and "clobber" were removed.
    
    The Tcl libraries are always distcleaned when "gmake clean" is
    invoked.
    
    Rules that can be used as dependencies were made for libnsthread and
    the Tcl libraries -- their names are "libnsthread," "libtcl76," and
    "libtcl8x," respectively.
    
    PREFIX is now used as the installation directory (along with INST), so
    the more familiar "gmake install PREFIX=/usr/local/aolserver" will
    work.
    
    Additionally, gmaking in a subdirectory with dependencies now works.
    
    
    The sourge of modlog has been removed.  All code included with AOLserver
    that used Ns_ModLog now doesn't.  Many log statements are now hopefully
    more standardized.  This will be a continuing improvement over the next
    several updates.  I would like to use gcc's __FUNCTION__ macro but it
    doesn't work on native compilers, but we may start using __LINE__ and
    __FILE__ instead or replace Ns_Log with a smart macro that takes care of
    all this stuff for us.
    
    
    (NsTclInfoCmd): ns_info pid added to return the process id.

M	ChangeLog
M	Makefile
M	doc/config.txt
M	doc/install.txt
M	include/Makefile.global
M	include/ns.h
M	include/nsextmsg.h
M	include/nspd.h
M	include/nsthread.h
M	include/tcl.h
M	nscgi/nscgi.c
M	nscp/nscp.c
M	nsd/Makefile
M	nsd/adp.c
M	nsd/adpfancy.c
M	nsd/auth.c
M	nsd/binder.c
M	nsd/cache.c
M	nsd/callbacks.c
M	nsd/config.c
M	nsd/conn.c
M	nsd/crypt.c
M	nsd/dbdrv.c
M	nsd/dbinit.c
M	nsd/dbtcl.c
M	nsd/dbutil.c
M	nsd/dns.c
M	nsd/drv.c
M	nsd/dstring.c
M	nsd/exec.c
M	nsd/fastpath.c
M	nsd/fd.c
M	nsd/filter.c
M	nsd/getopt.c
M	nsd/httptime.c
M	nsd/id.c
M	nsd/index.c
M	nsd/keepalive.c
M	nsd/lisp.c
M	nsd/listen.c
M	nsd/log.c
M	nsd/main.c
M	nsd/mimetypes.c
M	nsd/modload.c
M	nsd/nsconf.c
M	nsd/nsd.h
M	nsd/nsmain.c
M	nsd/nsthread.c
M	nsd/nswin32.c
M	nsd/op.c
M	nsd/pathname.c
M	nsd/pidfile.c
M	nsd/proc.c
M	nsd/quotehtml.c
M	nsd/random.c
M	nsd/request.c
M	nsd/return.c
M	nsd/rollfile.c
M	nsd/sched.c
M	nsd/serv.c
M	nsd/set.c
M	nsd/sock.c
M	nsd/sockcallback.c
M	nsd/str.c
M	nsd/tclcmds.c
M	nsd/tclconf.c
M	nsd/tclenv.c
M	nsd/tclfile.c
M	nsd/tclinit.c
M	nsd/tclinvoke.cpp
M	nsd/tclmisc.c
M	nsd/tclnsshare.cpp
M	nsd/tclop.c
M	nsd/tclresp.c
M	nsd/tclsched.c
M	nsd/tclset.c
M	nsd/tclstats.c
M	nsd/tclstub76.c
M	nsd/tclstub8x.c
M	nsd/tclthread.c
M	nsd/tclvar.c
M	nsd/unix.c
M	nsd/url.c
M	nsd/urlopen.c
M	nsd/urlspace.c
M	nsext/nsext.c
M	nsext/nsextmsg.c
M	nsext/nsextmsg.h
M	nslog/nslog.c
M	nspd/listen.c
M	nspd/log.c
M	nspd/main.c
M	nspd/pd.h
M	nsperm/compat.tcl
M	nsperm/init.tcl
M	nsperm/nsperm.c
M	nssock/Makefile
M	nssock/x509.c
M	tcl/debug.tcl
M	tcl/init.tcl
M	tcl/modlog.tcl
M	tcl/namespace.tcl
M	tcl/nsdb.tcl
M	tcl/sendmail.tcl
M	tcl/util.tcl
M	tcl7.6/Makefile
M	tcl7.6/generic/tclPosixStr.c
M	thread/Makefile
M	thread/compat.c
M	thread/cond.c
M	thread/cs.c
M	thread/cthread.cpp
M	thread/debug.c
M	thread/error.c
M	thread/master.c
M	thread/memory.c
M	thread/mutex.c
M	thread/oldpools.c
M	thread/osthread.c
M	thread/pool.c
M	thread/pthread.cpp
M	thread/reentrant.c
M	thread/rwlock.c
M	thread/sema.c
M	thread/signal.c
M	thread/sproc.cpp
M	thread/tcl8x.c
M	thread/test.c
M	thread/thread.c
M	thread/thread.h
M	thread/time.c
M	thread/tls.c
M	thread/win32.cpp
M	thread/windir.cpp

commit b3005179933ae1eaa43ed8d347aaf526ad1cf518
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-01

    (Ns_AdpRequest): The enableexpire option was putting an Expires header even if it already existed.

M	nsd/adp.c

commit c763916516737030d89dc4ebf01255f04b700f45
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-01

    (ns_getform): MSIE presents the wrong stuff to the server when a multipart/formdata POST is redirected
    
    Workaround contributed by Joseph Bank.

M	tcl/form.tcl

commit 29f926f4f8f0718270854ce1d91c8a701f9decd1
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-01

    (NsTclSockOpenCmd): Removed spurious Ns_Log Notice from ns_sockopen

M	nsd/tclsock.c

commit d3000fa01fcc5e273737df07fbf314c635b7f8f9
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-01

    (_ns_dirlist): base href removed -- links are now fully-qualified

M	tcl/fastpath.tcl

commit bb191f39c0a621d5860896ae2f2ea649f773d3f0
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-01

    (_ns_http_gets): \n replaced by \r in all but _ns_http_gets so that arbitrary headers get set correctly
    
    Contributed by Jin Choi <jsc@arsdigita.com>.

M	tcl/http.tcl

commit 746b364509132c95798643645dba7d34a77b201c
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-08-01

    (Tcl_SignalMsg): Patch to Tcl 7.6 for Red Hat on SPARC architectures
    
    Contributed by Mike Chan <snotty@linux.com>.

M	tcl7.6/generic/tclPosixStr.c

commit 3a64b3217bf3afbfd9dae7f29c829a49603cc198
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-07-13

    Obsolete file removed

D	include/tcl82.h

commit a9242a43f96a8f2ec1f595e55dc49d44c2edd5b2
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-07-13

    The fabulous echo command is now a macro

M	include/Makefile.global

commit ba0bba680b6376a3b78318d00ca5bc86040ec977
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-07-13

    SSL support merged back with nssock
    
    Both nsssl and nssock use identical socket code.
    Rename nssock.c sock.c

M	ChangeLog
M	Makefile
M	nssock/Makefile
A	nssock/keygen.tcl
R080	nssock/nssock.c	nssock/sock.c
A	nssock/ssl.c
A	nssock/ssl.h
A	nssock/ssltcl.c
A	nssock/ssltcl.h
A	nssock/t_stdlib.c
A	nssock/x509.c
A	nssock/x509.h

commit 639edc868a586b115983e933c7950d4c9c542fad
Author: Scott S. Goodwin <scott@scottg.net>
Date:   2000-06-20

    Add a 'how to compile' section
    
    Updated with info on compiling the domestic module and using RSA
    BSAFE Crypto-C library versions 4.x and 5.x.

M	doc/nsssl2.txt

commit 027c9298e2cbf07d4d64cf7890bf1e6fe98b97ad
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-05-09

    Re-added doc directory which has had the online docs removed

M	ChangeLog
A	doc/config.txt
A	doc/index.html
A	doc/install.txt
A	doc/internals.txt
A	doc/nsftp.txt
A	doc/nspostgres.txt
A	doc/nsssl2.txt
A	doc/nsv.txt
A	doc/release.html
A	doc/threads.txt

commit eeb956b1d01979f18e8c5dea046e28258994a16a
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-05-02

    Tiny doc note

M	nsexample/Makefile

commit e24de82e57c56ca69b5cdbd9e0f0ace9fc9574a9
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-05-02

    Use NSHOME variable to locate AOLserver
    
    NSHOME is automatically figured out in the top-level Makefile and
    all the lower Makefiles still use relative directory paths.  The
    intention of NSHOME is for modules that do NOT live in the
    AOLserver source directory tree.  The nsexample/Makefile explains
    how this works.

M	ChangeLog
M	Makefile
M	include/Makefile.global
M	include/Makefile.module
M	nsexample/Makefile

commit 623c68241de1d3bfb16e5331631438019a5e58fd
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-05-02

    Add nsftp module, by Eric O'Laughlen

M	ChangeLog
M	Makefile
M	include/Makefile.global
M	nsd/Makefile

commit d5614167e591836b5d83ecae40ebfd7884f0264c
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-05-02

    Tag aolserver-3.0.0

A	.hgtags

commit 364587e4af3ff9e26f236a43fcdc5a3613cc3a66
Author: Kriston Rehberg <kriston@aol.com>
Date:   2000-05-02

    Initial revision

A	ChangeLog
A	LICENSE.txt
A	Makefile
A	README.txt
A	include/Makefile.global
A	include/Makefile.module
A	include/ns.h
A	include/nsextmsg.h
A	include/nspd.h
A	include/nsthread.h
A	include/tcl.h
A	include/tcl76.h
A	include/tcl82.h
A	include/tcl83.h
A	include/tclDecls.h
A	nscgi/Makefile
A	nscgi/nscgi.c
A	nscp/Makefile
A	nscp/nscp.c
A	nsd/Makefile
A	nsd/adp.c
A	nsd/adpfancy.c
A	nsd/auth.c
A	nsd/binder.c
A	nsd/cache.c
A	nsd/callbacks.c
A	nsd/config.c
A	nsd/conn.c
A	nsd/crypt.c
A	nsd/dbdrv.c
A	nsd/dbinit.c
A	nsd/dbtcl.c
A	nsd/dbutil.c
A	nsd/dns.c
A	nsd/drv.c
A	nsd/dstring.c
A	nsd/exec.c
A	nsd/fastpath.c
A	nsd/fd.c
A	nsd/filter.c
A	nsd/getopt.c
A	nsd/getopt.h
A	nsd/httptime.c
A	nsd/htuu.c
A	nsd/id.c
A	nsd/index.c
A	nsd/keepalive.c
A	nsd/lisp.c
A	nsd/listen.c
A	nsd/log.c
A	nsd/main.c
A	nsd/mimetypes.c
A	nsd/modload.c
A	nsd/nsconf.c
A	nsd/nsd.h
A	nsd/nsmain.c
A	nsd/nsthread.c
A	nsd/nswin32.c
A	nsd/op.c
A	nsd/pathname.c
A	nsd/pidfile.c
A	nsd/proc.c
A	nsd/quotehtml.c
A	nsd/random.c
A	nsd/request.c
A	nsd/return.c
A	nsd/rollfile.c
A	nsd/sched.c
A	nsd/serv.c
A	nsd/set.c
A	nsd/sock.c
A	nsd/sockcallback.c
A	nsd/str.c
A	nsd/tclcmds.c
A	nsd/tclconf.c
A	nsd/tclenv.c
A	nsd/tclfile.c
A	nsd/tclinit.c
A	nsd/tclinvoke.cpp
A	nsd/tclmisc.c
A	nsd/tclnsshare.cpp
A	nsd/tclop.c
A	nsd/tclresp.c
A	nsd/tclsched.c
A	nsd/tclset.c
A	nsd/tclsock.c
A	nsd/tclstats.c
A	nsd/tclstub76.c
A	nsd/tclstub8x.c
A	nsd/tclstubs.cpp
A	nsd/tclthread.c
A	nsd/tclvar.c
A	nsd/unix.c
A	nsd/url.c
A	nsd/urlencode.c
A	nsd/urlopen.c
A	nsd/urlspace.c
A	nsexample/Makefile
A	nsexample/nsexample.c
A	nsext/Makefile
A	nsext/nsext.c
A	nsext/nsextmsg.c
A	nsext/nsextmsg.h
A	nslog/Makefile
A	nslog/nslog.c
A	nspd/Makefile
A	nspd/listen.c
A	nspd/log.c
A	nspd/main.c
A	nspd/pd.h
A	nsperm/Makefile
A	nsperm/compat.tcl
A	nsperm/group
A	nsperm/hosts.allow
A	nsperm/hosts.deny
A	nsperm/init.tcl
A	nsperm/nsperm.c
A	nsperm/passwd
A	nsperm/perms
A	nssock/Makefile
A	nssock/nssock.c
A	tcl/debug.tcl
A	tcl/fastpath.tcl
A	tcl/file.tcl
A	tcl/form.tcl
A	tcl/http.tcl
A	tcl/init.tcl
A	tcl/modlog.tcl
A	tcl/namespace.tcl
A	tcl/nsdb.tcl
A	tcl/prodebug.tcl
A	tcl/sendmail.tcl
A	tcl/util.tcl
A	tcl7.6/Makefile
A	tcl7.6/README-aolserver.txt
A	tcl7.6/compat/README
A	tcl7.6/compat/dirent.h
A	tcl7.6/compat/dirent2.h
A	tcl7.6/compat/dlfcn.h
A	tcl7.6/compat/fixstrtod.c
A	tcl7.6/compat/float.h
A	tcl7.6/compat/getcwd.c
A	tcl7.6/compat/gettod.c
A	tcl7.6/compat/license.terms
A	tcl7.6/compat/limits.h
A	tcl7.6/compat/opendir.c
A	tcl7.6/compat/stdlib.h
A	tcl7.6/compat/strftime.c
A	tcl7.6/compat/string.h
A	tcl7.6/compat/strncasecmp.c
A	tcl7.6/compat/strstr.c
A	tcl7.6/compat/strtod.c
A	tcl7.6/compat/strtol.c
A	tcl7.6/compat/strtoul.c
A	tcl7.6/compat/tclErrno.h
A	tcl7.6/compat/tmpnam.c
A	tcl7.6/compat/unistd.h
A	tcl7.6/compat/waitpid.c
A	tcl7.6/generic/README
A	tcl7.6/generic/panic.c
A	tcl7.6/generic/regexp.c
A	tcl7.6/generic/tcl.h
A	tcl7.6/generic/tclAsync.c
A	tcl7.6/generic/tclBasic.c
A	tcl7.6/generic/tclCkalloc.c
A	tcl7.6/generic/tclClock.c
A	tcl7.6/generic/tclCmdAH.c
A	tcl7.6/generic/tclCmdIL.c
A	tcl7.6/generic/tclCmdMZ.c
A	tcl7.6/generic/tclDate.c
A	tcl7.6/generic/tclEnv.c
A	tcl7.6/generic/tclEvent.c
A	tcl7.6/generic/tclExpr.c
A	tcl7.6/generic/tclFCmd.c
A	tcl7.6/generic/tclFHandle.c
A	tcl7.6/generic/tclFileName.c
A	tcl7.6/generic/tclGet.c
A	tcl7.6/generic/tclGetDate.y
A	tcl7.6/generic/tclHash.c
A	tcl7.6/generic/tclHistory.c
A	tcl7.6/generic/tclIO.c
A	tcl7.6/generic/tclIOCmd.c
A	tcl7.6/generic/tclIOSock.c
A	tcl7.6/generic/tclIOUtil.c
A	tcl7.6/generic/tclInt.h
A	tcl7.6/generic/tclInterp.c
A	tcl7.6/generic/tclLink.c
A	tcl7.6/generic/tclLoad.c
A	tcl7.6/generic/tclLoadNone.c
A	tcl7.6/generic/tclMain.c
A	tcl7.6/generic/tclNotify.c
A	tcl7.6/generic/tclParse.c
A	tcl7.6/generic/tclPatch.h
A	tcl7.6/generic/tclPkg.c
A	tcl7.6/generic/tclPort.h
A	tcl7.6/generic/tclPosixStr.c
A	tcl7.6/generic/tclPreserve.c
A	tcl7.6/generic/tclProc.c
A	tcl7.6/generic/tclRegexp.h
A	tcl7.6/generic/tclTest.c
A	tcl7.6/generic/tclUtil.c
A	tcl7.6/generic/tclVar.c
A	tcl7.6/generic/tclVar.c-
A	tcl7.6/unix/Makefile.in
A	tcl7.6/unix/README
A	tcl7.6/unix/configure
A	tcl7.6/unix/configure.in
A	tcl7.6/unix/dltest/Makefile.in
A	tcl7.6/unix/dltest/README
A	tcl7.6/unix/dltest/configure
A	tcl7.6/unix/dltest/configure.in
A	tcl7.6/unix/dltest/pkga.c
A	tcl7.6/unix/dltest/pkgb.c
A	tcl7.6/unix/dltest/pkgc.c
A	tcl7.6/unix/dltest/pkgd.c
A	tcl7.6/unix/dltest/pkge.c
A	tcl7.6/unix/dltest/pkgf.c
A	tcl7.6/unix/install-sh
A	tcl7.6/unix/ldAix
A	tcl7.6/unix/mkLinks
A	tcl7.6/unix/porting.notes
A	tcl7.6/unix/tclAppInit.c
A	tcl7.6/unix/tclConfig.sh.in
A	tcl7.6/unix/tclLoadAix.c
A	tcl7.6/unix/tclLoadAout.c
A	tcl7.6/unix/tclLoadDl.c
A	tcl7.6/unix/tclLoadDl2.c
A	tcl7.6/unix/tclLoadDld.c
A	tcl7.6/unix/tclLoadNext.c
A	tcl7.6/unix/tclLoadOSF.c
A	tcl7.6/unix/tclLoadShl.c
A	tcl7.6/unix/tclMtherr.c
A	tcl7.6/unix/tclUnixChan.c
A	tcl7.6/unix/tclUnixFCmd.c
A	tcl7.6/unix/tclUnixFile.c
A	tcl7.6/unix/tclUnixInit.c
A	tcl7.6/unix/tclUnixNotfy.c
A	tcl7.6/unix/tclUnixPipe.c
A	tcl7.6/unix/tclUnixPort.h
A	tcl7.6/unix/tclUnixSock.c
A	tcl7.6/unix/tclUnixTest.c
A	tcl7.6/unix/tclUnixTime.c
A	thread/Makefile
A	thread/compat.c
A	thread/cond.c
A	thread/cs.c
A	thread/cthread.cpp
A	thread/debug.c
A	thread/error.c
A	thread/master.c
A	thread/memory.c
A	thread/mutex.c
A	thread/oldpools.c
A	thread/osthread.c
A	thread/pool.c
A	thread/pthread.cpp
A	thread/reentrant.c
A	thread/rwlock.c
A	thread/sema.c
A	thread/signal.c
A	thread/sproc.cpp
A	thread/tcl8x.c
A	thread/test.c
A	thread/thread.c
A	thread/thread.h
A	thread/time.c
A	thread/tls.c
A	thread/win32.cpp
A	thread/windir.cpp
A	win32/README
A	win32/aolserver.dsw
A	win32/cgitest/cgitest.dsp
A	win32/cgitest/main.c
A	win32/main/main.dsp
A	win32/nscgi/nscgi.dsp
A	win32/nscp/nscp.dsp
A	win32/nsd/nsd.dsp
A	win32/nslog/nslog.dsp
A	win32/nsodbc/nsodbc.dsp
A	win32/nsperm/nsperm.dsp
A	win32/nssock/nssock.dsp
A	win32/nstcl/nstcl.dsp
A	win32/nsthread/nsthread.dsp
A	win32/test/nsd.tcl
A	win32/test/servers/test/pages/cgitest.bat
A	win32/test/servers/test/pages/index.adp
A	win32/threadtest/threadtest.dsp
